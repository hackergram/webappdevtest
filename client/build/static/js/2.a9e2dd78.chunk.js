/*! For license information please see 2.a9e2dd78.chunk.js.LICENSE */
(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[2],[function(t,e,n){"use strict";t.exports=n(46)},function(t,e,n){t.exports=n(62)()},function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return i})),n.d(e,"__assign",(function(){return o})),n.d(e,"__rest",(function(){return a})),n.d(e,"__decorate",(function(){return s})),n.d(e,"__param",(function(){return u})),n.d(e,"__metadata",(function(){return c})),n.d(e,"__awaiter",(function(){return l})),n.d(e,"__generator",(function(){return h})),n.d(e,"__exportStar",(function(){return p})),n.d(e,"__values",(function(){return f})),n.d(e,"__read",(function(){return d})),n.d(e,"__spread",(function(){return m})),n.d(e,"__spreadArrays",(function(){return y})),n.d(e,"__await",(function(){return g})),n.d(e,"__asyncGenerator",(function(){return v})),n.d(e,"__asyncDelegator",(function(){return _})),n.d(e,"__asyncValues",(function(){return b})),n.d(e,"__makeTemplateObject",(function(){return w})),n.d(e,"__importStar",(function(){return x})),n.d(e,"__importDefault",(function(){return E}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function p(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function f(t){var e="function"===typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function d(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function g(t){return this instanceof g?(this.v=t,this):new g(t)}function v(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof g?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(r){l(o[0][3],r)}var n}function u(t){s("next",t)}function c(t){s("throw",t)}function l(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function _(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:g(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=f(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){(function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)})(r,i,(e=t[n](e)).done,e.value)}))}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function x(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function E(t){return t&&t.__esModule?t:{default:t}}},function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i,o=n(2),a=n(13),s=n(12),u=n(23),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r),l=new a.ErrorFactory("app","Firebase",c),h="@firebase/app",p="0.5.0",f="[DEFAULT]",d=((i={})[h]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),m=new u.Logger("@firebase/app"),y=function(){function t(t,e,n){var r,i,u=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=a.deepCopy(t),this.container=new s.ComponentContainer(e.name),this._addComponent(new s.Component("app",(function(){return u}),"PUBLIC"));try{for(var c=o.__values(this.firebase_.INTERNAL.components.values()),l=c.next();!l.done;l=c.next()){var h=l.value;this._addComponent(h)}}catch(p){r={error:p}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=f),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=f),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){m.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},t}();y.prototype.name&&y.prototype.options||y.prototype.delete||console.log("dc");var g="7.6.0";var v=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!==typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=f);var s=o.name;if("string"!==typeof s||!s)throw l.create("bad-app-name",{appName:String(s)});if(a.contains(e,s))throw l.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=d[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){var c=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&c.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&a&&c.push("and"),a&&c.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void m.warn(c.join(" "))}u(new s.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},apps:null,SDK_VERSION:g,INTERNAL:{registerComponent:u,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(t=t||f,!a.contains(e,t))throw l.create("no-app",{appName:t});return e[t]}function u(s){var u,c,h=s.name;if(n.has(h))return m.debug("There were multiple attempts to register component "+h+"."),"PUBLIC"===s.type?r[h]:null;if(n.set(h,s),"PUBLIC"===s.type){var p=function(t){if(void 0===t&&(t=i()),"function"!==typeof t[h])throw l.create("invalid-app-argument",{appName:h});return t[h]()};void 0!==s.serviceProps&&a.deepExtend(p,s.serviceProps),r[h]=p,t.prototype[h]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,h);return n.apply(this,s.multipleInstances?t:[])}}try{for(var f=o.__values(Object.keys(e)),d=f.next();!d.done;d=f.next()){var y=d.value;e[y]._addComponent(s)}}catch(g){u={error:g}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(u)throw u.error}}return"PUBLIC"===s.type?r[h]:null}return(r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r)}(y);return e.INTERNAL=o.__assign(o.__assign({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){a.deepExtend(e,t)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,deepExtend:a.deepExtend}),e}(),_=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e,n=t.getComponent();return"VERSION"===(null===(e=n)||void 0===e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if(a.isBrowser()&&void 0!==self.firebase){m.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var b=self.firebase.SDK_VERSION;b&&b.indexOf("LITE")>=0&&m.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var w=v.initializeApp;v.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return a.isNode()&&m.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),w.apply(void 0,t)};var x=v;!function(t,e){t.INTERNAL.registerComponent(new s.Component("platform-logger",(function(t){return new _(t)}),"PRIVATE")),t.registerVersion(h,p,e),t.registerVersion("fire-js","")}(x),e.default=x,e.firebase=x},function(t,e,n){"use strict";function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(24),i=n(4);function o(t,e){return!e||"object"!==Object(r.a)(e)&&"function"!==typeof e?Object(i.a)(t):e}},function(t,e,n){"use strict";function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(13),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),a="[DEFAULT]",s=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=a);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.Deferred;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=r.__assign({identifier:a,optional:!1},t),n=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(n);try{var s=this.getOrInitializeService(o);if(!s){if(i)return null;throw Error("Service "+this.name+" is not available")}return s}catch(u){if(i)return null;throw u}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService(a)}catch(p){}try{for(var i=r.__values(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=r.__read(o.value,2),u=s[0],c=s[1],l=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService(l);c.resolve(h)}catch(p){}}}catch(f){e={error:f}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=a),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===a?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:a:t},t}();var u=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new s(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();e.Component=o,e.ComponentContainer=u,e.Provider=s},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,p=(15&s)<<2|c>>6,f=63&c;u||(f=64,a||(p=64)),r.push(n[l],n[h],n[p],n[f])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){try{return u.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=l(t[n],e[n]));return t}var h=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"===typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function p(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}var f="FirebaseError",d=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=f,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,m.prototype.create),i}return r.__extends(e,t),e}(Error),m=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?y(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new d(i,s),c=0,l=Object.keys(r);c<l.length;c++){var h=l[c];"_"!==h.slice(-1)&&(h in u&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),u[h]=r[h])}return u},t}();function y(t,e){return t.replace(g,(function(t,n){var r=e[n];return null!=r?r.toString():"<"+n+"?>"}))}var g=/\{\$([^}]+)}/g;function v(t){return JSON.parse(t)}var _=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=v(c(o[0])||""),n=v(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:e,claims:n,data:r,signature:i}};var b=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"===typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"===typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();var w=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!==typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"===typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=x),void 0===r.error&&(r.error=x),void 0===r.complete&&(r.complete=x);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function x(){}function E(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument "}e.CONSTANTS=i,e.Deferred=h,e.ErrorFactory=m,e.FirebaseError=d,e.Sha1=b,e.assert=o,e.assertionError=a,e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}},e.base64=u,e.base64Decode=c,e.base64Encode=function(t){var e=s(t);return u.encodeByteArray(e,!0)},e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new w(t,e);return n.subscribe.bind(n)},e.decode=_,e.deepCopy=function(t){return l(void 0,t)},e.deepExtend=l,e.errorPrefix=E,e.getUA=p,e.isAdmin=function(t){var e=_(t).claims;return"object"===typeof e&&!0===e.admin},e.isBrowser=function(){return"object"===typeof self&&self.self===self},e.isEmpty=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},e.isMobileCordova=function(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())},e.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}},e.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},e.isReactNative=function(){return"object"===typeof navigator&&"ReactNative"===navigator.product},e.isValidFormat=function(t){var e=_(t).claims;return!!e&&"object"===typeof e&&e.hasOwnProperty("iat")},e.isValidTimestamp=function(t){var e=_(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"===typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},e.issuedAtTime=function(t){var e=_(t).claims;return"object"===typeof e&&e.hasOwnProperty("iat")?e.iat:null},e.jsonEval=v,e.map=function(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r},e.querystring=function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}})),e},e.safeGet=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},e.stringToByteArray=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,o(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},e.validateCallback=function(t,e,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(E(t,e,r)+"must be a valid function.")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(E(t,e,r)+"must be a valid context object.")},e.validateNamespace=function(t,e,n,r){if((!r||n)&&"string"!==typeof n)throw new Error(E(t,e,r)+"must be a valid firebase namespace.")}}).call(this,n(20))},function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));var r="undefined"!==typeof window?window:t,i=("undefined"!==typeof t||window,"undefined"!==typeof document?document:{})}).call(this,n(20))},function(t,e,n){"use strict";var r={};n.r(r),n.d(r,"reversed",(function(){return nt})),n.d(r,"mirrored",(function(){return rt})),n.d(r,"createReversedEasing",(function(){return it})),n.d(r,"createMirroredEasing",(function(){return ot})),n.d(r,"createExpoIn",(function(){return at})),n.d(r,"createBackIn",(function(){return st})),n.d(r,"createAnticipateEasing",(function(){return ut})),n.d(r,"linear",(function(){return ct})),n.d(r,"easeIn",(function(){return lt})),n.d(r,"easeOut",(function(){return ht})),n.d(r,"easeInOut",(function(){return pt})),n.d(r,"circIn",(function(){return ft})),n.d(r,"circOut",(function(){return dt})),n.d(r,"circInOut",(function(){return mt})),n.d(r,"backIn",(function(){return yt})),n.d(r,"backOut",(function(){return gt})),n.d(r,"backInOut",(function(){return vt})),n.d(r,"anticipate",(function(){return _t})),n.d(r,"bounceOut",(function(){return bt})),n.d(r,"bounceIn",(function(){return wt})),n.d(r,"bounceInOut",(function(){return xt})),n.d(r,"cubicBezier",(function(){return Nt}));var i=n(2),o=n(0),a=n.n(o),s=function(){},u=function(){};var c,l=0,h="undefined"!==typeof window&&void 0!==window.requestAnimationFrame?function(t){return window.requestAnimationFrame(t)}:function(t){var e=Date.now(),n=Math.max(0,16.7-(e-l));l=e+n,setTimeout((function(){return t(l)}),n)};!function(t){t.Read="read",t.Update="update",t.Render="render",t.PostRender="postRender",t.FixedUpdate="fixedUpdate"}(c||(c={}));var p=1/60*1e3,f=!0,d=!1,m=!1,y={delta:0,timestamp:0},g=[c.Read,c.Update,c.Render,c.PostRender],v=function(t){return d=t},_=g.reduce((function(t,e){var n=function(t){var e=[],n=[],r=0,i=!1,o=0,a=new WeakSet,s=new WeakSet,c={cancel:function(t){var e=n.indexOf(t);a.add(t),-1!==e&&n.splice(e,1)},process:function(u){var l,h;if(i=!0,e=(l=[n,e])[0],(n=l[1]).length=0,r=e.length)for(o=0;o<r;o++)(h=e[o])(u),!0!==s.has(h)||a.has(h)||(c.schedule(h),t(!0));i=!1},schedule:function(t,o,c){void 0===o&&(o=!1),void 0===c&&(c=!1),u("function"===typeof t,"Argument must be a function");var l=c&&i,h=l?e:n;a.delete(t),o&&s.add(t),-1===h.indexOf(t)&&(h.push(t),l&&(r=e.length))}};return c}(v);return t.sync[e]=function(t,e,r){return void 0===e&&(e=!1),void 0===r&&(r=!1),d||S(),n.schedule(t,e,r),t},t.cancelSync[e]=function(t){return n.cancel(t)},t.steps[e]=n,t}),{steps:{},sync:{},cancelSync:{}}),b=_.steps,w=_.sync,x=_.cancelSync,E=function(t){return b[t].process(y)},T=function t(e){d=!1,y.delta=f?p:Math.max(Math.min(e-y.timestamp,40),1),f||(p=y.delta),y.timestamp=e,m=!0,g.forEach(E),m=!1,d&&(f=!1,h(t))},S=function(){d=!0,f=!0,m||h(T)},C=function(){return y},I=w,k=function(){return(k=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},A=function(t,e){return function(n){return Math.max(Math.min(n,e),t)}},O=function(t){return t%1?Number(t.toFixed(5)):t},P=/(-)?(\d[\d\.]*)/g,D=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,M=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))$/i,R={test:function(t){return"number"===typeof t},parse:parseFloat,transform:function(t){return t}},N=k(k({},R),{transform:A(0,1)}),L=k(k({},R),{default:1}),F=function(t){return{test:function(e){return"string"===typeof e&&e.endsWith(t)&&1===e.split(" ").length},parse:parseFloat,transform:function(e){return""+e+t}}},j=F("deg"),z=F("%"),B=F("px"),U=F("vh"),V=F("vw"),q=k(k({},z),{parse:function(t){return z.parse(t)/100},transform:function(t){return z.transform(100*t)}}),W=A(0,255),G=function(t){return void 0!==t.red},H=function(t){return void 0!==t.hue},K=function(t){return function(e){if("string"!==typeof e)return e;for(var n,r={},i=(n=e,n.substring(n.indexOf("(")+1,n.lastIndexOf(")"))).split(/,\s*/),o=0;o<4;o++)r[t[o]]=void 0!==i[o]?parseFloat(i[o]):1;return r}},Q=k(k({},R),{transform:function(t){return Math.round(W(t))}});function X(t,e){return t.startsWith(e)&&M.test(t)}var Y={test:function(t){return"string"===typeof t?X(t,"rgb"):G(t)},parse:K(["red","green","blue","alpha"]),transform:function(t){var e=t.red,n=t.green,r=t.blue,i=t.alpha,o=void 0===i?1:i;return function(t){var e=t.red,n=t.green,r=t.blue,i=t.alpha;return"rgba("+e+", "+n+", "+r+", "+(void 0===i?1:i)+")"}({red:Q.transform(e),green:Q.transform(n),blue:Q.transform(r),alpha:O(N.transform(o))})}},Z={test:function(t){return"string"===typeof t?X(t,"hsl"):H(t)},parse:K(["hue","saturation","lightness","alpha"]),transform:function(t){var e=t.hue,n=t.saturation,r=t.lightness,i=t.alpha,o=void 0===i?1:i;return function(t){var e=t.hue,n=t.saturation,r=t.lightness,i=t.alpha;return"hsla("+e+", "+n+", "+r+", "+(void 0===i?1:i)+")"}({hue:Math.round(e),saturation:z.transform(O(n)),lightness:z.transform(O(r)),alpha:O(N.transform(o))})}},J=k(k({},Y),{test:function(t){return"string"===typeof t&&X(t,"#")},parse:function(t){var e="",n="",r="";return t.length>4?(e=t.substr(1,2),n=t.substr(3,2),r=t.substr(5,2)):(e=t.substr(1,1),n=t.substr(2,1),r=t.substr(3,1),e+=e,n+=n,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:1}}}),$={test:function(t){return"string"===typeof t&&M.test(t)||G(t)||H(t)},parse:function(t){return Y.test(t)?Y.parse(t):Z.test(t)?Z.parse(t):J.test(t)?J.parse(t):t},transform:function(t){return G(t)?Y.transform(t):H(t)?Z.transform(t):t}},tt=function(t){return"number"===typeof t?0:t},et={test:function(t){if("string"!==typeof t||!isNaN(t))return!1;var e=0,n=t.match(P),r=t.match(D);return n&&(e+=n.length),r&&(e+=r.length),e>0},parse:function(t){var e=t,n=[],r=e.match(D);r&&(e=e.replace(D,"${c}"),n.push.apply(n,r.map($.parse)));var i=e.match(P);return i&&n.push.apply(n,i.map(R.parse)),n},createTransformer:function(t){var e=t,n=0,r=t.match(D),i=r?r.length:0;if(r)for(var o=0;o<i;o++)e=e.replace(r[o],"${c}"),n++;var a=e.match(P),s=a?a.length:0;if(a)for(o=0;o<s;o++)e=e.replace(a[o],"${n}"),n++;return function(t){for(var r=e,o=0;o<n;o++)r=r.replace(o<i?"${c}":"${n}",o<i?$.transform(t[o]):O(t[o]));return r}},getAnimatableNone:function(t){var e=et.parse(t);return et.createTransformer(t)(e.map(tt))}},nt=function(t){return function(e){return 1-t(1-e)}},rt=function(t){return function(e){return e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2}},it=nt,ot=rt,at=function(t){return function(e){return Math.pow(e,t)}},st=function(t){return function(e){return e*e*((t+1)*e-t)}},ut=function(t){var e=st(t);return function(t){return(t*=2)<1?.5*e(t):.5*(2-Math.pow(2,-10*(t-1)))}},ct=function(t){return t},lt=at(2),ht=nt(lt),pt=rt(lt),ft=function(t){return 1-Math.sin(Math.acos(t))},dt=nt(ft),mt=rt(dt),yt=st(1.525),gt=nt(yt),vt=rt(yt),_t=ut(1.525),bt=function(t){var e=t*t;return t<4/11?7.5625*e:t<8/11?9.075*e-9.9*t+3.4:t<.9?4356/361*e-35442/1805*t+16061/1805:10.8*t*t-20.52*t+10.72},wt=function(t){return 1-bt(1-t)},xt=function(t){return t<.5?.5*(1-bt(1-2*t)):.5*bt(2*t-1)+.5},Et=8,Tt=.001,St=1e-7,Ct=10,It=11,kt=1/(It-1),At="undefined"!==typeof Float32Array,Ot=function(t,e){return 1-3*e+3*t},Pt=function(t,e){return 3*e-6*t},Dt=function(t){return 3*t},Mt=function(t,e,n){return 3*Ot(e,n)*t*t+2*Pt(e,n)*t+Dt(e)},Rt=function(t,e,n){return((Ot(e,n)*t+Pt(e,n))*t+Dt(e))*t};function Nt(t,e,n,r){var i=At?new Float32Array(It):new Array(It),o=function(e){for(var r,o,a,s=0,u=1,c=It-1;u!==c&&i[u]<=e;++u)s+=kt;return--u,r=(e-i[u])/(i[u+1]-i[u]),(a=Mt(o=s+r*kt,t,n))>=Tt?function(e,r){for(var i=0,o=0;i<Et;++i){if(0===(o=Mt(r,t,n)))return r;r-=(Rt(r,t,n)-e)/o}return r}(e,o):0===a?o:function(e,r,i){var o,a,s=0;do{(o=Rt(a=r+(i-r)/2,t,n)-e)>0?i=a:r=a}while(Math.abs(o)>St&&++s<Ct);return a}(e,s,s+kt)};!function(){for(var e=0;e<It;++e)i[e]=Rt(e*kt,t,n)}();return function(i){return t===e&&n===r?i:0===i?0:1===i?1:Rt(o(i),e,r)}}var Lt={x:0,y:0,z:0},Ft=function(t){return"number"===typeof t},jt=function(t){return function(e,n,r){return void 0!==r?t(e,n,r):function(r){return t(e,n,r)}}},zt=jt((function(t,e,n){return Math.min(Math.max(n,t),e)})),Bt=function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")},Ut=function(t){return Bt(t)&&t.hasOwnProperty("z")},Vt=function(t,e){return Math.abs(t-e)},qt=function(t,e){if(void 0===e&&(e=Lt),Ft(t)&&Ft(e))return Vt(t,e);if(Bt(t)&&Bt(e)){var n=Vt(t.x,e.x),r=Vt(t.y,e.y),i=Ut(t)&&Ut(e)?Vt(t.z,e.z):0;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2)+Math.pow(i,2))}return 0},Wt=function(t,e,n){var r=e-t;return 0===r?1:(n-t)/r},Gt=function(t,e,n){return-n*t+n*e+t},Ht=function(){return(Ht=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Kt=function(t,e,n){var r=t*t,i=e*e;return Math.sqrt(Math.max(0,n*(i-r)+r))},Qt=[J,Y,Z],Xt=function(t){return Qt.find((function(e){return e.test(t)}))},Yt=function(t){return"'"+t+"' is not an animatable color. Use the equivalent color code instead."},Zt=function(t,e){var n=Xt(t),r=Xt(e);u(!!n,Yt(t)),u(!!r,Yt(e)),u(n.transform===r.transform,"Both colors must be hex/RGBA, OR both must be HSLA.");var i=n.parse(t),o=r.parse(e),a=Ht({},i),s=n===Z?Gt:Kt;return function(t){for(var e in a)"alpha"!==e&&(a[e]=s(i[e],o[e],t));return a.alpha=Gt(i.alpha,o.alpha,t),n.transform(a)}},Jt=function(t,e){return function(n){return e(t(n))}},$t=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.reduce(Jt)};function te(t,e){return Ft(t)?function(n){return Gt(t,e,n)}:$.test(t)?Zt(t,e):re(t,e)}var ee=function(t,e){var n=t.slice(),r=n.length,i=t.map((function(t,n){return te(t,e[n])}));return function(t){for(var e=0;e<r;e++)n[e]=i[e](t);return n}};function ne(t){for(var e=et.parse(t),n=e.length,r=0,i=0,o=0,a=0;a<n;a++)r||"number"===typeof e[a]?r++:void 0!==e[a].hue?o++:i++;return{parsed:e,numNumbers:r,numRGB:i,numHSL:o}}var re=function(t,e){var n=et.createTransformer(e),r=ne(t),i=ne(e);return u(r.numHSL===i.numHSL&&r.numRGB===i.numRGB&&r.numNumbers>=i.numNumbers,"Complex values '"+t+"' and '"+e+"' too different to mix. Ensure all colors are of the same type."),$t(ee(r.parsed,i.parsed),n)};var ie,oe=function(t){return t},ae=function(t){return void 0===t&&(t=oe),jt((function(e,n,r){var i=n-r,o=-(0-e+1)*(0-t(Math.abs(i)));return i<=0?n+o:n-o}))},se=(ae(),ae(Math.sqrt),function(t,e){return e?t*(1e3/e):0}),ue=(jt((function(t,e,n){var r=e-t;return((n-t)%r+r)%r+t})),zt(0,1),function(t){var e=t.onRead,n=t.onRender,r=t.uncachedValues,o=void 0===r?new Set:r,a=t.useCache,s=void 0===a||a;return function(t){void 0===t&&(t={});var r=Object(i.__rest)(t,[]),a={},u=[],c=!1;function l(t,e){t.startsWith("--")&&(r.hasCSSVariable=!0);var n=a[t];a[t]=e,a[t]!==n&&(-1===u.indexOf(t)&&u.push(t),c||(c=!0,I.render(h.render)))}var h={get:function(t,n){return void 0===n&&(n=!1),!n&&s&&!o.has(t)&&void 0!==a[t]?a[t]:e(t,r)},set:function(t,e){if("string"===typeof t)l(t,e);else for(var n in t)l(n,t[n]);return this},render:function(t){return void 0===t&&(t=!1),(c||!0===t)&&(n(a,r,u),c=!1,u.length=0),this}};return h}}),ce=/([a-z])([A-Z])/g,le=function(t){return t.replace(ce,"$1-$2").toLowerCase()},he=new Map,pe=new Map,fe=["Webkit","Moz","O","ms",""],de=fe.length,me="undefined"!==typeof document,ye=function(t,e){return pe.set(t,le(e))},ge=function(t,e){void 0===e&&(e=!1);var n=e?pe:he;return n.has(t)||(me?function(t){ie=ie||document.createElement("div");for(var e=0;e<de;e++){var n=fe[e],r=""===n,i=r?t:n+t.charAt(0).toUpperCase()+t.slice(1);if(i in ie.style||r){if(r&&"clipPath"===t&&pe.has(t))return;he.set(t,i),ye(t,(r?"":"-")+le(i))}}}(t):function(t){ye(t,t)}(t)),n.get(t)||t},ve=["","X","Y","Z"],_e=["translate","scale","rotate","skew","transformPerspective"].reduce((function(t,e){return ve.reduce((function(t,n){return t.push(e+n),t}),t)}),["x","y","z"]),be=_e.reduce((function(t,e){return t[e]=!0,t}),{});function we(t){return!0===be[t]}function xe(t,e){return _e.indexOf(t)-_e.indexOf(e)}var Ee=new Set(["originX","originY","originZ"]);function Te(t){return Ee.has(t)}var Se=Object(i.__assign)(Object(i.__assign)({},R),{transform:Math.round}),Ce={color:$,backgroundColor:$,outlineColor:$,fill:$,stroke:$,borderColor:$,borderTopColor:$,borderRightColor:$,borderBottomColor:$,borderLeftColor:$,borderWidth:B,borderTopWidth:B,borderRightWidth:B,borderBottomWidth:B,borderLeftWidth:B,borderRadius:B,radius:B,borderTopLeftRadius:B,borderTopRightRadius:B,borderBottomRightRadius:B,borderBottomLeftRadius:B,width:B,maxWidth:B,height:B,maxHeight:B,size:B,top:B,right:B,bottom:B,left:B,padding:B,paddingTop:B,paddingRight:B,paddingBottom:B,paddingLeft:B,margin:B,marginTop:B,marginRight:B,marginBottom:B,marginLeft:B,rotate:j,rotateX:j,rotateY:j,rotateZ:j,scale:L,scaleX:L,scaleY:L,scaleZ:L,skew:j,skewX:j,skewY:j,distance:B,translateX:B,translateY:B,translateZ:B,x:B,y:B,z:B,perspective:B,opacity:N,originX:q,originY:q,originZ:B,zIndex:Se,fillOpacity:N,strokeOpacity:N,numOctaves:Se},Ie=function(t){return Ce[t]},ke=function(t,e){return e&&"number"===typeof t?e.transform(t):t},Ae="scrollLeft",Oe="scrollTop",Pe=new Set([Ae,Oe]),De=new Set([Ae,Oe,"transform"]),Me={x:"translateX",y:"translateY",z:"translateZ"};function Re(t){return"function"===typeof t}function Ne(t,e,n,r,i,o,a){void 0===e&&(e=!0),void 0===n&&(n={}),void 0===r&&(r={}),void 0===i&&(i={}),void 0===o&&(o=[]),void 0===a&&(a=!1);var s=!0,u=!1,c=!1;for(var l in t){var h=t[l],p=Ie(l),f=ke(h,p);we(l)?(u=!0,r[l]=f,o.push(l),s&&(p.default&&h!==p.default||!p.default&&0!==h)&&(s=!1)):Te(l)?(i[l]=f,c=!0):De.has(l)&&Re(f)||(n[ge(l,a)]=f)}return(u||"function"===typeof t.transform)&&(n.transform=function(t,e,n,r,i){var o="",a=!1;n.sort(xe);for(var s=n.length,u=0;u<s;u++){var c=n[u];o+=(Me[c]||c)+"("+e[c]+") ",a="z"===c||a}return!a&&i?o+="translateZ(0)":o=o.trim(),Re(t.transform)?o=t.transform(e,o):r&&(o="none"),o}(t,r,o,s,e)),c&&(n.transformOrigin=(i.originX||"50%")+" "+(i.originY||"50%")+" "+(i.originZ||0)),n}function Le(t,e){void 0===t&&(t=!0),void 0===e&&(e=!0);var n={},r={},i={},o=[];return function(a){return o.length=0,Ne(a,t,n,r,i,o,e),n}}var Fe=ue({onRead:function(t,e){var n=e.element,r=e.preparseOutput,i=Ie(t);if(we(t))return i&&i.default||0;if(Pe.has(t))return n[t];var o=window.getComputedStyle(n,null).getPropertyValue(ge(t,!0))||0;return r&&i&&i.test(o)&&i.parse?i.parse(o):o},onRender:function(t,e,n){var r=e.element,i=e.buildStyles,o=e.hasCSSVariable;if(Object.assign(r.style,i(t)),o)for(var a=n.length,s=0;s<a;s++){var u=n[s];u.startsWith("--")&&r.style.setProperty(u,t[u])}-1!==n.indexOf(Ae)&&(r[Ae]=t[Ae]),-1!==n.indexOf(Oe)&&(r[Oe]=t[Oe])},uncachedValues:Pe});var je=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues"]),ze=.5,Be=function(){return{style:{}}},Ue=function(t,e){return B.transform(t*e)},Ve={x:0,y:0,width:0,height:0};function qe(t,e,n){return"string"===typeof t?t:B.transform(e+n*t)}function We(t,e,n,r,o,a){void 0===e&&(e=Ve),void 0===r&&(r=Le(!1,!1)),void 0===o&&(o=Be()),void 0===a&&(a=!0);var s=t.attrX,u=t.attrY,c=t.originX,l=t.originY,h=t.pathLength,p=t.pathSpacing,f=void 0===p?1:p,d=t.pathOffset,m=void 0===d?0:d,y=r(Object(i.__rest)(t,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]));for(var g in y){if("transform"===g)o.style.transform=y[g];else o[a&&!je.has(g)?le(g):g]=y[g]}return(void 0!==c||void 0!==l||y.transform)&&(o.style.transformOrigin=function(t,e,n){return qe(e,t.x,t.width)+" "+qe(n,t.y,t.height)}(e,void 0!==c?c:ze,void 0!==l?l:ze)),void 0!==s&&(o.x=s),void 0!==u&&(o.y=u),void 0!==n&&void 0!==h&&(o[a?"stroke-dashoffset":"strokeDashoffset"]=Ue(-m,n),o[a?"stroke-dasharray":"strokeDasharray"]=Ue(h,n)+" "+Ue(f,n)),o}function Ge(t,e,n){void 0===n&&(n=!0);var r=Be(),i=Le(!1,!1);return function(o){return We(o,t,e,i,r,n)}}var He=ue({onRead:function(t,e){var n=e.element;if(we(t=je.has(t)?t:le(t))){var r=Ie(t);return r&&r.default||0}return n.getAttribute(t)},onRender:function(t,e){var n=e.element,r=(0,e.buildAttrs)(t);for(var i in r)"style"===i?Object.assign(n.style,r.style):n.setAttribute(i,r[i])}}),Ke=ue({useCache:!1,onRead:function(t){return"scrollTop"===t?window.pageYOffset:window.pageXOffset},onRender:function(t){var e=t.scrollTop,n=void 0===e?0:e,r=t.scrollLeft,i=void 0===r?0:r;return window.scrollTo(i,n)}}),Qe=new WeakMap,Xe=function(t,e){var n;return t instanceof HTMLElement?n=function(t,e){void 0===e&&(e={});var n=e.enableHardwareAcceleration,r=Object(i.__rest)(e,["enableHardwareAcceleration"]);return Fe(Object(i.__assign)({element:t,buildStyles:Le(n),preparseOutput:!0},r))}(t,e):t instanceof SVGElement?n=function(t){var e=function(t){try{return function(t){return"function"===typeof t.getBBox?t.getBBox():t.getBoundingClientRect()}(t)}catch(e){return{x:0,y:0,width:0,height:0}}}(t),n=function(t){return"path"===t.tagName}(t)&&t.getTotalLength?t.getTotalLength():void 0;return He({element:t,buildAttrs:Ge(e,n)})}(t):t===window&&(n=Ke(t)),u(void 0!==n,"No valid node provided. Node must be HTMLElement, SVGElement or window."),Qe.set(t,n),n},Ye=function(t,e){return Qe.has(t)?Qe.get(t):Xe(t,e)};var Ze=function(t,e){var n="string"===typeof t?document.querySelector(t):t;return Ye(n,e)},Je=function(){return function(t,e){var n=this,r=t.middleware,i=t.onComplete;this.isActive=!0,this.update=function(t){n.observer.update&&n.updateObserver(t)},this.complete=function(){n.observer.complete&&n.isActive&&n.observer.complete(),n.onComplete&&n.onComplete(),n.isActive=!1},this.error=function(t){n.observer.error&&n.isActive&&n.observer.error(t),n.isActive=!1},this.observer=e,this.updateObserver=function(t){return e.update(t)},this.onComplete=i,e.update&&r&&r.length&&r.forEach((function(t){return n.updateObserver=t(n.updateObserver,n.complete)}))}}(),$e=function(t,e,n){var r=e.middleware;return new Je({middleware:r,onComplete:n},"function"===typeof t?{update:t}:t)},tn=function(){function t(t){void 0===t&&(t={}),this.props=t}return t.prototype.create=function(e){return new t(e)},t.prototype.start=function(t){void 0===t&&(t={});var e=!1,n={stop:function(){}},r=this.props,o=r.init,a=Object(i.__rest)(r,["init"]),s=o($e(t,a,(function(){e=!0,n.stop()})));return n=s?Object(i.__assign)({},n,s):n,e&&n.stop(),n},t.prototype.applyMiddleware=function(t){return this.create(Object(i.__assign)({},this.props,{middleware:this.props.middleware?[t].concat(this.props.middleware):[t]}))},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=1===t.length?t[0]:$t.apply(void 0,t);return this.applyMiddleware((function(t){return function(e){return t(n(e))}}))},t}(),en=function(t){return new tn({init:t})},nn=[B,z,j,U,V],rn=function(t){return nn.find((function(e){return e.test(t)}))},on=function(t,e){return t(e)},an=function(t,e){var n=e.from,r=e.to,o=Object(i.__rest)(e,["from","to"]),a=rn(n)||rn(r),s=a.transform,u=a.parse;return t(Object(i.__assign)({},o,{from:"string"===typeof n?u(n):n,to:"string"===typeof r?u(r):r})).pipe(s)},sn=function(t){return function(e,n){var r=n.from,o=n.to,a=Object(i.__rest)(n,["from","to"]);return e(Object(i.__assign)({},a,{from:0,to:1})).pipe(t(r,o))}},un=sn(Zt),cn=sn(re),ln=function(t,e){var n=function(t){var e=Object.keys(t),n=function(e,n){return void 0!==e&&!t[n](e)};return{getVectorKeys:function(t){return e.reduce((function(e,r){return n(t[r],r)&&e.push(r),e}),[])},testVectorProps:function(t){return t&&e.some((function(e){return n(t[e],e)}))}}}(e),r=n.testVectorProps,i=n.getVectorKeys;return function(e){if(!r(e))return t(e);var n=i(e),o=e[n[0]];return hn(o)(t,e,n)}},hn=function(t){return"number"===typeof t?on:function(t){return Boolean(rn(t))}(t)?an:$.test(t)?un:et.test(t)?cn:on},pn=ln((function(t){return void 0===t&&(t={}),en((function(e){var n=e.complete,r=e.update,i=t.velocity,o=void 0===i?0:i,a=t.from,s=void 0===a?0:a,u=t.power,c=void 0===u?.8:u,l=t.timeConstant,h=void 0===l?350:l,p=t.restDelta,f=void 0===p?.5:p,d=t.modifyTarget,m=0,y=c*o,g=Math.round(s+y),v="undefined"===typeof d?g:d(g),_=I.update((function(t){var e=t.delta;m+=e;var i=-y*Math.exp(-m/h),o=i>f||i<-f;r(o?v+i:v),o||(x.update(_),n())}),!0);return{stop:function(){return x.update(_)}}}))}),{from:R.test,modifyTarget:function(t){return"function"===typeof t},velocity:R.test}),fn=ln((function(t){return void 0===t&&(t={}),en((function(e){var n=e.update,r=e.complete,i=t.velocity,o=void 0===i?0:i,a=t.from,s=void 0===a?0:a,u=t.to,c=void 0===u?0:u,l=t.stiffness,h=void 0===l?100:l,p=t.damping,f=void 0===p?10:p,d=t.mass,m=void 0===d?1:d,y=t.restSpeed,g=void 0===y?.01:y,v=t.restDelta,_=void 0===v?.01:v,b=o?-o/1e3:0,w=0,E=c-s,T=s,S=T,C=I.update((function(t){var e=t.delta;w+=e;var i=f/(2*Math.sqrt(h*m)),a=Math.sqrt(h/m)/1e3;if(S=T,i<1){var s=Math.exp(-i*a*w),u=a*Math.sqrt(1-i*i);T=c-s*((b+i*a*E)/u*Math.sin(u*w)+E*Math.cos(u*w))}else{s=Math.exp(-a*w);T=c-s*(E+(b+a*E)*w)}o=se(T-S,e);var l=Math.abs(o)<=g,p=Math.abs(c-T)<=_;l&&p?(n(T=c),x.update(C),r()):n(T)}),!0);return{stop:function(){return x.update(C)}}}))}),{from:R.test,to:R.test,stiffness:R.test,damping:R.test,mass:R.test,velocity:R.test}),dn=ln((function(t){var e=t.from,n=void 0===e?0:e,r=t.velocity,o=void 0===r?0:r,a=t.min,s=t.max,u=t.power,c=void 0===u?.8:u,l=t.timeConstant,h=void 0===l?700:l,p=t.bounceStiffness,f=void 0===p?500:p,d=t.bounceDamping,m=void 0===d?10:d,y=t.restDelta,g=void 0===y?1:y,v=t.modifyTarget;return en((function(t){var e,r=t.update,u=t.complete,l=n,p=n,d=!1,y=function(t){return void 0!==a&&t<=a},_=function(t){return void 0!==s&&t>=s},b=function(t){return y(t)||_(t)},w=function(t){r(t),l=p,o=se((p=t)-l,C().delta),e&&!d&&function(t,e){return y(t)&&e<0||_(t)&&e>0}(t,o)&&E({from:t,velocity:o})},x=function(t,n){e&&e.stop(),e=t.start({update:w,complete:function(){n?n():u()}})},E=function(t){d=!0,x(fn(Object(i.__assign)({},t,{to:y(t.from)?a:s,stiffness:f,damping:m,restDelta:g})))};if(b(n))E({from:n,velocity:o});else if(0!==o){var T=pn({from:n,velocity:o,timeConstant:h,power:c,restDelta:b(n)?20:g,modifyTarget:v});x(T,(function(){b(p)?E({from:p,velocity:o}):u()}))}else u();return{stop:function(){return e&&e.stop()}}}))}),{from:R.test,velocity:R.test,min:R.test,max:R.test,damping:R.test,stiffness:R.test,modifyTarget:function(t){return"function"===typeof t}}),mn=ln((function(t){var e=t.from,n=void 0===e?0:e,r=t.to,i=void 0===r?1:r,o=t.ease,a=void 0===o?ct:o,s=t.reverseEase;return void 0!==s&&s&&(a=it(a)),en((function(t){var e=t.update;return{seek:function(t){return e(t)}}})).pipe(a,(function(t){return Gt(n,i,t)}))}),{ease:function(t){return"function"===typeof t},from:R.test,to:R.test}),yn=zt(0,1),gn=function(t){return void 0===t&&(t={}),en((function(e){var n,r=e.update,i=e.complete,o=t.duration,a=void 0===o?300:o,s=t.ease,u=void 0===s?ht:s,c=t.flip,l=void 0===c?0:c,h=t.loop,p=void 0===h?0:h,f=t.yoyo,d=void 0===f?0:f,m=t.repeatDelay,y=void 0===m?0:m,g=t.from,v=void 0===g?0:g,_=t.to,b=void 0===_?1:_,w=t.elapsed,E=void 0===w?0:w,T=t.flipCount,S=void 0===T?0:T,C=t.yoyoCount,k=void 0===C?0:C,A=t.loopCount,O=void 0===A?0:A,P=mn({from:v,to:b,ease:u}).start(r),D=0,M=!1,R=function(t){var e;void 0===t&&(t=!1),P=mn({from:v=(e=[b,v])[0],to:b=e[1],ease:u,reverseEase:t}).start(r)},N=function(){D=yn(Wt(0,a,E)),P.seek(D)},L=function(){M=!0,n=I.update((function(t){var e=t.delta;E+=e,N(),function(){var t=M&&E>a+y;return!!t&&(!(!t||p||l||d)||(E=E-a-y,p&&O<p?(O++,!1):l&&S<l?(S++,R(),!1):!(d&&k<d)||(k++,R(k%2!==0),!1)))}()&&(x.update(n),i&&I.update(i,!1,!0))}),!0)},F=function(){M=!1,n&&x.update(n)};return L(),{isActive:function(){return M},getElapsed:function(){return zt(0,a,E)},getProgress:function(){return D},stop:function(){F()},pause:function(){return F(),this},resume:function(){return M||L(),this},seek:function(t){return E=Gt(0,a,t),I.update(N,!1,!0),this},reverse:function(){return R(),this}}}))},vn=zt(0,1),_n=function(t){var e=t.easings,n=t.ease,r=void 0===n?ct:n,o=t.times,a=t.values,s=Object(i.__rest)(t,["easings","ease","times","values"]);e=Array.isArray(e)?e:function(t,e){return t.map((function(){return e||ht})).splice(0,t.length-1)}(a,e),o=o||function(t){var e=t.length;return t.map((function(t,n){return 0!==n?n/(e-1):0}))}(a);var u=e.map((function(t,e){return mn({from:a[e],to:a[e+1],ease:t})}));return gn(Object(i.__assign)({},s,{ease:r})).applyMiddleware((function(t){return function(t,e,n){var r=t.length,i=r-1,o=i-1,a=e.map((function(t){return t.start(n)}));return function(e){e<=t[0]&&a[0].seek(0),e>=t[i]&&a[o].seek(1);for(var n=1;n<r&&!(t[n]>e||n===i);n++);var s=Wt(t[n-1],t[n],e);a[n-1].seek(vn(s))}}(o,u,t)}))},bn=function(t,e,n){return en((function(r){var i=r.update,o=e.split(" ").map((function(e){return t.addEventListener(e,i,n),e}));return{stop:function(){return o.forEach((function(e){return t.removeEventListener(e,i,n)}))}}}))},wn=function(){return{clientX:0,clientY:0,pageX:0,pageY:0,x:0,y:0}},xn=function(t,e){return void 0===e&&(e={clientX:0,clientY:0,pageX:0,pageY:0,x:0,y:0}),e.clientX=e.x=t.clientX,e.clientY=e.y=t.clientY,e.pageX=t.pageX,e.pageY=t.pageY,e},En=[wn()];if("undefined"!==typeof document){bn(document,"touchstart touchmove",{passive:!0,capture:!0}).start((function(t){var e=t.touches;!0;var n=e.length;En.length=0;for(var r=0;r<n;r++){var i=e[r];En.push(xn(i))}}))}var Tn=wn();if("undefined"!==typeof document){bn(document,"mousedown mousemove",!0).start((function(t){!0,xn(t,Tn)}))}var Sn=function(t){return en((function(e){var n=e.complete,r=setTimeout(n,t);return{stop:function(){return clearTimeout(r)}}}))};n.d(e,"a",(function(){return Lo})),n.d(e,"b",(function(){return Do})),n.d(e,"c",(function(){return Mo})),n.d(e,"d",(function(){return fi}));var Cn=function(t){return!isNaN(parseFloat(t))},In=function(){function t(t,e){var n=this,r=void 0===e?{}:e,i=r.transformer,o=r.parent;this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.updateAndNotify=function(t,e){void 0===e&&(e=!0),n.prev=n.current,n.current=n.transformer?n.transformer(t):t,n.updateSubscribers&&n.prev!==n.current&&n.updateSubscribers.forEach(n.notifySubscriber),n.children&&n.children.forEach(n.setChild),e&&n.renderSubscribers&&n.renderSubscribers.forEach(n.notifySubscriber);var r=C(),i=r.delta,o=r.timestamp;n.lastUpdated!==o&&(n.timeDelta=i,n.lastUpdated=o,I.postRender(n.scheduleVelocityCheck))},this.notifySubscriber=function(t){t(n.current)},this.scheduleVelocityCheck=function(){return I.postRender(n.velocityCheck)},this.velocityCheck=function(t){t.timestamp!==n.lastUpdated&&(n.prev=n.current)},this.setChild=function(t){return t.set(n.current)},this.parent=o,this.transformer=i,this.set(t,!1),this.canTrackVelocity=Cn(this.current)}return t.prototype.addChild=function(e){void 0===e&&(e={});var n=new t(this.current,Object(i.__assign)({parent:this},e));return this.children||(this.children=new Set),this.children.add(n),n},t.prototype.removeChild=function(t){this.children&&this.children.delete(t)},t.prototype.subscribeTo=function(t,e){var n=this,r=function(){return e(n.current)};return t.add(r),function(){return t.delete(r)}},t.prototype.onChange=function(t){return this.updateSubscribers||(this.updateSubscribers=new Set),this.subscribeTo(this.updateSubscribers,t)},t.prototype.onRenderRequest=function(t){return this.renderSubscribers||(this.renderSubscribers=new Set),this.notifySubscriber(t),this.subscribeTo(this.renderSubscribers,t)},t.prototype.attach=function(t){this.passiveEffect=t},t.prototype.set=function(t,e){void 0===e&&(e=!0),e&&this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t,e)},t.prototype.get=function(){return this.current},t.prototype.getVelocity=function(){return this.canTrackVelocity?se(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0},t.prototype.start=function(t){var e=this;return this.stop(),new Promise((function(n){e.stopAnimation=t(n)})).then((function(){return e.clearAnimation()}))},t.prototype.stop=function(){this.stopAnimation&&this.stopAnimation(),this.clearAnimation()},t.prototype.isAnimating=function(){return!!this.stopAnimation},t.prototype.clearAnimation=function(){this.stopAnimation=null},t.prototype.destroy=function(){this.updateSubscribers&&this.updateSubscribers.clear(),this.renderSubscribers&&this.renderSubscribers.clear(),this.parent&&this.parent.removeChild(this),this.stop()},t}();function kn(t,e){return new In(t,e)}function An(t){var e=Object(o.useRef)(null);return null===e.current&&(e.current=t()),e.current}var On,Pn=function(t){return t instanceof In},Dn=ue({onRead:function(){return null},onRender:function(t,e){return(0,e.onUpdate)(t)}}),Mn=function(){function t(){this.hasMounted=!1,this.values=new Map,this.unsubscribers=new Map}return t.prototype.has=function(t){return this.values.has(t)},t.prototype.set=function(t,e){this.values.set(t,e),this.hasMounted&&this.bindValueToOutput(t,e)},t.prototype.get=function(t,e){var n=this.values.get(t);return void 0===n&&void 0!==e&&(n=new In(e),this.set(t,n)),n},t.prototype.forEach=function(t){return this.values.forEach(t)},t.prototype.bindValueToOutput=function(t,e){var n=this,r=e.onRenderRequest((function(e){return n.output&&n.output(t,e)})),i=e.onChange((function(e){n.onUpdate&&n.onUpdate.set(t,e)}));this.unsubscribers.has(t)&&this.unsubscribers.get(t)(),this.unsubscribers.set(t,(function(){r(),i()}))},t.prototype.setOnUpdate=function(t){this.onUpdate=void 0,t&&(this.onUpdate=Dn({onUpdate:t}))},t.prototype.setTransformTemplate=function(t){this.transformTemplate!==t&&(this.transformTemplate=t,this.updateTransformTemplate())},t.prototype.getTransformTemplate=function(){return this.transformTemplate},t.prototype.updateTransformTemplate=function(){this.output&&this.output("transform",this.transformTemplate)},t.prototype.mount=function(t){var e=this;this.hasMounted=!0,t&&(this.output=t),this.values.forEach((function(t,n){return e.bindValueToOutput(n,t)})),this.updateTransformTemplate()},t.prototype.unmount=function(){var t=this;this.values.forEach((function(e,n){var r=t.unsubscribers.get(n);r&&r()}))},t}(),Rn=new Set(["dragOriginX","dragOriginY"]),Nn=function(t){var e=An((function(){var e=new Mn;for(var n in t)Pn(t[n])&&!Rn.has(n)&&e.set(n,t[n]);return e}));return e.setOnUpdate(t.onUpdate),e.setTransformTemplate(t.transformTemplate),e},Ln=null,Fn=function(){return null!==Ln},jn=function(){u(!Ln,"Sync render session already open"),Ln=[]},zn=function(){u(null!==Ln,"No sync render session found"),Ln&&Ln.forEach((function(t){return t.render()})),Ln=null},Bn=function(t){u(null!==Ln,"No sync render session found"),Ln&&Ln.push(t)},Un=Object(o.memo)((function(t){var e=t.innerRef,n=t.values,r=t.isStatic;return Object(o.useEffect)((function(){u(e.current instanceof Element,"No `ref` found. Ensure components created with `motion.custom` forward refs using `React.forwardRef`");var t=Ze(e.current,{preparseOutput:!1,enableHardwareAcceleration:!r});return n.mount((function(e,n){t.set(e,n),Fn()&&Bn(t)})),function(){return n.unmount()}}),[]),null})),Vn=(On=function(t){return t.get()},function(t){var e={};return t.forEach((function(t,n){return e[n]=On(t)})),e}),qn=new Set(["originX","originY","originZ"]),Wn=function(t){return qn.has(t)},Gn=function(t,e,n){var r=Vn(t),o=t.getTransformTemplate();return o&&(r.transform=e.transform?o({},e.transform):o),Ne(Object(i.__assign)({},e,r),!n)},Hn=function(t,e,n,r){void 0===e&&(e={});var i={},a=Object(o.useRef)({}).current;for(var s in e){var u=e[s];if(Pn(u))t.set(s,u);else if(n||!we(s)&&!Wn(s))i[s]=u;else{if(t.has(s)){if(u!==a[s])t.get(s).set(u)}else t.set(s,kn(u));a[s]=u}}return r?r(i):i},Kn=function(t){return Array.isArray(t)},Qn=function(t){return Kn(t)?t[t.length-1]||0:t},Xn=[R,B,z,j,V,U,{test:function(t){return"auto"===t},parse:function(t){return t}}],Yn=Xn.concat([$,et]),Zn=function(t){return function(e){return e.test(t)}},Jn=function(t){return Xn.find(Zn(t))},$n=function(t){return Yn.find(Zn(t))},tr=function(){return{type:"spring",stiffness:500,damping:25,restDelta:.5,restSpeed:10}},er=function(t){return{type:"spring",stiffness:700,damping:0===t?100:35}},nr=function(){return{ease:"linear",duration:.3}},rr=function(t){return{type:"keyframes",duration:.8,values:t}},ir={x:tr,y:tr,z:tr,rotate:tr,rotateX:tr,rotateY:tr,rotateZ:tr,scaleX:er,scaleY:er,scale:er,opacity:nr,backgroundColor:nr,color:nr,default:er},or=function(t){var e=t.to,n=t.duration;return en((function(t){var r=t.update,i=t.complete;r(e),n?Sn(n).start({complete:i}):i()}))},ar=function(t){return Array.isArray(t)?(u(4===t.length,"Cubic bezier arrays must contain four numerical values."),Nt(t[0],t[1],t[2],t[3])):"string"===typeof t?(u(void 0!==r[t],"Invalid easing type '"+t+"'"),r[t]):t},sr=function(t){return Array.isArray(t)&&"number"!==typeof t[0]},ur=function(t,e){return"zIndex"!==t&&(!("number"!==typeof e&&!Array.isArray(e))||!("string"!==typeof e||!et.test(e)||e.startsWith("url(")))},cr=function(t){return 1e3*t},lr={tween:gn,spring:fn,keyframes:_n,inertia:dn,just:or},hr={tween:function(t){if(t.ease){var e=sr(t.ease)?t.ease[0]:t.ease;t.ease=ar(e)}return t},keyframes:function(t){var e=t.from,n=(t.to,t.velocity,Object(i.__rest)(t,["from","to","velocity"]));if(n.values&&null===n.values[0]){var r=n.values.slice();r[0]=e,n.values=r}return n.ease&&(n.easings=sr(n.ease)?n.ease.map(ar):ar(n.ease)),n.ease=ct,n}},pr=function(t,e,n){var r=n?n.delay:0;if(void 0===n||!function(t){t.when,t.delay,t.delayChildren,t.staggerChildren,t.staggerDirection;var e=Object(i.__rest)(t,["when","delay","delayChildren","staggerChildren","staggerDirection"]);return Object.keys(e).length}(n))return Object(i.__assign)({delay:r},function(t,e){var n;return n=Kn(e)?rr:ir[t]||ir.default,Object(i.__assign)({to:e},n(e))}(t,e));var o=n[t]||n.default||n;return!1===o.type?{delay:o.hasOwnProperty("delay")?o.delay:r,to:Kn(e)?e[e.length-1]:e,type:"just"}:Kn(e)?Object(i.__assign)({values:e,duration:.8,delay:r,ease:"linear"},o,{type:"keyframes"}):Object(i.__assign)({type:"tween",to:e,delay:r},o)},fr=function(t,e,n,r){var o=e.get(),a=ur(t,o),u=ur(t,n);s(a===u,"You are trying to animate "+t+' from "'+o+'" to '+n+'. "'+o+'" is not an animatable value - to enable this animation set '+o+" to a value animatable to "+n+" via the `style` property.");var c,l=pr(t,n,r),h=l.type,p=void 0===h?"tween":h,f=Object(i.__rest)(l,["type"]),d=a&&u?lr[p]:or,m=function(t,e){return hr[t]?hr[t](e):e}(p,Object(i.__assign)({from:o,velocity:e.getVelocity()},f));return((c=m).hasOwnProperty("duration")||c.hasOwnProperty("repeatDelay"))&&(m.duration&&(m.duration=cr(m.duration)),m.repeatDelay&&(m.repeatDelay=cr(m.repeatDelay))),[d,m]};function dr(t,e,n,r){var o=r.delay,a=void 0===o?0:o,s=Object(i.__rest)(r,["delay"]);return e.start((function(r){var o,u=fr(t,e,n,s),c=u[0],l=u[1],h=l.delay,p=Object(i.__rest)(l,["delay"]);void 0!==h&&(a=h);var f=function(){var t=c(p);o=t.start({update:function(t){return e.set(t)},complete:r})};return a?o=Sn(cr(a)).start({complete:f}):f(),function(){o&&o.stop()}}))}var mr=function(){function t(t){var e=this,n=t.values,r=t.readValueFromSource,i=t.makeTargetAnimatable;this.props={},this.variants={},this.baseTarget={},this.overrides=[],this.resolvedOverrides=[],this.activeOverrides=new Set,this.isAnimating=new Set,this.hasValue=function(t){return!e.values.has(t)},this.values=n,this.readValueFromSource=r,this.makeTargetAnimatable=i,this.values.forEach((function(t,n){return e.baseTarget[n]=t.get()}))}return t.prototype.setProps=function(t){this.props=t},t.prototype.setVariants=function(t){t&&(this.variants=t)},t.prototype.setDefaultTransition=function(t){t&&(this.defaultTransition=t)},t.prototype.setValues=function(t,e){var n=this,r=void 0===e?{}:e,o=r.isActive,a=void 0===o?new Set:o,s=r.priority,u=this.resolveVariant(t),c=u.target,l=u.transitionEnd;return c=this.transformValues(Object(i.__assign)({},c,l)),Object.keys(c).forEach((function(t){if(!a.has(t)&&(a.add(t),c)){var e=Qn(c[t]);if(n.values.has(t)){var r=n.values.get(t);r&&r.set(e)}else n.values.set(t,kn(e));s||(n.baseTarget[t]=e)}}))},t.prototype.transformValues=function(t){var e=this.props.transformValues;return e?e(t):t},t.prototype.checkForNewValues=function(t){var e=Object.keys(t).filter(this.hasValue),n=e.length;if(n)for(var r=0;r<n;r++){var i=e[r],o=t[i],a=null;Array.isArray(o)&&(a=o[0]),null===a&&(a=this.readValueFromSource(i),u(null!==a,'No initial value for "'+i+'" can be inferred. Ensure an initial value for "'+i+'" is defined on the component.')),"string"===typeof a&&/^\d*\.?\d+$/.test(a)?a=parseFloat(a):!$n(a)&&et.test(o)&&(a=et.getAnimatableNone(o)),this.values.set(i,kn(a)),this.baseTarget[i]=a}},t.prototype.resolveVariant=function(t){if(!t)return{target:void 0,transition:void 0,transitionEnd:void 0};"function"===typeof t&&(t=t(this.props.custom,function(t){var e={};return t.forEach((function(t,n){return e[n]=t.get()})),e}(this.values),function(t){var e={};return t.forEach((function(t,n){return e[n]=t.getVelocity()})),e}(this.values)));var e=t.transition;return{transition:void 0===e?this.defaultTransition:e,transitionEnd:t.transitionEnd,target:Object(i.__rest)(t,["transition","transitionEnd"])}},t.prototype.getHighestPriority=function(){return this.activeOverrides.size?Math.max.apply(Math,Array.from(this.activeOverrides)):0},t.prototype.setOverride=function(t,e){this.overrides[e]=t,this.children&&this.children.forEach((function(n){return n.setOverride(t,e)}))},t.prototype.startOverride=function(t){var e=this.overrides[t];if(e)return this.start(e,{priority:t})},t.prototype.clearOverride=function(t){var e=this;if(this.children&&this.children.forEach((function(e){return e.clearOverride(t)})),this.overrides[t]){this.activeOverrides.delete(t);var n=this.getHighestPriority();if(this.resetIsAnimating(),n)this.overrides[n]&&this.startOverride(n);var r=this.resolvedOverrides[t];if(r){var i={};for(var o in this.baseTarget)void 0!==r[o]&&(i[o]=this.baseTarget[o]);this.onStart(),this.animate(i).then((function(){return e.onComplete()}))}}},t.prototype.apply=function(t){return Array.isArray(t)?this.applyVariantLabels(t):"string"===typeof t?this.applyVariantLabels([t]):void this.setValues(t)},t.prototype.applyVariantLabels=function(t){var e=this,n=new Set;t.slice().reverse().forEach((function(r){var i=e.resolveVariant(e.variants[r]),o=i.target,a=i.transitionEnd;a&&e.setValues(a,{isActive:n}),o&&e.setValues(o,{isActive:n}),e.children&&e.children.size&&e.children.forEach((function(e){return e.applyVariantLabels(t)}))}))},t.prototype.start=function(t,e){var n,r,i=this;return void 0===e&&(e={}),e.priority&&this.activeOverrides.add(e.priority),this.resetIsAnimating(e.priority),r=t,n=Array.isArray(r)?this.animateVariantLabels(t,e):"string"===typeof t?this.animateVariant(t,e):this.animate(t,e),this.onStart(),n.then((function(){return i.onComplete()}))},t.prototype.animate=function(t,e){var n=this,r=void 0===e?{}:e,o=r.delay,a=void 0===o?0:o,s=r.priority,u=void 0===s?0:s,c=r.transitionOverride,l=this.resolveVariant(t),h=l.target,p=l.transition,f=l.transitionEnd;if(c&&(p=c),!h)return Promise.resolve();if(h=this.transformValues(h),f&&(f=this.transformValues(f)),this.checkForNewValues(h),this.makeTargetAnimatable){var d=this.makeTargetAnimatable(h,f);h=d.target,f=d.transitionEnd}u&&(this.resolvedOverrides[u]=h),this.checkForNewValues(h);var m=[];for(var y in h){var g=this.values.get(y);if(g&&h&&void 0!==h[y]){var v=h[y];u||(this.baseTarget[y]=Qn(v)),this.isAnimating.has(y)||(this.isAnimating.add(y),m.push(dr(y,g,v,Object(i.__assign)({delay:a},p))))}}var _=Promise.all(m);return f?_.then((function(){n.setValues(f,{priority:u})})):_},t.prototype.animateVariantLabels=function(t,e){var n=this,r=t.slice().reverse().map((function(t){return n.animateVariant(t,e)}));return Promise.all(r)},t.prototype.animateVariant=function(t,e){var n=this,r=!1,i=0,o=0,a=1,s=e&&e.priority||0,u=this.variants[t],c=u?function(){return n.animate(u,e)}:function(){return Promise.resolve()},l=this.children?function(){return n.animateChildren(t,i,o,a,s)}:function(){return Promise.resolve()};if(u&&this.children){var h=this.resolveVariant(u).transition;h&&(r=h.when||r,i=h.delayChildren||i,o=h.staggerChildren||o,a=h.staggerDirection||a)}if(r){var p="beforeChildren"===r?[c,l]:[l,c],f=p[1];return(0,p[0])().then(f)}return Promise.all([c(),l()])},t.prototype.animateChildren=function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=0),!this.children)return Promise.resolve();var o=[],a=(this.children.size-1)*n,s=1===r?function(t){return t*n}:function(t){return a-t*n};return Array.from(this.children).forEach((function(n,r){var a=n.animateVariant(t,{priority:i,delay:e+s(r)});o.push(a)})),Promise.all(o)},t.prototype.onStart=function(){var t=this.props.onAnimationStart;t&&t()},t.prototype.onComplete=function(){var t=this.props.onAnimationComplete;t&&t()},t.prototype.checkOverrideIsAnimating=function(t){for(var e=this.overrides.length,n=t+1;n<e;n++){var r=this.resolvedOverrides[n];if(r)for(var i in r)this.isAnimating.add(i)}},t.prototype.resetIsAnimating=function(t){void 0===t&&(t=0),this.isAnimating.clear(),t<this.getHighestPriority()&&this.checkOverrideIsAnimating(t),this.children&&this.children.forEach((function(e){return e.resetIsAnimating(t)}))},t.prototype.stop=function(){this.values.forEach((function(t){return t.stop()}))},t.prototype.addChild=function(t){this.children||(this.children=new Set),this.children.add(t),this.overrides.forEach((function(e,n){e&&t.setOverride(e,n)}))},t.prototype.removeChild=function(t){this.children&&this.children.delete(t)},t.prototype.resetChildren=function(){this.children&&this.children.clear()},t}();var yr=function(){function t(){this.hasMounted=!1,this.pendingAnimations=[],this.componentControls=new Set}return t.prototype.setVariants=function(t){this.variants=t,this.componentControls.forEach((function(e){return e.setVariants(t)}))},t.prototype.setDefaultTransition=function(t){this.defaultTransition=t,this.componentControls.forEach((function(e){return e.setDefaultTransition(t)}))},t.prototype.subscribe=function(t){var e=this;return this.componentControls.add(t),this.variants&&t.setVariants(this.variants),this.defaultTransition&&t.setDefaultTransition(this.defaultTransition),function(){return e.componentControls.delete(t)}},t.prototype.start=function(t,e){var n=this;if(this.hasMounted){var r=[];return this.componentControls.forEach((function(n){var i=n.start(t,{transitionOverride:e});r.push(i)})),Promise.all(r)}return new Promise((function(r){n.pendingAnimations.push({animation:[t,e],resolve:r})}))},t.prototype.set=function(t){return u(this.hasMounted,"controls.set() should only be called after a component has mounted. Consider calling within a useEffect hook."),this.componentControls.forEach((function(e){return e.apply(t)}))},t.prototype.stop=function(){this.componentControls.forEach((function(t){return t.stop()}))},t.prototype.mount=function(){var t=this;this.hasMounted=!0,this.pendingAnimations.forEach((function(e){var n=e.animation,r=e.resolve;return t.start.apply(t,n).then(r)}))},t.prototype.unmount=function(){this.hasMounted=!1,this.stop()},t}(),gr=Object(o.createContext)({static:!1}),vr=function(t){return"string"===typeof t||Array.isArray(t)},_r=function(t){return t instanceof yr},br=function(t,e,n,r,i){void 0===r&&(r=!1);var a,s=i.initial,u=i.animate,c=i.variants,l=i.whileTap,h=i.whileHover;t.exitProps&&void 0!==t.exitProps.initial&&(s=t.exitProps.initial),!1!==s||_r(u)?"boolean"!==typeof s&&(a=s):a=u;var p=Object(o.useRef)(!1),f=c||vr(u)||vr(l)||vr(h)||_r(u),d=vr(a)?a:t.initial,m=vr(u)?u:t.animate,y=r?d:null,g=f&&vr(m)?m:null,v=Object(o.useMemo)((function(){return{controls:f?e:t.controls,initial:d,animate:m,values:n,hasMounted:p,isReducedMotion:t.isReducedMotion}}),[y,g,t.isReducedMotion]);return v.static=r,function(t,e){void 0===e&&(e=!1);var n=Object(o.useRef)(!0);(!e||e&&n.current)&&t(),n.current=!1}((function(){var n=a||t.initial;n&&e.apply(n)}),!r),Object(o.useEffect)((function(){p.current=!0}),[]),v};function wr(t,e,n,r){var a=e.variants,s=e.transition,u=Object(o.useContext)(gr).controls,c=An((function(){return new mr(t)}));return r&&r.exitProps&&r.exitProps.isExiting||(c.resetChildren(),c.setProps(e),c.setVariants(a),c.setDefaultTransition(s)),Object(o.useEffect)((function(){n&&u&&u.addChild(c)})),Object(o.useEffect)((function(){return function(){e.onAnimationComplete;var t=Object(i.__rest)(e,["onAnimationComplete"]);c.setProps(t),u&&u.removeChild(c)}}),[]),c}var xr=function(t){var e=t.animate,n=t.variants,r=t.inherit;return(void 0===r||r)&&!!n&&(!e||e instanceof yr)};var Er,Tr=function(t){var e=t.getValueControlsConfig,n=t.loadFunctionalityComponents,r=t.renderComponent;return Object(o.forwardRef)((function(t,i){var a=function(t){var e=t&&"function"!==typeof t?t:Object(o.useRef)(null);return t&&"function"===typeof t&&Object(o.useEffect)((function(){return t(e.current),function(){return t(null)}}),[]),e}(i),s=Object(o.useContext)(gr),u=s.static||t.static||!1,c=Nn(t),l=Hn(c,t.style,u,t.transformValues),h=xr(t),p=wr(An((function(){return e(a,c)})),t,h,s),f=br(s,p,c,u,t),d=u?null:n(a,c,t,s,p,h),m=r(a,l,c,t,u);return Object(o.createElement)(o.Fragment,null,Object(o.createElement)(gr.Provider,{value:f},m),Object(o.createElement)(o.Fragment,null,Object(o.createElement)(Un,{innerRef:a,values:c,isStatic:u}),d))}))},Sr=["animate","circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","switch","symbol","text","textPath","tspan","use","view"];!function(t){t.subtract=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},t.relativeTo=function(t){var e;return function(n){var r=n.x,i=n.y,o=void 0!==e?e:e="string"===typeof t?document.getElementById(t):t;if(o){var a=o.getBoundingClientRect();return{x:r-a.left-window.scrollX,y:i-a.top-window.scrollY}}}}}(Er||(Er={}));var Cr=Object(o.createContext)({transformPagePoint:function(t){return t}});var Ir=!1;"undefined"!==typeof window&&document.addEventListener("touchmove",(function(t){Ir&&t.preventDefault()}),{passive:!1});var kr=function(){return Ir=!0},Ar=function(){return Ir=!1};function Or(t){return"undefined"!==typeof PointerEvent&&t instanceof PointerEvent?!("mouse"!==t.pointerType):t instanceof MouseEvent}function Pr(t){return!!t.touches}function Dr(t){var e=Object(o.useRef)(t);return Object(o.useEffect)((function(){e.current=t})),e}function Mr(t){return Object(o.useEffect)((function(){return function(){return t()}}),[])}function Rr(t,e,n,r){if(n)return t.addEventListener(e,n,r),function(){return t.removeEventListener(e,n,r)}}var Nr={pageX:0,pageY:0};function Lr(t){var e=t.touches[0]||t.changedTouches[0]||Nr;return{x:e.pageX,y:e.pageY}}function Fr(t){var e=t.pageX,n=void 0===e?0:e,r=t.pageY;return{x:n,y:void 0===r?0:r}}var jr=function(t,e){if(void 0===e&&(e=!1),t){var n=function(e){return t(e,function(t){return{point:Pr(t)?Lr(t):Fr(t)}}(e))};return e?function(t){if(t)return function(e){var n=e instanceof MouseEvent;(!n||n&&0===e.button)&&t(e)}}(n):n}},zr="undefined"!==typeof window,Br=function(){return zr&&null===window.onpointerdown},Ur=function(){return zr&&null===window.ontouchstart},Vr=function(){return zr&&null===window.onmousedown},qr={pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointercancel:"mousecancel",pointerover:"mouseover",pointerout:"mouseout",pointerenter:"mouseenter",pointerleave:"mouseleave"},Wr={pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"};function Gr(t){return Br()?t:Ur()?Wr[t]:Vr()?qr[t]:t}function Hr(t,e,n,r){return Rr(t,Gr(e),jr(n,"pointerdown"===e),r)}function Kr(t,e,n,r){return function(t,e,n,r){Object(o.useEffect)((function(){var i=t.current;if(n&&i)return Rr(i,e,n,r)}),[t,e,n,r])}(t,Gr(e),jr(n,"pointerdown"===e),r)}function Qr(t){return t.pointHistory[0]}function Xr(t){return t.pointHistory[t.pointHistory.length-1]}function Yr(t,e){var n=t.pointHistory;if(n.length<2)return{x:0,y:0};for(var r=n.length-1,i=null,o=Xr(t);r>=0&&(i=n[r],!(o.timestamp-i.timestamp>cr(e)));)r--;if(!i)return{x:0,y:0};var a=(o.timestamp-i.timestamp)/1e3;if(0===a)return{x:0,y:0};var s={x:(o.x-i.x)/a,y:(o.y-i.y)/a};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function Zr(t,e){var n=t.onPan,r=t.onPanStart,a=t.onPanEnd,u=t.onPanSessionStart,c=n||r||a||u,l=Object(o.useRef)(null),h=Object(o.useRef)(null),p=Object(o.useRef)(null),f=Object(o.useContext)(Cr).transformPagePoint,d=Object(o.useRef)(null),m=Dr({onPanSessionStart:u,onPanStart:r,onPan:n,onPanEnd:a});function y(){d.current&&d.current(),d.current=null}function g(t){var e=t.point,n=l.current;return{point:e,delta:Er.subtract(e,Xr(n)),offset:Er.subtract(e,Qr(n)),velocity:Yr(n,.1)}}function v(t){return{point:f(t.point)}}function _(){y(),x.update(b),Ar()}function b(){if(!l.current||!h.current||!p.current)return s(!1,"onPointerMove fired without pointer session"),void _();var t=g(p.current),e=void 0!==l.current.startEvent,n=qt(t.offset,{x:0,y:0})>=3;if(e||n){var r=t.point,o=C().timestamp;l.current.pointHistory.push(Object(i.__assign)({},r,{timestamp:o}));var a=m.current,u=a.onPanStart,c=a.onPan;e||(u&&u(h.current,t),l.current.startEvent=h.current),c&&c(h.current,t)}}function w(t,e){h.current=t,p.current=v(e),Or(t)&&0===t.buttons?E(t,e):I.update(b,!0)}function E(t,e){if(_(),l.current){var n=m.current.onPanEnd;n&&n(t,g(v(e))),l.current=null}else s(!1,"onPointerUp fired without pointer session")}Kr(e,"pointerdown",c&&function(t,e){if(!(Pr(t)&&t.touches.length>1)){var n=v(e),r=n.point,o=C().timestamp;l.current={target:t.target,pointHistory:[Object(i.__assign)({},r,{timestamp:o})]};var a=m.current.onPanSessionStart;a&&a(t,g(n)),y();var s=Hr(window,"pointermove",w),u=Hr(window,"pointerup",E);d.current=function(){s&&s(),u&&u()}}}),Mr(_)}var Jr=function t(e,n){return!!n&&(e===n||t(e,n.parentElement))},$r=["whileHover","whileTap","whileDrag"],ti=function(t){return $r.indexOf(t)+1};function ei(t){var e=null;return function(){return null===e&&(e=t,function(){e=null})}}var ni=ei("dragHorizontal"),ri=ei("dragVertical");function ii(t){var e=!1;if("y"===t)e=ri();else if("x"===t)e=ni();else{var n=ni(),r=ri();n&&r?e=function(){n(),r()}:(n&&n(),r&&r())}return e}var oi=ti("whileTap");var ai=ti("whileHover"),si=function(t){return function(e,n){Or(e)&&t(e,n)}};function ui(t,e){Zr(t,e),function(t,e){var n=t.onTap,r=t.onTapStart,i=t.onTapCancel,a=t.whileTap,s=t.controls,u=n||r||i||a,c=Object(o.useRef)(!1),l=Object(o.useRef)(null);function h(){l.current&&l.current(),l.current=null}a&&s&&s.setOverride(a,oi);var p=Object(o.useRef)(null);p.current=function(t,r){var o=e.current;if(h(),c.current&&o){c.current=!1,s&&a&&s.clearOverride(oi);var u=ii(!0);u&&(u(),Jr(o,t.target)?n&&n(t,r):i&&i(t,r))}},Kr(e,"pointerdown",u?function(t,n){h(),l.current=Hr(window,"pointerup",(function(t,e){return p.current(t,e)})),e.current&&!c.current&&(c.current=!0,r&&r(t,n),s&&a&&s.startOverride(oi))}:void 0),Mr(h)}(t,e),function(t,e){var n=t.whileHover,r=t.onHoverStart,i=t.onHoverEnd,o=t.controls;n&&o&&o.setOverride(n,ai),Kr(e,"pointerenter",si((function(t,e){r&&r(t,e),n&&o&&o.startOverride(ai)}))),Kr(e,"pointerleave",si((function(t,e){i&&i(t,e),n&&o&&o.clearOverride(ai)})))}(t,e)}var ci=function(t){return function(e){return t(e),null}},li=["drag","onPan","onPanStart","onPanEnd","onPanSessionStart","onTap","onTapStart","onTapCancel","whileTap","whileHover","onHoverStart","onHoverEnd"],hi={key:"gestures",shouldRender:function(t){return li.some((function(e){return t.hasOwnProperty(e)}))},Component:ci((function(t){var e=t.innerRef;ui(Object(i.__rest)(t,["innerRef"]),e)}))},pi=function(t){return"object"===typeof t&&t.hasOwnProperty("current")};function fi(t){return An((function(){return kn(t)}))}var di=new Set(["INPUT","TEXTAREA","SELECT"]),mi=function(t,e){var n=t.current.getBoundingClientRect(),r=e({x:n.left,y:n.top}),i=r.x,o=r.y,a=e({x:n.width,y:n.height});return{left:i,top:o,width:a.x,height:a.y}},yi=function(t){return t?t.get():0},gi=function(t,e,n,r){u(null!==t.current&&null!==e.current,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");var i=mi(t,r),o=mi(e,r),a=i.left-o.left+yi(n.x),s=i.top-o.top+yi(n.y);return{top:s,left:a,right:i.width-o.width+a,bottom:i.height-o.height+s}};function vi(t,e,n){return(!0===e||e===t)&&(null===n||n===t)}var _i=function(t,e){var n=e.top,r=e.right,i=e.bottom,o=e.left;return"x"===t?{min:o,max:r}:{min:n,max:i}};function bi(t,e,n,r){var i=e instanceof In?e.get():e;if(!n)return i;var o=_i(t,n),a=o.min,s=o.max;return void 0!==a&&i<a?i=r?wi(a,i,r):Math.max(a,i):void 0!==s&&i>s&&(i=r?wi(s,i,r):Math.min(s,i)),e instanceof In&&e.set(i),i}function wi(t,e,n){return Gt(t,e,"number"===typeof n?n:.35)}function xi(t){return[t("x"),t("y")]}function Ei(t,e,n,r){var a,s,u=t.drag,c=void 0!==u&&u,l=t.dragDirectionLock,h=void 0!==l&&l,p=t.dragPropagation,f=void 0!==p&&p,d=t.dragConstraints,m=void 0!==d&&d,y=t.dragElastic,g=void 0===y||y,v=t.dragMomentum,_=void 0===v||v,b=t._dragValueX,w=t._dragValueY,x=t._dragTransitionControls,E=t.dragOriginX,T=t.dragOriginY,S=t.dragTransition,C=t.onDirectionLock,I=t.onDragStart,k=t.onDrag,A=t.onDragEnd,O=t.onDragTransitionEnd,P=pi(m),D=Object(o.useRef)({isDragging:!1,currentDirection:null,constraints:!1}).current,M=Dr({onDragStart:I,onDrag:k,onDragEnd:A,onDirectionLock:C,onDragTransitionEnd:O}),R=Object(o.useRef)({}).current,N=fi(0),L=fi(0),F={x:E||N,y:T||L},j=Object(o.useRef)(null),z=Object(o.useContext)(Cr).transformPagePoint,B=Object(o.useRef)({width:0,height:0,x:0,y:0}).current,U=function(){if(pi(m)){var t=mi(m,z),n=mi(e,z),r=function(e,r){var i=R[e];if(i){if(i.isAnimating())return i.stop(),void V();var o=B[r]?(t[r]-n[r])/B[r]:1;i.set(B[e]*o)}};r("x","width"),r("y","height")}};a=m,s=U,Object(o.useEffect)((function(){if(a&&pi(a))return window.addEventListener("resize",s),function(){return window.removeEventListener("resize",s)}}),[a,s]);var V=function(t){if(t){var e=t.right,n=t.left,r=t.bottom,i=t.top;B.width=(e||0)-(n||0),B.height=(r||0)-(i||0)}R.x&&(B.x=R.x.get()),R.y&&(B.y=R.y.get())},q=function(t){return xi((function(e){var n=R[e];n&&!n.isAnimating()&&bi(e,n,t,0)}))};function W(t){return Object(i.__assign)({},t,{point:{x:R.x?R.x.get():0,y:R.y?R.y.get():0}})}function G(t,e){var n=R[t];if(vi(t,c,D.currentDirection)&&n){var r=bi(t,F[t].get()+e[t],D.constraints,g);n.set(r)}}function H(){Ar(),D.isDragging=!1,!f&&j.current&&(j.current(),j.current=null)}Object(o.useEffect)((function(){if(P){var t=gi(m,e,R,z);q(t),V(t)}else!D.isDragging&&D.constraints&&q(D.constraints)}),[]),D.constraints=P?D.constraints||!1:m,xi((function(t){if(vi(t,c,D.currentDirection)){var e="x"===t?b:w;R[t]=e||n.get(t,0)}})),Zr(c?{onPan:function(t,e){if(f||j.current){var n=e.offset;if(h&&null===D.currentDirection){if(D.currentDirection=function(t,e){void 0===e&&(e=10);var n=null;Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x");return n}(n),null!==D.currentDirection){var r=M.current.onDirectionLock;r&&r(D.currentDirection)}}else{G("x",n),G("y",n);var i=M.current.onDrag;i&&i(t,W(e))}}},onPanStart:function(t,n){if(P&&(D.constraints=gi(m,e,R,z),q(D.constraints)),xi((function(t){var e=R[t];e&&(F[t].set(e.get()),e.stop())})),f||(j.current&&j.current(),j.current=ii(c),j.current)){D.isDragging=!0,D.currentDirection=null;var r=M.current.onDragStart;r&&r(t,W(n))}},onPanEnd:function(t,e){var n=D.isDragging;if(H(),n){if(_||g)!function(t){var e=xi((function(e){var n;if(vi(e,c,D.currentDirection)){var o=D.constraints?_i(e,D.constraints):{},a=g?200:1e6,s=g?40:1e7;return(x||r).start(((n={})[e]=0,n.transition=Object(i.__assign)({type:"inertia",velocity:_?t[e]:0,bounceStiffness:a,bounceDamping:s,timeConstant:750,restDelta:1},S,o),n))}}));Promise.all(e).then((function(){V(D.constraints),U();var t=M.current.onDragTransitionEnd;t&&t()}))}(e.velocity);else V(D.constraints);var o=M.current.onDragEnd;o&&o(t,W(e))}},onPanSessionStart:function(t){t.target&&!di.has(t.target.tagName)&&(Ur()||(t.preventDefault(),document.activeElement instanceof HTMLElement&&document.activeElement.blur())),kr(),xi((function(t){var e=R[t];e&&e.stop()}))}}:{},e),Mr((function(){return D.isDragging&&H()}))}var Ti={key:"drag",shouldRender:function(t){return!!t.drag},Component:ci((function(t){var e=t.innerRef,n=t.values,r=t.controls;return Ei(Object(i.__rest)(t,["innerRef","values","controls"]),e,n,r)}))};function Si(t){return"string"===typeof t&&t.startsWith("var(--")}var Ci=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;var Ii=4;function ki(t,e,n){void 0===n&&(n=1),u(n<=Ii,'Max CSS variable fallback depth detected in property "'+t+'". This may indicate a circular fallback dependency.');var r=function(t){var e=Ci.exec(t);return e?[e[1],e[2]]:[,]}(t),i=r[0],o=r[1];if(i){var a=window.getComputedStyle(e).getPropertyValue(i);return a||(Si(o)?ki(o,e,n+1):o)}}var Ai,Oi=new Set(["width","height","top","left","right","bottom","x","y"]),Pi=function(t){return Oi.has(t)},Di=function(t){return Object.keys(t).some(Pi)},Mi=function(t,e){t.set(e,!1),t.set(e)},Ri=function(t){return t===R||t===B};!function(t){t.width="width",t.height="height",t.left="left",t.right="right",t.top="top",t.bottom="bottom"}(Ai||(Ai={}));var Ni=function(t,e){return parseFloat(t.split(", ")[e])},Li=function(t,e){return function(n,r){var i=r.transform;if("none"===i||!i)return 0;var o=i.match(/^matrix3d\((.+)\)$/);if(o)return Ni(o[1],e);var a=i.match(/^matrix\((.+)\)$/);return Ni(a[1],t)}},Fi=new Set(["x","y","z"]),ji=_e.filter((function(t){return!Fi.has(t)}));var zi={width:function(t){var e=t.width;return e},height:function(t){var e=t.height;return e},top:function(t,e){var n=e.top;return parseFloat(n)},left:function(t,e){var n=e.left;return parseFloat(n)},bottom:function(t,e){var n=t.height,r=e.top;return parseFloat(r)+n},right:function(t,e){var n=t.width,r=e.left;return parseFloat(r)+n},x:Li(4,13),y:Li(5,14)},Bi=function(t,e,n,r){void 0===r&&(r={}),n=Object(i.__assign)({},n),r=Object(i.__assign)({},r);var o=e.current,a=Ze(o),s=Object.keys(n).filter(Pi),c=[],l=!1,h=s.reduce((function(e,i){var o=t.get(i);if(!o)return e;var s,h=o.get(),p=n[i],f=Jn(h);if(Kn(p))for(var d=p.length,m=null===p[0]?1:0;m<d;m++)s?u(Jn(p[m])===s,"All keyframes must be of the same type"):(s=Jn(p[m]),u(s===f||Ri(f)&&Ri(s),"Keyframes must be of the same dimension as the current value"));else s=Jn(p);if(f!==s)if(Ri(f)&&Ri(s)){var y=o.get();"string"===typeof y&&o.set(parseFloat(y)),"string"===typeof p?n[i]=parseFloat(p):Array.isArray(p)&&s===B&&(n[i]=p.map(parseFloat))}else l||(c=function(t,e){var n=[];return ji.forEach((function(e){var r=t.get(e);void 0!==r&&(n.push([e,r.get()]),r.set(e.startsWith("scale")?1:0))})),n.length&&e.render(),n}(t,a),l=!0),e.push(i),r[i]=void 0!==r[i]?r[i]:n[i],Mi(o,p);return e}),[]);if(h.length){var p=function(t,e,n,r,i){var o=n.getBoundingClientRect(),a=getComputedStyle(n),s=a.display,u={top:a.top,left:a.left,bottom:a.bottom,right:a.right,transform:a.transform};"none"===s&&r.set("display",t.display||"block"),r.render();var c=n.getBoundingClientRect();return i.forEach((function(n){var r=e.get(n);Mi(r,zi[n](o,u)),t[n]=zi[n](c,a)})),t}(n,t,o,a,h);return c.length&&c.forEach((function(e){var n=e[0],r=e[1];t.get(n).set(r)})),a.render(),{target:p,transitionEnd:r}}return{target:n,transitionEnd:r}};var Ui=function(t,e){return function(n,r){var o=function(t,e,n,r){var o=Object(i.__rest)(n,[]),a=e.current;if(!(a instanceof HTMLElement))return{target:o,transitionEnd:r};for(var s in r&&(r=Object(i.__assign)({},r)),t.forEach((function(t){var e=t.get();if(Si(e)){var n=ki(e,a);n&&t.set(n)}})),o){var u=o[s];if(Si(u)){var c=ki(u,a);c&&(o[s]=c,r&&void 0===r[s]&&(r[s]=u))}}return{target:o,transitionEnd:r}}(t,e,n,r);return n=o.target,r=o.transitionEnd,function(t,e,n,r){return Di(n)?Bi(t,e,n,r):{target:n,transitionEnd:r}}(t,e,n,r)}};function Vi(){var t=Object(o.useState)(0),e=t[0],n=t[1];return Object(o.useCallback)((function(){return n(e+1)}),[e])}var qi,Wi,Gi=Object(o.createContext)(null);!function(t){t.Prepare="prepare",t.Read="read",t.Render="render"}(Wi||(Wi={}));var Hi=[Wi.Prepare,Wi.Read,Wi.Render].reduce((function(t,e){return t[e]=[],t}),{}),Ki=!1;function Qi(t){for(var e=t.length,n=0;n<e;n++)t[n]();t.length=0}var Xi=function(t){return function(e){e&&(Ki=!0,Hi[t].push(e))}},Yi=((qi={})[Wi.Prepare]=Xi(Wi.Prepare),qi[Wi.Read]=Xi(Wi.Read),qi[Wi.Render]=Xi(Wi.Render),qi.flush=function(){Ki&&(Qi(Hi.prepare),Qi(Hi.read),Qi(Hi.render),Ki=!1)},qi);var Zi={duration:.8,ease:[.45,.05,.19,1]},Ji={type:"spring",stiffness:500,damping:25,restDelta:.5,restSpeed:10};var $i={x:{id:"x",size:"width",min:"left",max:"right",origin:"originX"},y:{id:"y",size:"height",min:"top",max:"bottom",origin:"originY"}};function to(t,e){return(t+e)/2}function eo(t,e,n){var r,i=t[n.size]-e[n.size],o=.5;return i&&(t[n.min]===e[n.min]?o=0:t[n.max]===e[n.max]&&(o=1)),(r={})[n.size]=i,r[n.origin]=o,r[n.id]=.5===o?to(t[n.min],t[n.max])-to(e[n.min],e[n.max]):0,r}var no={getLayout:function(t){return t.offset},measure:function(t){var e=t.offsetLeft,n=t.offsetTop,r=t.offsetWidth,i=t.offsetHeight;return{left:e,top:n,right:e+r,bottom:n+i,width:r,height:i}}},ro={getLayout:function(t){return t.boundingBox},measure:function(t){var e=t.getBoundingClientRect();return{left:e.left,top:e.top,width:e.width,height:e.height,right:e.right,bottom:e.bottom}}};function io(t){return window.getComputedStyle(t).position}function oo(t){return"width"===t||"height"===t}var ao,so={key:"layout",shouldRender:function(t){var e=t.positionTransition,n=t.layoutTransition;return u(!(e&&n),"Don't set both positionTransition and layoutTransition on the same component"),"undefined"!==typeof window&&!(!e&&!n)},Component:function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.getSnapshotBeforeUpdate=function(){var t=this.props,e=t.innerRef,n=t.positionTransition,r=t.values,o=t.controls,a=e.current;if(function(t){return t instanceof HTMLElement}(a)){var s,u,c,l=function(t){var e=t.layoutTransition,n=t.positionTransition;return e||n}(this.props),h=!!n,p=io(a),f={offset:no.measure(a),boundingBox:ro.measure(a)};return Yi.prepare((function(){s=a.style.transform,a.style.transform=""})),Yi.read((function(){u={offset:no.measure(a),boundingBox:ro.measure(a)};var t=io(a);c=function(t,e,n){return n&&t===e?no:ro}(p,t,h)})),Yi.render((function(){var t=function(t,e){return Object(i.__assign)({},eo(t,e,$i.x),eo(t,e,$i.y))}(c.getLayout(f),c.getLayout(u));if(t.x||t.y||t.width||t.height){Ze(a).set({originX:t.originX,originY:t.originY}),jn();var e={},n={},p=function(t){return"function"===typeof t}(l)?l({delta:t}):l;d("left","x",0,t.x),d("top","y",0,t.y),h||(d("width","scaleX",1,f.boundingBox.width/u.boundingBox.width),d("height","scaleY",1,f.boundingBox.height/u.boundingBox.height)),e.transition=n,p&&o.start(e),zn()}else s&&(a.style.transform=s);function d(o,a,s,u){var l=oo(o)?o:a;if(t[l]){var f="boolean"===typeof p?Object(i.__assign)({},function(t){return t?Ji:Zi}(h)):p,d=r.get(a,s),m=d.getVelocity();n[a]=f[a]?Object(i.__assign)({},f[a]):Object(i.__assign)({},f),void 0===n[a].velocity&&(n[a].velocity=m||0),e[a]=s;var y=oo(o)||c!==no?0:d.get();d.set(u+y)}}})),null}},e.prototype.componentDidUpdate=function(){Yi.flush()},e.prototype.render=function(){return null},e.contextType=Gi,e}(a.a.Component)},uo=new Set(["initial","animate","exit","style","variants","transition","transformTemplate","transformValues","custom","inherit","static","positionTransition","layoutTransition","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onDirectionLock","onDragTransitionEnd","drag","dragConstraints","dragDirectionLock","dragElastic","dragMomentum","dragPropagation","dragTransition","_dragValueX","_dragValueY","_dragTransitionControls","dragOriginX","dragOriginY","onPan","onPanStart","onPanEnd","onPanSessionStart","onTap","onTapStart","onTapCancel","whileHover","whileTap","onHoverEnd","onHoverStart"]);function co(t){return uo.has(t)}!function(t){t.Target="Target",t.VariantLabel="VariantLabel",t.AnimationSubscription="AnimationSubscription"}(ao||(ao={}));var lo=function(t,e){return void 0!==e&&(Array.isArray(t)&&Array.isArray(e)?!function(t,e){if(null===e)return!1;var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}(e,t):t!==e)};function ho(t,e){void 0===e&&(e=!1);t.transition;var n=t.transitionEnd,r=Object(i.__rest)(t,["transition","transitionEnd"]);return e?Object(i.__assign)({},r,n):r}var po,fo,mo=function(t){var e,n=t instanceof In?t.get():t;return Array.from(new Set((e=n)?Array.isArray(e)?e:[e]:[]))},yo=function(t){return[t.join(",")]},go=function(t,e){return t.join(",")!==e.join(",")};var vo=((po={})[ao.Target]=ci((function(t){return function(t,e,n,r){var a=Object(o.useRef)(!0),s=Object(o.useRef)(null);s.current||(s.current=ho(t,!0)),Object(o.useEffect)((function(){var o={},u=ho(t),c=ho(t,!0);for(var l in u){var h=a.current&&(!n.has(l)||n.get(l).get()!==c[l]),p=null!==c[l],f=lo(s.current[l],c[l]);p&&(f||h)&&(o[l]=u[l])}a.current=!1,s.current=Object(i.__assign)({},s.current,c),Object.keys(o).length&&e.start(Object(i.__assign)({},o,{transition:t.transition||r,transitionEnd:t.transitionEnd}))}),[t])}(t.animate,t.controls,t.values,t.transition)})),po[ao.VariantLabel]=ci((function(t){var e=t.animate,n=t.inherit,r=void 0===n||n,i=t.controls;return function(t,e,n,r){var i=mo(e),a=Object(o.useContext)(gr),s=a.hasMounted&&a.hasMounted.current,u=Object(o.useRef)(!1);Object(o.useEffect)((function(){var e=!1;n?(e=!!s,i=mo(a.animate)):e=u.current||go(mo(t),i),e&&r.start(i),u.current=!0}),yo(i))}(t.initial,e,r,i)})),po[ao.AnimationSubscription]=ci((function(t){return function(t,e){var n=Object(o.useMemo)((function(){return t.subscribe(e)}),[t]);Object(o.useEffect)((function(){return function(){n&&n()}}),[n])}(t.animate,t.controls)})),po),_o=function(t){return t.animate instanceof yr},bo=["initial","animate","whileTap","whileHover"],wo=((fo={})[ao.Target]=function(t){return void 0!==t.animate&&(e=t.animate,!(Array.isArray(e)||"string"===typeof e))&&!_o(t);var e},fo[ao.VariantLabel]=function(t){return void 0!==t.variants||bo.some((function(e){return"string"===typeof t[e]}))},fo[ao.AnimationSubscription]=_o,fo),xo=function(t){var e=void 0;for(var n in ao)wo[n](t)&&(e=n);return e?vo[e]:void 0},Eo={key:"exit",shouldRender:function(t,e){var n=t.exit,r=!!e.exitProps,i=!!n;return u(!r||r&&i,"No exit prop defined on a child of AnimatePresence."),r&&i},Component:ci((function(t){var e=t.animate,n=t.controls,r=t.parentContext,a=t.exit,s=r.exitProps,u=Object(o.useRef)(!1);if(s&&a){var c=s.isExiting,l=s.custom,h=s.onExitComplete;Object(o.useEffect)((function(){c?(!u.current&&a&&(n.setProps(Object(i.__assign)({},t,{custom:void 0!==l?l:t.custom})),n.start(a).then(h)),u.current=!0):!u.current||!e||e instanceof yr||n.start(e),c||(u.current=!1)}),[c])}}))},To=function(t){return!co(t)};try{var So=n(73).default;To=function(t){return t.startsWith("on")?!co(t):So(t)}}catch(Bo){}var Co=function(t,e){var n=We(Vn(t),void 0,void 0,void 0,void 0,!1);return n.style=Object(i.__assign)({},e,n.style),n},Io=[so,Ti,hi,Eo],ko=Io.length;function Ao(t){var e="string"===typeof t,n=e&&-1!==Sr.indexOf(t);return{renderComponent:function(r,a,s,u,c){var l=e?function(t){var e={};for(var n in t)To(n)&&(e[n]=t[n]);return e}(u):u,h=n?Co(s,a):{style:Gn(s,a,c)};return Object(o.createElement)(t,Object(i.__assign)({},l,{ref:r},h))},loadFunctionalityComponents:function(t,e,n,r,a,s){var u=[],c=xo(n);c&&u.push(Object(o.createElement)(c,{key:"animation",initial:n.initial,animate:n.animate,variants:n.variants,transition:n.transition,controls:a,inherit:s,values:e}));for(var l=0;l<ko;l++){var h=Io[l],p=h.shouldRender,f=h.key,d=h.Component;p(n,r)&&u.push(Object(o.createElement)(d,Object(i.__assign)({key:f},n,{parentContext:r,values:e,controls:a,innerRef:t})))}return u},getValueControlsConfig:function(t,e){return{values:e,readValueFromSource:function(e){return Ze(t.current).get(e)},makeTargetAnimatable:Ui(e,t)}}}}var Oo=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","webview"].reduce((function(t,e){var n=Ao(e);return t[e]=Tr(n),t}),{}),Po=Sr.reduce((function(t,e){return t[e]=Tr(Ao(e)),t}),{}),Do=Object(i.__assign)({custom:function(t){return Tr(Ao(t))}},Oo,Po);kn(0),kn(0),kn(0),kn(0);function Mo(){var t=An((function(){return new yr}));return Object(o.useEffect)((function(){return t.mount(),function(){return t.unmount()}}),[]),t}var Ro=function(t){var e=t.children,n=t.exitProps,r=Object(o.useContext)(gr);return r=Object(i.__assign)({},r,{exitProps:n||{}}),Object(o.createElement)(gr.Provider,{value:r},e)};function No(t){return t.key||""}var Lo=function(t){var e=t.children,n=t.custom,r=t.initial,i=void 0===r||r,a=t.onExitComplete,s=t.exitBeforeEnter,u=Vi(),c=Object(o.useContext)(Gi)||u,l=Object(o.useRef)(!0),h=function(t){var e=[];return o.Children.forEach(t,(function(t){Object(o.isValidElement)(t)&&e.push(t)})),e}(e),p=Object(o.useRef)(h),f=Object(o.useRef)(new Map).current,d=Object(o.useRef)(new Set).current;if(function(t,e){t.forEach((function(t){var n=No(t);e.set(n,t)}))}(h,f),l.current)return l.current=!1,Object(o.createElement)(o.Fragment,null,h.map((function(t){return Object(o.createElement)(Ro,{key:No(t),exitProps:i?void 0:{initial:!1}},t)})));for(var m=h.slice(),y=p.current.map(No),g=h.map(No),v=y.length,_=0;_<v;_++){var b=y[_];-1===g.indexOf(b)?d.add(b):d.delete(b)}return s&&d.size&&(m=[]),d.forEach((function(t){if(-1===g.indexOf(t)){var e=f.get(t);if(e){var r=y.indexOf(t),i={custom:n,isExiting:!0,onExitComplete:function(){d.delete(t);var e=p.current.findIndex((function(e){return e.key===t}));p.current.splice(e,1),d.size||(p.current=h,c(),a&&a())}};m.splice(r,0,Object(o.createElement)(Ro,{key:No(e),exitProps:i},e))}}})),m=m.map((function(t){var e=t.key;return d.has(e)?t:Object(o.createElement)(Ro,{key:No(t)},t)})),p.current=m,Object(o.createElement)(o.Fragment,null,d.size?m:m.map((function(t){return Object(o.cloneElement)(t)})))},Fo=kn(null);if("undefined"!==typeof window)if(window.matchMedia){var jo=window.matchMedia("(prefers-reduced-motion)"),zo=function(){return Fo.set(jo.matches)};jo.addListener(zo),zo()}else Fo.set(!1)},function(t,e,n){var r;!function(){"use strict";var i=!("undefined"===typeof window||!window.document||!window.document.createElement),o={canUseDOM:i,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:i&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:i&&!!window.screen};void 0===(r=function(){return o}.call(e,n,e,t))||(t.exports=r)}()},function(t,e,n){var r,i,o;o=function(){var t,e,n=document,r=n.getElementsByTagName("head")[0],i=!1,o="push",a="readyState",s="onreadystatechange",u={},c={},l={},h={};function p(t,e){for(var n=0,r=t.length;n<r;++n)if(!e(t[n]))return i;return 1}function f(t,e){p(t,(function(t){return e(t),1}))}function d(e,n,r){e=e[o]?e:[e];var i=n&&n.call,a=i?n:r,s=i?e.join(""):n,y=e.length;function g(t){return t.call?t():u[t]}function v(){if(!--y)for(var t in u[s]=1,a&&a(),l)p(t.split("|"),g)&&!f(l[t],g)&&(l[t]=[])}return setTimeout((function(){f(e,(function e(n,r){return null===n?v():(r||/^https?:\/\//.test(n)||!t||(n=-1===n.indexOf(".js")?t+n+".js":t+n),h[n]?(s&&(c[s]=1),2==h[n]?v():setTimeout((function(){e(n,!0)}),0)):(h[n]=1,s&&(c[s]=1),void m(n,v)))}))}),0),d}function m(t,i){var o,u=n.createElement("script");u.onload=u.onerror=u[s]=function(){u[a]&&!/^c|loade/.test(u[a])||o||(u.onload=u[s]=null,o=1,h[t]=2,i())},u.async=1,u.src=e?t+(-1===t.indexOf("?")?"?":"&")+e:t,r.insertBefore(u,r.lastChild)}return d.get=m,d.order=function(t,e,n){!function r(i){i=t.shift(),t.length?d(i,r):d(i,e,n)}()},d.path=function(e){t=e},d.urlArgs=function(t){e=t},d.ready=function(t,e,n){t=t[o]?t:[t];var r,i=[];return!f(t,(function(t){u[t]||i[o](t)}))&&p(t,(function(t){return u[t]}))?e():(r=t.join("|"),l[r]=l[r]||[],l[r][o](e),n&&n(i)),d},d.done=function(t){d([null],t)},d},t.exports?t.exports=o():void 0===(i="function"===typeof(r=o)?r.call(e,n,e,t):r)||(t.exports=i)},function(t,e,n){t.exports=n(51)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e,n,r){return"boolean"==typeof t?t:"function"==typeof t?t(e,n,r):!(!0!==!!t)&&!!t},i=function(t,e){return Object.hasOwnProperty.call(t,e)},o=function(t,e,n,r){return r?new Error(r):new Error("Required "+t[e]+" `"+e+"` was not specified in `"+n+"`.")};e.default=function(t,e,n){return function(t,e){if("function"!=typeof t)throw new TypeError("The typeValidator argument must be a function with the signature function(props, propName, componentName).");if(e&&"string"!=typeof e)throw new TypeError("The error message is optional, but must be a string if provided.")}(t,n),function(a,s,u){for(var c=arguments.length,l=Array(3<c?c-3:0),h=3;h<c;h++)l[h-3]=arguments[h];return r(e,a,s,u)?i(a,s)?t.apply(void 0,[a,s,u].concat(l)):o(a,s,u,n):t.apply(void 0,[a,s,u].concat(l))}}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var r="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",i="undefined"!==typeof window?window:t,o=("undefined"!==typeof t||window,"undefined"!==typeof document&&document,!1);try{var a={get passive(){return o=!0,!0}};i.addEventListener("test",a,a),i.removeEventListener("test",a,a)}catch(s){}}).call(this,n(20))},,function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}n.r(e),n.d(e,"LogLevel",(function(){return i})),n.d(e,"Logger",(function(){return u})),n.d(e,"setLogLevel",(function(){return c}));var i,o=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(i||(i={}));var a=i.INFO,s=function(t,e){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(!(e<t.logLevel)){var a=(new Date).toISOString();switch(e){case i.DEBUG:case i.VERBOSE:console.log.apply(console,r(["["+a+"]  "+t.name+":"],n));break;case i.INFO:console.info.apply(console,r(["["+a+"]  "+t.name+":"],n));break;case i.WARN:console.warn.apply(console,r(["["+a+"]  "+t.name+":"],n));break;case i.ERROR:console.error.apply(console,r(["["+a+"]  "+t.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},u=function(){function t(t){this.name=t,this._logLevel=a,this._logHandler=s,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in i))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.ERROR],t))},t}();function c(t){o.forEach((function(e){e.logLevel=t}))}},function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return(i="function"===typeof Symbol&&"symbol"===r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)})(t)}n.d(e,"a",(function(){return i}))},function(t,e,n){var r;!function(i,o,a,s){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),h="function",p=Math.round,f=Math.abs,d=Date.now;function m(t,e,n){return setTimeout(x(t,n),e)}function y(t,e,n){return!!Array.isArray(t)&&(g(t,n[e],n),!0)}function g(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==s)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function v(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!==typeof Object.assign?function(t){if(t===s||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==s&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var _=v((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===s)&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),b=v((function(t,e){return _(t,e,!0)}),"merge","Use `assign`.");function w(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&u(r,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function E(t,e){return typeof t==h?t.apply(e&&e[0]||s,e):t}function T(t,e){return t===s?e:t}function S(t,e,n){g(A(e),(function(e){t.addEventListener(e,n,!1)}))}function C(t,e,n){g(A(e),(function(e){t.removeEventListener(e,n,!1)}))}function I(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function k(t,e){return t.indexOf(e)>-1}function A(t){return t.trim().split(/\s+/g)}function O(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function P(t){return Array.prototype.slice.call(t,0)}function D(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];O(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function M(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((r=(n=c[o])?n+i:e)in t)return r;o++}return s}var R=1;function N(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var L="ontouchstart"in i,F=M(i,"PointerEvent")!==s,j=L&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),z=25,B=1,U=2,V=4,q=8,W=1,G=2,H=4,K=8,Q=16,X=G|H,Y=K|Q,Z=X|Y,J=["x","y"],$=["clientX","clientY"];function tt(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){E(t.options.enable,[t])&&n.handler(e)},this.init()}function et(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&B&&r-i===0,a=e&(V|q)&&r-i===0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=nt(e));i>1&&!n.firstMultiple?n.firstMultiple=nt(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,u=a?a.center:o.center,c=e.center=rt(r);e.timeStamp=d(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=st(u,c),e.distance=at(u,c),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};e.eventType!==B&&o.eventType!==V||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=ot(e.deltaX,e.deltaY);var l=it(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=l.x,e.overallVelocityY=l.y,e.overallVelocity=f(l.x)>f(l.y)?l.x:l.y,e.scale=a?(h=a.pointers,p=r,at(p[0],p[1],$)/at(h[0],h[1],$)):1,e.rotation=a?function(t,e){return st(e[1],e[0],$)+st(t[1],t[0],$)}(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,a=t.lastInterval||e,u=e.timeStamp-a.timeStamp;if(e.eventType!=q&&(u>z||a.velocity===s)){var c=e.deltaX-a.deltaX,l=e.deltaY-a.deltaY,h=it(u,c,l);r=h.x,i=h.y,n=f(h.x)>f(h.y)?h.x:h.y,o=ot(c,l),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var h,p;var m=t.element;I(e.srcEvent.target,m)&&(m=e.srcEvent.target);e.target=m}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function nt(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:p(t.pointers[n].clientX),clientY:p(t.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:e,center:rt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function rt(t){var e=t.length;if(1===e)return{x:p(t[0].clientX),y:p(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:p(n/e),y:p(r/e)}}function it(t,e,n){return{x:e/t||0,y:n/t||0}}function ot(t,e){return t===e?W:f(t)>=f(e)?t<0?G:H:e<0?K:Q}function at(t,e,n){n||(n=J);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function st(t,e,n){n||(n=J);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}tt.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(N(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(N(this.element),this.evWin,this.domHandler)}};var ut={mousedown:B,mousemove:U,mouseup:V},ct="mousedown",lt="mousemove mouseup";function ht(){this.evEl=ct,this.evWin=lt,this.pressed=!1,tt.apply(this,arguments)}w(ht,tt,{handler:function(t){var e=ut[t.type];e&B&&0===t.button&&(this.pressed=!0),e&U&&1!==t.which&&(e=V),this.pressed&&(e&V&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var pt={pointerdown:B,pointermove:U,pointerup:V,pointercancel:q,pointerout:q},ft={2:"touch",3:"pen",4:"mouse",5:"kinect"},dt="pointerdown",mt="pointermove pointerup pointercancel";function yt(){this.evEl=dt,this.evWin=mt,tt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(dt="MSPointerDown",mt="MSPointerMove MSPointerUp MSPointerCancel"),w(yt,tt,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=pt[r],o=ft[t.pointerType]||t.pointerType,a="touch"==o,s=O(e,t.pointerId,"pointerId");i&B&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):i&(V|q)&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var gt={touchstart:B,touchmove:U,touchend:V,touchcancel:q},vt="touchstart",_t="touchstart touchmove touchend touchcancel";function bt(){this.evTarget=vt,this.evWin=_t,this.started=!1,tt.apply(this,arguments)}function wt(t,e){var n=P(t.touches),r=P(t.changedTouches);return e&(V|q)&&(n=D(n.concat(r),"identifier",!0)),[n,r]}w(bt,tt,{handler:function(t){var e=gt[t.type];if(e===B&&(this.started=!0),this.started){var n=wt.call(this,t,e);e&(V|q)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var xt={touchstart:B,touchmove:U,touchend:V,touchcancel:q},Et="touchstart touchmove touchend touchcancel";function Tt(){this.evTarget=Et,this.targetIds={},tt.apply(this,arguments)}function St(t,e){var n=P(t.touches),r=this.targetIds;if(e&(B|U)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=P(t.changedTouches),s=[],u=this.target;if(o=n.filter((function(t){return I(t.target,u)})),e===B)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),e&(V|q)&&delete r[a[i].identifier],i++;return s.length?[D(o.concat(s),"identifier",!0),s]:void 0}w(Tt,tt,{handler:function(t){var e=xt[t.type],n=St.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}});var Ct=2500,It=25;function kt(){tt.apply(this,arguments);var t=x(this.handler,this);this.touch=new Tt(this.manager,t),this.mouse=new ht(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function At(t,e){t&B?(this.primaryTouch=e.changedPointers[0].identifier,Ot.call(this,e)):t&(V|q)&&Ot.call(this,e)}function Ot(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),Ct)}}function Pt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=It&&a<=It)return!0}return!1}w(kt,tt,{handler:function(t,e,n){var r="touch"==n.pointerType,i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)At.call(this,e,n);else if(i&&Pt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Dt=M(l.style,"touchAction"),Mt=Dt!==s,Rt="auto",Nt="manipulation",Lt="none",Ft="pan-x",jt="pan-y",zt=function(){if(!Mt)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}();function Bt(t,e){this.manager=t,this.set(e)}Bt.prototype={set:function(t){"compute"==t&&(t=this.compute()),Mt&&this.manager.element.style&&zt[t]&&(this.manager.element.style[Dt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return g(this.manager.recognizers,(function(e){E(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(k(t,Lt))return Lt;var e=k(t,Ft),n=k(t,jt);if(e&&n)return Lt;if(e||n)return e?Ft:jt;if(k(t,Nt))return Nt;return Rt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=k(r,Lt)&&!zt[Lt],o=k(r,jt)&&!zt[jt],a=k(r,Ft)&&!zt[Ft];if(i){var s=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(s&&u&&c)return}if(!a||!o)return i||o&&n&X||a&&n&Y?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Ut=1,Vt=2,qt=4,Wt=8,Gt=Wt,Ht=16;function Kt(t){this.options=u({},this.defaults,t||{}),this.id=R++,this.manager=null,this.options.enable=T(this.options.enable,!0),this.state=Ut,this.simultaneous={},this.requireFail=[]}function Qt(t){return t&Ht?"cancel":t&Wt?"end":t&qt?"move":t&Vt?"start":""}function Xt(t){return t==Q?"down":t==K?"up":t==G?"left":t==H?"right":""}function Yt(t,e){var n=e.manager;return n?n.get(t):t}function Zt(){Kt.apply(this,arguments)}function Jt(){Zt.apply(this,arguments),this.pX=null,this.pY=null}function $t(){Zt.apply(this,arguments)}function te(){Kt.apply(this,arguments),this._timer=null,this._input=null}function ee(){Zt.apply(this,arguments)}function ne(){Zt.apply(this,arguments)}function re(){Kt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ie(t,e){return(e=e||{}).recognizers=T(e.recognizers,ie.defaults.preset),new oe(t,e)}Kt.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(y(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Yt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return y(t,"dropRecognizeWith",this)?this:(t=Yt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(y(t,"requireFailure",this))return this;var e=this.requireFail;return-1===O(e,t=Yt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(y(t,"dropRequireFailure",this))return this;t=Yt(t,this);var e=O(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<Wt&&r(e.options.event+Qt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=Wt&&r(e.options.event+Qt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|Ut)))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!E(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(Gt|Ht|32)&&(this.state=Ut),this.state=this.process(e),this.state&(Vt|qt|Wt|Ht)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},w(Zt,Kt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(Vt|qt),i=this.attrTest(t);return r&&(n&q||!i)?e|Ht:r||i?n&V?e|Wt:e&Vt?e|qt:Vt:32}}),w(Jt,Zt,{defaults:{event:"pan",threshold:10,pointers:1,direction:Z},getTouchAction:function(){var t=this.options.direction,e=[];return t&X&&e.push(jt),t&Y&&e.push(Ft),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(e.direction&X?(i=0===o?W:o<0?G:H,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?W:a<0?K:Q,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Zt.prototype.attrTest.call(this,t)&&(this.state&Vt||!(this.state&Vt)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Xt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),w($t,Zt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Lt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Vt)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),w(te,Kt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Rt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(V|q)&&!i)this.reset();else if(t.eventType&B)this.reset(),this._timer=m((function(){this.state=Gt,this.tryEmit()}),e.time,this);else if(t.eventType&V)return Gt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Gt&&(t&&t.eventType&V?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),w(ee,Zt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Lt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Vt)}}),w(ne,Zt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:X|Y,pointers:1},getTouchAction:function(){return Jt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(X|Y)?e=t.overallVelocity:n&X?e=t.overallVelocityX:n&Y&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&f(e)>this.options.velocity&&t.eventType&V},emit:function(t){var e=Xt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),w(re,Kt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Nt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),t.eventType&B&&0===this.count)return this.failTimeout();if(r&&i&&n){if(t.eventType!=V)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||at(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=m((function(){this.state=Gt,this.tryEmit()}),e.interval,this),Vt):Gt}return 32},failTimeout:function(){return this._timer=m((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Gt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ie.VERSION="2.0.7",ie.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[ee,{enable:!1}],[$t,{enable:!1},["rotate"]],[ne,{direction:X}],[Jt,{direction:X},["swipe"]],[re],[re,{event:"doubletap",taps:2},["tap"]],[te]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function oe(t,e){this.options=u({},ie.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=function(t){var e=t.options.inputClass;return new(e||(F?yt:j?Tt:L?kt:ht))(t,et)}(this),this.touchAction=new Bt(this,this.options.touchAction),ae(this,!0),g(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function ae(t,e){var n,r=t.element;r.style&&(g(t.options.cssProps,(function(i,o){n=M(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}oe.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&Gt)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&n.state&(Vt|qt|Wt)&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Kt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(y(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(y(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=O(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==s&&e!==s){var n=this.handlers;return g(A(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==s){var n=this.handlers;return g(A(t),(function(t){e?n[t]&&n[t].splice(O(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&ae(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(ie,{INPUT_START:B,INPUT_MOVE:U,INPUT_END:V,INPUT_CANCEL:q,STATE_POSSIBLE:Ut,STATE_BEGAN:Vt,STATE_CHANGED:qt,STATE_ENDED:Wt,STATE_RECOGNIZED:Gt,STATE_CANCELLED:Ht,STATE_FAILED:32,DIRECTION_NONE:W,DIRECTION_LEFT:G,DIRECTION_RIGHT:H,DIRECTION_UP:K,DIRECTION_DOWN:Q,DIRECTION_HORIZONTAL:X,DIRECTION_VERTICAL:Y,DIRECTION_ALL:Z,Manager:oe,Input:tt,TouchAction:Bt,TouchInput:Tt,MouseInput:ht,PointerEventInput:yt,TouchMouseInput:kt,SingleTouchInput:bt,Recognizer:Kt,AttrRecognizer:Zt,Tap:re,Pan:Jt,Swipe:ne,Pinch:$t,Rotate:ee,Press:te,on:S,off:C,each:g,merge:b,extend:_,assign:u,inherit:w,bindFn:x,prefixed:M}),("undefined"!==typeof i?i:"undefined"!==typeof self?self:{}).Hammer=ie,(r=function(){return ie}.call(e,n,e,t))===s||(t.exports=r)}(window,document)},function(t,e,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(t,e){for(var n,s,u=a(t),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))i.call(n,l)&&(u[l]=n[l]);if(r){s=r(n);for(var h=0;h<s.length;h++)o.call(n,s[h])&&(u[s[h]]=n[s[h]])}}return u}},function(t,e,n){"use strict";n.r(e),n.d(e,"registerInstallations",(function(){return Z}));var r,i=n(7),o=n.n(i),a=n(12),s=n(2),u=n(13),c=n(36),l="@firebase/installations",h="0.3.8",p=1e4,f="w:"+h,d="FIS_v2",m="https://firebaseinstallations.googleapis.com/v1",y=36e5,g=((r={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',r["not-registered"]="Firebase Installation is not registered.",r["installation-not-found"]="Firebase Installation not found.",r["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',r["app-offline"]="Could not process request. Application offline.",r["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",r),v=new u.ErrorFactory("installations","Installations",g);function _(t){return t instanceof u.FirebaseError&&t.code.includes("request-failed")}function b(t){var e=t.projectId;return m+"/projects/"+e+"/installations"}function w(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function x(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,v.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function E(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function T(t,e){var n=e.refreshToken,r=E(t);return r.append("Authorization",function(t){return d+" "+t}(n)),r}function S(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function C(t,e){var n=e.fid;return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,r,i,o,a,u;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return e=b(t),r=E(t),i={fid:n,authVersion:d,appId:t.appId,sdkVersion:f},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,S((function(){return fetch(e,o)}))];case 1:return(a=s.sent()).ok?[4,a.json()]:[3,3];case 2:return u=s.sent(),[2,{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:w(u.authToken)}];case 3:return[4,x("Create Installation",a)];case 4:throw s.sent()}}))}))}function I(t){return new Promise((function(e){setTimeout(e,t)}))}var k=/^[cdef][\w-]{21}$/,A="";function O(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,Object(s.__spread)(e))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return k.test(e)?e:A}catch(r){return A}}var P="firebase-installations-database",D=1,M="firebase-installations-store",R=null;function N(){return R||(R=Object(c.openDb)(P,D,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(M)}}))),R}function L(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return n=z(t),[4,N()];case 1:return r=o.sent(),[4,(i=r.transaction(M,"readwrite")).objectStore(M).put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function F(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return e=z(t),[4,N()];case 1:return n=i.sent(),[4,(r=n.transaction(M,"readwrite")).objectStore(M).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function j(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,u;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return n=z(t),[4,N()];case 1:return r=s.sent(),i=r.transaction(M,"readwrite"),[4,(o=i.objectStore(M)).get(n)];case 2:return a=s.sent(),void 0!==(u=e(a))?[3,4]:[4,o.delete(n)];case 3:return s.sent(),[3,6];case 4:return[4,o.put(u,n)];case 5:s.sent(),s.label=6;case 6:return[4,i.complete];case 7:return s.sent(),[2,u]}}))}))}function z(t){return t.appName+"!"+t.appId}function B(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return[4,j(t,(function(n){var r=function(t){return q(t||{fid:O(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine){var n=Promise.reject(v.create("app-offline"));return{installationEntry:e,registrationPromise:n}}var r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=function(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,C(t,e)];case 1:return n=i.sent(),[2,L(t,n)];case 2:return _(r=i.sent())&&409===r.serverCode?[4,F(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,L(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,r);return{installationEntry:r,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:U(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return(n=i.sent()).fid!==A?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function U(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return[4,V(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,I(100)];case 3:return o.sent(),[4,V(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,B(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function V(t){return j(t,(function(t){if(!t)throw v.create("installation-not-found");return q(t)}))}function q(t){return 1===(e=t).registrationStatus&&e.registrationTime+p<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function W(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,i,o,a,u,c,l;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return t=function(t,e){var n=e.fid;return b(t)+"/"+n+"/authTokens:generate"}(n,e),i=T(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),a={installation:{sdkVersion:f}},u={method:"POST",headers:i,body:JSON.stringify(a)},[4,S((function(){return fetch(t,u)}))];case 1:return(c=s.sent()).ok?[4,c.json()]:[3,3];case 2:return l=s.sent(),[2,w(l)];case 3:return[4,x("Generate Auth Token",c)];case 4:throw s.sent()}}))}))}function G(t,e){return void 0===e&&(e=!1),Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return[4,j(t.appConfig,(function(r){if(!K(r))throw v.create("not-registered");var i=r.authToken;if(!e&&function(t){return 2===t.requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+y}(t)}(i))return r;if(1===i.requestStatus)return n=function(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return[4,H(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,I(100)];case 3:return i.sent(),[4,H(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,G(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw v.create("app-offline");var o=function(t){var e={requestStatus:1,requestTime:Date.now()};return Object(s.__assign)(Object(s.__assign)({},t),{authToken:e})}(r);return n=function(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,W(t,e)];case 1:return n=o.sent(),i=Object(s.__assign)(Object(s.__assign)({},e),{authToken:n}),[4,L(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!_(r=o.sent())||401!==r.serverCode&&404!==r.serverCode?[3,5]:[4,F(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=Object(s.__assign)(Object(s.__assign)({},e),{authToken:{requestStatus:0}}),[4,L(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,o),o}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function H(t){return j(t,(function(t){if(!K(t))throw v.create("not-registered");var e,n=t.authToken;return 1===(e=n).requestStatus&&e.requestTime+p<Date.now()?Object(s.__assign)(Object(s.__assign)({},t),{authToken:{requestStatus:0}}):t}))}function K(t){return void 0!==t&&2===t.registrationStatus}function Q(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,B(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function X(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return n=function(t,e){var n=e.fid;return b(t)+"/"+n}(t,e),r=T(t,e),i={method:"DELETE",headers:r},[4,S((function(){return fetch(n,i)}))];case 1:return(o=a.sent()).ok?[3,3]:[4,x("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}function Y(t){return v.create("missing-app-config-values",{valueName:t})}function Z(t){t.INTERNAL.registerComponent(new a.Component("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw Y("App Configuration");if(!t.name)throw Y("App Name");try{for(var r=Object(s.__values)(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw Y(o)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return[4,B(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):G(t).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,Q(t.appConfig)];case 1:return n.sent(),[4,G(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return[4,j(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw v.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw v.create("app-offline");case 3:return[4,X(e,n)];case 4:return r.sent(),[4,F(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)}}}),"PUBLIC")),t.registerVersion(l,h)}Z(o.a)},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return p}));var r=n(6),i=n(5),o=n(3),a=n(1),s=n.n(a),u=n(14);var c={container:s.a.object,gl:s.a.object,mapboxApiAccessToken:s.a.string,mapboxApiUrl:s.a.string,attributionControl:s.a.bool,preserveDrawingBuffer:s.a.bool,reuseMaps:s.a.bool,transformRequest:s.a.func,mapOptions:s.a.object,mapStyle:s.a.oneOfType([s.a.string,s.a.object]),visible:s.a.bool,asyncRender:s.a.bool,onLoad:s.a.func,onError:s.a.func,width:s.a.number,height:s.a.number,viewState:s.a.object,longitude:s.a.number,latitude:s.a.number,zoom:s.a.number,bearing:s.a.number,pitch:s.a.number,altitude:s.a.number},l={container:u.a.body,mapboxApiAccessToken:function(){var e=null;if("undefined"!==typeof window&&window.location){var n=window.location.search.match(/access_token=([^&\/]*)/);e=n&&n[1]}e||"undefined"===typeof t||(e=e||Object({NODE_ENV:"production",PUBLIC_URL:""}).MapboxAccessToken||Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_MAPBOX_ACCESS_TOKEN);return e||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",visible:!0,asyncRender:!1,onLoad:function(){},onError:function(t){t&&console.error(t.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0};function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";t.debug&&s.a.checkPropTypes(c,t,"prop",e)}var p=function(){function t(e){var n=this;if(Object(r.a)(this,t),Object(o.a)(this,"mapboxgl",void 0),Object(o.a)(this,"props",l),Object(o.a)(this,"_map",null),Object(o.a)(this,"width",0),Object(o.a)(this,"height",0),Object(o.a)(this,"_fireLoadEvent",(function(){n.props.onLoad({type:"load",target:n._map})})),!e.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=e.mapboxgl,t.initialized||(t.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(e)}return Object(i.a)(t,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(t){return this._update(this.props,t),this}},{key:"resize",value:function(){return this._map.resize(),this}},{key:"redraw",value:function(){var t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(e){this._map=t.savedMap;var n=this._map.getContainer(),r=e.container;for(r.classList.add("mapboxgl-map");n.childNodes.length>0;)r.appendChild(n.childNodes[0]);this._map._container=r,t.savedMap=null,e.mapStyle&&this._map.setStyle(e.mapStyle,{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(e){if(e.reuseMaps&&t.savedMap)this._reuse(e);else{if(e.gl){var n=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=n,e.gl}}var r={container:e.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:e.mapStyle,interactive:!1,trackResize:!1,attributionControl:e.attributionControl,preserveDrawingBuffer:e.preserveDrawingBuffer};e.transformRequest&&(r.transformRequest=e.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},r,e.mapOptions)),this._map.once("load",e.onLoad),this._map.on("error",e.onError)}return this}},{key:"_destroy",value:function(){this._map&&(t.savedMap?this._map.remove():(t.savedMap=this._map,this._map.off("load",this.props.onLoad),this._map.off("error",this.props.onError),this._map.off("styledata",this._fireLoadEvent)),this._map=null)}},{key:"_initialize",value:function(t){var e=this;h(t=Object.assign({},l,t),"Mapbox"),this.mapboxgl.accessToken=t.mapboxApiAccessToken||l.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=t.mapboxApiUrl,this._create(t);var n=t.container;Object.defineProperty(n,"offsetWidth",{get:function(){return e.width}}),Object.defineProperty(n,"clientWidth",{get:function(){return e.width}}),Object.defineProperty(n,"offsetHeight",{get:function(){return e.height}}),Object.defineProperty(n,"clientHeight",{get:function(){return e.height}});var r=this._map.getCanvas();r&&(r.style.outline="none"),this._updateMapViewport({},t),this._updateMapSize({},t),this.props=t}},{key:"_update",value:function(t,e){if(this._map){h(e=Object.assign({},this.props,e),"Mapbox");var n=this._updateMapViewport(t,e),r=this._updateMapSize(t,e);e.asyncRender||!n&&!r||this.redraw(),this.props=e}}},{key:"_updateMapSize",value:function(t,e){var n=t.width!==e.width||t.height!==e.height;return n&&(this.width=e.width,this.height=e.height,this.resize()),n}},{key:"_updateMapViewport",value:function(t,e){var n=this._getViewState(t),r=this._getViewState(e),i=r.latitude!==n.latitude||r.longitude!==n.longitude||r.zoom!==n.zoom||r.pitch!==n.pitch||r.bearing!==n.bearing||r.altitude!==n.altitude;return i&&(this._map.jumpTo(this._viewStateToMapboxProps(r)),r.altitude!==n.altitude&&(this._map.transform.altitude=r.altitude)),i}},{key:"_getViewState",value:function(t){var e=t.viewState||t,n=e.longitude,r=e.latitude,i=e.zoom,o=e.pitch,a=void 0===o?0:o,s=e.bearing,u=void 0===s?0:s,c=e.altitude;return{longitude:n,latitude:r,zoom:i,pitch:a,bearing:u,altitude:void 0===c?1.5:c}}},{key:"_checkStyleSheet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if("undefined"!==typeof u.a)try{var e=u.a.createElement("div");e.className="mapboxgl-map",e.style.display="none",u.a.body.append(e);var n="static"!==window.getComputedStyle(e).position;if(!n){var r=u.a.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(t,"/mapbox-gl.css")),u.a.head.append(r)}}catch(i){}}},{key:"_viewStateToMapboxProps",value:function(t){return{center:[t.longitude,t.latitude],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}}}]),t}();Object(o.a)(p,"initialized",!1),Object(o.a)(p,"propTypes",c),Object(o.a)(p,"defaultProps",l),Object(o.a)(p,"savedMap",null)}).call(this,n(30))},function(t,e,n){"use strict";var r={};n.r(r),n.d(r,"initialize",(function(){return V})),n.d(r,"ga",(function(){return q})),n.d(r,"set",(function(){return W})),n.d(r,"send",(function(){return G})),n.d(r,"pageview",(function(){return H})),n.d(r,"modalview",(function(){return K})),n.d(r,"timing",(function(){return Q})),n.d(r,"event",(function(){return X})),n.d(r,"exception",(function(){return Y})),n.d(r,"plugin",(function(){return Z})),n.d(r,"outboundLink",(function(){return J})),n.d(r,"testModeAPI",(function(){return $})),n.d(r,"default",(function(){return tt}));var i=n(0),o=n.n(i),a=n(1),s=n.n(a);function u(t){console.warn("[react-ga]",t)}function c(t){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g="_blank",v=1,_=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return n=function(t,e){return!e||"object"!==c(e)&&"function"!==typeof e?d(t):e}(this,(t=f(e)).call.apply(t,[this].concat(i))),y(d(n),"handleClick",(function(t){var r=n.props,i=r.target,o=r.eventLabel,a=r.to,s=r.onClick,u=r.trackerNames,c={label:o},l=i!==g,h=!(t.ctrlKey||t.shiftKey||t.metaKey||t.button===v);l&&h?(t.preventDefault(),e.trackLink(c,(function(){window.location.href=a}),u)):e.trackLink(c,(function(){}),u),s&&s(t)})),n}var n,r,i;return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(e,t),n=e,(r=[{key:"render",value:function(){var t=this.props,e=t.to,n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(n,!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},h(t,["to"]),{href:e,onClick:this.handleClick});return this.props.target===g&&(n.rel="noopener noreferrer"),delete n.eventLabel,delete n.trackerNames,o.a.createElement("a",n)}}])&&p(n.prototype,r),i&&p(n,i),e}(i.Component);function b(t){return t.replace(/^\s+|\s+$/g,"")}y(_,"trackLink",(function(){u("ga tracking not enabled")})),y(_,"propTypes",{eventLabel:s.a.string.isRequired,target:s.a.string,to:s.a.string,onClick:s.a.func,trackerNames:s.a.arrayOf(s.a.string)}),y(_,"defaultProps",{target:null,to:null,onClick:null,trackerNames:null});var w=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;var x="REDACTED (Potential Email Address)";function E(t,e){return function(t){return"string"===typeof t&&-1!==t.indexOf("@")}(t)?(u("This arg looks like an email address, redacting."),x):e?b(t).replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,(function(t,e,n){return e>0&&e+t.length!==n.length&&t.search(w)>-1&&":"!==n.charAt(e-2)&&("-"!==n.charAt(e+t.length)||"-"===n.charAt(e-1))&&n.charAt(e-1).search(/[^\s-]/)<0?t.toLowerCase():t.substr(1).search(/[A-Z]|\../)>-1?t:t.charAt(0).toUpperCase()+t.substr(1)})):t}var T=function(t){var e,n,r,i,o,a,s,u="https://www.google-analytics.com/analytics.js";t&&t.gaAddress?u=t.gaAddress:t&&t.debug&&(u="https://www.google-analytics.com/analytics_debug.js"),e=window,n=document,r="script",i=u,o="ga",e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,a=n.createElement(r),s=n.getElementsByTagName(r)[0],a.async=1,a.src=i,s.parentNode.insertBefore(a,s)};function S(t){console.info("[react-ga]",t)}var C=[],I={calls:C,ga:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];C.push([].concat(e))},resetCalls:function(){C.length=0}};function k(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P(t){return(P="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var M="undefined"===typeof window||"undefined"===typeof document,R=!1,N=!0,L=!1,F=!0,j=function(){var t;return L?I.ga.apply(I,arguments):!M&&(window.ga?(t=window).ga.apply(t,arguments):u("ReactGA.initialize must be called first or GoogleAnalytics should be loaded manually"))};function z(t){return E(t,N)}function B(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n[0];if("function"===typeof j){if("string"!==typeof i)return void u("ga command must be a string");!F&&Array.isArray(t)||j.apply(void 0,n),Array.isArray(t)&&t.forEach((function(t){j.apply(void 0,D(["".concat(t,".").concat(i)].concat(n.slice(1))))}))}}function U(t,e){t?e&&(e.debug&&!0===e.debug&&(R=!0),!1===e.titleCase&&(N=!1),e.useExistingGa)||(e&&e.gaOptions?j("create",t,e.gaOptions):j("create",t,"auto")):u("gaTrackingID is required in initialize()")}function V(t,e){if(e&&!0===e.testMode)L=!0;else{if(M)return!1;e&&!0===e.standardImplementation||T(e)}return F=!e||"boolean"!==typeof e.alwaysSendToDefaultTracker||e.alwaysSendToDefaultTracker,Array.isArray(t)?t.forEach((function(t){"object"===P(t)?U(t.trackingId,t):u("All configs must be an object")})):U(t,e),!0}function q(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length>0&&(j.apply(void 0,e),R&&(S("called ga('arguments');"),S("with arguments: ".concat(JSON.stringify(e))))),window.ga}function W(t,e){t?"object"===P(t)?(0===Object.keys(t).length&&u("empty `fieldsObject` given to .set()"),B(e,"set",t),R&&(S("called ga('set', fieldsObject);"),S("with fieldsObject: ".concat(JSON.stringify(t))))):u("Expected `fieldsObject` arg to be an Object"):u("`fieldsObject` is required in .set()")}function G(t,e){B(e,"send",t),R&&(S("called ga('send', fieldObject);"),S("with fieldObject: ".concat(JSON.stringify(t))),S("with trackers: ".concat(JSON.stringify(e))))}function H(t,e,n){if(t){var r=b(t);if(""!==r){var i={};if(n&&(i.title=n),B(e,"send",function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(n,!0).forEach((function(e){O(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({hitType:"pageview",page:r},i)),R){S("called ga('send', 'pageview', path);");var o="";n&&(o=" and title: ".concat(n)),S("with path: ".concat(r).concat(o))}}else u("path cannot be an empty string in .pageview()")}else u("path is required in .pageview()")}function K(t,e){if(t){var n,r="/"===(n=b(t)).substring(0,1)?n.substring(1):n;if(""!==r){var i="/modal/".concat(r);B(e,"send","pageview",i),R&&(S("called ga('send', 'pageview', path);"),S("with path: ".concat(i)))}else u("modalName cannot be an empty string or a single / in .modalview()")}else u("modalName is required in .modalview(modalName)")}function Q(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.category,n=t.variable,r=t.value,i=t.label,o=arguments.length>1?arguments[1]:void 0;if(e&&n&&r&&"number"===typeof r){var a={hitType:"timing",timingCategory:z(e),timingVar:z(n),timingValue:r};i&&(a.timingLabel=z(i)),G(a,o)}else u("args.category, args.variable AND args.value are required in timing() AND args.value has to be a number")}function X(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.category,n=t.action,r=t.label,i=t.value,o=t.nonInteraction,a=t.transport,s=k(t,["category","action","label","value","nonInteraction","transport"]),c=arguments.length>1?arguments[1]:void 0;if(e&&n){var l={hitType:"event",eventCategory:z(e),eventAction:z(n)};r&&(l.eventLabel=z(r)),"undefined"!==typeof i&&("number"!==typeof i?u("Expected `args.value` arg to be a Number."):l.eventValue=i),"undefined"!==typeof o&&("boolean"!==typeof o?u("`args.nonInteraction` must be a boolean."):l.nonInteraction=o),"undefined"!==typeof a&&("string"!==typeof a?u("`args.transport` must be a string."):(-1===["beacon","xhr","image"].indexOf(a)&&u("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),l.transport=a)),Object.keys(s).filter((function(t){return"dimension"===t.substr(0,"dimension".length)})).forEach((function(t){l[t]=s[t]})),Object.keys(s).filter((function(t){return"metric"===t.substr(0,"metric".length)})).forEach((function(t){l[t]=s[t]})),G(l,c)}else u("args.category AND args.action are required in event()")}function Y(t,e){var n=t.description,r=t.fatal,i={hitType:"exception"};n&&(i.exDescription=z(n)),"undefined"!==typeof r&&("boolean"!==typeof r?u("`args.fatal` must be a boolean."):i.exFatal=r),G(i,e)}var Z={require:function(t,e,n){if(t){var r=b(t);if(""!==r){var i=n?"".concat(n,".require"):"require";if(e){if("object"!==P(e))return void u("Expected `options` arg to be an Object");0===Object.keys(e).length&&u("Empty `options` given to .require()"),q(i,r,e),R&&S("called ga('require', '".concat(r,"', ").concat(JSON.stringify(e)))}else q(i,r),R&&S("called ga('require', '".concat(r,"');"))}else u("`name` cannot be an empty string in .require()")}else u("`name` is required in .require()")},execute:function(t,e){var n,r;if(1===(arguments.length<=2?0:arguments.length-2)?n=arguments.length<=2?void 0:arguments[2]:(r=arguments.length<=2?void 0:arguments[2],n=arguments.length<=3?void 0:arguments[3]),"string"!==typeof t)u("Expected `pluginName` arg to be a String.");else if("string"!==typeof e)u("Expected `action` arg to be a String.");else{var i="".concat(t,":").concat(e);n=n||null,r&&n?(q(i,r,n),R&&(S("called ga('".concat(i,"');")),S('actionType: "'.concat(r,'" with payload: ').concat(JSON.stringify(n))))):n?(q(i,n),R&&(S("called ga('".concat(i,"');")),S("with payload: ".concat(JSON.stringify(n))))):(q(i),R&&S("called ga('".concat(i,"');")))}}};function J(t,e,n){if("function"===typeof e)if(t&&t.label){var r={hitType:"event",eventCategory:"Outbound",eventAction:"Click",eventLabel:z(t.label)},i=!1,o=setTimeout((function(){i=!0,e()}),250);r.hitCallback=function(){clearTimeout(o),i||e()},G(r,n)}else u("args.label is required in outboundLink()");else u("hitCallback function is required")}var $=I,tt={initialize:V,ga:q,set:W,send:G,pageview:H,modalview:K,timing:Q,event:X,exception:Y,plugin:Z,outboundLink:J,testModeAPI:I};function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function nt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}_.origTrackLink=_.trackLink,_.trackLink=J;var rt=_;e.a=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(n,!0).forEach((function(e){nt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r,{OutboundLink:rt})},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"===typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],l=!1,h=-1;function p(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&f())}function f(){if(!l){var t=s(p);l=!0;for(var e=c.length;e;){for(u=c,c=[];++h<e;)u&&u[h].run();h=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||l||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";var r,i=(r=n(7))&&"object"===typeof r&&"default"in r?r.default:r;n(52),n(53),n(54),n(56),n(57),n(58),n(59),n(60),n(61);i.registerVersion("firebase","7.6.1","app");console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport * as firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),i.registerVersion("firebase","7.6.1"),t.exports=i},function(t,e,n){"use strict";function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var i=n(6),o=n(9),a=n(8),s=n(4),u=n(5),c=n(10),l=n(3),h=n(0),p=n.n(h),f=n(1),d=n.n(f);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(n,!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var g=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function v(t){if(!t)return null;if("string"===typeof t)return t;t.toJS&&(t=t.toJS());var e={},n=!0,r=!1,i=void 0;try{for(var o,a=t.layers[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e[s.id]=s}}catch(c){r=!0,i=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}var u=t.layers.map((function(t){var n=e[t.ref],r=null;if("interactive"in t&&delete(r=y({},t)).interactive,n){delete(r=r||y({},t)).ref;var i=!0,o=!1,a=void 0;try{for(var s,u=g[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;l in n&&(r[l]=n[l])}}catch(c){o=!0,a=c}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}return r||t}));return y({},t,{layers:u})}var _=n(11),b=1e-6,w="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});!function(){var t=function(){var t=new w(4);return w!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();function x(t,e){var n,r,i,o=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}([],e,t);return n=o,r=o,i=1/o[3],n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=r[3]*i,o}function E(t,e){var n=t%e;return n<0?e+n:n}function T(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],p=e[9],f=e[10],d=e[11],m=e[12],y=e[13],g=e[14],v=e[15],_=n[0],b=n[1],w=n[2],x=n[3];return t[0]=_*r+b*s+w*h+x*m,t[1]=_*i+b*u+w*p+x*y,t[2]=_*o+b*c+w*f+x*g,t[3]=_*a+b*l+w*d+x*v,_=n[4],b=n[5],w=n[6],x=n[7],t[4]=_*r+b*s+w*h+x*m,t[5]=_*i+b*u+w*p+x*y,t[6]=_*o+b*c+w*f+x*g,t[7]=_*a+b*l+w*d+x*v,_=n[8],b=n[9],w=n[10],x=n[11],t[8]=_*r+b*s+w*h+x*m,t[9]=_*i+b*u+w*p+x*y,t[10]=_*o+b*c+w*f+x*g,t[11]=_*a+b*l+w*d+x*v,_=n[12],b=n[13],w=n[14],x=n[15],t[12]=_*r+b*s+w*h+x*m,t[13]=_*i+b*u+w*p+x*y,t[14]=_*o+b*c+w*f+x*g,t[15]=_*a+b*l+w*d+x*v,t}function S(t,e,n){var r,i,o,a,s,u,c,l,h,p,f,d,m=n[0],y=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*y+e[8]*g+e[12],t[13]=e[1]*m+e[5]*y+e[9]*g+e[13],t[14]=e[2]*m+e[6]*y+e[10]*g+e[14],t[15]=e[3]*m+e[7]*y+e[11]*g+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],p=e[9],f=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=p,t[10]=f,t[11]=d,t[12]=r*m+s*y+h*g+e[12],t[13]=i*m+u*y+p*g+e[13],t[14]=o*m+c*y+f*g+e[14],t[15]=a*m+l*y+d*g+e[15]),t}function C(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function I(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=t[9],p=t[10],f=t[11],d=t[12],m=t[13],y=t[14],g=t[15],v=e[0],_=e[1],w=e[2],x=e[3],E=e[4],T=e[5],S=e[6],C=e[7],I=e[8],k=e[9],A=e[10],O=e[11],P=e[12],D=e[13],M=e[14],R=e[15];return Math.abs(n-v)<=b*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-_)<=b*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-w)<=b*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(o-x)<=b*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-E)<=b*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(s-T)<=b*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(u-S)<=b*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-C)<=b*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(l-I)<=b*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(h-k)<=b*Math.max(1,Math.abs(h),Math.abs(k))&&Math.abs(p-A)<=b*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(f-O)<=b*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(d-P)<=b*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(m-D)<=b*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(y-M)<=b*Math.max(1,Math.abs(y),Math.abs(M))&&Math.abs(g-R)<=b*Math.max(1,Math.abs(g),Math.abs(R))}function k(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function A(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function O(t){var e=t[0],n=t[1];return Math.hypot(e,n)}var P=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t};!function(){var t=function(){var t=new w(2);return w!=Float32Array&&(t[0]=0,t[1]=0),t}()}();!function(){var t=function(){var t=new w(3);return w!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();function D(t,e){if(!t)throw new Error(e||"viewport-mercator-project: assertion failed.")}var M=Math.PI,R=M/4,N=M/180,L=180/M,F=512,j=4003e4,z=1.5;function B(t){return Math.pow(2,t)}function U(t){return Math.log2(t)}function V(t,e){var n=Object(_.a)(t,2),r=n[0],i=n[1];D(Number.isFinite(r)&&Number.isFinite(e)),D(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude");var o=i*N;return[(e*=F)*(r*N+M)/(2*M),e*(M-Math.log(Math.tan(R+.5*o)))/(2*M)]}function q(t,e){var n=Object(_.a)(t,2),r=n[0],i=n[1],o=r/(e*=F)*(2*M)-M,a=2*(Math.atan(Math.exp(M-i/e*(2*M)))-R);return[o*L,a*L]}function W(t){var e=t.latitude,n=t.longitude,r=t.zoom,i=t.scale,o=t.highPrecision,a=void 0!==o&&o;i=void 0!==i?i:B(r),D(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(i));var s={},u=F*i,c=Math.cos(e*N),l=u/360,h=l/c,p=u/j/c;if(s.pixelsPerMeter=[p,-p,p],s.metersPerPixel=[1/p,-1/p,1/p],s.pixelsPerDegree=[l,-h,p],s.degreesPerPixel=[1/l,-1/h,1/p],a){var f=N*Math.tan(e*N)/c,d=l*f/2,m=u/j*f,y=m/h*p;s.pixelsPerDegree2=[0,-d,m],s.pixelsPerMeter2=[y,0,y]}return s}function G(t){var e,n,r=t.height,i=t.pitch,o=t.bearing,a=t.altitude,s=t.center,u=void 0===s?null:s,c=t.flipY,l=void 0!==c&&c,h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return S(h,h,[0,0,-a]),C(h,h,[1,1,1/r]),function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],p=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+h*r,t[7]=u*i+p*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=h*i-s*r,t[11]=p*i-u*r}(h,h,-i*N),function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],h=e[6],p=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+h*r,t[3]=u*i+p*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=h*i-s*r,t[7]=p*i-u*r}(h,h,o*N),l&&C(h,h,[1,-1,1]),u&&S(h,h,((e=[])[0]=-(n=u)[0],e[1]=-n[1],e[2]=-n[2],e)),h}function H(t){var e=t.width,n=t.height,r=t.pitch,i=function(t){var e=t.width,n=t.height,r=t.altitude,i=void 0===r?z:r,o=t.pitch,a=void 0===o?0:o,s=t.nearZMultiplier,u=void 0===s?1:s,c=t.farZMultiplier,l=void 0===c?1:c,h=a*N,p=Math.atan(.5/i),f=Math.sin(p)*i/Math.sin(Math.PI/2-h-p),d=Math.cos(Math.PI/2-h)*f+i;return{fov:2*Math.atan(n/2/i),aspect:e/n,focalDistance:i,near:u,far:d*l}}({width:e,height:n,altitude:t.altitude,pitch:r,nearZMultiplier:t.nearZMultiplier,farZMultiplier:t.farZMultiplier});return function(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}([],i.fov,i.aspect,i.near,i.far)}function K(t,e){var n=Object(_.a)(t,3),r=n[0],i=n[1],o=n[2],a=void 0===o?0:o;return D(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(a)),x(e,[r,i,a,1])}function Q(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Object(_.a)(t,3),i=r[0],o=r[1],a=r[2];if(D(Number.isFinite(i)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(a))return x(e,[i,o,a,1]);var s=x(e,[i,o,0,1]),u=x(e,[i,o,1,1]),c=s[2],l=u[2];return function(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}([],s,u,c===l?0:((n||0)-c)/(l-c))}var X=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function Y(t){var e=t.width,n=t.height,r=t.bounds,i=t.minExtent,o=void 0===i?0:i,a=t.maxZoom,s=void 0===a?24:a,u=t.padding,c=void 0===u?0:u,l=t.offset,h=void 0===l?[0,0]:l,p=Object(_.a)(r,2),f=Object(_.a)(p[0],2),d=f[0],m=f[1],y=Object(_.a)(p[1],2),g=y[0],v=y[1];if(Number.isFinite(c)){c={top:c,bottom:c,left:c,right:c}}else D(Number.isFinite(c.top)&&Number.isFinite(c.bottom)&&Number.isFinite(c.left)&&Number.isFinite(c.right));var b=new Z({width:e,height:n,longitude:0,latitude:0,zoom:0}),w=b.project([d,v]),x=b.project([g,m]),E=[Math.max(Math.abs(x[0]-w[0]),o),Math.max(Math.abs(x[1]-w[1]),o)],T=[e-c.left-c.right-2*Math.abs(h[0]),n-c.top-c.bottom-2*Math.abs(h[1])];D(T[0]>0&&T[1]>0);var S=T[0]/E[0],C=T[1]/E[1],I=(c.right-c.left)/2/S,k=(c.bottom-c.top)/2/C,A=[(x[0]+w[0])/2+I,(x[1]+w[1])/2+k],O=b.unproject(A),P=b.zoom+Math.log2(Math.abs(Math.min(S,C)));return{longitude:O[0],latitude:O[1],zoom:Math.min(P,s)}}var Z=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width,u=n.height,c=n.latitude,l=void 0===c?0:c,h=n.longitude,p=void 0===h?0:h,f=n.zoom,d=void 0===f?0:f,m=n.pitch,y=void 0===m?0:m,g=n.bearing,v=void 0===g?0:g,_=n.altitude,b=void 0===_?1.5:_,w=n.nearZMultiplier,x=n.farZMultiplier;Object(i.a)(this,e),r=r||1,u=u||1;var E=B(d);b=Math.max(.75,b);var T=V([p,l],E);T[2]=0;var S=H({width:r,height:u,pitch:y,bearing:v,altitude:b,nearZMultiplier:w||1/u,farZMultiplier:x||1.01}),C=G({height:u,center:T,pitch:y,bearing:v,altitude:b,flipY:!0});return(t=Object(o.a)(this,Object(a.a)(e).call(this,{width:r,height:u,viewMatrix:C,projectionMatrix:S}))).latitude=l,t.longitude=p,t.zoom=d,t.pitch=y,t.bearing=v,t.altitude=b,t.scale=E,t.center=T,t.pixelsPerMeter=W(Object(s.a)(Object(s.a)(t))).pixelsPerMeter[2],Object.freeze(Object(s.a)(Object(s.a)(t))),t}return Object(c.a)(e,t),Object(u.a)(e,[{key:"projectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return V(t,e)}},{key:"unprojectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return q(t,e)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e,n,r=t.lngLat,i=Q(t.pos,this.pixelUnprojectionMatrix),o=k([],V(r,this.scale),((e=[])[0]=-(n=i)[0],e[1]=-n[1],e));return q(k([],this.center,o),this.scale)}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=Y(Object.assign({width:r,height:i,bounds:t},n)),a=o.longitude,s=o.latitude,u=o.zoom;return new e({width:r,height:i,longitude:a,latitude:s,zoom:u})}}]),e}(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,r=e.height,o=e.viewMatrix,a=void 0===o?X:o,s=e.projectionMatrix,u=void 0===s?X:s;Object(i.a)(this,t),this.width=n||1,this.height=r||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=u;var c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];T(c,c,this.projectionMatrix),T(c,c,this.viewMatrix),this.viewProjectionMatrix=c;var l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];C(l,l,[this.width/2,-this.height/2,1]),S(l,l,[1,-1,0]),T(l,l,this.viewProjectionMatrix);var h=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],p=e[10],f=e[11],d=e[12],m=e[13],y=e[14],g=e[15],v=n*s-r*a,_=n*u-i*a,b=n*c-o*a,w=r*u-i*s,x=r*c-o*s,E=i*c-o*u,T=l*m-h*d,S=l*y-p*d,C=l*g-f*d,I=h*y-p*m,k=h*g-f*m,A=p*g-f*y,O=v*A-_*k+b*I+w*C-x*S+E*T;return O?(O=1/O,t[0]=(s*A-u*k+c*I)*O,t[1]=(i*k-r*A-o*I)*O,t[2]=(m*E-y*x+g*w)*O,t[3]=(p*x-h*E-f*w)*O,t[4]=(u*C-a*A-c*S)*O,t[5]=(n*A-i*C+o*S)*O,t[6]=(y*b-d*E-g*_)*O,t[7]=(l*E-p*b+f*_)*O,t[8]=(a*k-s*C+c*T)*O,t[9]=(r*C-n*k-o*T)*O,t[10]=(d*x-m*b+g*v)*O,t[11]=(h*b-l*x-f*v)*O,t[12]=(s*S-a*I-u*T)*O,t[13]=(n*I-r*S+i*T)*O,t[14]=(m*_-d*w-y*v)*O,t[15]=(l*w-h*_+p*v)*O,t):null}([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l);if(!h)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=l,this.pixelUnprojectionMatrix=h,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(u.a)(t,[{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&I(e.projectionMatrix,this.projectionMatrix)&&I(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=this.projectPosition(t),o=K(i,this.pixelProjectionMatrix),a=Object(_.a)(o,2),s=a[0],u=a[1],c=r?u:this.height-u;return 2===t.length?[s,c]:[s,c,o[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=e.targetZ,o=Object(_.a)(t,3),a=o[0],s=o[1],u=o[2],c=r?s:this.height-s,l=i&&i*this.pixelsPerMeter,h=Q([a,c,u],this.pixelUnprojectionMatrix,l),p=this.unprojectPosition(h),f=Object(_.a)(p,3),d=f[0],m=f[1],y=f[2];return Number.isFinite(u)?[d,m,y]:Number.isFinite(i)?[d,m,i]:[d,m]}},{key:"projectPosition",value:function(t){var e=this.projectFlat(t),n=Object(_.a)(e,2);return[n[0],n[1],(t[2]||0)*this.pixelsPerMeter]}},{key:"unprojectPosition",value:function(t){var e=this.unprojectFlat(t),n=Object(_.a)(e,2);return[n[0],n[1],(t[2]||0)/this.pixelsPerMeter]}},{key:"projectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return t}},{key:"unprojectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return t}}]),t}()),J=n(38),$=n(28),tt=n(33),et=n.n(tt),nt=85.05113,rt=-85.05113;var it=1e-7;function ot(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function at(t,e){if(t===e)return!0;if(ot(t)&&ot(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!at(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=it}function st(t,e,n){return Math.max(e,Math.min(n,t))}function ut(t,e,n){return ot(t)?t.map((function(t,r){return ut(t,e[r],n)})):n*e+(1-n)*t}function ct(t,e){if(!t)throw new Error(e||"react-map-gl: assertion failed.")}var lt=function(){function t(){Object(i.a)(this,t),Object(l.a)(this,"propNames",[])}return Object(u.a)(t,[{key:"arePropsEqual",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=(this.propNames||[])[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!at(t[s],e[s]))return!1}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0}},{key:"initializeProps",value:function(t,e){return{start:t,end:e}}},{key:"interpolateProps",value:function(t,e,n){ct(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(t,e){return e.transitionDuration}}]),t}(),ht=.01,pt=["longitude","latitude","zoom"],ft={curve:1.414,speed:1.2};function dt(t,e,n){var r=(n=Object.assign({},ft,n)).curve,i=t.zoom,o=[t.longitude,t.latitude],a=B(i),s=e.zoom,u=[e.longitude,e.latitude],c=B(s-i),l=V(o,a),h=V(u,a),p=P([],h,l),f=Math.max(t.width,t.height),d=f/c,m=O(p),y=r*r,g=(d*d-f*f+y*y*m*m)/(2*f*y*m),v=(d*d-f*f-y*y*m*m)/(2*d*y*m),_=Math.log(Math.sqrt(g*g+1)-g),b=Math.log(Math.sqrt(v*v+1)-v);return{startZoom:i,startCenterXY:l,uDelta:p,w0:f,u1:m,S:(b-_)/r,rho:r,rho2:y,r0:_,r1:b}}var mt={longitude:1,bearing:1};function yt(t){return Number.isFinite(t)||Array.isArray(t)}function gt(t,e,n){return function(t){return t in mt}(t)&&Math.abs(n-e)>180&&(n=n<0?n+360:n-360),n}var vt=["longitude","latitude","zoom","bearing","pitch"],_t=["latitude","longitude","zoom","width","height"],bt=["bearing","pitch"],wt={speed:1.2,curve:1.414},xt=(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.a)(this,e),t=Object(o.a)(this,Object(a.a)(e).call(this)),Object(l.a)(Object(s.a)(t),"speed",void 0),Object(l.a)(Object(s.a)(t),"propNames",vt),Object(l.a)(Object(s.a)(t),"props",void 0),t.props=Object.assign({},wt,n),t}Object(c.a)(e,t),Object(u.a)(e,[{key:"initializeProps",value:function(t,e){var n={},r={},i=!0,o=!1,a=void 0;try{for(var s,u=_t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=t[c],h=e[c];ct(yt(l)&&yt(h),"".concat(c," must be supplied for transition")),n[c]=l,r[c]=gt(c,l,h)}}catch(b){o=!0,a=b}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var p=!0,f=!1,d=void 0;try{for(var m,y=bt[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var g=m.value,v=t[g]||0,_=e[g]||0;n[g]=v,r[g]=gt(g,v,_)}}catch(b){f=!0,d=b}finally{try{p||null==y.return||y.return()}finally{if(f)throw d}}return{start:n,end:r}}},{key:"interpolateProps",value:function(t,e,n){var r=function(t,e,n){var r,i={},o=dt(t,e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),a=o.startZoom,s=o.startCenterXY,u=o.uDelta,c=o.w0,l=o.u1,h=o.S,p=o.rho,f=o.rho2,d=o.r0;if(Math.abs(l)<ht){for(var m=0;m<pt.length;m++){var y=pt[m],g=t[y],v=e[y];i[y]=(r=n)*v+(1-r)*g}return i}var _=n*h,b=Math.cosh(d)/Math.cosh(d+p*_),w=c*((Math.cosh(d)*Math.tanh(d+p*_)-Math.sinh(d))/f)/l,x=1/b,E=a+U(x),T=A([],u,w);k(T,T,s),A(T,T,x);var S=q(T,B(E));return i.longitude=S[0],i.latitude=S[1],i.zoom=E,i}(t,e,n,this.props),i=!0,o=!1,a=void 0;try{for(var s,u=bt[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r[c]=ut(t[c],e[c],n)}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return r}},{key:"getDuration",value:function(t,e){var n=e.transitionDuration;return"auto"===n&&(n=function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r=Object.assign({},ft,r),o=i.screenSpeed,a=i.speed,s=i.maxDuration,u=dt(t,e,r),c=u.S,l=u.rho,h=1e3*c;return n=Number.isFinite(o)?h/(o/l):h/a,Number.isFinite(s)&&n>s?0:n}(t,e,this.props)),n}}])}(lt),["longitude","latitude","zoom","bearing","pitch"]),Et=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.a)(this,e),t=Object(o.a)(this,Object(a.a)(e).call(this)),Object(l.a)(Object(s.a)(t),"around",void 0),Array.isArray(n)&&(n={transitionProps:n}),t.propNames=n.transitionProps||xt,n.around&&(t.around=n.around),t}return Object(c.a)(e,t),Object(u.a)(e,[{key:"initializeProps",value:function(t,e){var n={},r={};if(this.around){n.around=this.around;var i=new Z(t).unproject(this.around);Object.assign(r,e,{around:new Z(e).project(i),aroundLngLat:i})}var o=!0,a=!1,s=void 0;try{for(var u,c=this.propNames[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value,h=t[l],p=e[l];ct(yt(h)&&yt(p),"".concat(l," must be supplied for transition")),n[l]=h,r[l]=gt(l,h,p)}}catch(f){a=!0,s=f}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return{start:n,end:r}}},{key:"interpolateProps",value:function(t,e,n){var r={},i=!0,o=!1,a=void 0;try{for(var s,u=this.propNames[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r[c]=ut(t[c],e[c],n)}}catch(d){o=!0,a=d}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}if(e.around){var l=new Z(Object.assign({},e,r)).getMapCenterByLngLatPosition({lngLat:e.aroundLngLat,pos:ut(t.around,e.around,n)}),h=Object(_.a)(l,2),p=h[0],f=h[1];r.longitude=p,r.latitude=f}return r}}]),e}(lt),Tt={minZoom:0,maxZoom:24,minPitch:0,maxPitch:60},St={pitch:0,bearing:0,altitude:1.5},Ct=function(){function t(e){var n=e.width,r=e.height,o=e.latitude,a=e.longitude,s=e.zoom,u=e.bearing,c=void 0===u?St.bearing:u,h=e.pitch,p=void 0===h?St.pitch:h,f=e.altitude,d=void 0===f?St.altitude:f,m=e.maxZoom,y=void 0===m?Tt.maxZoom:m,g=e.minZoom,v=void 0===g?Tt.minZoom:g,_=e.maxPitch,b=void 0===_?Tt.maxPitch:_,w=e.minPitch,x=void 0===w?Tt.minPitch:w,E=e.transitionDuration,T=e.transitionEasing,S=e.transitionInterpolator,C=e.transitionInterruption,I=e.startPanLngLat,k=e.startZoomLngLat,A=e.startBearing,O=e.startPitch,P=e.startZoom;Object(i.a)(this,t),Object(l.a)(this,"_viewportProps",void 0),Object(l.a)(this,"_interactiveState",void 0),ct(Number.isFinite(n),"`width` must be supplied"),ct(Number.isFinite(r),"`height` must be supplied"),ct(Number.isFinite(a),"`longitude` must be supplied"),ct(Number.isFinite(o),"`latitude` must be supplied"),ct(Number.isFinite(s),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:r,latitude:o,longitude:a,zoom:s,bearing:c,pitch:p,altitude:d,maxZoom:y,minZoom:v,maxPitch:b,minPitch:x,transitionDuration:E,transitionEasing:T,transitionInterpolator:S,transitionInterruption:C}),this._interactiveState={startPanLngLat:I,startZoomLngLat:k,startBearing:A,startPitch:O,startZoom:P}}return Object(u.a)(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._interactiveState.startPanLngLat||this._unproject(n);if(!r)return this;var i=this._calculateNewLngLat({startPanLngLat:r,pos:e}),o=Object(_.a)(i,2),a=o[0],s=o[1];return this._getUpdatedMapState({longitude:a,latitude:s})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){t.pos;return this._getUpdatedMapState({startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=void 0===e?0:e,r=t.deltaScaleY,i=void 0===r?0:r,o=this._interactiveState,a=o.startBearing,s=o.startPitch;if(!Number.isFinite(a)||!Number.isFinite(s))return this;var u=this._calculateNewPitchAndBearing({deltaScaleX:n,deltaScaleY:i,startBearing:a||0,startPitch:s||0}),c=u.pitch,l=u.bearing;return this._getUpdatedMapState({bearing:l,pitch:c})}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale;ct(r>0,"`scale` must be a positive number");var i=this._interactiveState,o=i.startZoom,a=i.startZoomLngLat;Number.isFinite(o)||(o=this._viewportProps.zoom,a=this._unproject(n)||this._unproject(e)),ct(a,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var s=this._calculateNewZoom({scale:r,startZoom:o||0}),u=new Z(Object.assign({},this._viewportProps,{zoom:s})).getMapCenterByLngLatPosition({lngLat:a,pos:e}),c=Object(_.a)(u,2),l=c[0],h=c[1];return this._getUpdatedMapState({zoom:s,longitude:l,latitude:h})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(e){return new t(Object.assign({},this._viewportProps,this._interactiveState,e))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;t.zoom=st(r,n,e);var i=t.maxPitch,o=t.minPitch,a=t.pitch;return t.pitch=st(a,o,i),Object.assign(t,function(t){var e=t.width,n=t.height,r=t.longitude,i=t.latitude,o=t.zoom,a=t.pitch,s=void 0===a?0:a,u=t.bearing,c=void 0===u?0:u;(r<-180||r>180)&&(r=E(r+180,360)-180),(c<-180||c>180)&&(c=E(c+180,360)-180);var l=new Z({width:e,height:n,longitude:r,latitude:i,zoom:o}),h=l.project([r,nt])[1],p=l.project([r,rt])[1],f=0;return p-h<n&&(o+=Math.log2(n/(p-h)),h=(l=new Z({width:e,height:n,longitude:r,latitude:i,zoom:o})).project([r,nt])[1],p=l.project([r,rt])[1]),h>0?f=h:p<n&&(f=p-n),f&&(i=l.unproject([e/2,n/2+f])[1]),{width:e,height:n,longitude:r,latitude:i,zoom:o,pitch:s,bearing:c}}(t)),t}},{key:"_unproject",value:function(t){var e=new Z(this._viewportProps);return t&&e.unproject(t)}},{key:"_calculateNewLngLat",value:function(t){var e=t.startPanLngLat,n=t.pos;return new Z(this._viewportProps).getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this._viewportProps,i=r.maxZoom,o=r.minZoom;return st(n+Math.log2(e),o,i)}},{key:"_calculateNewPitchAndBearing",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY,r=t.startBearing,i=t.startPitch;n=st(n,-1,1);var o=this._viewportProps,a=o.minPitch,s=o.maxPitch,u=i;return n>0?u=i+n*(s-i):n<0&&(u=i-n*(a-i)),{pitch:u,bearing:r+180*e}}}]),t}();var It=Object(h.createContext)({viewport:null,map:null,mapContainer:null,onViewportChange:null,onViewStateChange:null,eventManager:null,isDragging:!1});function kt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function At(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kt(n,!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ot="A valid API access token is required to use Mapbox data";var Pt=401,Dt={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},Mt=Object.assign({},$.a.propTypes,{width:d.a.oneOfType([d.a.number,d.a.string]),height:d.a.oneOfType([d.a.number,d.a.string]),onResize:d.a.func,preventStyleDiffing:d.a.bool,disableTokenWarning:d.a.bool,visible:d.a.bool,className:d.a.string,style:d.a.object,visibilityConstraints:d.a.object}),Rt=Object.assign({},$.a.defaultProps,{preventStyleDiffing:!1,disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:Tt}),Nt=function(t){function e(){var t,n;Object(i.a)(this,e);for(var r=arguments.length,u=new Array(r),c=0;c<r;c++)u[c]=arguments[c];return n=Object(o.a)(this,(t=Object(a.a)(e)).call.apply(t,[this].concat(u))),Object(l.a)(Object(s.a)(n),"state",{accessTokenInvalid:!1}),Object(l.a)(Object(s.a)(n),"_mapbox",null),Object(l.a)(Object(s.a)(n),"_map",null),Object(l.a)(Object(s.a)(n),"_mapboxMapRef",Object(h.createRef)()),Object(l.a)(Object(s.a)(n),"_mapContainerRef",Object(h.createRef)()),Object(l.a)(Object(s.a)(n),"_queryParams",{}),Object(l.a)(Object(s.a)(n),"_width",0),Object(l.a)(Object(s.a)(n),"_height",0),Object(l.a)(Object(s.a)(n),"getMap",(function(){return n._map})),Object(l.a)(Object(s.a)(n),"queryRenderedFeatures",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n._map.queryRenderedFeatures(t,e)})),Object(l.a)(Object(s.a)(n),"_mapboxMapError",(function(t){(t.error&&t.error.status||t.status)!==Pt||n.state.accessTokenInvalid||(console.error(Ot),n.setState({accessTokenInvalid:!0})),n.props.onError(t)})),n}return Object(c.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){if(e.supported()){var t=this.props.mapStyle;this._mapbox=new $.a(Object.assign({},this.props,{mapboxgl:et.a,width:this._width,height:this._height,container:this._mapboxMapRef.current,onError:this._mapboxMapError,mapStyle:v(t)})),this._map=this._mapbox.getMap()}}},{key:"componentDidUpdate",value:function(t){this._mapbox&&(this._updateMapStyle(t,this.props),this._updateMapProps(this.props))}},{key:"componentWillUnmount",value:function(){this._mapbox&&(this._mapbox.finalize(),this._mapbox=null,this._map=null)}},{key:"_updateMapSize",value:function(t,e){this._width===t&&this._height===e||(this._width=t,this._height=e,this._updateMapProps(this.props))}},{key:"_updateMapStyle",value:function(t,e){var n=e.mapStyle;n!==t.mapStyle&&n&&this._map.setStyle(v(n),{diff:!this.props.preventStyleDiffing})}},{key:"_updateMapProps",value:function(t){this._mapbox&&this._mapbox.setProps(Object.assign({},t,{width:this._width,height:this._height}))}},{key:"_renderNoTokenWarning",value:function(){if(this.state.accessTokenInvalid&&!this.props.disableTokenWarning){return p.a.createElement("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},p.a.createElement("h3",{key:"header"},"NO_TOKEN_WARNING"),p.a.createElement("div",{key:"text"},"For information on setting up your basemap, read"),p.a.createElement("a",{key:"link",href:"https://uber.github.io/react-map-gl/#/Documentation/getting-started/about-mapbox-tokens"},"Note on Map Tokens"))}return null}},{key:"_renderOverlays",value:function(t){var e=this,n=t.width,r=void 0===n?Number(this.props.width):n,i=t.height,o=void 0===i?Number(this.props.height):i;return this._updateMapSize(r,o),p.a.createElement(It.Consumer,null,(function(t){var n=At({},t,{viewport:new Z(At({},e.props,{},e.props.viewState,{width:r,height:o})),map:e._map,mapContainer:t.mapContainer||e._mapContainerRef.current});return p.a.createElement(It.Provider,{value:n},p.a.createElement("div",{key:"map-overlays",className:"overlays",style:Dt},e.props.children))}))}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.width,r=t.height,i=t.style,o=t.visibilityConstraints,a=Object.assign({position:"relative"},i,{width:n,height:r}),s=this.props.visible&&function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt;for(var r in n){var i=r.slice(0,3),o=(e=r.slice(3))[0].toLowerCase()+e.slice(1);if("min"===i&&t[o]<n[r])return!1;if("max"===i&&t[o]>n[r])return!1}return!0}(this.props.viewState||this.props,o),u=Object.assign({},Dt,{visibility:s?"inherit":"hidden"});return p.a.createElement("div",{key:"map-container",style:a,ref:this._mapContainerRef},p.a.createElement("div",{key:"map-mapbox",ref:this._mapboxMapRef,style:u,className:e}),p.a.createElement(J.a,{key:"autosizer",disableWidth:Number.isFinite(n),disableHeight:Number.isFinite(r),onResize:this.props.onResize},this._renderOverlays.bind(this)),this._renderNoTokenWarning())}}],[{key:"supported",value:function(){return et.a&&et.a.supported()}}]),e}(h.PureComponent);Object(l.a)(Nt,"propTypes",Mt),Object(l.a)(Nt,"defaultProps",Rt);var Lt=function(){};var Ft=1,jt=2,zt=3,Bt=4,Ut={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new Et,transitionInterruption:Ft,onTransitionStart:Lt,onTransitionInterrupt:Lt,onTransitionEnd:Lt,onViewportChange:Lt,onStateChange:Lt},Vt=function(){function t(e,n){var r=this;Object(i.a)(this,t),Object(l.a)(this,"props",void 0),Object(l.a)(this,"state",void 0),Object(l.a)(this,"time",void 0),Object(l.a)(this,"_animationFrame",null),Object(l.a)(this,"_onTransitionFrame",(function(){r._animationFrame=requestAnimationFrame(r._onTransitionFrame),r._updateViewport()})),e&&(this.props=e),this.time=n||Date.now}return Object(u.a)(t,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(t){var e=this.props;if(this.props=t,this._shouldIgnoreViewportChange(e,t))return!1;if(this._isTransitionEnabled(t)){var n=Object.assign({},e),r=Object.assign({},t);if(this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this.state.interruption===jt?Object.assign(n,this.state.endProps):Object.assign(n,this.state.propsInTransition),this.state.interruption===Bt)){var i=this.time(),o=(i-this.state.startTime)/this.state.duration;r.transitionDuration=this.state.duration-(i-this.state.startTime),r.transitionEasing=function(t,e){var n=t(e);return function(r){return 1/(1-n)*(t(r*(1-e)+e)-n)}}(this.state.easing,o),r.transitionInterpolator=n.transitionInterpolator}return r.onTransitionStart(),this._triggerTransition(n,r),!0}return this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return Boolean(this._animationFrame)}},{key:"_isTransitionEnabled",value:function(t){var e=t.transitionDuration,n=t.transitionInterpolator;return(e>0||"auto"===e)&&Boolean(n)}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(t,this.state.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return!t||(this._isTransitionInProgress()?this.state.interruption===zt||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e))}},{key:"_triggerTransition",value:function(t,e){ct(this._isTransitionEnabled(e),"Transition is not enabled"),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var n=e.transitionInterpolator,r=n.getDuration?n.getDuration(t,e):e.transitionDuration,i=e.transitionInterpolator.initializeProps(t,e),o={inTransition:!0,isZooming:t.zoom!==e.zoom,isPanning:t.longitude!==e.longitude||t.latitude!==e.latitude,isRotating:t.bearing!==e.bearing||t.pitch!==e.pitch};this.state={duration:r,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startTime:this.time(),startProps:i.start,endProps:i.end,animation:null,propsInTransition:{},interactionState:o},this._onTransitionFrame(),this.props.onStateChange(o)}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.props.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var t=this.time(),e=this.state,n=e.startTime,r=e.duration,i=e.easing,o=e.interpolator,a=e.startProps,s=e.endProps,u=!1,c=(t-n)/r;c>=1&&(c=1,u=!0),c=i(c);var l=o.interpolateProps(a,s,c),h=new Ct(Object.assign({},this.props,l));this.state.propsInTransition=h.getViewportProps(),this.props.onViewportChange(this.state.propsInTransition,this.state.interactionState,this.props),u&&(this._endTransition(),this.props.onTransitionEnd())}}]),t}();Object(l.a)(Vt,"defaultProps",Ut);var qt=n(25),Wt=n.n(qt),Gt=1,Ht=2,Kt=4,Qt={mousedown:Gt,mousemove:Ht,mouseup:Kt};!function(t){var e=t.prototype.handler;t.prototype.handler=function(t){var n=this.store;t.button>0&&(function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(n,(function(e){return e.pointerId===t.pointerId}))||n.push(t)),e.call(this,t)}}(Wt.a.PointerEventInput),Wt.a.MouseInput.prototype.handler=function(t){var e=Qt[t.type];e&Gt&&t.button>=0&&(this.pressed=!0),e&Ht&&0===t.which&&(e=Kt),this.pressed&&(e&Kt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};var Xt=Wt.a.Manager,Yt=Wt.a,Zt=Yt?[[Yt.Rotate,{enable:!1}],[Yt.Pinch,{enable:!1}],[Yt.Swipe,{enable:!1}],[Yt.Pan,{threshold:0,enable:!1}],[Yt.Press,{enable:!1}],[Yt.Tap,{event:"doubletap",taps:2,enable:!1}],[Yt.Tap,{event:"anytap",enable:!1}],[Yt.Tap,{enable:!1}]]:null,Jt={rotate:["pinch"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},$t={doubletap:["tap"]},te={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},ee=["keydown","keyup"],ne=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],re=["wheel","mousewheel","DOMMouseScroll"],ie={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},oe={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},ae=n(21),se=-1!==ae.b.indexOf("firefox"),ue=re,ce=function(){function t(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},o),this.events=ue.concat(o.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((function(t){return e.addEventListener(t,r.handleEvent,!!ae.a&&{passive:!1})}))}return Object(u.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"wheel"===t&&(this.options.enable=e)}},{key:"handleEvent",value:function(t){if(this.options.enable){var e=t.deltaY;ae.c.WheelEvent&&(se&&t.deltaMode===ae.c.WheelEvent.DOM_DELTA_PIXEL&&(e/=ae.c.devicePixelRatio),t.deltaMode===ae.c.WheelEvent.DOM_DELTA_LINE&&(e*=40));var n={x:t.clientX,y:t.clientY};0!==e&&e%4.000244140625===0&&(e=Math.floor(e/4.000244140625)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,n)}}},{key:"_onWheel",value:function(t,e,n){this.callback({type:"wheel",center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}]),t}(),le=ne,he=function(){function t(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i.a)(this,t),this.element=e,this.callback=n,this.pressed=!1,this.options=Object.assign({enable:!0},o),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=le.concat(o.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((function(t){return e.addEventListener(t,r.handleEvent)}))}return Object(u.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"pointermove"===t&&(this.enableMoveEvent=e),"pointerover"===t&&(this.enableOverEvent=e),"pointerout"===t&&(this.enableOutEvent=e),"pointerleave"===t&&(this.enableLeaveEvent=e)}},{key:"handleEvent",value:function(t){this.handleOverEvent(t),this.handleOutEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)}},{key:"handleOverEvent",value:function(t){this.enableOverEvent&&"mouseover"===t.type&&this.callback({type:"pointerover",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleOutEvent",value:function(t){this.enableOutEvent&&"mouseout"===t.type&&this.callback({type:"pointerout",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleLeaveEvent",value:function(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:"pointerleave",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleMoveEvent",value:function(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:"pointermove",srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}]),t}(),pe=ee,fe=function(){function t(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},o),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=pe.concat(o.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=1,e.style.outline="none",this.events.forEach((function(t){return e.addEventListener(t,r.handleEvent)}))}return Object(u.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"keydown"===t&&(this.enableDownEvent=e),"keyup"===t&&(this.enableUpEvent=e)}},{key:"handleEvent",value:function(t){var e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:"keydown",srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:"keyup",srcEvent:t,key:t.key,target:t.target}))}}]),t}(),de=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},r),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}return Object(u.a)(t,[{key:"destroy",value:function(){this.element.removeEventListener("contextmenu",this.handleEvent)}},{key:"enableEventType",value:function(t,e){"contextmenu"===t&&(this.options.enable=e)}},{key:"handleEvent",value:function(t){this.options.enable&&this.callback({type:"contextmenu",center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}]),t}(),me=1,ye=2,ge=4,ve={pointerdown:me,pointermove:ye,pointerup:ge,mousedown:me,mousemove:ye,mouseup:ge},_e=1,be=2,we=3,xe=0,Ee=1,Te=2,Se=1,Ce=2,Ie=4;var ke=function(){function t(e){Object(i.a)(this,t),this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this)}return Object(u.a)(t,[{key:"isEmpty",value:function(){return 0===this.handlers.length}},{key:"add",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"root",r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.handlers,o=this.handlersByElement;o.has(n)||o.set(n,[]);var a={type:t,handler:e,srcElement:n,once:r};i.push(a),o.get(n).push(a)}},{key:"remove",value:function(t,e){for(var n=this.handlers,r=this.handlersByElement,i=n.length-1;i>=0;i--){var o=n[i];if(o.type===t&&o.handler===e){n.splice(i,1);var a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}}},{key:"handleEvent",value:function(t){if(!this.isEmpty()){for(var e=this._normalizeEvent(t),n=t.srcEvent.target;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")}}},{key:"_emit",value:function(t,e){var n=this.handlersByElement.get(e);if(n){for(var r=!1,i=function(){t.handled=!0},o=function(){t.handled=!0,r=!0},a=[],s=0;s<n.length;s++){var u=n[s],c=u.type,l=u.handler,h=u.once;if(l(Object.assign({},t,{type:c,stopPropagation:i,stopImmediatePropagation:o})),h&&a.push(n[s]),r)break}for(var p=0;p<a.length;p++){var f=a[p];c=f.type,l=f.handler;this.remove(c,l)}}}},{key:"_normalizeEvent",value:function(t){var e=this.eventManager.element;return Object.assign({},t,function(t){var e=ve[t.srcEvent.type];if(!e)return null;var n=t.srcEvent,r=n.buttons,i=n.button,o=n.which,a=!1,s=!1,u=!1;return e===ge||e===ye&&!Number.isFinite(r)?(a=o===_e,s=o===be,u=o===we):e===ye?(a=Boolean(r&Se),s=Boolean(r&Ie),u=Boolean(r&Ce)):e===me&&(a=i===xe,s=i===Ee,u=i===Te),{leftButton:a,middleButton:s,rightButton:u}}(t),function(t,e){var n=t.srcEvent;if(!t.center&&!Number.isFinite(n.clientX))return null;var r=t.center||{x:n.clientX,y:n.clientY},i=e.getBoundingClientRect(),o=i.width/e.offsetWidth,a=i.height/e.offsetHeight;return{center:r,offsetCenter:{x:(r.x-i.left-e.clientLeft)/o,y:(r.y-i.top-e.clientTop)/a}}}(t,e),{handled:!1,rootElement:e})}}]),t}(),Ae={events:null,recognizers:null,recognizerOptions:{},Manager:Xt,touchAction:"none"},Oe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(i.a)(this,t),this.options=Object.assign({},Ae,n),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);var r=n.events;r&&this.on(r)}return Object(u.a)(t,[{key:"setElement",value:function(t){var e=this;if(this.element&&this.destroy(),this.element=t,t){var n=this.options,r=n.Manager;for(var i in this.manager=new r(t,{touchAction:n.touchAction,recognizers:n.recognizers||Zt}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(Jt).forEach((function(t){var n=e.manager.get(t);n&&Jt[t].forEach((function(t){n.recognizeWith(t)}))})),n.recognizerOptions){var o=this.manager.get(i);if(o){var a=n.recognizerOptions[i];delete a.enable,o.set(a)}}this.wheelInput=new ce(t,this._onOtherEvent,{enable:!1}),this.moveInput=new he(t,this._onOtherEvent,{enable:!1}),this.keyInput=new fe(t,this._onOtherEvent,{enable:!1}),this.contextmenuInput=new de(t,this._onOtherEvent,{enable:!1});var s=!0,u=!1,c=void 0;try{for(var l,h=this.events[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var p=Object(_.a)(l.value,2),f=p[0],d=p[1];d.isEmpty()||(this._toggleRecognizer(d.recognizerName,!0),this.manager.on(f,d.handleEvent))}}catch(m){u=!0,c=m}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}}}},{key:"destroy",value:function(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}},{key:"on",value:function(t,e,n){this._addEventHandler(t,e,n,!1)}},{key:"once",value:function(t,e,n){this._addEventHandler(t,e,n,!0)}},{key:"off",value:function(t,e){this._removeEventHandler(t,e)}},{key:"_toggleRecognizer",value:function(t,e){var n=this.manager;if(n){var r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});var i=$t[t];i&&!this.options.recognizers&&i.forEach((function(i){var o=n.get(i);e?(o.requireFailure(t),r.dropRequireFailure(i)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}}},{key:"_addEventHandler",value:function(t,e,n,r){if("string"===typeof t){var i=this.manager,o=this.events,a=oe[t]||t,s=o.get(a);s||(s=new ke(this),o.set(a,s),s.recognizerName=ie[a]||a,i&&i.on(a,s.handleEvent)),this._toggleRecognizer(s.recognizerName,!0),s.add(t,e,n,r)}else for(var u in n=e,t)this._addEventHandler(u,t[u],n,r)}},{key:"_removeEventHandler",value:function(t,e){if("string"===typeof t){var n=this.events,r=oe[t]||t,i=n.get(r);if(i&&(i.remove(t,e),i.isEmpty())){var o=i.recognizerName,a=!1,s=!0,u=!1,c=void 0;try{for(var l,h=n.values()[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var p=l.value;if(p.recognizerName===o&&!p.isEmpty()){a=!0;break}}}catch(d){u=!0,c=d}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}a||this._toggleRecognizer(o,!1)}}else for(var f in t)this._removeEventHandler(f,t[f])}},{key:"_onBasicInput",value:function(t){var e=t.srcEvent,n=te[e.type];n&&this.manager.emit(n,t)}},{key:"_onOtherEvent",value:function(t){this.manager.emit(t.type,t)}}]),t}();var Pe={transitionDuration:0},De={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new Et,transitionInterruption:Ft},Me=["wheel"],Re=["panstart","panmove","panend"],Ne=["pinchstart","pinchmove","pinchend","pinchcancel"],Le=["doubletap"],Fe=["keydown"],je=function(){function t(){var e=this;Object(i.a)(this,t),Object(l.a)(this,"events",[]),Object(l.a)(this,"mapState",void 0),Object(l.a)(this,"onViewportChange",void 0),Object(l.a)(this,"onStateChange",void 0),Object(l.a)(this,"mapStateProps",void 0),Object(l.a)(this,"eventManager",void 0),Object(l.a)(this,"scrollZoom",!0),Object(l.a)(this,"dragPan",!0),Object(l.a)(this,"dragRotate",!0),Object(l.a)(this,"doubleClickZoom",!0),Object(l.a)(this,"touchZoom",!0),Object(l.a)(this,"touchRotate",!1),Object(l.a)(this,"keyboard",!0),Object(l.a)(this,"_state",{isDragging:!1}),Object(l.a)(this,"_events",{}),Object(l.a)(this,"_transitionManager",new Vt),Object(l.a)(this,"setState",(function(t){Object.assign(e._state,t),e.onStateChange&&e.onStateChange(e._state)})),this.handleEvent=this.handleEvent.bind(this),this._onWheelEnd=function(t,e){var n,r,i,o=function(){return i=null,t.apply(n,r)};return function(){n=this,r=arguments,i&&clearTimeout(i),i=setTimeout(o,e)}}(this._onWheelEnd,100)}return Object(u.a)(t,[{key:"handleEvent",value:function(t){switch(this.mapState=this.getMapState(),t.type){case"panstart":return this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchcancel":case"pinchend":return this._onPinchEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}},{key:"getCenter",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"updateViewport",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.mapState?this.mapState.getViewportProps():{},i=Object.assign({},t.getViewportProps(),e),o=Object.keys(i).some((function(t){return r[t]!==i[t]}));o&&this.onViewportChange(i,n,r),this.setState(Object.assign({},t.getInteractiveState(),n))}},{key:"getMapState",value:function(t){return new Ct(Object.assign({},this.mapStateProps,this._state,t))}},{key:"setOptions",value:function(t){var e=t.onViewportChange,n=t.onStateChange,r=t.eventManager,i=void 0===r?this.eventManager:r,o=t.isInteractive,a=void 0===o||o,s=t.scrollZoom,u=void 0===s?this.scrollZoom:s,c=t.dragPan,l=void 0===c?this.dragPan:c,h=t.dragRotate,p=void 0===h?this.dragRotate:h,f=t.doubleClickZoom,d=void 0===f?this.doubleClickZoom:f,m=t.touchZoom,y=void 0===m?this.touchZoom:m,g=t.touchRotate,v=void 0===g?this.touchRotate:g,_=t.keyboard,b=void 0===_?this.keyboard:_;this.onViewportChange=e,this.onStateChange=n,this.mapStateProps&&this.mapStateProps.height===t.height||this.updateViewport(new Ct(t)),this.mapStateProps=t,this._transitionManager.processViewportChange(Object.assign({},t,{onStateChange:this.setState})),this.eventManager!==i&&(this.eventManager=i,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(Me,a&&u),this.toggleEvents(Re,a&&(l||p)),this.toggleEvents(Ne,a&&(y||v)),this.toggleEvents(Le,a&&d),this.toggleEvents(Fe,a&&b),this.scrollZoom=u,this.dragPan=l,this.dragRotate=p,this.doubleClickZoom=d,this.touchZoom=y,this.touchRotate=v,this.keyboard=b}},{key:"toggleEvents",value:function(t,e){var n=this;this.eventManager&&t.forEach((function(t){n._events[t]!==e&&(n._events[t]=e,e?n.eventManager.on(t,n.handleEvent):n.eventManager.off(t,n.handleEvent))}))}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t),n=this.mapState.panStart({pos:e}).rotateStart({pos:e});return this.updateViewport(n,Pe,{isDragging:!0}),!0}},{key:"_onPan",value:function(t){return this.isFunctionKeyPressed(t)||t.rightButton?this._onPanRotate(t):this._onPanMove(t)}},{key:"_onPanEnd",value:function(t){var e=this.mapState.panEnd().rotateEnd();return this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isRotating:!1}),!0}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t),n=this.mapState.pan({pos:e});return this.updateViewport(n,Pe,{isPanning:!0}),!0}},{key:"_onPanRotate",value:function(t){if(!this.dragRotate)return!1;var e=t.deltaX,n=t.deltaY,r=this.getCenter(t),i=Object(_.a)(r,2)[1],o=i-n,a=this.mapState.getViewportProps(),s=a.width,u=a.height,c=e/s,l=0;n>0?Math.abs(u-o)>5&&(l=n/(o-u)*1.2):n<0&&o>5&&(l=1-i/o),l=Math.min(1,Math.max(-1,l));var h=this.mapState.rotate({deltaScaleX:c,deltaScaleY:l});return this.updateViewport(h,Pe,{isRotating:!0}),!0}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;t.preventDefault();var e=this.getCenter(t),n=t.delta,r=2/(1+Math.exp(-Math.abs(.01*n)));n<0&&0!==r&&(r=1/r);var i=this.mapState.zoom({pos:e,scale:r});return this.updateViewport(i,Pe,{isZooming:!0}),this._onWheelEnd(),!0}},{key:"_onWheelEnd",value:function(){this.setState({isZooming:!1})}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t),n=this.mapState.zoomStart({pos:e}).rotateStart({pos:e});return this._state.startPinchRotation=t.rotation,this.updateViewport(n,Pe,{isDragging:!0}),!0}},{key:"_onPinch",value:function(t){if(!this.touchZoom&&!this.touchRotate)return!1;var e=this.mapState;if(this.touchZoom){var n=t.scale,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){var i=t.rotation,o=this._state.startPinchRotation;e=e.rotate({deltaScaleX:-(i-o)/180})}return this.updateViewport(e,Pe,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),!0}},{key:"_onPinchEnd",value:function(t){var e=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t),n=this.isFunctionKeyPressed(t),r=this.mapState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,Object.assign({},De,{transitionInterpolator:new Et({around:e})})),!0}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,n=this.isFunctionKeyPressed(t),r=this.mapStateProps;switch(t.srcEvent.keyCode){case 189:e=n?this.getMapState({zoom:r.zoom-2}):this.getMapState({zoom:r.zoom-1});break;case 187:e=n?this.getMapState({zoom:r.zoom+2}):this.getMapState({zoom:r.zoom+1});break;case 37:e=n?this.getMapState({bearing:r.bearing-15}):this.mapState.pan({pos:[100,0],startPos:[0,0]});break;case 39:e=n?this.getMapState({bearing:r.bearing+15}):this.mapState.pan({pos:[-100,0],startPos:[0,0]});break;case 38:e=n?this.getMapState({pitch:r.pitch+10}):this.mapState.pan({pos:[0,100],startPos:[0,0]});break;case 40:e=n?this.getMapState({pitch:r.pitch-10}):this.mapState.pan({pos:[0,-100],startPos:[0,0]});break;default:return!1}return this.updateViewport(e,De)}}]),t}(),ze=[{old:"onChangeViewport",new:"onViewportChange"},{old:"perspectiveEnabled",new:"dragRotate"},{old:"onHoverFeatures",new:"onHover"},{old:"onClickFeatures",new:"onClick"},{old:"touchZoomRotate",new:"touchZoom, touchRotate"},{old:"mapControls",new:"controller"}];function Be(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ze.forEach((function(e){if(t.hasOwnProperty(e.old)){var n=(r=e.old,"react-map-gl: `".concat(r,"` is removed."));e.new&&(n="".concat(n," ").concat(function(t){return"Use `".concat(t,"` instead.")}(e.new))),console.warn(n)}var r}))}var Ue=Object.assign({},Nt.propTypes,{maxZoom:d.a.number,minZoom:d.a.number,maxPitch:d.a.number,minPitch:d.a.number,onViewStateChange:d.a.func,onViewportChange:d.a.func,onInteractionStateChange:d.a.func,transitionDuration:d.a.oneOfType([d.a.number,d.a.string]),transitionInterpolator:d.a.object,transitionInterruption:d.a.number,transitionEasing:d.a.func,onTransitionStart:d.a.func,onTransitionInterrupt:d.a.func,onTransitionEnd:d.a.func,scrollZoom:d.a.bool,dragPan:d.a.bool,dragRotate:d.a.bool,doubleClickZoom:d.a.bool,touchZoom:d.a.bool,touchRotate:d.a.bool,keyboard:d.a.bool,onHover:d.a.func,onClick:d.a.func,onDblClick:d.a.func,onContextMenu:d.a.func,onMouseDown:d.a.func,onMouseMove:d.a.func,onMouseUp:d.a.func,onTouchStart:d.a.func,onTouchMove:d.a.func,onTouchEnd:d.a.func,onMouseEnter:d.a.func,onMouseLeave:d.a.func,onMouseOut:d.a.func,onWheel:d.a.func,touchAction:d.a.string,clickRadius:d.a.number,interactiveLayerIds:d.a.array,getCursor:d.a.func,controller:d.a.instanceOf(je)}),Ve=Object.assign({},Nt.defaultProps,Tt,Vt.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(t){return t.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",clickRadius:0,getCursor:function(t){var e=t.isDragging,n=t.isHovering;return e?"grabbing":n?"pointer":"grab"}}),qe=function(t){function e(t){var n;return Object(i.a)(this,e),n=Object(o.a)(this,Object(a.a)(e).call(this,t)),Object(l.a)(Object(s.a)(n),"state",{isLoaded:!1,isDragging:!1,isHovering:!1}),Object(l.a)(Object(s.a)(n),"_controller",void 0),Object(l.a)(Object(s.a)(n),"_eventManager",void 0),Object(l.a)(Object(s.a)(n),"_interactiveContext",void 0),Object(l.a)(Object(s.a)(n),"_width",0),Object(l.a)(Object(s.a)(n),"_height",0),Object(l.a)(Object(s.a)(n),"_eventCanvasRef",Object(h.createRef)()),Object(l.a)(Object(s.a)(n),"_staticMapRef",Object(h.createRef)()),Object(l.a)(Object(s.a)(n),"getMap",(function(){return n._staticMapRef.current?n._staticMapRef.current.getMap():null})),Object(l.a)(Object(s.a)(n),"queryRenderedFeatures",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.getMap();return r&&r.queryRenderedFeatures(t,e)})),Object(l.a)(Object(s.a)(n),"_onInteractionStateChange",(function(t){var e=t.isDragging,r=void 0!==e&&e;r!==n.state.isDragging&&(n._updateInteractiveContext({isDragging:r}),n.setState({isDragging:r}));var i=n.props.onInteractionStateChange;i&&i(t)})),Object(l.a)(Object(s.a)(n),"_onResize",(function(t){var e=t.width,r=t.height;n._width=e,n._height=r,n._setControllerProps(n.props),n.props.onResize({width:e,height:r})})),Object(l.a)(Object(s.a)(n),"_onViewportChange",(function(t,e,r){var i=n.props,o=i.onViewStateChange,a=i.onViewportChange;o&&o({viewState:t,interactionState:e,oldViewState:r}),a&&a(t,e,r)})),Object(l.a)(Object(s.a)(n),"_onLoad",(function(t){n.setState({isLoaded:!0}),n.props.onLoad(t)})),Object(l.a)(Object(s.a)(n),"_onEvent",(function(t,e){var r=n.props[t];r&&r(n._normalizeEvent(e))})),Object(l.a)(Object(s.a)(n),"_onPointerDown",(function(t){switch(t.pointerType){case"touch":n._onEvent("onTouchStart",t);break;default:n._onEvent("onMouseDown",t)}})),Object(l.a)(Object(s.a)(n),"_onPointerUp",(function(t){switch(t.pointerType){case"touch":n._onEvent("onTouchEnd",t);break;default:n._onEvent("onMouseUp",t)}})),Object(l.a)(Object(s.a)(n),"_onPointerMove",(function(t){switch(t.pointerType){case"touch":n._onEvent("onTouchMove",t);break;default:n._onEvent("onMouseMove",t)}if(!n.state.isDragging){var e,r=n.props,i=r.onHover,o=r.interactiveLayerIds;t=n._normalizeEvent(t),n.state.isLoaded&&(o||i)&&(e=n._getFeatures({pos:t.point,radius:n.props.clickRadius})),i&&(t.features=e,i(t));var a=Boolean(o&&e&&e.length>0),s=a&&!n.state.isHovering,u=!a&&n.state.isHovering;s&&n._onEvent("onMouseEnter",t),u&&n._onEvent("onMouseLeave",t),(s||u)&&n.setState({isHovering:a})}})),Object(l.a)(Object(s.a)(n),"_onClick",(function(t){var e=n.props,r=e.onClick,i=e.onNativeClick,o=e.onDblClick,a=e.doubleClickZoom,s=[],u=o||a;switch(t.type){case"anyclick":s.push(i),u||s.push(r);break;case"click":u&&s.push(r)}(s=s.filter(Boolean)).length&&((t=n._normalizeEvent(t)).features=n._getFeatures({pos:t.point,radius:n.props.clickRadius}),s.forEach((function(e){return e(t)})))})),Be(t),n._controller=t.controller||new je,n._eventManager=new Oe(null,{touchAction:t.touchAction}),n._updateInteractiveContext({isDragging:!1,eventManager:n._eventManager}),n}return Object(c.a)(e,t),Object(u.a)(e,null,[{key:"supported",value:function(){return Nt.supported()}}]),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this._eventManager,e=this._eventCanvasRef.current;t.setElement(e),t.on({pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerup:this._onPointerUp,pointerleave:this._onEvent.bind(this,"onMouseOut"),click:this._onClick,anyclick:this._onClick,dblclick:this._onEvent.bind(this,"onDblClick"),wheel:this._onEvent.bind(this,"onWheel"),contextmenu:this._onEvent.bind(this,"onContextMenu")}),this._setControllerProps(this.props),this._updateInteractiveContext({mapContainer:e})}},{key:"componentWillUnmount",value:function(){this._eventManager.destroy()}},{key:"_setControllerProps",value:function(t){t=Object.assign({},t,t.viewState,{isInteractive:Boolean(t.onViewStateChange||t.onViewportChange),onViewportChange:this._onViewportChange,onStateChange:this._onInteractionStateChange,eventManager:this._eventManager,width:this._width,height:this._height}),this._controller.setOptions(t);var e=this._interactiveContext;e.onViewportChange=t.onViewportChange,e.onViewStateChange=t.onViewStateChange}},{key:"_getFeatures",value:function(t){var e,n=t.pos,r=t.radius,i={},o=this.getMap();if(this.props.interactiveLayerIds&&(i.layers=this.props.interactiveLayerIds),r){var a=r,s=[[n[0]-a,n[1]+a],[n[0]+a,n[1]-a]];e=o&&o.queryRenderedFeatures(s,i)}else e=o&&o.queryRenderedFeatures(n,i);return e}},{key:"_updateInteractiveContext",value:function(t){this._interactiveContext=Object.assign({},this._interactiveContext,t)}},{key:"_normalizeEvent",value:function(t){if(t.lngLat)return t;var e=t.offsetCenter,n=[e.x,e.y],r=new Z(Object.assign({},this.props,{width:this._width,height:this._height}));return t.point=n,t.lngLat=r.unproject(n),t}},{key:"render",value:function(){this._setControllerProps(this.props);var t=this.props,e=t.width,n=t.height,i=t.style,o=t.getCursor,a=Object.assign({position:"relative"},i,{width:e,height:n,cursor:o(this.state)});return p.a.createElement(It.Provider,{value:this._interactiveContext},p.a.createElement("div",{key:"event-canvas",ref:this._eventCanvasRef,style:a},p.a.createElement(Nt,r({},this.props,{width:"100%",height:"100%",style:null,onResize:this._onResize,onLoad:this._onLoad,ref:this._staticMapRef}),this.props.children)))}}]),e}(h.PureComponent);Object(l.a)(qe,"propTypes",Ue),Object(l.a)(qe,"defaultProps",Ve);var We={type:d.a.string.isRequired,id:d.a.string},Ge=0,He=function(t){function e(t){var n;return Object(i.a)(this,e),n=Object(o.a)(this,Object(a.a)(e).call(this,t)),Object(l.a)(Object(s.a)(n),"id",void 0),Object(l.a)(Object(s.a)(n),"type",void 0),Object(l.a)(Object(s.a)(n),"_map",null),Object(l.a)(Object(s.a)(n),"_sourceOptions",{}),Object(l.a)(Object(s.a)(n),"_updateSource",(function(){var t=Object(s.a)(n),e=t.type,r=t._map;if(r){var i=Object(s.a)(n),o=i._sourceOptions,a=i.props;ct(!a.id||a.id===n.id,"source id changed"),ct(a.type===e,"source type changed");var u=null,c=0;for(var l in a)"children"!==l&&"id"!==l&&o[l]!==a[l]&&(o[l]=a[l],u=l,c++);var h=n.getSource();h?c&&("geojson"===e?h.setData(o.data):"image"===e?h.updateImage({url:o.url,coordinates:o.coordinates}):"canvas"!==e&&"video"!==e||1!==c||"coordinates"!==u?(r.removeSource(n.id),r.addSource(n.id,o)):h.setCoordinates(o.coordinates)):n._createSource(o)}})),n.id=t.id||"jsx-source-".concat(Ge++),n.type=t.type,n}return Object(c.a)(e,t),Object(u.a)(e,[{key:"componentWillUnmount",value:function(){var t=this,e=this._map;e&&(e.off("styledata",this._updateSource),e.style&&requestAnimationFrame((function(){return e.removeSource(t.id)})))}},{key:"getSource",value:function(){var t=this._map;return t&&t.style&&t.getSource(this.id)}},{key:"_createSource",value:function(t){var e=this._map;e.style&&e.style._loaded&&e.addSource(this.id,t)}},{key:"_render",value:function(t){var e=this;return this._map||(this._map=t.map,this._map.on("styledata",this._updateSource)),this._updateSource(),p.a.Children.map(this.props.children,(function(t){return Object(h.cloneElement)(t,{source:e.id})}))}},{key:"render",value:function(){return p.a.createElement(It.Consumer,null,this._render.bind(this))}}]),e}(h.PureComponent);function Ke(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}Object(l.a)(He,"propTypes",We);var Qe=n(24);function Xe(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!Xe(t[n],e[n]))return!1;return!0}if(Array.isArray(e))return!1;if("object"===Object(Qe.a)(t)&&"object"===Object(Qe.a)(e)){var r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(var o=0,a=r;o<a.length;o++){var s=a[o];if(!e.hasOwnProperty(s))return!1;if(!Xe(t[s],e[s]))return!1}return!0}return!1}var Ye={type:d.a.string.isRequired,id:d.a.string,source:d.a.string,beforeId:d.a.string};var Ze=0,Je=function(t){function e(t){var n;return Object(i.a)(this,e),n=Object(o.a)(this,Object(a.a)(e).call(this,t)),Object(l.a)(Object(s.a)(n),"id",void 0),Object(l.a)(Object(s.a)(n),"type",void 0),Object(l.a)(Object(s.a)(n),"_map",null),Object(l.a)(Object(s.a)(n),"_layerOptions",{}),Object(l.a)(Object(s.a)(n),"_updateLayer",(function(){var t=n._map;if(t){var e=Object(s.a)(n),r=e.props,i=e._layerOptions;if(ct(!r.id||r.id===n.id,"layer id changed"),ct(r.type===n.type,"layer type changed"),n.getLayer())try{!function(t,e,n,r){var i=n.layout,o=void 0===i?{}:i,a=n.paint,s=void 0===a?{}:a,u=n.filter,c=n.minzoom,l=n.maxzoom,h=n.beforeId,p=Ke(n,["layout","paint","filter","minzoom","maxzoom","beforeId"]);if(h!==r.beforeId&&t.moveLayer(e,h),o!==r.layout)for(var f in o)Xe(o[f],r.layout[f])||t.setLayoutProperty(e,f,o[f]);if(s!==r.paint)for(var d in s)Xe(s[d],r.paint[d])||t.setPaintProperty(e,d,s[d]);for(var m in Xe(u,r.filter)||t.setFilter(e,u),c===r.minzoom&&l===r.maxzoom||t.setLayerZoomRange(e,c,l),p)Xe(p[m],r[m])||t.setLayerProperty(e,m,p[m])}(t,n.id,r,i),Object.assign(i,r)}catch(o){console.warn(o)}else n._createLayer()}})),n.id=t.id||"jsx-layer-".concat(Ze++),n.type=t.type,n}return Object(c.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){this._updateLayer()}},{key:"componentDidUpdate",value:function(){this._updateLayer()}},{key:"componentWillUnmount",value:function(){var t=this._map;t&&(t.off("styledata",this._updateLayer),t.style&&t.removeLayer(this.id))}},{key:"getLayer",value:function(){var t=this._map;return t&&t.style&&t.getLayer(this.id)}},{key:"_createLayer",value:function(){var t=this._map;if(t.style&&t.style._loaded){var e=Object.assign({},this.props);e.id=this.id,delete e.beforeId,t.addLayer(e,this.props.beforeId),this._layerOptions=e}}},{key:"_render",value:function(t){return this._map||(this._map=t.map,this._map.on("styledata",this._updateLayer)),null}},{key:"render",value:function(){return p.a.createElement(It.Consumer,null,this._render.bind(this))}}]),e}(h.PureComponent);Object(l.a)(Je,"propTypes",Ye);var $e={captureScroll:d.a.bool,captureDrag:d.a.bool,captureClick:d.a.bool,captureDoubleClick:d.a.bool},tn=function(t){function e(){var t,n;Object(i.a)(this,e);for(var r=arguments.length,u=new Array(r),c=0;c<r;c++)u[c]=arguments[c];return n=Object(o.a)(this,(t=Object(a.a)(e)).call.apply(t,[this].concat(u))),Object(l.a)(Object(s.a)(n),"_context",{}),Object(l.a)(Object(s.a)(n),"_events",null),Object(l.a)(Object(s.a)(n),"_containerRef",Object(h.createRef)()),Object(l.a)(Object(s.a)(n),"_onScroll",(function(t){n.props.captureScroll&&t.stopPropagation()})),Object(l.a)(Object(s.a)(n),"_onDragStart",(function(t){n.props.captureDrag&&t.stopPropagation()})),Object(l.a)(Object(s.a)(n),"_onDblClick",(function(t){n.props.captureDoubleClick&&t.stopPropagation()})),Object(l.a)(Object(s.a)(n),"_onClick",(function(t){n.props.captureClick&&t.stopPropagation()})),n}return Object(c.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this._containerRef.current;if(t){var e=this._context.eventManager;e&&(this._events={wheel:this._onScroll,panstart:this._onDragStart,anyclick:this._onClick,click:this._onClick,dblclick:this._onDblClick},e.on(this._events,t))}}},{key:"componentWillUnmount",value:function(){var t=this._context.eventManager;t&&this._events&&t.off(this._events)}},{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){var t=this;return p.a.createElement(It.Consumer,null,(function(e){return t._context=e,t._render()}))}}]),e}(h.PureComponent);function en(t,e,n){return(en="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Object(a.a)(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}Object(l.a)(tn,"propTypes",$e),Object(l.a)(tn,"defaultProps",{captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0});var nn=Object.assign({},tn.propTypes,{draggable:d.a.bool,onDrag:d.a.func,onDragEnd:d.a.func,onDragStart:d.a.func,offsetLeft:d.a.number,offsetTop:d.a.number}),rn=Object.assign({},tn.defaultProps,{draggable:!1,offsetLeft:0,offsetTop:0}),on=function(t){function e(){var t,n;Object(i.a)(this,e);for(var r=arguments.length,u=new Array(r),c=0;c<r;c++)u[c]=arguments[c];return n=Object(o.a)(this,(t=Object(a.a)(e)).call.apply(t,[this].concat(u))),Object(l.a)(Object(s.a)(n),"state",{dragPos:null,dragOffset:null}),Object(l.a)(Object(s.a)(n),"_dragEvents",null),Object(l.a)(Object(s.a)(n),"_onDragStart",(function(t){var e=n.props,r=e.draggable,i=e.captureDrag;if((r||i)&&t.stopPropagation(),r){var o=n._getDragEventPosition(t),a=n._getDragEventOffset(t);n.setState({dragPos:o,dragOffset:a}),n._setupDragEvents();var s=n.props.onDragStart;if(s&&a){var u=Object.assign({},t);u.lngLat=n._getDragLngLat(o,a),s(u)}}})),Object(l.a)(Object(s.a)(n),"_onDrag",(function(t){t.stopPropagation();var e=n._getDragEventPosition(t);n.setState({dragPos:e});var r=n.props.onDrag,i=n.state.dragOffset;if(r&&i){var o=Object.assign({},t);o.lngLat=n._getDragLngLat(e,i),r(o)}})),Object(l.a)(Object(s.a)(n),"_onDragEnd",(function(t){var e=n.state,r=e.dragPos,i=e.dragOffset;t.stopPropagation(),n.setState({dragPos:null,dragOffset:null}),n._removeDragEvents();var o=n.props.onDragEnd;if(o&&r&&i){var a=Object.assign({},t);a.lngLat=n._getDragLngLat(r,i),o(a)}})),Object(l.a)(Object(s.a)(n),"_onDragCancel",(function(t){t.stopPropagation(),n.setState({dragPos:null,dragOffset:null}),n._removeDragEvents()})),n}return Object(c.a)(e,t),Object(u.a)(e,[{key:"componentWillUnmount",value:function(){en(Object(a.a)(e.prototype),"componentWillUnmount",this).call(this),this._removeDragEvents()}},{key:"_setupDragEvents",value:function(){var t=this._context.eventManager;t&&(this._dragEvents={panmove:this._onDrag,panend:this._onDragEnd,pancancel:this._onDragCancel},t.on(this._dragEvents))}},{key:"_removeDragEvents",value:function(){var t=this._context.eventManager;t&&this._dragEvents&&(t.off(this._dragEvents),this._dragEvents=null)}},{key:"_getDragEventPosition",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"_getDragEventOffset",value:function(t){var e=t.center,n=e.x,r=e.y,i=this._containerRef.current;if(i){var o=i.getBoundingClientRect();return[o.left-n,o.top-r]}return null}},{key:"_getDraggedPosition",value:function(t,e){return[t[0]+e[0],t[1]+e[1]]}},{key:"_getDragLngLat",value:function(t,e){var n=this.props,r=n.offsetLeft,i=n.offsetTop,o=this._getDraggedPosition(t,e),a=Object(_.a)(o,2),s=a[0],u=a[1];return this._context.viewport.unproject([s-r,u-i])}}]),e}(tn);Object(l.a)(on,"propTypes",nn),Object(l.a)(on,"defaultProps",rn);var an=Object.assign({},on.propTypes,{className:d.a.string,longitude:d.a.number.isRequired,latitude:d.a.number.isRequired}),sn=Object.assign({},on.defaultProps,{className:""}),un=function(t){function e(){var t,n;Object(i.a)(this,e);for(var r=arguments.length,u=new Array(r),c=0;c<r;c++)u[c]=arguments[c];return n=Object(o.a)(this,(t=Object(a.a)(e)).call.apply(t,[this].concat(u))),Object(l.a)(Object(s.a)(n),"_control",null),n}return Object(c.a)(e,t),Object(u.a)(e,[{key:"_getPosition",value:function(){var t=this.props,e=t.longitude,n=t.latitude,r=t.offsetLeft,i=t.offsetTop,o=this.state,a=o.dragPos,s=o.dragOffset;if(a&&s)return this._getDraggedPosition(a,s);var u=this._context.viewport.project([e,n]),c=Object(_.a)(u,2),l=c[0],h=c[1];return[l+=r,h+=i]}},{key:"_render",value:function(){var t=this._getPosition(),e=Object(_.a)(t,2),n=e[0],r=e[1],i="translate(".concat(n,"px, ").concat(r,"px)"),o=this._containerRef.current;if(this._control&&o)o.style.transform=i;else{var a=this.props,s=a.className,u=a.draggable,c=this.state.dragPos,l={position:"absolute",left:0,top:0,transform:i,cursor:u?c?"grabbing":"grab":"auto"};this._control=p.a.createElement("div",{className:"mapboxgl-marker ".concat(s),ref:this._containerRef,style:l},this.props.children)}return this._control}},{key:"render",value:function(){return this._control=null,en(Object(a.a)(e.prototype),"render",this).call(this)}}]),e}(on);Object(l.a)(un,"propTypes",an),Object(l.a)(un,"defaultProps",sn);var cn={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},ln=Object.keys(cn);var hn=Object.assign({},tn.propTypes,{className:d.a.string,longitude:d.a.number.isRequired,latitude:d.a.number.isRequired,altitude:d.a.number,offsetLeft:d.a.number,offsetTop:d.a.number,tipSize:d.a.number,closeButton:d.a.bool,closeOnClick:d.a.bool,anchor:d.a.oneOf(Object.keys(cn)),dynamicPosition:d.a.bool,sortByDepth:d.a.bool,onClose:d.a.func}),pn=Object.assign({},tn.defaultProps,{className:"",altitude:0,offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}}),fn=function(t){function e(){var t,n;Object(i.a)(this,e);for(var r=arguments.length,u=new Array(r),c=0;c<r;c++)u[c]=arguments[c];return n=Object(o.a)(this,(t=Object(a.a)(e)).call.apply(t,[this].concat(u))),Object(l.a)(Object(s.a)(n),"_closeOnClick",!1),Object(l.a)(Object(s.a)(n),"_contentRef",Object(h.createRef)()),Object(l.a)(Object(s.a)(n),"_onClick",(function(t){if(n.props.captureClick&&t.stopPropagation(),n.props.closeOnClick||"mapboxgl-popup-close-button"===t.target.className){n.props.onClose();var e=n._context.eventManager;e&&e.once("click",(function(t){return t.stopPropagation()}),t.target)}})),n}return Object(c.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){en(Object(a.a)(e.prototype),"componentDidMount",this).call(this),this.forceUpdate()}},{key:"_getPosition",value:function(t,e){var n=this._context.viewport,r=this.props,i=r.anchor,o=r.dynamicPosition,a=r.tipSize,s=this._contentRef.current;return s&&o?function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.selfWidth,a=t.selfHeight,s=t.anchor,u=t.padding,c=void 0===u?0:u,l=cn[s],h=l.x,p=l.y,f=n-p*a,d=f+a;if(f<c)for(;f<c&&p>=.5;)p-=.5,f+=.5*a;else if(d>i-c)for(;d>i-c&&p<=.5;)p+=.5,d-=.5*a;var m=e-h*o,y=m+o,g=.5;if(.5===p&&(h=Math.floor(h),g=1),m<c)for(;m<c&&h>=g;)h-=g,m+=g*o;else if(y>r-c)for(;y>r-c&&h<=1-g;)h+=g,y-=g*o;return ln.find((function(t){var e=cn[t];return e.x===h&&e.y===p}))||s}({x:t,y:e,anchor:i,padding:a,width:n.width,height:n.height,selfWidth:s.clientWidth,selfHeight:s.clientHeight}):i}},{key:"_getContainerStyle",value:function(t,e,n,r){var i=this._context.viewport,o=this.props,a=o.offsetLeft,s=o.offsetTop,u=o.sortByDepth,c=cn[r],l=t+a,h=e+s,p={position:"absolute",transform:"\n        translate(".concat(100*-c.x,"%, ").concat(100*-c.y,"%)\n        translate(").concat(l,"px, ").concat(h,"px)\n      "),display:void 0,zIndex:void 0};return u?(n>1||n<-1||t<0||t>i.width||e<0||e>i.height?p.display="none":p.zIndex=Math.floor((1-n)/2*1e5),p):p}},{key:"_renderTip",value:function(t){var e=this.props.tipSize;return p.a.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:e}})}},{key:"_renderContent",value:function(){var t=this.props,e=t.closeButton,n=t.children,r=this._context.eventManager?null:this._onClick;return p.a.createElement("div",{key:"content",ref:this._contentRef,className:"mapboxgl-popup-content",onClick:r},e&&p.a.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button"},"\xd7"),n)}},{key:"_render",value:function(){var t=this.props,e=t.className,n=t.longitude,r=t.latitude,i=t.altitude,o=this._context.viewport.project([n,r,i]),a=Object(_.a)(o,3),s=a[0],u=a[1],c=a[2],l=this._getPosition(s,u),h=this._getContainerStyle(s,u,c,l);return p.a.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(l," ").concat(e),style:h,ref:this._containerRef},this._renderTip(l),this._renderContent())}}]),e}(tn);Object(l.a)(fn,"propTypes",hn),Object(l.a)(fn,"defaultProps",pn);var dn,mn=n(14),yn=Object.assign({},tn.propTypes,{className:d.a.string,container:d.a.object}),gn=Object.assign({},tn.defaultProps,{className:"",container:null}),vn=function(t){function e(){var t,n;Object(i.a)(this,e);for(var r=arguments.length,u=new Array(r),c=0;c<r;c++)u[c]=arguments[c];return n=Object(o.a)(this,(t=Object(a.a)(e)).call.apply(t,[this].concat(u))),Object(l.a)(Object(s.a)(n),"state",{isFullscreen:!1,showButton:!1}),Object(l.a)(Object(s.a)(n),"_mapboxFullscreenControl",null),Object(l.a)(Object(s.a)(n),"_onFullscreenChange",(function(){var t=!n._mapboxFullscreenControl._fullscreen;n._mapboxFullscreenControl._fullscreen=t,n.setState({isFullscreen:t})})),Object(l.a)(Object(s.a)(n),"_onClickFullscreen",(function(){n._mapboxFullscreenControl._onClickFullscreen()})),n}return Object(c.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this.props.container||this._context.mapContainer;this._mapboxFullscreenControl=new et.a.FullscreenControl({container:t}),this.setState({showButton:this._mapboxFullscreenControl._checkFullscreenSupport()}),mn.a.addEventListener(this._mapboxFullscreenControl._fullscreenchange,this._onFullscreenChange)}},{key:"componentWillUnmount",value:function(){mn.a.removeEventListener(this._mapboxFullscreenControl._fullscreenchange,this._onFullscreenChange)}},{key:"_renderButton",value:function(t,e,n){return p.a.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:n})}},{key:"_render",value:function(){if(!this.state.showButton)return null;var t=this.props.className,e=this.state.isFullscreen?"shrink":"fullscreen";return p.a.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(t),ref:this._containerRef},this._renderButton(e,"Toggle fullscreen",this._onClickFullscreen))}}]),e}(tn);Object(l.a)(vn,"propTypes",yn),Object(l.a)(vn,"defaultProps",gn);var _n=Object.assign({},Vt.defaultProps,{transitionDuration:500}),bn=function(){},wn=Object.assign({},tn.propTypes,{className:d.a.string,style:d.a.object,label:d.a.string,positionOptions:d.a.object,fitBoundsOptions:d.a.object,trackUserLocation:d.a.bool,showUserLocation:d.a.bool,onViewStateChange:d.a.func,onViewportChange:d.a.func}),xn=Object.assign({},tn.defaultProps,{className:"",style:{},label:"Geolocate",positionOptions:null,fitBoundsOptions:null,trackUserLocation:!1,showUserLocation:!0}),En=function(t){function e(){var t,n;Object(i.a)(this,e);for(var r=arguments.length,u=new Array(r),c=0;c<r;c++)u[c]=arguments[c];return n=Object(o.a)(this,(t=Object(a.a)(e)).call.apply(t,[this].concat(u))),Object(l.a)(Object(s.a)(n),"state",{supportsGeolocation:!1,markerPosition:null}),Object(l.a)(Object(s.a)(n),"_mapboxGeolocateControl",null),Object(l.a)(Object(s.a)(n),"_geolocateButtonRef",Object(h.createRef)()),Object(l.a)(Object(s.a)(n),"_setupMapboxGeolocateControl",(function(t){if(t){var e={showUserLocation:!1};["positionOptions","fitBoundsOptions","trackUserLocation"].forEach((function(t){t in n.props&&null!==n.props[t]&&(e[t]=n.props[t])})),n._mapboxGeolocateControl=new et.a.GeolocateControl(e),n._mapboxGeolocateControl._watchState="OFF",n._mapboxGeolocateControl._geolocateButton=n._geolocateButtonRef.current,n._mapboxGeolocateControl._updateMarker=n._updateMarker,n._mapboxGeolocateControl._updateCamera=n._updateCamera,n._mapboxGeolocateControl._setup=!0}else console.warn("Geolocation support is not available, the GeolocateControl will not be visible.")})),Object(l.a)(Object(s.a)(n),"_onClickGeolocate",(function(){return n._mapboxGeolocateControl._map=n._context.map,n.props.showUserLocation&&(n._mapboxGeolocateControl.on("geolocate",n._updateMarker),n._mapboxGeolocateControl.on("trackuserlocationend",n._updateMarker)),n._mapboxGeolocateControl.trigger()})),Object(l.a)(Object(s.a)(n),"_updateMarker",(function(t){t&&n.setState({markerPosition:t.coords})})),Object(l.a)(Object(s.a)(n),"_getBounds",(function(t){var e=new et.a.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,r=e.toBounds(n);return[[r._ne.lng,r._ne.lat],[r._sw.lng,r._sw.lat]]})),Object(l.a)(Object(s.a)(n),"_updateCamera",(function(t){var e=n._context.viewport,r=n._getBounds(t),i=new Z(e).fitBounds(r),o=i.longitude,a=i.latitude,s=i.zoom,u=Object.assign({},e,{longitude:o,latitude:a,zoom:s}),c=new Ct(u),l=Object.assign({},c.getViewportProps(),_n),h=n.props.onViewportChange||n._context.onViewportChange||bn;(n.props.onViewStateChange||n._context.onViewStateChange||bn)({viewState:l}),h(l)})),Object(l.a)(Object(s.a)(n),"_renderButton",(function(t,e,r){return p.a.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),ref:n._geolocateButtonRef,type:"button",title:e,onClick:r})})),Object(l.a)(Object(s.a)(n),"_renderMarker",(function(){var t=n.state.markerPosition,e=n.props.showUserLocation;return t&&e?p.a.createElement(un,{key:"location-maker",className:"mapboxgl-user-location-dot",longitude:t.longitude,latitude:t.latitude,onContextMenu:function(t){return t.preventDefault()},captureDrag:!1,captureDoubleClick:!1}):null})),n}return Object(c.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this;(void 0!==dn?Promise.resolve(dn):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((function(t){return dn="denied"!==t.state})):(dn=Boolean(window.navigator.geolocation),Promise.resolve(dn))).then((function(e){t.setState({supportsGeolocation:e}),t._setupMapboxGeolocateControl(e)}))}},{key:"componentWillUnmount",value:function(){if(this._mapboxGeolocateControl){var t=this._mapboxGeolocateControl._geolocationWatchID;void 0!==t&&(window.navigator.geolocation.clearWatch(t),this._mapboxGeolocateControl._geolocationWatchID=void 0)}}},{key:"_render",value:function(){if(!this.state.supportsGeolocation)return null;var t=this.props,e=t.className,n=t.style,r=t.label;return p.a.createElement("div",null,this._renderMarker(),p.a.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(e),ref:this._containerRef,style:n,onContextMenu:function(t){return t.preventDefault()}},this._renderButton("geolocate",r,this._onClickGeolocate)))}}]),e}(tn);Object(l.a)(En,"propTypes",wn),Object(l.a)(En,"defaultProps",xn);var Tn=function(){},Sn=Object.assign({},tn.propTypes,{className:d.a.string,onViewStateChange:d.a.func,onViewportChange:d.a.func,showCompass:d.a.bool,showZoom:d.a.bool,zoomInLabel:d.a.string,zoomOutLabel:d.a.string,compassLabel:d.a.string}),Cn=Object.assign({},tn.defaultProps,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"}),In=function(t){function e(t){var n;return Object(i.a)(this,e),n=Object(o.a)(this,Object(a.a)(e).call(this,t)),Object(l.a)(Object(s.a)(n),"_onZoomIn",(function(){n._updateViewport({zoom:n._context.viewport.zoom+1})})),Object(l.a)(Object(s.a)(n),"_onZoomOut",(function(){n._updateViewport({zoom:n._context.viewport.zoom-1})})),Object(l.a)(Object(s.a)(n),"_onResetNorth",(function(){n._updateViewport({bearing:0,pitch:0})})),Be(t),n}return Object(c.a)(e,t),Object(u.a)(e,[{key:"_updateViewport",value:function(t){var e=this._context.viewport,n=new Ct(Object.assign({},e,t)),r=Object.assign({},n.getViewportProps(),De),i=this.props.onViewportChange||this._context.onViewportChange||Tn;(this.props.onViewStateChange||this._context.onViewStateChange||Tn)({viewState:r}),i(r)}},{key:"_renderCompass",value:function(){var t=this._context.viewport.bearing;return p.a.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:{transform:"rotate(".concat(-t,"deg)")}})}},{key:"_renderButton",value:function(t,e,n,r){return p.a.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:n},r)}},{key:"_render",value:function(){var t=this.props,e=t.className,n=t.showCompass,r=t.showZoom,i=t.zoomInLabel,o=t.zoomOutLabel,a=t.compassLabel;return p.a.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(e),ref:this._containerRef},r&&this._renderButton("zoom-in",i,this._onZoomIn),r&&this._renderButton("zoom-out",o,this._onZoomOut),n&&this._renderButton("compass",a,this._onResetNorth,this._renderCompass()))}}]),e}(tn);Object(l.a)(In,"propTypes",Sn),Object(l.a)(In,"defaultProps",Cn);var kn=Object.assign({},tn.propTypes,{redraw:d.a.func.isRequired}),An=function(t){function e(){var t,n;Object(i.a)(this,e);for(var r=arguments.length,u=new Array(r),c=0;c<r;c++)u[c]=arguments[c];return n=Object(o.a)(this,(t=Object(a.a)(e)).call.apply(t,[this].concat(u))),Object(l.a)(Object(s.a)(n),"_canvas",void 0),Object(l.a)(Object(s.a)(n),"_ctx",void 0),Object(l.a)(Object(s.a)(n),"_redraw",(function(){var t=n._ctx;if(t){var e=mn.b.devicePixelRatio||1;t.save(),t.scale(e,e);var r=n._context,i=r.viewport,o=r.isDragging;n.props.redraw({width:i.width,height:i.height,ctx:t,isDragging:o,project:i.project.bind(i),unproject:i.unproject.bind(i)}),t.restore()}})),n}return Object(c.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this._containerRef.current;t&&(this._canvas=t,this._ctx=t.getContext("2d")),this._redraw()}},{key:"_render",value:function(){var t=mn.b.devicePixelRatio||1,e=this._context.viewport,n=e.width,r=e.height;return this._redraw(),p.a.createElement("canvas",{ref:this._containerRef,width:n*t,height:r*t,style:{width:"".concat(n,"px"),height:"".concat(r,"px"),position:"absolute",left:0,top:0}})}}]),e}(tn);Object(l.a)(An,"propTypes",kn),Object(l.a)(An,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1});var On=Object.assign({},tn.propTypes,{redraw:d.a.func.isRequired,style:d.a.object}),Pn=function(t){function e(){return Object(i.a)(this,e),Object(o.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(c.a)(e,t),Object(u.a)(e,[{key:"_render",value:function(){var t=this._context,e=t.viewport,n=t.isDragging,r=Object.assign({position:"absolute",left:0,top:0,width:e.width,height:e.height},this.props.style);return p.a.createElement("div",{ref:this._containerRef,style:r},this.props.redraw({width:e.width,height:e.height,isDragging:n,project:e.project.bind(e),unproject:e.unproject.bind(e)}))}}]),e}(tn);Object(l.a)(Pn,"propTypes",On),Object(l.a)(Pn,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1});var Dn=Object.assign({},tn.propTypes,{redraw:d.a.func.isRequired,style:d.a.object}),Mn=function(t){function e(){return Object(i.a)(this,e),Object(o.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(c.a)(e,t),Object(u.a)(e,[{key:"_render",value:function(){var t=this._context,e=t.viewport,n=t.isDragging,r=Object.assign({position:"absolute",left:0,top:0},this.props.style);return p.a.createElement("svg",{width:e.width,height:e.height,ref:this._containerRef,style:r},this.props.redraw({width:e.width,height:e.height,isDragging:n,project:e.project.bind(e),unproject:e.unproject.bind(e)}))}}]),e}(tn);Object(l.a)(Mn,"propTypes",Dn),Object(l.a)(Mn,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1}),n.d(e,"b",(function(){return qe})),n.d(e,"a",(function(){return un}))},function(t,e,n){t.exports=function(){"use strict";var t,e,n;function r(r,i){if(t)if(e){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",a={};t(a),(n=i(a)).workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"}))}else e=i;else t=i}return r(0,(function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var n=r;function r(t,e,n,r){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=n,this.p2y=r}r.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},r.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},r.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},r.prototype.solveCurveX=function(t,e){var n,r,i,o,a;for(void 0===e&&(e=1e-6),i=t,a=0;a<8;a++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if((i=t)<(n=0))return n;if(i>(r=1))return r;for(;n<r;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?n=i:r=i,i=.5*(r-n)+n}return i},r.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var i=o;function o(t,e){this.x=t,this.y=e}function a(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!a(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!a(t[r],e[r]))return!1;return!0}return t===e}function s(t,e,r,i){var o=new n(t,e,r,i);return function(t){return o.solve(t)}}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,i=n*this.x+e*this.y;return this.x=r,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.x+n*(this.x-e.x)-r*(this.y-e.y),o=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t};var u=s(.25,.1,.25,1);function c(t,e,n){return Math.min(n,Math.max(e,t))}function l(t,e,n){var r=n-e,i=((t-e)%r+r)%r+e;return i===e?n:i}function h(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var r=0,i=e;r<i.length;r+=1){var o=i[r];for(var a in o)t[a]=o[a]}return t}var p=1;function f(){return p++}function d(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function m(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function y(t,e){t.forEach((function(t){e[t]&&(e[t]=e[t].bind(e))}))}function g(t,e){return-1!==t.indexOf(e,t.length-e.length)}function v(t,e,n){var r={};for(var i in t)r[i]=e.call(n||this,t[i],i,t);return r}function _(t,e,n){var r={};for(var i in t)e.call(n||this,t[i],i,t)&&(r[i]=t[i]);return r}function b(t){return Array.isArray(t)?t.map(b):"object"==typeof t&&t?v(t,b):t}var w={};function x(t){w[t]||("undefined"!=typeof console&&console.warn(t),w[t]=!0)}function E(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function T(t){for(var e=0,n=0,r=t.length,i=r-1,o=void 0,a=void 0;n<r;i=n++)o=t[n],e+=((a=t[i]).x-o.x)*(o.y+a.y);return e}function S(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function C(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(t,n,r,i){var o=r||i;return e[n]=!o||o.toLowerCase(),""})),e["max-age"]){var n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}var I=null;function k(t){if(null==I){var e=t.navigator?t.navigator.userAgent:null;I=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return I}function A(t){try{var e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}var O,P,D,M,R=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),N=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,L=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,F={now:R,frame:function(t){var e=N(t);return{cancel:function(){return L(e)}}},getImageData:function(t,e){void 0===e&&(e=0);var n=self.document.createElement("canvas"),r=n.getContext("2d");if(!r)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,r.drawImage(t,0,0,t.width,t.height),r.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return O||(O=self.document.createElement("a")),O.href=t,O.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==P&&(P=self.matchMedia("(prefers-reduced-motion: reduce)")),P.matches)}},j={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},z={supported:!1,testSupport:function(t){!B&&M&&(U?V(t):D=t)}},B=!1,U=!1;function V(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,M),t.isContextLost())return;z.supported=!0}catch(t){}t.deleteTexture(e),B=!0}self.document&&((M=self.document.createElement("img")).onload=function(){D&&V(D),D=null,U=!0},M.onerror=function(){B=!0,D=null},M.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var q="01",W=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function G(t){return 0===t.indexOf("mapbox:")}W.prototype._createSkuToken=function(){var t=function(){for(var t="",e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",q,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},W.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},W.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},W.prototype.normalizeStyleURL=function(t,e){if(!G(t))return t;var n=X(t);return n.path="/styles/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)},W.prototype.normalizeGlyphsURL=function(t,e){if(!G(t))return t;var n=X(t);return n.path="/fonts/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)},W.prototype.normalizeSourceURL=function(t,e){if(!G(t))return t;var n=X(t);return n.path="/v4/"+n.authority+".json",n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||e)},W.prototype.normalizeSpriteURL=function(t,e,n,r){var i=X(t);return G(t)?(i.path="/styles/v1"+i.path+"/sprite"+e+n,this._makeAPIURL(i,this._customAccessToken||r)):(i.path+=""+e+n,Y(i))},W.prototype.normalizeTileURL=function(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),!e||!G(e))return t;var r=X(t),i=F.devicePixelRatio>=2||512===n?"@2x":"",o=z.supported?".webp":"$1";return r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+i+o),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path,j.REQUIRE_ACCESS_TOKEN&&(j.ACCESS_TOKEN||this._customAccessToken)&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,this._customAccessToken)},W.prototype.canonicalizeTileURL=function(t){var e=X(t);if(!e.path.match(/(^\/v4\/)/)||!e.path.match(/\.[\w]+$/))return t;var n="mapbox://tiles/";n+=e.path.replace("/v4/","");var r=e.params.filter((function(t){return!t.match(/^access_token=/)}));return r.length&&(n+="?"+r.join("&")),n},W.prototype.canonicalizeTileset=function(t,e){if(!G(e))return t.tiles||[];for(var n=[],r=0,i=t.tiles;r<i.length;r+=1){var o=i[r],a=this.canonicalizeTileURL(o);n.push(a)}return n},W.prototype._makeAPIURL=function(t,e){var n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",r=X(j.API_URL);if(t.protocol=r.protocol,t.authority=r.authority,"/"!==r.path&&(t.path=""+r.path+t.path),!j.REQUIRE_ACCESS_TOKEN)return Y(t);if(!(e=e||j.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+n);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+n);return t.params=t.params.filter((function(t){return-1===t.indexOf("access_token")})),t.params.push("access_token="+e),Y(t)};var H=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function K(t){return H.test(t)}var Q=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function X(t){var e=t.match(Q);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Y(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function Z(t){if(!t)return null;var e,n=t.split(".");if(!n||3!==n.length)return null;try{return JSON.parse((e=n[1],decodeURIComponent(self.atob(e).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""))))}catch(t){return null}}var J=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};J.prototype.getStorageKey=function(t){var e,n=Z(j.ACCESS_TOKEN),r="";return n&&n.u?(e=n.u,r=self.btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(Number("0x"+e))})))):r=j.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+r:"mapbox.eventData:"+r},J.prototype.fetchEventData=function(){var t=A("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{var r=self.localStorage.getItem(e);r&&(this.eventData=JSON.parse(r));var i=self.localStorage.getItem(n);i&&(this.anonId=i)}catch(t){x("Unable to read from LocalStorage")}},J.prototype.saveEventData=function(){var t=A("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{self.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){x("Unable to write to LocalStorage")}},J.prototype.processRequests=function(t){},J.prototype.postEvent=function(t,e,n,r){var i=this;if(j.EVENTS_URL){var o=X(j.EVENTS_URL);o.params.push("access_token="+(r||j.ACCESS_TOKEN||""));var a={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.6.1",skuId:q,userId:this.anonId},s=e?h(a,e):a,u={url:Y(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=wt(u,(function(t){i.pendingRequest=null,n(t),i.saveEventData(),i.processRequests(r)}))}},J.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var $,tt,et=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postMapLoadEvent=function(t,e,n,r){this.skuToken=n,(j.EVENTS_URL&&r||j.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return G(t)||K(t)})))&&this.queueRequest({id:e,timestamp:Date.now()},r)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var n=this.queue.shift(),r=n.id,i=n.timestamp;r&&this.success[r]||(this.anonId||this.fetchEventData(),m(this.anonId)||(this.anonId=d()),this.postEvent(i,{skuToken:this.skuToken},(function(t){t||r&&(e.success[r]=!0)}),t))}},e}(J),nt=new(function(t){function e(e){t.call(this,"appUserTurnstile"),this._customAccessToken=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postTurnstileEvent=function(t,e){j.EVENTS_URL&&j.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return G(t)||K(t)}))&&this.queueRequest(Date.now(),e)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var n=Z(j.ACCESS_TOKEN),r=n?n.u:j.ACCESS_TOKEN,i=r!==this.eventData.tokenU;m(this.anonId)||(this.anonId=d(),i=!0);var o=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),s=new Date(o),u=(o-this.eventData.lastSuccess)/864e5;i=i||u>=1||u<-1||a.getDate()!==s.getDate()}else i=!0;if(!i)return this.processRequests();this.postEvent(o,{"enabled.telemetry":!1},(function(t){t||(e.eventData.lastSuccess=o,e.eventData.tokenU=r)}),t)}},e}(J)),rt=nt.postTurnstileEvent.bind(nt),it=new et,ot=it.postMapLoadEvent.bind(it),at="mapbox-tiles",st=500,ut=50,ct=42e4;function lt(){self.caches&&!$&&($=self.caches.open(at))}function ht(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var pt=1/0,ft={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ft);var dt=function(t){function e(e,n,r){401===n&&K(r)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,e),this.status=n,this.url=r,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),mt=S()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href};function yt(t,e){var n,r=new self.AbortController,i=new self.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:mt(),signal:r.signal}),o=!1,a=!1,s=(n=i.url).indexOf("sku=")>0&&K(n);"json"===t.type&&i.headers.set("Accept","application/json");var u=function(n,r,o){if(!a){if(n&&"SecurityError"!==n.message&&x(n),r&&o)return c(r);var u=Date.now();self.fetch(i).then((function(n){if(n.ok){var r=s?n.clone():null;return c(n,r,u)}return e(new dt(n.statusText,n.status,t.url))})).catch((function(t){20!==t.code&&e(new Error(t.message))}))}},c=function(n,r,s){("arrayBuffer"===t.type?n.arrayBuffer():"json"===t.type?n.json():n.text()).then((function(t){a||(r&&s&&function(t,e,n){if(lt(),$){var r={status:e.status,statusText:e.statusText,headers:new self.Headers};e.headers.forEach((function(t,e){return r.headers.set(e,t)}));var i=C(e.headers.get("Cache-Control")||"");i["no-store"]||(i["max-age"]&&r.headers.set("Expires",new Date(n+1e3*i["max-age"]).toUTCString()),new Date(r.headers.get("Expires")).getTime()-n<ct||function(t,e){if(void 0===tt)try{new Response(new ReadableStream),tt=!0}catch(t){tt=!1}tt?e(t.body):t.blob().then(e)}(e,(function(e){var n=new self.Response(e,r);lt(),$&&$.then((function(e){return e.put(ht(t.url),n)})).catch((function(t){return x(t.message)}))})))}}(i,r,s),o=!0,e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((function(t){a||e(new Error(t.message))}))};return s?function(t,e){if(lt(),!$)return e(null);var n=ht(t.url);$.then((function(t){t.match(n).then((function(r){var i=function(t){if(!t)return!1;var e=new Date(t.headers.get("Expires")||0),n=C(t.headers.get("Cache-Control")||"");return e>Date.now()&&!n["no-cache"]}(r);t.delete(n),i&&t.put(n,r.clone()),e(null,r,i)})).catch(e)})).catch(e)}(i,u):u(null,null),{cancel:function(){a=!0,o||r.abort()}}}var gt,vt,_t=function(t,e){if(n=t.url,!(/^file:/.test(n)||/^file:/.test(mt())&&!/^\w+:/.test(n))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return yt(t,e);if(S()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(t,e){var n=new self.XMLHttpRequest;for(var r in n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer"),t.headers)n.setRequestHeader(r,t.headers[r]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){var r=n.response;if("json"===t.type)try{r=JSON.parse(n.response)}catch(t){return e(t)}e(null,r,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else e(new dt(n.statusText,n.status,t.url))},n.send(t.body),{cancel:function(){return n.abort()}}}(t,e)},bt=function(t,e){return _t(h(t,{type:"arrayBuffer"}),e)},wt=function(t,e){return _t(h(t,{method:"POST"}),e)};function xt(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function Et(t,e,n){if(n&&n[t]){var r=n[t].indexOf(e);-1!==r&&n[t].splice(r,1)}}gt=[],vt=0;var Tt=function(t,e){void 0===e&&(e={}),h(this,e),this.type=t},St=function(t){function e(e,n){void 0===n&&(n={}),t.call(this,"error",h({error:e},n))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Tt),Ct=function(){};Ct.prototype.on=function(t,e){return this._listeners=this._listeners||{},xt(t,e,this._listeners),this},Ct.prototype.off=function(t,e){return Et(t,e,this._listeners),Et(t,e,this._oneTimeListeners),this},Ct.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},xt(t,e,this._oneTimeListeners),this},Ct.prototype.fire=function(t,e){"string"==typeof t&&(t=new Tt(t,e||{}));var n=t.type;if(this.listens(n)){t.target=this;for(var r=0,i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];r<i.length;r+=1)i[r].call(this,t);for(var o=0,a=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];o<a.length;o+=1){var s=a[o];Et(n,s,this._oneTimeListeners),s.call(this,t)}var u=this._eventedParent;u&&(h(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),u.fire(t))}else t instanceof St&&console.error(t.error);return this},Ct.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},Ct.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var It={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}},kt=function(t,e,n,r){this.message=(t?t+": ":"")+n,r&&(this.identifier=r),null!=e&&e.__line__&&(this.line=e.__line__)};function At(t){var e=t.key,n=t.value;return n?[new kt(e,n,"constants have been deprecated as of v8")]:[]}function Ot(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var r=0,i=e;r<i.length;r+=1){var o=i[r];for(var a in o)t[a]=o[a]}return t}function Pt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Dt(t){if(Array.isArray(t))return t.map(Dt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var n in t)e[n]=Dt(t[n]);return e}return Pt(t)}var Mt=function(t){function e(e,n){t.call(this,n),this.message=n,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),Rt=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var n=0,r=e;n<r.length;n+=1){var i=r[n],o=i[0],a=i[1];this.bindings[o]=a}};Rt.prototype.concat=function(t){return new Rt(this,t)},Rt.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Rt.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Nt={kind:"null"},Lt={kind:"number"},Ft={kind:"string"},jt={kind:"boolean"},zt={kind:"color"},Bt={kind:"object"},Ut={kind:"value"},Vt={kind:"collator"},qt={kind:"formatted"},Wt={kind:"resolvedImage"};function Gt(t,e){return{kind:"array",itemType:t,N:e}}function Ht(t){if("array"===t.kind){var e=Ht(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var Kt=[Nt,Lt,Ft,jt,zt,qt,Bt,Gt(Ut),Wt];function Qt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Qt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var n=0,r=Kt;n<r.length;n+=1)if(!Qt(r[n],e))return null}return"Expected "+Ht(t)+" but found "+Ht(e)+" instead."}var Xt=e((function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return t<0?0:t>1?1:t}function o(t){return"%"===t[t.length-1]?r(parseFloat(t)/100*255):r(parseInt(t))}function a(t){return"%"===t[t.length-1]?i(parseFloat(t)/100):i(parseFloat(t))}function s(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in n)return n[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var u=i.indexOf("("),c=i.indexOf(")");if(-1!==u&&c+1===i.length){var l=i.substr(0,u),h=i.substr(u+1,c-(u+1)).split(","),p=1;switch(l){case"rgba":if(4!==h.length)return null;p=a(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),p];case"hsla":if(4!==h.length)return null;p=a(h.pop());case"hsl":if(3!==h.length)return null;var f=(parseFloat(h[0])%360+360)%360/360,d=a(h[1]),m=a(h[2]),y=m<=.5?m*(d+1):m+d-m*d,g=2*m-y;return[r(255*s(g,y,f+1/3)),r(255*s(g,y,f)),r(255*s(g,y,f-1/3)),p];default:return null}}return null}}catch(t){}})).parseCSSColor,Yt=function(t,e,n,r){void 0===r&&(r=1),this.r=t,this.g=e,this.b=n,this.a=r};Yt.parse=function(t){if(t){if(t instanceof Yt)return t;if("string"==typeof t){var e=Xt(t);if(e)return new Yt(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},Yt.prototype.toString=function(){var t=this.toArray(),e=t[0],n=t[1],r=t[2],i=t[3];return"rgba("+Math.round(e)+","+Math.round(n)+","+Math.round(r)+","+i+")"},Yt.prototype.toArray=function(){var t=this.r,e=this.g,n=this.b,r=this.a;return 0===r?[0,0,0,0]:[255*t/r,255*e/r,255*n/r,r]},Yt.black=new Yt(0,0,0,1),Yt.white=new Yt(1,1,1,1),Yt.transparent=new Yt(0,0,0,0),Yt.red=new Yt(1,0,0,1);var Zt=function(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Zt.prototype.compare=function(t,e){return this.collator.compare(t,e)},Zt.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Jt=function(t,e,n,r,i){this.text=t,this.image=e,this.scale=n,this.fontStack=r,this.textColor=i},$t=function(t){this.sections=t};$t.fromString=function(t){return new $t([new Jt(t,null,null,null,null)])},$t.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))},$t.factory=function(t){return t instanceof $t?t:$t.fromString(t)},$t.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")},$t.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var r=n[e];if(r.image)t.push(["image",r.image.name]);else{t.push(r.text);var i={};r.fontStack&&(i["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(i["font-scale"]=r.scale),r.textColor&&(i["text-color"]=["rgba"].concat(r.textColor.toArray())),t.push(i)}}return t};var te=function(t){this.name=t.name,this.available=t.available};function ee(t,e,n,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid rgba value ["+[t,e,n,r].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof r?[t,e,n,r]:[t,e,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ne(t){if(null===t)return Nt;if("string"==typeof t)return Ft;if("boolean"==typeof t)return jt;if("number"==typeof t)return Lt;if(t instanceof Yt)return zt;if(t instanceof Zt)return Vt;if(t instanceof $t)return qt;if(t instanceof te)return Wt;if(Array.isArray(t)){for(var e,n=t.length,r=0,i=t;r<i.length;r+=1){var o=ne(i[r]);if(e){if(e===o)continue;e=Ut;break}e=o}return Gt(e||Ut,n)}return Bt}function re(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Yt||t instanceof $t||t instanceof te?t.toString():JSON.stringify(t)}te.prototype.toString=function(){return this.name},te.fromString=function(t){return new te({name:t,available:!1})},te.prototype.serialize=function(){return["image",this.name]};var ie=function(t,e){this.type=t,this.value=e};ie.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!function t(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Yt)return!0;if(e instanceof Zt)return!0;if(e instanceof $t)return!0;if(e instanceof te)return!0;if(Array.isArray(e)){for(var n=0,r=e;n<r.length;n+=1)if(!t(r[n]))return!1;return!0}if("object"==typeof e){for(var i in e)if(!t(e[i]))return!1;return!0}return!1}(t[1]))return e.error("invalid value");var n=t[1],r=ne(n),i=e.expectedType;return"array"!==r.kind||0!==r.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(r=i),new ie(r,n)},ie.prototype.evaluate=function(){return this.value},ie.prototype.eachChild=function(){},ie.prototype.possibleOutputs=function(){return[this.value]},ie.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Yt?["rgba"].concat(this.value.toArray()):this.value instanceof $t?this.value.serialize():this.value};var oe=function(t){this.name="ExpressionEvaluationError",this.message=t};oe.prototype.toJSON=function(){return this.message};var ae={string:Ft,number:Lt,boolean:jt,object:Bt},se=function(t,e){this.type=t,this.args=e};se.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n,r=1,i=t[0];if("array"===i){var o,a;if(t.length>2){var s=t[1];if("string"!=typeof s||!(s in ae)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=ae[s],r++}else o=Ut;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],r++}n=Gt(o,a)}else n=ae[i];for(var u=[];r<t.length;r++){var c=e.parse(t[r],r,Ut);if(!c)return null;u.push(c)}return new se(n,u)},se.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!Qt(this.type,ne(n)))return n;if(e===this.args.length-1)throw new oe("Expected value to be of type "+Ht(this.type)+", but found "+Ht(ne(n))+" instead.")}return null},se.prototype.eachChild=function(t){this.args.forEach(t)},se.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map((function(t){return t.possibleOutputs()})))},se.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);var r=t.N;("number"==typeof r||this.args.length>1)&&e.push(r)}}return e.concat(this.args.map((function(t){return t.serialize()})))};var ue=function(t){this.type=qt,this.sections=t};ue.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");for(var r=[],i=!1,o=1;o<=t.length-1;++o){var a=t[o];if(i&&"object"==typeof a&&!Array.isArray(a)){i=!1;var s=null;if(a["font-scale"]&&!(s=e.parse(a["font-scale"],1,Lt)))return null;var u=null;if(a["text-font"]&&!(u=e.parse(a["text-font"],1,Gt(Ft))))return null;var c=null;if(a["text-color"]&&!(c=e.parse(a["text-color"],1,zt)))return null;var l=r[r.length-1];l.scale=s,l.font=u,l.textColor=c}else{var h=e.parse(t[o],1,Ut);if(!h)return null;var p=h.type.kind;if("string"!==p&&"value"!==p&&"null"!==p&&"resolvedImage"!==p)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,r.push({content:h,scale:null,font:null,textColor:null})}}return new ue(r)},ue.prototype.evaluate=function(t){return new $t(this.sections.map((function(e){var n=e.content.evaluate(t);return ne(n)===Wt?new Jt("",n,null,null,null):new Jt(re(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))},ue.prototype.eachChild=function(t){for(var e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}},ue.prototype.possibleOutputs=function(){return[void 0]},ue.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t.push(r.content.serialize());var i={};r.scale&&(i["font-scale"]=r.scale.serialize()),r.font&&(i["text-font"]=r.font.serialize()),r.textColor&&(i["text-color"]=r.textColor.serialize()),t.push(i)}return t};var ce=function(t){this.type=Wt,this.input=t};ce.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,Ft);return n?new ce(n):e.error("No image name provided.")},ce.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=!1;return t.availableImages&&t.availableImages.indexOf(e)>-1&&(n=!0),new te({name:e,available:n})},ce.prototype.eachChild=function(t){t(this.input)},ce.prototype.possibleOutputs=function(){return[void 0]},ce.prototype.serialize=function(){return["image",this.input.serialize()]};var le={"to-boolean":jt,"to-color":zt,"to-number":Lt,"to-string":Ft},he=function(t,e){this.type=t,this.args=e};he.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");for(var r=le[n],i=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,Ut);if(!a)return null;i.push(a)}return new he(r,i)},he.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,n,r=0,i=this.args;r<i.length;r+=1){if(n=null,(e=i[r].evaluate(t))instanceof Yt)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(n=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":ee(e[0],e[1],e[2],e[3])))return new Yt(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new oe(n||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var a=null,s=0,u=this.args;s<u.length;s+=1){if(null===(a=u[s].evaluate(t)))return 0;var c=Number(a);if(!isNaN(c))return c}throw new oe("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?$t.fromString(re(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?te.fromString(re(this.args[0].evaluate(t))):re(this.args[0].evaluate(t))},he.prototype.eachChild=function(t){this.args.forEach(t)},he.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map((function(t){return t.possibleOutputs()})))},he.prototype.serialize=function(){if("formatted"===this.type.kind)return new ue([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ce(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild((function(e){t.push(e.serialize())})),t};var pe=["Unknown","Point","LineString","Polygon"],fe=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null};fe.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},fe.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?pe[this.feature.type]:this.feature.type:null},fe.prototype.properties=function(){return this.feature&&this.feature.properties||{}},fe.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Yt.parse(t)),e};var de=function(t,e,n,r){this.name=t,this.type=e,this._evaluate=n,this.args=r};de.prototype.evaluate=function(t){return this._evaluate(t,this.args)},de.prototype.eachChild=function(t){this.args.forEach(t)},de.prototype.possibleOutputs=function(){return[void 0]},de.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},de.parse=function(t,e){var n,r=t[0],i=de.definitions[r];if(!i)return e.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter((function(e){var n=e[0];return!Array.isArray(n)||n.length===t.length-1})),u=null,c=0,l=s;c<l.length;c+=1){var h=l[c],p=h[0],f=h[1];u=new be(e.registry,e.path,null,e.scope);for(var d=[],m=!1,y=1;y<t.length;y++){var g=t[y],v=Array.isArray(p)?p[y-1]:p.type,_=u.parse(g,1+d.length,v);if(!_){m=!0;break}d.push(_)}if(!m)if(Array.isArray(p)&&p.length!==d.length)u.error("Expected "+p.length+" arguments, but found "+d.length+" instead.");else{for(var b=0;b<d.length;b++){var w=Array.isArray(p)?p[b]:p.type,x=d[b];u.concat(b+1).checkSubtype(w,x.type)}if(0===u.errors.length)return new de(r,o,f,d)}}if(1===s.length)(n=e.errors).push.apply(n,u.errors);else{for(var E=(s.length?s:a).map((function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(Ht).join(", ")+")":"("+Ht(e.type)+"...)"})).join(" | "),T=[],S=1;S<t.length;S++){var C=e.parse(t[S],1+T.length);if(!C)return null;T.push(Ht(C.type))}e.error("Expected arguments of type "+E+", but found ("+T.join(", ")+") instead.")}return null},de.register=function(t,e){for(var n in de.definitions=e,e)t[n]=de};var me=function(t,e,n){this.type=Vt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e};function ye(t){if(t instanceof de){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}var e=!0;return t.eachChild((function(t){e&&!ye(t)&&(e=!1)})),e}function ge(t){if(t instanceof de&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild((function(t){e&&!ge(t)&&(e=!1)})),e}function ve(t,e){if(t instanceof de&&e.indexOf(t.name)>=0)return!1;var n=!0;return t.eachChild((function(t){n&&!ve(t,e)&&(n=!1)})),n}me.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");var r=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,jt);if(!r)return null;var i=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,jt);if(!i)return null;var o=null;return n.locale&&!(o=e.parse(n.locale,1,Ft))?null:new me(r,i,o)},me.prototype.evaluate=function(t){return new Zt(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},me.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},me.prototype.possibleOutputs=function(){return[void 0]},me.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var _e=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};_e.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var n=t[1];return e.scope.has(n)?new _e(n,e.scope.get(n)):e.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},_e.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},_e.prototype.eachChild=function(){},_e.prototype.possibleOutputs=function(){return[void 0]},_e.prototype.serialize=function(){return["var",this.name]};var be=function(t,e,n,r,i){void 0===e&&(e=[]),void 0===r&&(r=new Rt),void 0===i&&(i=[]),this.registry=t,this.path=e,this.key=e.map((function(t){return"["+t+"]"})).join(""),this.scope=r,this.errors=i,this.expectedType=n};function we(t,e){for(var n,r,i=t.length-1,o=0,a=i,s=0;o<=a;)if(n=t[s=Math.floor((o+a)/2)],r=t[s+1],n<=e){if(s===i||e<r)return s;o=s+1}else{if(!(n>e))throw new oe("Input is not a number.");a=s-1}return 0}be.prototype.parse=function(t,e,n,r,i){return void 0===i&&(i={}),e?this.concat(e,n,r)._parse(t,i):this._parse(t,i)},be.prototype._parse=function(t,e){function n(t,e,n){return"assert"===n?new se(e,[t]):"coerce"===n?new he(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=t[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[r];if(i){var o=i.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=n(o,a,e.typeAnnotation||"coerce");else o=n(o,a,e.typeAnnotation||"assert")}if(!(o instanceof ie)&&"resolvedImage"!==o.type.kind&&function t(e){if(e instanceof _e)return t(e.boundExpression);if(e instanceof de&&"error"===e.name)return!1;if(e instanceof me)return!1;var n=e instanceof he||e instanceof se,r=!0;return e.eachChild((function(e){r=n?r&&t(e):r&&e instanceof ie})),!!r&&ye(e)&&ve(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(o)){var u=new fe;try{o=new ie(o.type,o.evaluate(u))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},be.prototype.concat=function(t,e,n){var r="number"==typeof t?this.path.concat(t):this.path,i=n?this.scope.concat(n):this.scope;return new be(this.registry,r,e||null,i,this.errors)},be.prototype.error=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var r=""+this.key+e.map((function(t){return"["+t+"]"})).join("");this.errors.push(new Mt(r,t))},be.prototype.checkSubtype=function(t,e){var n=Qt(t,e);return n&&this.error(n),n};var xe=function(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var r=0,i=n;r<i.length;r+=1){var o=i[r],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};function Ee(t,e,n){return t*(1-n)+e*n}xe.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var n=e.parse(t[1],1,Lt);if(!n)return null;var r=[],i=null;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var o=1;o<t.length;o+=2){var a=1===o?-1/0:t[o],s=t[o+1],u=o,c=o+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(r.length&&r[r.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var l=e.parse(s,c,i);if(!l)return null;i=i||l.type,r.push([a,l])}return new xe(i,n,r)},xe.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);var i=e.length;return r>=e[i-1]?n[i-1].evaluate(t):n[we(e,r)].evaluate(t)},xe.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},xe.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map((function(t){return t.possibleOutputs()})))},xe.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Te=Object.freeze({__proto__:null,number:Ee,color:function(t,e,n){return new Yt(Ee(t.r,e.r,n),Ee(t.g,e.g,n),Ee(t.b,e.b,n),Ee(t.a,e.a,n))},array:function(t,e,n){return t.map((function(t,r){return Ee(t,e[r],n)}))}}),Se=.95047,Ce=1,Ie=1.08883,ke=4/29,Ae=6/29,Oe=3*Ae*Ae,Pe=Ae*Ae*Ae,De=Math.PI/180,Me=180/Math.PI;function Re(t){return t>Pe?Math.pow(t,1/3):t/Oe+ke}function Ne(t){return t>Ae?t*t*t:Oe*(t-ke)}function Le(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Fe(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function je(t){var e=Fe(t.r),n=Fe(t.g),r=Fe(t.b),i=Re((.4124564*e+.3575761*n+.1804375*r)/Se),o=Re((.2126729*e+.7151522*n+.072175*r)/Ce);return{l:116*o-16,a:500*(i-o),b:200*(o-Re((.0193339*e+.119192*n+.9503041*r)/Ie)),alpha:t.a}}function ze(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,r=isNaN(t.b)?e:e-t.b/200;return e=Ce*Ne(e),n=Se*Ne(n),r=Ie*Ne(r),new Yt(Le(3.2404542*n-1.5371385*e-.4985314*r),Le(-.969266*n+1.8760108*e+.041556*r),Le(.0556434*n-.2040259*e+1.0572252*r),t.alpha)}function Be(t,e,n){var r=e-t;return t+n*(r>180||r<-180?r-360*Math.round(r/360):r)}var Ue={forward:je,reverse:ze,interpolate:function(t,e,n){return{l:Ee(t.l,e.l,n),a:Ee(t.a,e.a,n),b:Ee(t.b,e.b,n),alpha:Ee(t.alpha,e.alpha,n)}}},Ve={forward:function(t){var e=je(t),n=e.l,r=e.a,i=e.b,o=Math.atan2(i,r)*Me;return{h:o<0?o+360:o,c:Math.sqrt(r*r+i*i),l:n,alpha:t.a}},reverse:function(t){var e=t.h*De,n=t.c;return ze({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:Be(t.h,e.h,n),c:Ee(t.c,e.c,n),l:Ee(t.l,e.l,n),alpha:Ee(t.alpha,e.alpha,n)}}},qe=Object.freeze({__proto__:null,lab:Ue,hcl:Ve}),We=function(t,e,n,r,i){this.type=t,this.operator=e,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(var o=0,a=i;o<a.length;o+=1){var s=a[o],u=s[0],c=s[1];this.labels.push(u),this.outputs.push(c)}};function Ge(t,e,n,r){var i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}We.interpolationFactor=function(t,e,r,i){var o=0;if("exponential"===t.name)o=Ge(e,t.base,r,i);else if("linear"===t.name)o=Ge(e,1,r,i);else if("cubic-bezier"===t.name){var a=t.controlPoints;o=new n(a[0],a[1],a[2],a[3]).solve(Ge(e,1,r,i))}return o},We.parse=function(t,e){var n=t[0],r=t[1],i=t[2],o=t.slice(3);if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var a=r[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:a}}else{if("cubic-bezier"!==r[0])return e.error("Unknown interpolation type "+String(r[0]),1,0);var s=r.slice(1);if(4!==s.length||s.some((function(t){return"number"!=typeof t||t<0||t>1})))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(i=e.parse(i,2,Lt)))return null;var u=[],c=null;"interpolate-hcl"===n||"interpolate-lab"===n?c=zt:e.expectedType&&"value"!==e.expectedType.kind&&(c=e.expectedType);for(var l=0;l<o.length;l+=2){var h=o[l],p=o[l+1],f=l+3,d=l+4;if("number"!=typeof h)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',f);if(u.length&&u[u.length-1][0]>=h)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',f);var m=e.parse(p,d,c);if(!m)return null;c=c||m.type,u.push([h,m])}return"number"===c.kind||"color"===c.kind||"array"===c.kind&&"number"===c.itemType.kind&&"number"==typeof c.N?new We(c,n,r,i,u):e.error("Type "+Ht(c)+" is not interpolatable.")},We.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);var i=e.length;if(r>=e[i-1])return n[i-1].evaluate(t);var o=we(e,r),a=e[o],s=e[o+1],u=We.interpolationFactor(this.interpolation,r,a,s),c=n[o].evaluate(t),l=n[o+1].evaluate(t);return"interpolate"===this.operator?Te[this.type.kind.toLowerCase()](c,l,u):"interpolate-hcl"===this.operator?Ve.reverse(Ve.interpolate(Ve.forward(c),Ve.forward(l),u)):Ue.reverse(Ue.interpolate(Ue.forward(c),Ue.forward(l),u))},We.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},We.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map((function(t){return t.possibleOutputs()})))},We.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e};var He=function(t,e){this.type=t,this.args=e};He.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var n=null,r=e.expectedType;r&&"value"!==r.kind&&(n=r);for(var i=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=a[o],u=e.parse(s,1+i.length,n,void 0,{typeAnnotation:"omit"});if(!u)return null;n=n||u.type,i.push(u)}var c=r&&i.some((function(t){return Qt(r,t.type)}));return new He(c?Ut:n,i)},He.prototype.evaluate=function(t){for(var e,n=null,r=0,i=0,o=this.args;i<o.length&&(r++,(n=o[i].evaluate(t))&&n instanceof te&&!n.available&&(e||(e=n.name),n=null,r===this.args.length&&(n=e)),null===n);i+=1);return n},He.prototype.eachChild=function(t){this.args.forEach(t)},He.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map((function(t){return t.possibleOutputs()})))},He.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(e){t.push(e.serialize())})),t};var Ke=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Ke.prototype.evaluate=function(t){return this.result.evaluate(t)},Ke.prototype.eachChild=function(t){for(var e=0,n=this.bindings;e<n.length;e+=1)t(n[e][1]);t(this.result)},Ke.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var n=[],r=1;r<t.length-1;r+=2){var i=t[r];if("string"!=typeof i)return e.error("Expected string, but found "+typeof i+" instead.",r);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);var o=e.parse(t[r+1],r+1);if(!o)return null;n.push([i,o])}var a=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return a?new Ke(n,a):null},Ke.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},Ke.prototype.serialize=function(){for(var t=["let"],e=0,n=this.bindings;e<n.length;e+=1){var r=n[e],i=r[0],o=r[1];t.push(i,o.serialize())}return t.push(this.result.serialize()),t};var Qe=function(t,e,n){this.type=t,this.index=e,this.input=n};Qe.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Lt),r=e.parse(t[2],2,Gt(e.expectedType||Ut));if(!n||!r)return null;var i=r.type;return new Qe(i.itemType,n,r)},Qe.prototype.evaluate=function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new oe("Array index out of bounds: "+e+" < 0.");if(e>=n.length)throw new oe("Array index out of bounds: "+e+" > "+(n.length-1)+".");if(e!==Math.floor(e))throw new oe("Array index must be an integer, but found "+e+" instead.");return n[e]},Qe.prototype.eachChild=function(t){t(this.index),t(this.input)},Qe.prototype.possibleOutputs=function(){return[void 0]},Qe.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Xe=function(t,e){this.type=jt,this.needle=t,this.haystack=e};Xe.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n,r=e.parse(t[1],1,Ut),i=e.parse(t[2],2,Ut);return r&&i?"boolean"!==(n=r.type).kind&&"string"!==n.kind&&"number"!==n.kind&&"null"!==n.kind&&"value"!==n.kind?e.error("Expected first argument to be of type boolean, string, number or null, but found "+Ht(r.type)+" instead"):new Xe(r,i):null},Xe.prototype.evaluate=function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!e||!n)return!1;if(!function(t){return"boolean"==typeof t||"string"==typeof t||"number"==typeof t}(e))throw new oe("Expected first argument to be of type boolean, string or number, but found "+Ht(ne(e))+" instead.");if(!function(t){return Array.isArray(t)||"string"==typeof t}(n))throw new oe("Expected second argument to be of type array or string, but found "+Ht(ne(n))+" instead.");return n.indexOf(e)>=0},Xe.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},Xe.prototype.possibleOutputs=function(){return[!0,!1]},Xe.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ye=function(t,e,n,r,i,o){this.inputType=t,this.type=e,this.input=n,this.cases=r,this.outputs=i,this.otherwise=o};Ye.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var n,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var i={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],u=t[a+1];Array.isArray(s)||(s=[s]);var c=e.concat(a);if(0===s.length)return c.error("Expected at least one branch label.");for(var l=0,h=s;l<h.length;l+=1){var p=h[l];if("number"!=typeof p&&"string"!=typeof p)return c.error("Branch labels must be numbers or strings.");if("number"==typeof p&&Math.abs(p)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof p&&Math.floor(p)!==p)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,ne(p)))return null}else n=ne(p);if(void 0!==i[String(p)])return c.error("Branch labels must be unique.");i[String(p)]=o.length}var f=e.parse(u,a,r);if(!f)return null;r=r||f.type,o.push(f)}var d=e.parse(t[1],1,Ut);if(!d)return null;var m=e.parse(t[t.length-1],t.length-1,r);return m?"value"!==d.type.kind&&e.concat(1).checkSubtype(n,d.type)?null:new Ye(n,r,d,i,o,m):null},Ye.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(ne(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Ye.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Ye.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map((function(t){return t.possibleOutputs()}))).concat(this.otherwise.possibleOutputs())},Ye.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],n=[],r={},i=0,o=Object.keys(this.cases).sort();i<o.length;i+=1){var a=o[i];void 0===(h=r[this.cases[a]])?(r[this.cases[a]]=n.length,n.push([this.cases[a],[a]])):n[h][1].push(a)}for(var s=function(e){return"number"===t.inputType.kind?Number(e):e},u=0,c=n;u<c.length;u+=1){var l=c[u],h=l[0],p=l[1];1===p.length?e.push(s(p[0])):e.push(p.map(s)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var Ze=function(t,e,n){this.type=t,this.branches=e,this.otherwise=n};function Je(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function $e(t,e,n,r){return 0===r.compare(e,n)}function tn(t,e,n){var r="=="!==t&&"!="!==t;return function(){function i(t,e,n){this.type=jt,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return i.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var n=t[0],o=e.parse(t[1],1,Ut);if(!o)return null;if(!Je(n,o.type))return e.concat(1).error('"'+n+"\" comparisons are not supported for type '"+Ht(o.type)+"'.");var a=e.parse(t[2],2,Ut);if(!a)return null;if(!Je(n,a.type))return e.concat(2).error('"'+n+"\" comparisons are not supported for type '"+Ht(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '"+Ht(o.type)+"' and '"+Ht(a.type)+"'.");r&&("value"===o.type.kind&&"value"!==a.type.kind?o=new se(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new se(o.type,[a])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,Vt)))return null}return new i(o,a,s)},i.prototype.evaluate=function(i){var o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(r&&this.hasUntypedArgument){var s=ne(o),u=ne(a);if(s.kind!==u.kind||"string"!==s.kind&&"number"!==s.kind)throw new oe('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+u.kind+") instead.")}if(this.collator&&!r&&this.hasUntypedArgument){var c=ne(o),l=ne(a);if("string"!==c.kind||"string"!==l.kind)return e(i,o,a)}return this.collator?n(i,o,a,this.collator.evaluate(i)):e(i,o,a)},i.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},i.prototype.possibleOutputs=function(){return[!0,!1]},i.prototype.serialize=function(){var e=[t];return this.eachChild((function(t){e.push(t.serialize())})),e},i}()}Ze.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var r=[],i=1;i<t.length-1;i+=2){var o=e.parse(t[i],i,jt);if(!o)return null;var a=e.parse(t[i+1],i+1,n);if(!a)return null;r.push([o,a]),n=n||a.type}var s=e.parse(t[t.length-1],t.length-1,n);return s?new Ze(n,r,s):null},Ze.prototype.evaluate=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var r=n[e],i=r[0],o=r[1];if(i.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},Ze.prototype.eachChild=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var r=n[e],i=r[0],o=r[1];t(i),t(o)}t(this.otherwise)},Ze.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.branches.map((function(t){return t[0],t[1].possibleOutputs()}))).concat(this.otherwise.possibleOutputs())},Ze.prototype.serialize=function(){var t=["case"];return this.eachChild((function(e){t.push(e.serialize())})),t};var en=tn("==",(function(t,e,n){return e===n}),$e),nn=tn("!=",(function(t,e,n){return e!==n}),(function(t,e,n,r){return!$e(0,e,n,r)})),rn=tn("<",(function(t,e,n){return e<n}),(function(t,e,n,r){return r.compare(e,n)<0})),on=tn(">",(function(t,e,n){return e>n}),(function(t,e,n,r){return r.compare(e,n)>0})),an=tn("<=",(function(t,e,n){return e<=n}),(function(t,e,n,r){return r.compare(e,n)<=0})),sn=tn(">=",(function(t,e,n){return e>=n}),(function(t,e,n,r){return r.compare(e,n)>=0})),un=function(t,e,n,r,i){this.type=Ft,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=r,this.maxFractionDigits=i};un.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,Lt);if(!n)return null;var r=t[2];if("object"!=typeof r||Array.isArray(r))return e.error("NumberFormat options argument must be an object.");var i=null;if(r.locale&&!(i=e.parse(r.locale,1,Ft)))return null;var o=null;if(r.currency&&!(o=e.parse(r.currency,1,Ft)))return null;var a=null;if(r["min-fraction-digits"]&&!(a=e.parse(r["min-fraction-digits"],1,Lt)))return null;var s=null;return r["max-fraction-digits"]&&!(s=e.parse(r["max-fraction-digits"],1,Lt))?null:new un(n,i,o,a,s)},un.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},un.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},un.prototype.possibleOutputs=function(){return[void 0]},un.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var cn=function(t){this.type=Lt,this.input=t};cn.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found "+Ht(n.type)+" instead."):new cn(n):null},cn.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new oe("Expected value to be of type string or array, but found "+Ht(ne(e))+" instead.")},cn.prototype.eachChild=function(t){t(this.input)},cn.prototype.possibleOutputs=function(){return[void 0]},cn.prototype.serialize=function(){var t=["length"];return this.eachChild((function(e){t.push(e.serialize())})),t};var ln={"==":en,"!=":nn,">":on,"<":rn,">=":sn,"<=":an,array:se,at:Qe,boolean:se,case:Ze,coalesce:He,collator:me,format:ue,image:ce,in:Xe,interpolate:We,"interpolate-hcl":We,"interpolate-lab":We,length:cn,let:Ke,literal:ie,match:Ye,number:se,"number-format":un,object:se,step:xe,string:se,"to-boolean":he,"to-color":he,"to-number":he,"to-string":he,var:_e};function hn(t,e){var n=e[0],r=e[1],i=e[2],o=e[3];n=n.evaluate(t),r=r.evaluate(t),i=i.evaluate(t);var a=o?o.evaluate(t):1,s=ee(n,r,i,a);if(s)throw new oe(s);return new Yt(n/255*a,r/255*a,i/255*a,a)}function pn(t,e){return t in e}function fn(t,e){var n=e[t];return void 0===n?null:n}function dn(t){return{type:t}}function mn(t){return{result:"success",value:t}}function yn(t){return{result:"error",value:t}}function gn(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function vn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function _n(t){return!!t.expression&&t.expression.interpolated}function bn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function wn(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function xn(t){return t}function En(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function Tn(t,e,n,r,i){return En(typeof n===i?r[n]:void 0,t.default,e.default)}function Sn(t,e,n){if("number"!==bn(n))return En(t.default,e.default);var r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];var i=we(t.stops.map((function(t){return t[0]})),n);return t.stops[i][1]}function Cn(t,e,n){var r=void 0!==t.base?t.base:1;if("number"!==bn(n))return En(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];var o=we(t.stops.map((function(t){return t[0]})),n),a=function(t,e,n,r){var i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(n,r,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],u=t.stops[o+1][1],c=Te[e.type]||xn;if(t.colorSpace&&"rgb"!==t.colorSpace){var l=qe[t.colorSpace];c=function(t,e){return l.reverse(l.interpolate(l.forward(t),l.forward(e),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=s.evaluate.apply(void 0,t),r=u.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==r)return c(n,r,a)}}:c(s,u,a)}function In(t,e,n){return"color"===e.type?n=Yt.parse(n):"formatted"===e.type?n=$t.fromString(n.toString()):"resolvedImage"===e.type?n=te.fromString(n.toString()):bn(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),En(n,t.default,e.default)}de.register(ln,{error:[{kind:"error"},[Ft],function(t,e){var n=e[0];throw new oe(n.evaluate(t))}],typeof:[Ft,[Ut],function(t,e){return Ht(ne(e[0].evaluate(t)))}],"to-rgba":[Gt(Lt,4),[zt],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[zt,[Lt,Lt,Lt],hn],rgba:[zt,[Lt,Lt,Lt,Lt],hn],has:{type:jt,overloads:[[[Ft],function(t,e){return pn(e[0].evaluate(t),t.properties())}],[[Ft,Bt],function(t,e){var n=e[0],r=e[1];return pn(n.evaluate(t),r.evaluate(t))}]]},get:{type:Ut,overloads:[[[Ft],function(t,e){return fn(e[0].evaluate(t),t.properties())}],[[Ft,Bt],function(t,e){var n=e[0],r=e[1];return fn(n.evaluate(t),r.evaluate(t))}]]},"feature-state":[Ut,[Ft],function(t,e){return fn(e[0].evaluate(t),t.featureState||{})}],properties:[Bt,[],function(t){return t.properties()}],"geometry-type":[Ft,[],function(t){return t.geometryType()}],id:[Ut,[],function(t){return t.id()}],zoom:[Lt,[],function(t){return t.globals.zoom}],"heatmap-density":[Lt,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Lt,[],function(t){return t.globals.lineProgress||0}],accumulated:[Ut,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Lt,dn(Lt),function(t,e){for(var n=0,r=0,i=e;r<i.length;r+=1)n+=i[r].evaluate(t);return n}],"*":[Lt,dn(Lt),function(t,e){for(var n=1,r=0,i=e;r<i.length;r+=1)n*=i[r].evaluate(t);return n}],"-":{type:Lt,overloads:[[[Lt,Lt],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)-r.evaluate(t)}],[[Lt],function(t,e){return-e[0].evaluate(t)}]]},"/":[Lt,[Lt,Lt],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)/r.evaluate(t)}],"%":[Lt,[Lt,Lt],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)%r.evaluate(t)}],ln2:[Lt,[],function(){return Math.LN2}],pi:[Lt,[],function(){return Math.PI}],e:[Lt,[],function(){return Math.E}],"^":[Lt,[Lt,Lt],function(t,e){var n=e[0],r=e[1];return Math.pow(n.evaluate(t),r.evaluate(t))}],sqrt:[Lt,[Lt],function(t,e){var n=e[0];return Math.sqrt(n.evaluate(t))}],log10:[Lt,[Lt],function(t,e){var n=e[0];return Math.log(n.evaluate(t))/Math.LN10}],ln:[Lt,[Lt],function(t,e){var n=e[0];return Math.log(n.evaluate(t))}],log2:[Lt,[Lt],function(t,e){var n=e[0];return Math.log(n.evaluate(t))/Math.LN2}],sin:[Lt,[Lt],function(t,e){var n=e[0];return Math.sin(n.evaluate(t))}],cos:[Lt,[Lt],function(t,e){var n=e[0];return Math.cos(n.evaluate(t))}],tan:[Lt,[Lt],function(t,e){var n=e[0];return Math.tan(n.evaluate(t))}],asin:[Lt,[Lt],function(t,e){var n=e[0];return Math.asin(n.evaluate(t))}],acos:[Lt,[Lt],function(t,e){var n=e[0];return Math.acos(n.evaluate(t))}],atan:[Lt,[Lt],function(t,e){var n=e[0];return Math.atan(n.evaluate(t))}],min:[Lt,dn(Lt),function(t,e){return Math.min.apply(Math,e.map((function(e){return e.evaluate(t)})))}],max:[Lt,dn(Lt),function(t,e){return Math.max.apply(Math,e.map((function(e){return e.evaluate(t)})))}],abs:[Lt,[Lt],function(t,e){var n=e[0];return Math.abs(n.evaluate(t))}],round:[Lt,[Lt],function(t,e){var n=e[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Lt,[Lt],function(t,e){var n=e[0];return Math.floor(n.evaluate(t))}],ceil:[Lt,[Lt],function(t,e){var n=e[0];return Math.ceil(n.evaluate(t))}],"filter-==":[jt,[Ft,Ut],function(t,e){var n=e[0],r=e[1];return t.properties()[n.value]===r.value}],"filter-id-==":[jt,[Ut],function(t,e){var n=e[0];return t.id()===n.value}],"filter-type-==":[jt,[Ft],function(t,e){var n=e[0];return t.geometryType()===n.value}],"filter-<":[jt,[Ft,Ut],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i<o}],"filter-id-<":[jt,[Ut],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<i}],"filter->":[jt,[Ft,Ut],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i>o}],"filter-id->":[jt,[Ut],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>i}],"filter-<=":[jt,[Ft,Ut],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i<=o}],"filter-id-<=":[jt,[Ut],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<=i}],"filter->=":[jt,[Ft,Ut],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i>=o}],"filter-id->=":[jt,[Ut],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>=i}],"filter-has":[jt,[Ut],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[jt,[],function(t){return null!==t.id()}],"filter-type-in":[jt,[Gt(Ft)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[jt,[Gt(Ut)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[jt,[Ft,Gt(Ut)],function(t,e){var n=e[0];return e[1].value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[jt,[Ft,Gt(Ut)],function(t,e){var n=e[0],r=e[1];return function(t,e,n,r){for(;n<=r;){var i=n+r>>1;if(e[i]===t)return!0;e[i]>t?r=i-1:n=i+1}return!1}(t.properties()[n.value],r.value,0,r.value.length-1)}],all:{type:jt,overloads:[[[jt,jt],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)&&r.evaluate(t)}],[dn(jt),function(t,e){for(var n=0,r=e;n<r.length;n+=1)if(!r[n].evaluate(t))return!1;return!0}]]},any:{type:jt,overloads:[[[jt,jt],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)||r.evaluate(t)}],[dn(jt),function(t,e){for(var n=0,r=e;n<r.length;n+=1)if(r[n].evaluate(t))return!0;return!1}]]},"!":[jt,[jt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[jt,[Ft],function(t,e){var n=e[0],r=t.globals&&t.globals.isSupportedScript;return!r||r(n.evaluate(t))}],upcase:[Ft,[Ft],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Ft,[Ft],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Ft,dn(Ut),function(t,e){return e.map((function(e){return re(e.evaluate(t))})).join("")}],"resolved-locale":[Ft,[Vt],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var kn=function(t,e){this.expression=t,this._warningHistory={},this._evaluator=new fe,this._defaultValue=e?function(t){return"color"===t.type&&wn(t.default)?new Yt(0,0,0,0):"color"===t.type?Yt.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null};function An(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in ln}function On(t,e){var n=new be(ln,[],e?function(t){var e={color:zt,string:Ft,number:Lt,enum:Ft,boolean:jt,formatted:qt,resolvedImage:Wt};return"array"===t.type?Gt(e[t.value]||Ut,t.length):e[t.type]}(e):void 0),r=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?mn(new kn(r,e)):yn(n.errors)}kn.prototype.evaluateWithoutErrorHandling=function(t,e,n,r,i){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=i,this.expression.evaluate(this._evaluator)},kn.prototype.evaluate=function(t,e,n,r,i){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=i||null;try{var o=this.expression.evaluate(this._evaluator);if(null==o||"number"==typeof o&&o!=o)return this._defaultValue;if(this._enumValues&&!(o in this._enumValues))throw new oe("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(o)+" instead.");return o}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var Pn=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!ge(e.expression)};Pn.prototype.evaluateWithoutErrorHandling=function(t,e,n,r,i){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i)},Pn.prototype.evaluate=function(t,e,n,r,i){return this._styleExpression.evaluate(t,e,n,r,i)};var Dn=function(t,e,n,r){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!ge(e.expression),this.interpolationType=r};function Mn(t,e){if("error"===(t=On(t,e)).result)return t;var n=t.value.expression,r=ye(n);if(!r&&!gn(e))return yn([new Mt("","data expressions not supported")]);var i=ve(n,["zoom"]);if(!i&&!vn(e))return yn([new Mt("","zoom expressions not supported")]);var o=function t(e){var n=null;if(e instanceof Ke)n=t(e.result);else if(e instanceof He)for(var r=0,i=e.args;r<i.length;r+=1){var o=i[r];if(n=t(o))break}else(e instanceof xe||e instanceof We)&&e.input instanceof de&&"zoom"===e.input.name&&(n=e);return n instanceof Mt?n:(e.eachChild((function(e){var r=t(e);r instanceof Mt?n=r:!n&&r?n=new Mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&r&&n!==r&&(n=new Mt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n)}(n);if(!o&&!i)return yn([new Mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof Mt)return yn([o]);if(o instanceof We&&!_n(e))return yn([new Mt("",'"interpolate" expressions cannot be used with this property')]);if(!o)return mn(new Pn(r?"constant":"source",t.value));var a=o instanceof We?o.interpolation:void 0;return mn(new Dn(r?"camera":"composite",t.value,o.labels,a))}Dn.prototype.evaluateWithoutErrorHandling=function(t,e,n,r,i){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i)},Dn.prototype.evaluate=function(t,e,n,r,i){return this._styleExpression.evaluate(t,e,n,r,i)},Dn.prototype.interpolationFactor=function(t,e,n){return this.interpolationType?We.interpolationFactor(this.interpolationType,t,e,n):0};var Rn=function(t,e){this._parameters=t,this._specification=e,Ot(this,function t(e,n){var r,i,o,a="color"===n.type,s=e.stops&&"object"==typeof e.stops[0][0],u=s||void 0!==e.property,c=s||!u,l=e.type||(_n(n)?"exponential":"interval");if(a&&((e=Ot({},e)).stops&&(e.stops=e.stops.map((function(t){return[t[0],Yt.parse(t[1])]}))),e.default?e.default=Yt.parse(e.default):e.default=Yt.parse(n.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!qe[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===l)r=Cn;else if("interval"===l)r=Sn;else if("categorical"===l){r=Tn,i=Object.create(null);for(var h=0,p=e.stops;h<p.length;h+=1){var f=p[h];i[f[0]]=f[1]}o=typeof e.stops[0][0]}else{if("identity"!==l)throw new Error('Unknown function type "'+l+'"');r=In}if(s){for(var d={},m=[],y=0;y<e.stops.length;y++){var g=e.stops[y],v=g[0].zoom;void 0===d[v]&&(d[v]={zoom:v,type:e.type,property:e.property,default:e.default,stops:[]},m.push(v)),d[v].stops.push([g[0].value,g[1]])}for(var _=[],b=0,w=m;b<w.length;b+=1){var x=w[b];_.push([d[x].zoom,t(d[x],n)])}var E={name:"linear"};return{kind:"composite",interpolationType:E,interpolationFactor:We.interpolationFactor.bind(void 0,E),zoomStops:_.map((function(t){return t[0]})),evaluate:function(t,r){var i=t.zoom;return Cn({stops:_,base:e.base},n,i).evaluate(i,r)}}}if(c){var T="exponential"===l?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:We.interpolationFactor.bind(void 0,T),zoomStops:e.stops.map((function(t){return t[0]})),evaluate:function(t){var a=t.zoom;return r(e,n,a,i,o)}}}return{kind:"source",evaluate:function(t,a){var s=a&&a.properties?a.properties[e.property]:void 0;return void 0===s?En(e.default,n.default):r(e,n,s,i,o)}}}(this._parameters,this._specification))};function Nn(t){var e=t.key,n=t.value,r=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],u=bn(n);if("object"!==u)return[new kt(e,n,"object expected, "+u+" found")];for(var c in n){var l=c.split(".")[0],h=r[l]||r["*"],p=void 0;if(i[l])p=i[l];else if(r[l])p=or;else if(i["*"])p=i["*"];else{if(!r["*"]){s.push(new kt(e,n[c],'unknown property "'+c+'"'));continue}p=or}s=s.concat(p({key:(e?e+".":e)+c,value:n[c],valueSpec:h,style:o,styleSpec:a,object:n,objectKey:c},n))}for(var f in r)i[f]||r[f].required&&void 0===r[f].default&&void 0===n[f]&&s.push(new kt(e,n,'missing required property "'+f+'"'));return s}function Ln(t){var e=t.value,n=t.valueSpec,r=t.style,i=t.styleSpec,o=t.key,a=t.arrayElementValidator||or;if("array"!==bn(e))return[new kt(o,e,"array expected, "+bn(e)+" found")];if(n.length&&e.length!==n.length)return[new kt(o,e,"array length "+n.length+" expected, length "+e.length+" found")];if(n["min-length"]&&e.length<n["min-length"])return[new kt(o,e,"array length at least "+n["min-length"]+" expected, length "+e.length+" found")];var s={type:n.value,values:n.values};i.$version<7&&(s.function=n.function),"object"===bn(n.value)&&(s=n.value);for(var u=[],c=0;c<e.length;c++)u=u.concat(a({array:e,arrayIndex:c,value:e[c],valueSpec:s,style:r,styleSpec:i,key:o+"["+c+"]"}));return u}function Fn(t){var e=t.key,n=t.value,r=t.valueSpec,i=bn(n);return"number"===i&&n!=n&&(i="NaN"),"number"!==i?[new kt(e,n,"number expected, "+i+" found")]:"minimum"in r&&n<r.minimum?[new kt(e,n,n+" is less than the minimum value "+r.minimum)]:"maximum"in r&&n>r.maximum?[new kt(e,n,n+" is greater than the maximum value "+r.maximum)]:[]}function jn(t){var e,n,r,i=t.valueSpec,o=Pt(t.value.type),a={},s="categorical"!==o&&void 0===t.value.property,u=!s,c="array"===bn(t.value.stops)&&"array"===bn(t.value.stops[0])&&"object"===bn(t.value.stops[0][0]),l=Nn({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===o)return[new kt(t.key,t.value,'identity function may not have a "stops" property')];var e=[],n=t.value;return e=e.concat(Ln({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===bn(n)&&0===n.length&&e.push(new kt(t.key,n,"array must have at least one stop")),e},default:function(t){return or({key:t.key,value:t.value,valueSpec:i,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===o&&s&&l.push(new kt(t.key,t.value,'missing required property "property"')),"identity"===o||t.value.stops||l.push(new kt(t.key,t.value,'missing required property "stops"')),"exponential"===o&&t.valueSpec.expression&&!_n(t.valueSpec)&&l.push(new kt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(u&&!gn(t.valueSpec)?l.push(new kt(t.key,t.value,"property functions not supported")):s&&!vn(t.valueSpec)&&l.push(new kt(t.key,t.value,"zoom functions not supported"))),"categorical"!==o&&!c||void 0!==t.value.property||l.push(new kt(t.key,t.value,'"property" property is required')),l;function h(t){var e=[],o=t.value,s=t.key;if("array"!==bn(o))return[new kt(s,o,"array expected, "+bn(o)+" found")];if(2!==o.length)return[new kt(s,o,"array length 2 expected, length "+o.length+" found")];if(c){if("object"!==bn(o[0]))return[new kt(s,o,"object expected, "+bn(o[0])+" found")];if(void 0===o[0].zoom)return[new kt(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new kt(s,o,"object stop key must have value")];if(r&&r>Pt(o[0].zoom))return[new kt(s,o[0].zoom,"stop zoom values must appear in ascending order")];Pt(o[0].zoom)!==r&&(r=Pt(o[0].zoom),n=void 0,a={}),e=e.concat(Nn({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Fn,value:p}}))}else e=e.concat(p({key:s+"[0]",value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return An(Dt(o[1]))?e.concat([new kt(s+"[1]",o[1],"expressions are not allowed in function stops.")]):e.concat(or({key:s+"[1]",value:o[1],valueSpec:i,style:t.style,styleSpec:t.styleSpec}))}function p(t,r){var s=bn(t.value),u=Pt(t.value),c=null!==t.value?t.value:r;if(e){if(s!==e)return[new kt(t.key,c,s+" stop domain type must match previous stop domain type "+e)]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new kt(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==o){var l="number expected, "+s+" found";return gn(i)&&void 0===o&&(l+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new kt(t.key,c,l)]}return"categorical"!==o||"number"!==s||isFinite(u)&&Math.floor(u)===u?"categorical"!==o&&"number"===s&&void 0!==n&&u<n?[new kt(t.key,c,"stop domain values must appear in ascending order")]:(n=u,"categorical"===o&&u in a?[new kt(t.key,c,"stop domain values must be unique")]:(a[u]=!0,[])):[new kt(t.key,c,"integer expected, found "+u)]}}function zn(t){var e=("property"===t.expressionContext?Mn:On)(Dt(t.value),t.valueSpec);if("error"===e.result)return e.value.map((function(e){return new kt(""+t.key+e.key,t.value,e.message)}));var n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&-1!==n.possibleOutputs().indexOf(void 0))return[new kt(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!ge(n))return[new kt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!ge(n))return[new kt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!ve(n,["zoom","feature-state"]))return[new kt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!ye(n))return[new kt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Bn(t){var e=t.key,n=t.value,r=t.valueSpec,i=[];return Array.isArray(r.values)?-1===r.values.indexOf(Pt(n))&&i.push(new kt(e,n,"expected one of ["+r.values.join(", ")+"], "+JSON.stringify(n)+" found")):-1===Object.keys(r.values).indexOf(Pt(n))&&i.push(new kt(e,n,"expected one of ["+Object.keys(r.values).join(", ")+"], "+JSON.stringify(n)+" found")),i}function Un(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&Array.isArray(t[2]);case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,n=t.slice(1);e<n.length;e+=1){var r=n[e];if(!Un(r)&&"boolean"!=typeof r)return!1}return!0;default:return!0}}Rn.deserialize=function(t){return new Rn(t._parameters,t._specification)},Rn.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Vn={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function qn(t){if(null==t)return function(){return!0};Un(t)||(t=Gn(t));var e=On(t,Vn);if("error"===e.result)throw new Error(e.value.map((function(t){return t.key+": "+t.message})).join(", "));return function(t,n){return e.value.evaluate(t,n)}}function Wn(t,e){return t<e?-1:t>e?1:0}function Gn(t){if(!t)return!0;var e,n=t[0];return t.length<=1?"any"!==n:"=="===n?Hn(t[1],t[2],"=="):"!="===n?Xn(Hn(t[1],t[2],"==")):"<"===n||">"===n||"<="===n||">="===n?Hn(t[1],t[2],n):"any"===n?(e=t.slice(1),["any"].concat(e.map(Gn))):"all"===n?["all"].concat(t.slice(1).map(Gn)):"none"===n?["all"].concat(t.slice(1).map(Gn).map(Xn)):"in"===n?Kn(t[1],t.slice(2)):"!in"===n?Xn(Kn(t[1],t.slice(2))):"has"===n?Qn(t[1]):"!has"!==n||Xn(Qn(t[1]))}function Hn(t,e,n){switch(t){case"$type":return["filter-type-"+n,e];case"$id":return["filter-id-"+n,e];default:return["filter-"+n,t,e]}}function Kn(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((function(t){return typeof t!=typeof e[0]}))?["filter-in-large",t,["literal",e.sort(Wn)]]:["filter-in-small",t,["literal",e]]}}function Qn(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Xn(t){return["!",t]}function Yn(t){return Un(Dt(t.value))?zn(Ot({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var n=e.value,r=e.key;if("array"!==bn(n))return[new kt(r,n,"array expected, "+bn(n)+" found")];var i,o=e.styleSpec,a=[];if(n.length<1)return[new kt(r,n,"filter array must have at least 1 element")];switch(a=a.concat(Bn({key:r+"[0]",value:n[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),Pt(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===Pt(n[1])&&a.push(new kt(r,n,'"$type" cannot be use with operator "'+n[0]+'"'));case"==":case"!=":3!==n.length&&a.push(new kt(r,n,'filter array for operator "'+n[0]+'" must have 3 elements'));case"in":case"!in":n.length>=2&&"string"!==(i=bn(n[1]))&&a.push(new kt(r+"[1]",n[1],"string expected, "+i+" found"));for(var s=2;s<n.length;s++)i=bn(n[s]),"$type"===Pt(n[1])?a=a.concat(Bn({key:r+"["+s+"]",value:n[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&a.push(new kt(r+"["+s+"]",n[s],"string, number, or boolean expected, "+i+" found"));break;case"any":case"all":case"none":for(var u=1;u<n.length;u++)a=a.concat(t({key:r+"["+u+"]",value:n[u],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=bn(n[1]),2!==n.length?a.push(new kt(r,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"string"!==i&&a.push(new kt(r+"[1]",n[1],"string expected, "+i+" found"))}return a}(t)}function Zn(t,e){var n=t.key,r=t.style,i=t.styleSpec,o=t.value,a=t.objectKey,s=i[e+"_"+t.layerType];if(!s)return[];var u=a.match(/^(.*)-transition$/);if("paint"===e&&u&&s[u[1]]&&s[u[1]].transition)return or({key:n,value:o,valueSpec:i.transition,style:r,styleSpec:i});var c,l=t.valueSpec||s[a];if(!l)return[new kt(n,o,'unknown property "'+a+'"')];if("string"===bn(o)&&gn(l)&&!l.tokens&&(c=/^{([^}]+)}$/.exec(o)))return[new kt(n,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(c[1])+" }`.")];var h=[];return"symbol"===t.layerType&&("text-field"===a&&r&&!r.glyphs&&h.push(new kt(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&wn(Dt(o))&&"identity"===Pt(o.type)&&h.push(new kt(n,o,'"text-font" does not support identity functions'))),h.concat(or({key:t.key,value:o,valueSpec:l,style:r,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:a}))}function Jn(t){return Zn(t,"paint")}function $n(t){return Zn(t,"layout")}function tr(t){var e=[],n=t.value,r=t.key,i=t.style,o=t.styleSpec;n.type||n.ref||e.push(new kt(r,n,'either "type" or "ref" is required'));var a,s=Pt(n.type),u=Pt(n.ref);if(n.id)for(var c=Pt(n.id),l=0;l<t.arrayIndex;l++){var h=i.layers[l];Pt(h.id)===c&&e.push(new kt(r,n.id,'duplicate layer id "'+n.id+'", previously used at line '+h.id.__line__))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach((function(t){t in n&&e.push(new kt(r,n[t],'"'+t+'" is prohibited for ref layers'))})),i.layers.forEach((function(t){Pt(t.id)===u&&(a=t)})),a?a.ref?e.push(new kt(r,n.ref,"ref cannot reference another ref layer")):s=Pt(a.type):e.push(new kt(r,n.ref,'ref layer "'+u+'" not found'));else if("background"!==s)if(n.source){var p=i.sources&&i.sources[n.source],f=p&&Pt(p.type);p?"vector"===f&&"raster"===s?e.push(new kt(r,n.source,'layer "'+n.id+'" requires a raster source')):"raster"===f&&"raster"!==s?e.push(new kt(r,n.source,'layer "'+n.id+'" requires a vector source')):"vector"!==f||n["source-layer"]?"raster-dem"===f&&"hillshade"!==s?e.push(new kt(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===f&&p.lineMetrics||e.push(new kt(r,n,'layer "'+n.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new kt(r,n,'layer "'+n.id+'" must specify a "source-layer"')):e.push(new kt(r,n.source,'source "'+n.source+'" not found'))}else e.push(new kt(r,n,'missing required property "source"'));return e=e.concat(Nn({key:r,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return or({key:r+".type",value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"})},filter:Yn,layout:function(t){return Nn({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return $n(Ot({layerType:s},t))}}})},paint:function(t){return Nn({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return Jn(Ot({layerType:s},t))}}})}}}))}function er(t){var e=t.value,n=t.key,r=t.styleSpec,i=t.style;if(!e.type)return[new kt(n,e,'"type" is required')];var o,a=Pt(e.type);switch(a){case"vector":case"raster":case"raster-dem":return Nn({key:n,value:e,valueSpec:r["source_"+a.replace("-","_")],style:t.style,styleSpec:r});case"geojson":if(o=Nn({key:n,value:e,valueSpec:r.source_geojson,style:i,styleSpec:r}),e.cluster)for(var s in e.clusterProperties){var u=e.clusterProperties[s],c=u[0],l=u[1],h="string"==typeof c?[c,["accumulated"],["get",s]]:c;o.push.apply(o,zn({key:n+"."+s+".map",value:l,expressionContext:"cluster-map"})),o.push.apply(o,zn({key:n+"."+s+".reduce",value:h,expressionContext:"cluster-reduce"}))}return o;case"video":return Nn({key:n,value:e,valueSpec:r.source_video,style:i,styleSpec:r});case"image":return Nn({key:n,value:e,valueSpec:r.source_image,style:i,styleSpec:r});case"canvas":return[new kt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bn({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:r})}}function nr(t){var e=t.value,n=t.styleSpec,r=n.light,i=t.style,o=[],a=bn(e);if(void 0===e)return o;if("object"!==a)return o.concat([new kt("light",e,"object expected, "+a+" found")]);for(var s in e){var u=s.match(/^(.*)-transition$/);o=u&&r[u[1]]&&r[u[1]].transition?o.concat(or({key:s,value:e[s],valueSpec:n.transition,style:i,styleSpec:n})):r[s]?o.concat(or({key:s,value:e[s],valueSpec:r[s],style:i,styleSpec:n})):o.concat([new kt(s,e[s],'unknown property "'+s+'"')])}return o}function rr(t){var e=t.value,n=t.key,r=bn(e);return"string"!==r?[new kt(n,e,"string expected, "+r+" found")]:[]}var ir={"*":function(){return[]},array:Ln,boolean:function(t){var e=t.value,n=t.key,r=bn(e);return"boolean"!==r?[new kt(n,e,"boolean expected, "+r+" found")]:[]},number:Fn,color:function(t){var e=t.key,n=t.value,r=bn(n);return"string"!==r?[new kt(e,n,"color expected, "+r+" found")]:null===Xt(n)?[new kt(e,n,'color expected, "'+n+'" found')]:[]},constants:At,enum:Bn,filter:Yn,function:jn,layer:tr,object:Nn,source:er,light:nr,string:rr,formatted:function(t){return 0===rr(t).length?[]:zn(t)},resolvedImage:function(t){return 0===rr(t).length?[]:zn(t)}};function or(t){var e=t.value,n=t.valueSpec,r=t.styleSpec;return n.expression&&wn(Pt(e))?jn(t):n.expression&&An(Dt(e))?zn(t):n.type&&ir[n.type]?ir[n.type](t):Nn(Ot({},t,{valueSpec:n.type?r[n.type]:n}))}function ar(t){var e=t.value,n=t.key,r=rr(t);return r.length?r:(-1===e.indexOf("{fontstack}")&&r.push(new kt(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new kt(n,e,'"glyphs" url must include a "{range}" token')),r)}function sr(t,e){void 0===e&&(e=It);var n=[];return n=n.concat(or({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:ar,"*":function(){return[]}}})),t.constants&&(n=n.concat(At({key:"constants",value:t.constants,style:t,styleSpec:e}))),ur(n)}function ur(t){return[].concat(t).sort((function(t,e){return t.line-e.line}))}function cr(t){return function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return ur(t.apply(this,e))}}sr.source=cr(er),sr.light=cr(nr),sr.layer=cr(tr),sr.filter=cr(Yn),sr.paintProperty=cr(Jn),sr.layoutProperty=cr($n);var lr=sr,hr=lr.light,pr=lr.paintProperty,fr=lr.layoutProperty;function dr(t,e){var n=!1;if(e&&e.length)for(var r=0,i=e;r<i.length;r+=1){var o=i[r];t.fire(new St(new Error(o.message))),n=!0}return n}var mr=gr,yr=3;function gr(t,e,n){var r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var i=new Int32Array(this.arrayBuffer);t=i[0],e=i[1],n=i[2],this.d=e+2*n;for(var o=0;o<this.d*this.d;o++){var a=i[yr+o],s=i[yr+o+1];r.push(a===s?null:i.subarray(a,s))}var u=i[yr+r.length],c=i[yr+r.length+1];this.keys=i.subarray(u,c),this.bboxes=i.subarray(c),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var l=0;l<this.d*this.d;l++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var h=n/e*t;this.min=-h,this.max=t+h}gr.prototype.insert=function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},gr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},gr.prototype._insertCell=function(t,e,n,r,i,o){this.cells[i].push(o)},gr.prototype.query=function(t,e,n,r,i){var o=this.min,a=this.max;if(t<=o&&e<=o&&a<=n&&a<=r&&!i)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(t,e,n,r,this._queryCell,s,{},i),s},gr.prototype._queryCell=function(t,e,n,r,i,o,a,s){var u=this.cells[i];if(null!==u)for(var c=this.keys,l=this.bboxes,h=0;h<u.length;h++){var p=u[h];if(void 0===a[p]){var f=4*p;(s?s(l[f+0],l[f+1],l[f+2],l[f+3]):t<=l[f+2]&&e<=l[f+3]&&n>=l[f+0]&&r>=l[f+1])?(a[p]=!0,o.push(c[p])):a[p]=!1}}},gr.prototype._forEachCell=function(t,e,n,r,i,o,a,s){for(var u=this._convertToCellCoord(t),c=this._convertToCellCoord(e),l=this._convertToCellCoord(n),h=this._convertToCellCoord(r),p=u;p<=l;p++)for(var f=c;f<=h;f++){var d=this.d*f+p;if((!s||s(this._convertFromCellCoord(p),this._convertFromCellCoord(f),this._convertFromCellCoord(p+1),this._convertFromCellCoord(f+1)))&&i.call(this,t,e,n,r,d,o,a,s))return}},gr.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},gr.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},gr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=yr+this.cells.length+1+1,n=0,r=0;r<this.cells.length;r++)n+=this.cells[r].length;var i=new Int32Array(e+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];i[yr+a]=o,i.set(s,o),o+=s.length}return i[yr+t.length]=o,i.set(this.keys,o),o+=this.keys.length,i[yr+t.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer};var vr=self.ImageData,_r={};function br(t,e,n){void 0===n&&(n={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),_r[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}for(var wr in br("Object",Object),mr.serialize=function(t,e){var n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},mr.deserialize=function(t){return new mr(t.buffer)},br("Grid",mr),br("Color",Yt),br("Error",Error),br("ResolvedImage",te),br("StylePropertyFunction",Rn),br("StyleExpression",kn,{omit:["_evaluator"]}),br("ZoomDependentExpression",Dn),br("ZoomConstantExpression",Pn),br("CompoundExpression",de,{omit:["_evaluate"]}),ln)ln[wr]._classRegistryKey||br("Expression_"+wr,ln[wr]);function xr(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Er(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(xr(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var n=t;return e&&e.push(n.buffer),n}if(t instanceof vr)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var r=[],i=0,o=t;i<o.length;i+=1){var a=o[i];r.push(Er(a,e))}return r}if("object"==typeof t){var s=t.constructor,u=s._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class");var c=s.serialize?s.serialize(t,e):{};if(!s.serialize){for(var l in t)if(t.hasOwnProperty(l)&&!(_r[u].omit.indexOf(l)>=0)){var h=t[l];c[l]=_r[u].shallow.indexOf(l)>=0?h:Er(h,e)}t instanceof Error&&(c.message=t.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==u&&(c.$name=u),c}throw new Error("can't serialize object of type "+typeof t)}function Tr(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||xr(t)||ArrayBuffer.isView(t)||t instanceof vr)return t;if(Array.isArray(t))return t.map(Tr);if("object"==typeof t){var e=t.$name||"Object",n=_r[e].klass;if(!n)throw new Error("can't deserialize unregistered class "+e);if(n.deserialize)return n.deserialize(t);for(var r=Object.create(n.prototype),i=0,o=Object.keys(t);i<o.length;i+=1){var a=o[i];if("$name"!==a){var s=t[a];r[a]=_r[e].shallow.indexOf(a)>=0?s:Tr(s)}}return r}throw new Error("can't deserialize object of type "+typeof t)}var Sr=function(){this.first=!0};Sr.prototype.update=function(t,e){var n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))};var Cr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Ir(t){for(var e=0,n=t;e<n.length;e+=1)if(Ar(n[e].charCodeAt(0)))return!0;return!1}function kr(t){return!Cr.Arabic(t)&&!Cr["Arabic Supplement"](t)&&!Cr["Arabic Extended-A"](t)&&!Cr["Arabic Presentation Forms-A"](t)&&!Cr["Arabic Presentation Forms-B"](t)}function Ar(t){return 746===t||747===t||!(t<4352)&&(!!Cr["Bopomofo Extended"](t)||!!Cr.Bopomofo(t)||!(!Cr["CJK Compatibility Forms"](t)||t>=65097&&t<=65103)||!!Cr["CJK Compatibility Ideographs"](t)||!!Cr["CJK Compatibility"](t)||!!Cr["CJK Radicals Supplement"](t)||!!Cr["CJK Strokes"](t)||!(!Cr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||!!Cr["CJK Unified Ideographs Extension A"](t)||!!Cr["CJK Unified Ideographs"](t)||!!Cr["Enclosed CJK Letters and Months"](t)||!!Cr["Hangul Compatibility Jamo"](t)||!!Cr["Hangul Jamo Extended-A"](t)||!!Cr["Hangul Jamo Extended-B"](t)||!!Cr["Hangul Jamo"](t)||!!Cr["Hangul Syllables"](t)||!!Cr.Hiragana(t)||!!Cr["Ideographic Description Characters"](t)||!!Cr.Kanbun(t)||!!Cr["Kangxi Radicals"](t)||!!Cr["Katakana Phonetic Extensions"](t)||!(!Cr.Katakana(t)||12540===t)||!(!Cr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Cr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||!!Cr["Unified Canadian Aboriginal Syllabics"](t)||!!Cr["Unified Canadian Aboriginal Syllabics Extended"](t)||!!Cr["Vertical Forms"](t)||!!Cr["Yijing Hexagram Symbols"](t)||!!Cr["Yi Syllables"](t)||!!Cr["Yi Radicals"](t))}function Or(t){return!(Ar(t)||function(t){return!(!Cr["Latin-1 Supplement"](t)||167!==t&&169!==t&&174!==t&&177!==t&&188!==t&&189!==t&&190!==t&&215!==t&&247!==t)||!(!Cr["General Punctuation"](t)||8214!==t&&8224!==t&&8225!==t&&8240!==t&&8241!==t&&8251!==t&&8252!==t&&8258!==t&&8263!==t&&8264!==t&&8265!==t&&8273!==t)||!!Cr["Letterlike Symbols"](t)||!!Cr["Number Forms"](t)||!(!Cr["Miscellaneous Technical"](t)||!(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215))||!(!Cr["Control Pictures"](t)||9251===t)||!!Cr["Optical Character Recognition"](t)||!!Cr["Enclosed Alphanumerics"](t)||!!Cr["Geometric Shapes"](t)||!(!Cr["Miscellaneous Symbols"](t)||t>=9754&&t<=9759)||!(!Cr["Miscellaneous Symbols and Arrows"](t)||!(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243))||!!Cr["CJK Symbols and Punctuation"](t)||!!Cr.Katakana(t)||!!Cr["Private Use Area"](t)||!!Cr["CJK Compatibility Forms"](t)||!!Cr["Small Form Variants"](t)||!!Cr["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t}(t))}function Pr(t){return t>=1424&&t<=2303||Cr["Arabic Presentation Forms-A"](t)||Cr["Arabic Presentation Forms-B"](t)}function Dr(t,e){return!(!e&&Pr(t))&&!(t>=2304&&t<=3583||t>=3840&&t<=4255||Cr.Khmer(t))}function Mr(t){for(var e=0,n=t;e<n.length;e+=1)if(Pr(n[e].charCodeAt(0)))return!0;return!1}var Rr="deferred",Nr="loading",Lr="loaded",Fr=null,jr="unavailable",zr=null,Br=function(t){Fr&&Fr(t)};function Ur(){Vr.fire(new Tt("pluginStateChange",{pluginStatus:jr,pluginURL:zr}))}var Vr=new Ct,qr=function(){return jr},Wr=function(){if(jr!==Rr||!zr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");jr=Nr,Ur(),zr&&bt({url:zr},(function(t){t?Br(t):(jr=Lr,Ur())}))},Gr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return jr===Lr||null!=Gr.applyArabicShaping},isLoading:function(){return jr===Nr},setState:function(t){jr=t.pluginStatus,zr=t.pluginURL},isParsed:function(){return null!=Gr.applyArabicShaping&&null!=Gr.processBidirectionalText&&null!=Gr.processStyledBidirectionalText},getPluginURL:function(){return zr}},Hr=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Sr,this.transition={})};Hr.prototype.isSupportedScript=function(t){return function(t,e){for(var n=0,r=t;n<r.length;n+=1)if(!Dr(r[n].charCodeAt(0),e))return!1;return!0}(t,Gr.isLoaded())},Hr.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Hr.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}};var Kr=function(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(wn(t))return new Rn(t,e);if(An(t)){var n=Mn(t,e);if("error"===n.result)throw new Error(n.value.map((function(t){return t.key+": "+t.message})).join(", "));return n.value}var r=t;return"string"==typeof t&&"color"===e.type&&(r=Yt.parse(t)),{kind:"constant",evaluate:function(){return r}}}(void 0===e?t.specification.default:e,t.specification)};Kr.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Kr.prototype.possiblyEvaluate=function(t,e){return this.property.possiblyEvaluate(this,t,e)};var Qr=function(t){this.property=t,this.value=new Kr(t,void 0)};Qr.prototype.transitioned=function(t,e){return new Yr(this.property,this.value,e,h({},t.transition,this.transition),t.now)},Qr.prototype.untransitioned=function(){return new Yr(this.property,this.value,null,{},0)};var Xr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Xr.prototype.getValue=function(t){return b(this._values[t].value.value)},Xr.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Qr(this._values[t].property)),this._values[t].value=new Kr(this._values[t].property,null===e?void 0:b(e))},Xr.prototype.getTransition=function(t){return b(this._values[t].transition)},Xr.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Qr(this._values[t].property)),this._values[t].transition=b(e)||void 0},Xr.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i);var o=this.getTransition(r);void 0!==o&&(t[r+"-transition"]=o)}return t},Xr.prototype.transitioned=function(t,e){for(var n=new Zr(this._properties),r=0,i=Object.keys(this._values);r<i.length;r+=1){var o=i[r];n._values[o]=this._values[o].transitioned(t,e._values[o])}return n},Xr.prototype.untransitioned=function(){for(var t=new Zr(this._properties),e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e];t._values[r]=this._values[r].untransitioned()}return t};var Yr=function(t,e,n,r,i){this.property=t,this.value=e,this.begin=i+r.delay||0,this.end=this.begin+r.duration||0,t.specification.transition&&(r.delay||r.duration)&&(this.prior=n)};Yr.prototype.possiblyEvaluate=function(t,e){var n=t.now||0,r=this.value.possiblyEvaluate(t,e),i=this.prior;if(i){if(n>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(n<this.begin)return i.possiblyEvaluate(t,e);var o=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(i.possiblyEvaluate(t,e),r,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}(o))}return r};var Zr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Zr.prototype.possiblyEvaluate=function(t,e){for(var n=new ti(this._properties),r=0,i=Object.keys(this._values);r<i.length;r+=1){var o=i[r];n._values[o]=this._values[o].possiblyEvaluate(t,e)}return n},Zr.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1){var n=e[t];if(this._values[n].prior)return!0}return!1};var Jr=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Jr.prototype.getValue=function(t){return b(this._values[t].value)},Jr.prototype.setValue=function(t,e){this._values[t]=new Kr(this._values[t].property,null===e?void 0:b(e))},Jr.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i)}return t},Jr.prototype.possiblyEvaluate=function(t,e){for(var n=new ti(this._properties),r=0,i=Object.keys(this._values);r<i.length;r+=1){var o=i[r];n._values[o]=this._values[o].possiblyEvaluate(t,e)}return n};var $r=function(t,e,n){this.property=t,this.value=e,this.parameters=n};$r.prototype.isConstant=function(){return"constant"===this.value.kind},$r.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},$r.prototype.evaluate=function(t,e,n){return this.property.evaluate(this.value,this.parameters,t,e,n)};var ti=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};ti.prototype.get=function(t){return this._values[t]};var ei=function(t){this.specification=t};ei.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},ei.prototype.interpolate=function(t,e,n){var r=Te[this.specification.type];return r?r(t,e,n):t};var ni=function(t,e){this.specification=t,this.overrides=e};ni.prototype.possiblyEvaluate=function(t,e,n){return"constant"===t.expression.kind||"camera"===t.expression.kind?new $r(this,{kind:"constant",value:t.expression.evaluate(e,null,{},n)},e):new $r(this,t.expression,e)},ni.prototype.interpolate=function(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new $r(this,{kind:"constant",value:void 0},t.parameters);var r=Te[this.specification.type];return r?new $r(this,{kind:"constant",value:r(t.value.value,e.value.value,n)},t.parameters):t},ni.prototype.evaluate=function(t,e,n,r,i){return"constant"===t.kind?t.value:t.evaluate(e,n,r,i)};var ri=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(t,e,n){if(void 0===t.value)return new $r(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var r=t.expression.evaluate(e,null,{},n),i="resolvedImage"===t.property.specification.type&&"string"!=typeof r?r.name:r,o=this._calculate(i,i,i,e);return new $r(this,{kind:"constant",value:o},e)}if("camera"===t.expression.kind){var a=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new $r(this,{kind:"constant",value:a},e)}return new $r(this,t.expression,e)},e.prototype.evaluate=function(t,e,n,r,i){if("source"===t.kind){var o=t.evaluate(e,n,r,i);return this._calculate(o,o,o,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,r),t.evaluate({zoom:Math.floor(e.zoom)},n,r),t.evaluate({zoom:Math.floor(e.zoom)+1},n,r),e):t.value},e.prototype._calculate=function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},e.prototype.interpolate=function(t){return t},e}(ni),ii=function(t){this.specification=t};ii.prototype.possiblyEvaluate=function(t,e,n){if(void 0!==t.value){if("constant"===t.expression.kind){var r=t.expression.evaluate(e,null,{},n);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new Hr(Math.floor(e.zoom-1),e)),t.expression.evaluate(new Hr(Math.floor(e.zoom),e)),t.expression.evaluate(new Hr(Math.floor(e.zoom+1),e)),e)}},ii.prototype._calculate=function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},ii.prototype.interpolate=function(t){return t};var oi=function(t){this.specification=t};oi.prototype.possiblyEvaluate=function(t,e,n){return!!t.expression.evaluate(e,null,{},n)},oi.prototype.interpolate=function(){return!1};var ai=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var n=t[e];n.specification.overridable&&this.overridableProperties.push(e);var r=this.defaultPropertyValues[e]=new Kr(n,void 0),i=this.defaultTransitionablePropertyValues[e]=new Qr(n);this.defaultTransitioningPropertyValues[e]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=r.possiblyEvaluate({})}};br("DataDrivenProperty",ni),br("DataConstantProperty",ei),br("CrossFadedDataDrivenProperty",ri),br("CrossFadedProperty",ii),br("ColorRampProperty",oi);var si=function(t){function e(e,n){if(t.call(this),this.id=e.id,this.type=e.type,this._featureFilter=function(){return!0},"custom"!==e.type&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new Jr(n.layout)),n.paint)){for(var r in this._transitionablePaint=new Xr(n.paint),e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(var i in e.layout)this.setLayoutProperty(i,e.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,n){if(void 0===n&&(n={}),null!=e){var r="layers."+this.id+".layout."+t;if(this._validate(fr,r,t,e,n))return}"visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e},e.prototype.getPaintProperty=function(t){return g(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,n){if(void 0===n&&(n={}),null!=e){var r="layers."+this.id+".paint."+t;if(this._validate(pr,r,t,e,n))return!1}if(g(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var i=this._transitionablePaint._values[t],o="cross-faded-data-driven"===i.property.specification["property-type"],a=i.value.isDataDriven(),s=i.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);var u=this._transitionablePaint._values[t].value;return u.isDataDriven()||a||o||this._handleOverridablePaintPropertyUpdate(t,s,u)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){},e.prototype._handleOverridablePaintPropertyUpdate=function(t,e,n){return!1},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,e)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),_(t,(function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)}))},e.prototype._validate=function(t,e,n,r,i){return void 0===i&&(i={}),(!i||!1!==i.validate)&&dr(this,t.call(lr,{key:e,layerType:this.type,objectKey:n,value:r,styleSpec:It,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof $r&&gn(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},e}(Ct),ui={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ci=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},li=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function hi(t,e){void 0===e&&(e=1);var n=0,r=0;return{members:t.map((function(t){var i,o=(i=t.type,ui[i].BYTES_PER_ELEMENT),a=n=pi(n,Math.max(e,o)),s=t.components||1;return r=Math.max(r,o),n+=o*s,{name:t.name,type:t.type,components:s,offset:a}})),size:pi(n,Math.max(r,e)),alignment:e}}function pi(t,e){return Math.ceil(t/e)*e}li.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},li.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},li.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},li.prototype.clear=function(){this.length=0},li.prototype.resize=function(t){this.reserve(t),this.length=t},li.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},li.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var fi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.int16[r+0]=e,this.int16[r+1]=n,t},e}(li);fi.prototype.bytesPerElement=4,br("StructArrayLayout2i4",fi);var di=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)},e.prototype.emplace=function(t,e,n,r,i){var o=4*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=i,t},e}(li);di.prototype.bytesPerElement=8,br("StructArrayLayout4i8",di);var mi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)},e.prototype.emplace=function(t,e,n,r,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(li);mi.prototype.bytesPerElement=12,br("StructArrayLayout2i4i12",mi);var yi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)},e.prototype.emplace=function(t,e,n,r,i,o,a){var s=4*t,u=8*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.uint8[u+4]=r,this.uint8[u+5]=i,this.uint8[u+6]=o,this.uint8[u+7]=a,t},e}(li);yi.prototype.bytesPerElement=8,br("StructArrayLayout2i4ub8",yi);var gi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s){var u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,r,i,o,a,s)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u){var c=8*t;return this.uint16[c+0]=e,this.uint16[c+1]=n,this.uint16[c+2]=r,this.uint16[c+3]=i,this.uint16[c+4]=o,this.uint16[c+5]=a,this.uint16[c+6]=s,this.uint16[c+7]=u,t},e}(li);gi.prototype.bytesPerElement=16,br("StructArrayLayout8ui16",gi);var vi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l,h){var p=this.length;return this.resize(p+1),this.emplace(p,t,e,n,r,i,o,a,s,u,c,l,h)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,h,p){var f=12*t;return this.int16[f+0]=e,this.int16[f+1]=n,this.int16[f+2]=r,this.int16[f+3]=i,this.uint16[f+4]=o,this.uint16[f+5]=a,this.uint16[f+6]=s,this.uint16[f+7]=u,this.int16[f+8]=c,this.int16[f+9]=l,this.int16[f+10]=h,this.int16[f+11]=p,t},e}(li);vi.prototype.bytesPerElement=24,br("StructArrayLayout4i4ui4i24",vi);var _i=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.float32[i+0]=e,this.float32[i+1]=n,this.float32[i+2]=r,t},e}(li);_i.prototype.bytesPerElement=12,br("StructArrayLayout3f12",_i);var bi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){var n=1*t;return this.uint32[n+0]=e,t},e}(li);bi.prototype.bytesPerElement=4,br("StructArrayLayout1ul4",bi);var wi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l){var h=this.length;return this.resize(h+1),this.emplace(h,t,e,n,r,i,o,a,s,u,c,l)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,h){var p=12*t,f=6*t;return this.int16[p+0]=e,this.int16[p+1]=n,this.int16[p+2]=r,this.int16[p+3]=i,this.int16[p+4]=o,this.int16[p+5]=a,this.uint32[f+3]=s,this.uint16[p+8]=u,this.uint16[p+9]=c,this.int16[p+10]=l,this.int16[p+11]=h,t},e}(li);wi.prototype.bytesPerElement=24,br("StructArrayLayout6i1ul2ui2i24",wi);var xi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)},e.prototype.emplace=function(t,e,n,r,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(li);xi.prototype.bytesPerElement=12,br("StructArrayLayout2i2i2i12",xi);var Ei=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)},e.prototype.emplace=function(t,e,n,r,i){var o=12*t,a=3*t;return this.uint8[o+0]=e,this.uint8[o+1]=n,this.float32[a+1]=r,this.float32[a+2]=i,t},e}(li);Ei.prototype.bytesPerElement=12,br("StructArrayLayout2ub2f12",Ei);var Ti=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l,h,p,f,d,m,y){var g=this.length;return this.resize(g+1),this.emplace(g,t,e,n,r,i,o,a,s,u,c,l,h,p,f,d,m,y)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,h,p,f,d,m,y,g){var v=24*t,_=12*t,b=48*t;return this.int16[v+0]=e,this.int16[v+1]=n,this.uint16[v+2]=r,this.uint16[v+3]=i,this.uint32[_+2]=o,this.uint32[_+3]=a,this.uint32[_+4]=s,this.uint16[v+10]=u,this.uint16[v+11]=c,this.uint16[v+12]=l,this.float32[_+7]=h,this.float32[_+8]=p,this.uint8[b+36]=f,this.uint8[b+37]=d,this.uint8[b+38]=m,this.uint32[_+10]=y,this.int16[v+22]=g,t},e}(li);Ti.prototype.bytesPerElement=48,br("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ti);var Si=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l,h,p,f,d,m,y,g,v,_,b,w,x,E,T,S){var C=this.length;return this.resize(C+1),this.emplace(C,t,e,n,r,i,o,a,s,u,c,l,h,p,f,d,m,y,g,v,_,b,w,x,E,T,S)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,h,p,f,d,m,y,g,v,_,b,w,x,E,T,S,C){var I=30*t,k=15*t;return this.int16[I+0]=e,this.int16[I+1]=n,this.int16[I+2]=r,this.int16[I+3]=i,this.int16[I+4]=o,this.int16[I+5]=a,this.int16[I+6]=s,this.int16[I+7]=u,this.uint16[I+8]=c,this.uint16[I+9]=l,this.uint16[I+10]=h,this.uint16[I+11]=p,this.uint16[I+12]=f,this.uint16[I+13]=d,this.uint16[I+14]=m,this.uint16[I+15]=y,this.uint16[I+16]=g,this.uint16[I+17]=v,this.uint16[I+18]=_,this.uint16[I+19]=b,this.uint16[I+20]=w,this.uint16[I+21]=x,this.uint32[k+11]=E,this.float32[k+12]=T,this.float32[k+13]=S,this.float32[k+14]=C,t},e}(li);Si.prototype.bytesPerElement=60,br("StructArrayLayout8i14ui1ul3f60",Si);var Ci=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){var n=1*t;return this.float32[n+0]=e,t},e}(li);Ci.prototype.bytesPerElement=4,br("StructArrayLayout1f4",Ci);var Ii=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.int16[i+0]=e,this.int16[i+1]=n,this.int16[i+2]=r,t},e}(li);Ii.prototype.bytesPerElement=6,br("StructArrayLayout3i6",Ii);var ki=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=2*t,o=4*t;return this.uint32[i+0]=e,this.uint16[o+2]=n,this.uint16[o+3]=r,t},e}(li);ki.prototype.bytesPerElement=8,br("StructArrayLayout1ul2ui8",ki);var Ai=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,this.uint16[i+2]=r,t},e}(li);Ai.prototype.bytesPerElement=6,br("StructArrayLayout3ui6",Ai);var Oi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,t},e}(li);Oi.prototype.bytesPerElement=4,br("StructArrayLayout2ui4",Oi);var Pi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){var n=1*t;return this.uint16[n+0]=e,t},e}(li);Pi.prototype.bytesPerElement=2,br("StructArrayLayout1ui2",Pi);var Di=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.float32[r+0]=e,this.float32[r+1]=n,t},e}(li);Di.prototype.bytesPerElement=8,br("StructArrayLayout2f8",Di);var Mi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)},e.prototype.emplace=function(t,e,n,r,i){var o=4*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=r,this.float32[o+3]=i,t},e}(li);Mi.prototype.bytesPerElement=16,br("StructArrayLayout4f16",Mi);var Ri=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return n.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorPointX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorPointY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.x1.get=function(){return this._structArray.int16[this._pos2+2]},n.x1.set=function(t){this._structArray.int16[this._pos2+2]=t},n.y1.get=function(){return this._structArray.int16[this._pos2+3]},n.y1.set=function(t){this._structArray.int16[this._pos2+3]=t},n.x2.get=function(){return this._structArray.int16[this._pos2+4]},n.x2.set=function(t){this._structArray.int16[this._pos2+4]=t},n.y2.get=function(){return this._structArray.int16[this._pos2+5]},n.y2.set=function(t){this._structArray.int16[this._pos2+5]=t},n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.featureIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},n.radius.get=function(){return this._structArray.int16[this._pos2+10]},n.radius.set=function(t){this._structArray.int16[this._pos2+10]=t},n.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},n.signedDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+11]=t},n.anchorPoint.get=function(){return new i(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,n),e}(ci);Ri.prototype.size=24;var Ni=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Ri(this,t)},e}(wi);br("CollisionBoxArray",Ni);var Li=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.glyphStartIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},n.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},n.numGlyphs.set=function(t){this._structArray.uint16[this._pos2+3]=t},n.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},n.vertexStartIndex.set=function(t){this._structArray.uint32[this._pos4+2]=t},n.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.lineStartIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},n.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},n.lineLength.set=function(t){this._structArray.uint32[this._pos4+4]=t},n.segment.get=function(){return this._structArray.uint16[this._pos2+10]},n.segment.set=function(t){this._structArray.uint16[this._pos2+10]=t},n.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},n.lowerSize.set=function(t){this._structArray.uint16[this._pos2+11]=t},n.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},n.upperSize.set=function(t){this._structArray.uint16[this._pos2+12]=t},n.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},n.lineOffsetX.set=function(t){this._structArray.float32[this._pos4+7]=t},n.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},n.lineOffsetY.set=function(t){this._structArray.float32[this._pos4+8]=t},n.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},n.writingMode.set=function(t){this._structArray.uint8[this._pos1+36]=t},n.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},n.placedOrientation.set=function(t){this._structArray.uint8[this._pos1+37]=t},n.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},n.hidden.set=function(t){this._structArray.uint8[this._pos1+38]=t},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+10]=t},n.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},n.associatedIconIndex.set=function(t){this._structArray.int16[this._pos2+22]=t},Object.defineProperties(e.prototype,n),e}(ci);Li.prototype.size=48;var Fi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Li(this,t)},e}(Ti);br("PlacedSymbolArray",Fi);var ji=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},n.rightJustifiedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+2]=t},n.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},n.centerJustifiedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+3]=t},n.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},n.leftJustifiedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+4]=t},n.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},n.verticalPlacedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+5]=t},n.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},n.placedIconSymbolIndex.set=function(t){this._structArray.int16[this._pos2+6]=t},n.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},n.verticalPlacedIconSymbolIndex.set=function(t){this._structArray.int16[this._pos2+7]=t},n.key.get=function(){return this._structArray.uint16[this._pos2+8]},n.key.set=function(t){this._structArray.uint16[this._pos2+8]=t},n.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.textBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},n.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},n.textBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+10]=t},n.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},n.verticalTextBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+11]=t},n.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},n.verticalTextBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+12]=t},n.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},n.iconBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+13]=t},n.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},n.iconBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+14]=t},n.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},n.verticalIconBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+15]=t},n.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},n.verticalIconBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+16]=t},n.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},n.featureIndex.set=function(t){this._structArray.uint16[this._pos2+17]=t},n.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},n.numHorizontalGlyphVertices.set=function(t){this._structArray.uint16[this._pos2+18]=t},n.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},n.numVerticalGlyphVertices.set=function(t){this._structArray.uint16[this._pos2+19]=t},n.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},n.numIconVertices.set=function(t){this._structArray.uint16[this._pos2+20]=t},n.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},n.numVerticalIconVertices.set=function(t){this._structArray.uint16[this._pos2+21]=t},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+11]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+11]=t},n.textBoxScale.get=function(){return this._structArray.float32[this._pos4+12]},n.textBoxScale.set=function(t){this._structArray.float32[this._pos4+12]=t},n.textOffset0.get=function(){return this._structArray.float32[this._pos4+13]},n.textOffset0.set=function(t){this._structArray.float32[this._pos4+13]=t},n.textOffset1.get=function(){return this._structArray.float32[this._pos4+14]},n.textOffset1.set=function(t){this._structArray.float32[this._pos4+14]=t},Object.defineProperties(e.prototype,n),e}(ci);ji.prototype.size=60;var zi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new ji(this,t)},e}(Si);br("SymbolInstanceArray",zi);var Bi=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={offsetX:{configurable:!0}};return n.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},n.offsetX.set=function(t){this._structArray.float32[this._pos4+0]=t},Object.defineProperties(e.prototype,n),e}(ci);Bi.prototype.size=4;var Ui=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e.prototype.get=function(t){return new Bi(this,t)},e}(Ci);br("GlyphOffsetArray",Ui);var Vi=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return n.x.get=function(){return this._structArray.int16[this._pos2+0]},n.x.set=function(t){this._structArray.int16[this._pos2+0]=t},n.y.get=function(){return this._structArray.int16[this._pos2+1]},n.y.set=function(t){this._structArray.int16[this._pos2+1]=t},n.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},n.tileUnitDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+2]=t},Object.defineProperties(e.prototype,n),e}(ci);Vi.prototype.size=6;var qi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e.prototype.get=function(t){return new Vi(this,t)},e}(Ii);br("SymbolLineVertexArray",qi);var Wi=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},n.featureIndex.set=function(t){this._structArray.uint32[this._pos4+0]=t},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},n.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+3]=t},Object.defineProperties(e.prototype,n),e}(ci);Wi.prototype.size=8;var Gi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Wi(this,t)},e}(ki);br("FeatureIndexArray",Gi);var Hi=hi([{name:"a_pos",components:2,type:"Int16"}],4).members,Ki=function(t){void 0===t&&(t=[]),this.segments=t};function Qi(t,e){return 256*(t=c(Math.floor(t),0,255))+c(Math.floor(e),0,255)}Ki.prototype.prepareSegment=function(t,e,n,r){var i=this.segments[this.segments.length-1];return t>Ki.MAX_VERTEX_ARRAY_LENGTH&&x("Max vertices per segment is "+Ki.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!i||i.vertexLength+t>Ki.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==r)&&(i={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==r&&(i.sortKey=r),this.segments.push(i)),i},Ki.prototype.get=function(){return this.segments},Ki.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var n=e[t];for(var r in n.vaos)n.vaos[r].destroy()}},Ki.simpleSegment=function(t,e,n,r){return new Ki([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:r,vaos:{},sortKey:0}])},Ki.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,br("SegmentVector",Ki);var Xi=function(){this.ids=[],this.positions=[],this.indexed=!1};function Yi(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}Xi.prototype.add=function(t,e,n,r){this.ids.push(t),this.positions.push(e,n,r)},Xi.prototype.getPositions=function(t){for(var e=0,n=this.ids.length-1;e<n;){var r=e+n>>1;this.ids[r]>=t?n=r:e=r+1}for(var i=[];this.ids[e]===t;){var o=this.positions[3*e],a=this.positions[3*e+1],s=this.positions[3*e+2];i.push({index:o,start:a,end:s}),e++}return i},Xi.serialize=function(t,e){var n=new Float64Array(t.ids),r=new Uint32Array(t.positions);return function t(e,n,r,i){if(!(r>=i)){for(var o=e[r+i>>1],a=r-1,s=i+1;;){do{a++}while(e[a]<o);do{s--}while(e[s]>o);if(a>=s)break;Yi(e,a,s),Yi(n,3*a,3*s),Yi(n,3*a+1,3*s+1),Yi(n,3*a+2,3*s+2)}t(e,n,r,s),t(e,n,s+1,i)}}(n,r,0,n.length-1),e&&e.push(n.buffer,r.buffer),{ids:n,positions:r}},Xi.deserialize=function(t){var e=new Xi;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e},br("FeaturePositionMap",Xi);var Zi=function(t,e){this.gl=t.gl,this.location=e},Ji=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},e}(Zi),$i=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},e}(Zi),to=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},e}(Zi),eo=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},e}(Zi),no=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},e}(Zi),ro=function(t){function e(e,n){t.call(this,e,n),this.current=Yt.transparent}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},e}(Zi),io=new Float32Array(16),oo=function(t){function e(e,n){t.call(this,e,n),this.current=io}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},e}(Zi);function ao(t){return[Qi(255*t.r,255*t.g),Qi(255*t.b,255*t.a)]}var so=function(t,e,n){this.value=t,this.names=e,this.uniformNames=this.names.map((function(t){return"u_"+t})),this.type=n,this.maxValue=-1/0};so.prototype.defines=function(){return this.names.map((function(t){return"#define HAS_UNIFORM_u_"+t}))},so.prototype.setConstantPatternPositions=function(){},so.prototype.populatePaintArray=function(){},so.prototype.updatePaintArray=function(){},so.prototype.upload=function(){},so.prototype.destroy=function(){},so.prototype.setUniforms=function(t,e,n,r){e.set(r.constantOr(this.value))},so.prototype.getBinding=function(t,e){return"color"===this.type?new ro(t,e):new $i(t,e)},so.serialize=function(t){var e=t.value,n=t.names,r=t.type;return{value:Er(e),names:n,type:r}},so.deserialize=function(t){var e=t.value,n=t.names,r=t.type;return new so(Tr(e),n,r)};var uo=function(t,e,n){this.value=t,this.names=e,this.uniformNames=this.names.map((function(t){return"u_"+t})),this.type=n,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}};uo.prototype.defines=function(){return this.names.map((function(t){return"#define HAS_UNIFORM_u_"+t}))},uo.prototype.populatePaintArray=function(){},uo.prototype.updatePaintArray=function(){},uo.prototype.upload=function(){},uo.prototype.destroy=function(){},uo.prototype.setConstantPatternPositions=function(t,e){this.patternPositions.patternTo=t.tlbr,this.patternPositions.patternFrom=e.tlbr},uo.prototype.setUniforms=function(t,e,n,r,i){var o=this.patternPositions;"u_pattern_to"===i&&o.patternTo&&e.set(o.patternTo),"u_pattern_from"===i&&o.patternFrom&&e.set(o.patternFrom)},uo.prototype.getBinding=function(t,e){return new no(t,e)};var co=function(t,e,n,r){this.expression=t,this.names=e,this.type=n,this.uniformNames=this.names.map((function(t){return"a_"+t})),this.maxValue=-1/0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?2:1,offset:0}})),this.paintVertexArray=new r};co.prototype.defines=function(){return[]},co.prototype.setConstantPatternPositions=function(){},co.prototype.populatePaintArray=function(t,e,n,r){var i=this.paintVertexArray,o=i.length;i.reserve(t);var a=this.expression.evaluate(new Hr(0),e,{},[],r);if("color"===this.type)for(var s=ao(a),u=o;u<t;u++)i.emplaceBack(s[0],s[1]);else{for(var c=o;c<t;c++)i.emplaceBack(a);this.maxValue=Math.max(this.maxValue,a)}},co.prototype.updatePaintArray=function(t,e,n,r){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:0},n,r);if("color"===this.type)for(var a=ao(o),s=t;s<e;s++)i.emplace(s,a[0],a[1]);else{for(var u=t;u<e;u++)i.emplace(u,o);this.maxValue=Math.max(this.maxValue,o)}},co.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},co.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},co.prototype.setUniforms=function(t,e){e.set(0)},co.prototype.getBinding=function(t,e){return new $i(t,e)};var lo=function(t,e,n,r,i,o){this.expression=t,this.names=e,this.uniformNames=this.names.map((function(t){return"u_"+t+"_t"})),this.type=n,this.useIntegerZoom=r,this.zoom=i,this.maxValue=-1/0;var a=o;this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?4:2,offset:0}})),this.paintVertexArray=new a};lo.prototype.defines=function(){return[]},lo.prototype.setConstantPatternPositions=function(){},lo.prototype.populatePaintArray=function(t,e,n,r){var i=this.paintVertexArray,o=i.length;i.reserve(t);var a=this.expression.evaluate(new Hr(this.zoom),e,{},[],r),s=this.expression.evaluate(new Hr(this.zoom+1),e,{},[],r);if("color"===this.type)for(var u=ao(a),c=ao(s),l=o;l<t;l++)i.emplaceBack(u[0],u[1],c[0],c[1]);else{for(var h=o;h<t;h++)i.emplaceBack(a,s);this.maxValue=Math.max(this.maxValue,a,s)}},lo.prototype.updatePaintArray=function(t,e,n,r){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:this.zoom},n,r),a=this.expression.evaluate({zoom:this.zoom+1},n,r);if("color"===this.type)for(var s=ao(o),u=ao(a),c=t;c<e;c++)i.emplace(c,s[0],s[1],u[0],u[1]);else{for(var l=t;l<e;l++)i.emplace(l,o,a);this.maxValue=Math.max(this.maxValue,o,a)}},lo.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},lo.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},lo.prototype.interpolationFactor=function(t){return this.useIntegerZoom&&(t=Math.floor(t)),c(this.expression.interpolationFactor(t,this.zoom,this.zoom+1),0,1)},lo.prototype.setUniforms=function(t,e,n){e.set(this.interpolationFactor(n.zoom))},lo.prototype.getBinding=function(t,e){return new $i(t,e)};var ho=function(t,e,n,r,i,o,a){this.expression=t,this.names=e,this.type=n,this.uniformNames=this.names.map((function(t){return"u_"+t+"_t"})),this.useIntegerZoom=r,this.zoom=i,this.maxValue=-1/0,this.layerId=a,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Uint16",components:4,offset:0}})),this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o};ho.prototype.defines=function(){return[]},ho.prototype.setConstantPatternPositions=function(){},ho.prototype.populatePaintArray=function(t,e,n){var r=this.zoomInPaintVertexArray,i=this.zoomOutPaintVertexArray,o=this.layerId,a=r.length;if(r.reserve(t),i.reserve(t),n&&e.patterns&&e.patterns[o]){var s=e.patterns[o],u=s.min,c=s.mid,l=s.max,h=n[u],p=n[c],f=n[l];if(!h||!p||!f)return;for(var d=a;d<t;d++)r.emplaceBack(p.tl[0],p.tl[1],p.br[0],p.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1]),i.emplaceBack(p.tl[0],p.tl[1],p.br[0],p.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1])}},ho.prototype.updatePaintArray=function(t,e,n,r,i){var o=this.zoomInPaintVertexArray,a=this.zoomOutPaintVertexArray,s=this.layerId;if(i&&n.patterns&&n.patterns[s]){var u=n.patterns[s],c=u.min,l=u.mid,h=u.max,p=i[c],f=i[l],d=i[h];if(!p||!f||!d)return;for(var m=t;m<e;m++)o.emplace(m,f.tl[0],f.tl[1],f.br[0],f.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1]),a.emplace(m,f.tl[0],f.tl[1],f.br[0],f.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1])}},ho.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ho.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},ho.prototype.setUniforms=function(t,e){e.set(0)},ho.prototype.getBinding=function(t,e){return new $i(t,e)};var po=function(){this.binders={},this.cacheKey="",this._buffers=[]};po.createDynamic=function(t,e,n){var r=new po,i=[];for(var o in t.paint._values)if(n(o)){var a=t.paint.get(o);if(a instanceof $r&&gn(a.property.specification)){var s=mo(o,t.type),u=a.property.specification.type,c=a.property.useIntegerZoom;if("cross-faded"===a.property.specification["property-type"]||"cross-faded-data-driven"===a.property.specification["property-type"])if("constant"===a.value.kind)r.binders[o]=new uo(a.value.value,s,u),i.push("/u_"+o);else{var l=yo(o,u,"source");r.binders[o]=new ho(a.value,s,u,c,e,l,t.id),i.push("/a_"+o)}else if("constant"===a.value.kind)r.binders[o]=new so(a.value.value,s,u),i.push("/u_"+o);else if("source"===a.value.kind){var h=yo(o,u,"source");r.binders[o]=new co(a.value,s,u,h),i.push("/a_"+o)}else{var p=yo(o,u,"composite");r.binders[o]=new lo(a.value,s,u,c,e,p),i.push("/z_"+o)}}}return r.cacheKey=i.sort().join(""),r},po.prototype.populatePaintArrays=function(t,e,n,r,i){for(var o in this.binders)this.binders[o].populatePaintArray(t,e,r,i)},po.prototype.setConstantPatternPositions=function(t,e){for(var n in this.binders)this.binders[n].setConstantPatternPositions(t,e)},po.prototype.updatePaintArrays=function(t,e,n,r,i){var o=!1;for(var a in t)for(var s=0,u=e.getPositions(+a);s<u.length;s+=1){var c=u[s],l=n.feature(c.index);for(var h in this.binders){var p=this.binders[h];if(!(p instanceof so||p instanceof uo)&&!0===p.expression.isStateDependent){var f=r.paint.get(h);p.expression=f.value,p.updatePaintArray(c.start,c.end,l,t[a],i),o=!0}}}return o},po.prototype.defines=function(){var t=[];for(var e in this.binders)t.push.apply(t,this.binders[e].defines());return t},po.prototype.getPaintVertexBuffers=function(){return this._buffers},po.prototype.getUniforms=function(t,e){var n=[];for(var r in this.binders)for(var i=this.binders[r],o=0,a=i.uniformNames;o<a.length;o+=1){var s=a[o];if(e[s]){var u=i.getBinding(t,e[s]);n.push({name:s,property:r,binding:u})}}return n},po.prototype.setUniforms=function(t,e,n,r){for(var i=0,o=e;i<o.length;i+=1){var a=o[i],s=a.name,u=a.property,c=a.binding;this.binders[u].setUniforms(t,c,r,n.get(u),s)}},po.prototype.updatePatternPaintBuffers=function(t){var e=[];for(var n in this.binders){var r=this.binders[n];if(r instanceof ho){var i=2===t.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;i&&e.push(i)}else(r instanceof co||r instanceof lo)&&r.paintVertexBuffer&&e.push(r.paintVertexBuffer)}this._buffers=e},po.prototype.upload=function(t){for(var e in this.binders)this.binders[e].upload(t);var n=[];for(var r in this.binders){var i=this.binders[r];(i instanceof co||i instanceof lo)&&i.paintVertexBuffer&&n.push(i.paintVertexBuffer)}this._buffers=n},po.prototype.destroy=function(){for(var t in this.binders)this.binders[t].destroy()};var fo=function(t,e,n,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var i=0,o=e;i<o.length;i+=1){var a=o[i];this.programConfigurations[a.id]=po.createDynamic(a,n,r),this.programConfigurations[a.id].layoutAttributes=t}this.needsUpload=!1,this._featureMap=new Xi,this._bufferOffset=0};function mo(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function yo(t,e,n){var r={color:{source:Di,composite:Mi},number:{source:Ci,composite:Di}},i=function(t){return{"line-pattern":{source:gi,composite:gi},"fill-pattern":{source:gi,composite:gi},"fill-extrusion-pattern":{source:gi,composite:gi}}[t]}(t);return i&&i[n]||r[e][n]}fo.prototype.populatePaintArrays=function(t,e,n,r,i){for(var o in this.programConfigurations)this.programConfigurations[o].populatePaintArrays(t,e,n,r,i);void 0!==e.id&&this._featureMap.add(+e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},fo.prototype.updatePaintArrays=function(t,e,n,r){for(var i=0,o=n;i<o.length;i+=1){var a=o[i];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,this._featureMap,e,a,r)||this.needsUpload}},fo.prototype.get=function(t){return this.programConfigurations[t]},fo.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},fo.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},br("ConstantBinder",so),br("CrossFadedConstantBinder",uo),br("SourceExpressionBinder",co),br("CrossFadedCompositeBinder",ho),br("CompositeExpressionBinder",lo),br("ProgramConfiguration",po,{omit:["_buffers"]}),br("ProgramConfigurationSet",fo);var go=8192,vo={min:-1*Math.pow(2,14),max:Math.pow(2,14)-1};function _o(t){for(var e=go/t.extent,n=t.loadGeometry(),r=0;r<n.length;r++)for(var i=n[r],o=0;o<i.length;o++){var a=i[o];a.x=Math.round(a.x*e),a.y=Math.round(a.y*e),(a.x<vo.min||a.x>vo.max||a.y<vo.min||a.y>vo.max)&&(x("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a.x=c(a.x,vo.min,vo.max),a.y=c(a.y,vo.min,vo.max))}return n}function bo(t,e,n,r,i){t.emplaceBack(2*e+(r+1)/2,2*n+(i+1)/2)}var wo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new fi,this.indexArray=new Ai,this.segments=new Ki,this.programConfigurations=new fo(Hi,t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function xo(t,e){for(var n=0;n<t.length;n++)if(Po(e,t[n]))return!0;for(var r=0;r<e.length;r++)if(Po(t,e[r]))return!0;return!!Co(t,e)}function Eo(t,e,n){return!!Po(t,e)||!!ko(e,t,n)}function To(t,e){if(1===t.length)return Oo(e,t[0]);for(var n=0;n<e.length;n++)for(var r=e[n],i=0;i<r.length;i++)if(Po(t,r[i]))return!0;for(var o=0;o<t.length;o++)if(Oo(e,t[o]))return!0;for(var a=0;a<e.length;a++)if(Co(t,e[a]))return!0;return!1}function So(t,e,n){if(t.length>1){if(Co(t,e))return!0;for(var r=0;r<e.length;r++)if(ko(e[r],t,n))return!0}for(var i=0;i<t.length;i++)if(ko(t[i],e,n))return!0;return!1}function Co(t,e){if(0===t.length||0===e.length)return!1;for(var n=0;n<t.length-1;n++)for(var r=t[n],i=t[n+1],o=0;o<e.length-1;o++)if(Io(r,i,e[o],e[o+1]))return!0;return!1}function Io(t,e,n,r){return E(t,n,r)!==E(e,n,r)&&E(t,e,n)!==E(t,e,r)}function ko(t,e,n){var r=n*n;if(1===e.length)return t.distSqr(e[0])<r;for(var i=1;i<e.length;i++)if(Ao(t,e[i-1],e[i])<r)return!0;return!1}function Ao(t,e,n){var r=e.distSqr(n);if(0===r)return t.distSqr(e);var i=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/r;return i<0?t.distSqr(e):i>1?t.distSqr(n):t.distSqr(n.sub(e)._mult(i)._add(e))}function Oo(t,e){for(var n,r,i,o=!1,a=0;a<t.length;a++)for(var s=0,u=(n=t[a]).length-1;s<n.length;u=s++)r=n[s],i=n[u],r.y>e.y!=i.y>e.y&&e.x<(i.x-r.x)*(e.y-r.y)/(i.y-r.y)+r.x&&(o=!o);return o}function Po(t,e){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++){var o=t[r],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function Do(t,e,n){var r=n[0],i=n[2];if(t.x<r.x&&e.x<r.x||t.x>i.x&&e.x>i.x||t.y<r.y&&e.y<r.y||t.y>i.y&&e.y>i.y)return!1;var o=E(t,e,n[0]);return o!==E(t,e,n[1])||o!==E(t,e,n[2])||o!==E(t,e,n[3])}function Mo(t,e,n){var r=e.paint.get(t).value;return"constant"===r.kind?r.value:n.programConfigurations.get(e.id).binders[t].maxValue}function Ro(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function No(t,e,n,r,o){if(!e[0]&&!e[1])return t;var a=i.convert(e)._mult(o);"viewport"===n&&a._rotate(-r);for(var s=[],u=0;u<t.length;u++){var c=t[u];s.push(c.sub(a))}return s}wo.prototype.populate=function(t,e){var n=this.layers[0],r=[],i=null;"circle"===n.type&&(i=n.layout.get("circle-sort-key"));for(var o=0,a=t;o<a.length;o+=1){var s=a[o],u=s.feature,c=s.index,l=s.sourceLayerIndex;if(this.layers[0]._featureFilter(new Hr(this.zoom),u)){var h=_o(u),p=i?i.evaluate(u,{}):void 0,f={id:u.id,properties:u.properties,type:u.type,sourceLayerIndex:l,index:c,geometry:h,patterns:{},sortKey:p};r.push(f)}}i&&r.sort((function(t,e){return t.sortKey-e.sortKey}));for(var d=0,m=r;d<m.length;d+=1){var y=m[d],g=y,v=g.geometry,_=g.index,b=g.sourceLayerIndex,w=t[_].feature;this.addFeature(y,v,_),e.featureIndex.insert(w,v,_,b,this.index)}},wo.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},wo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},wo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},wo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Hi),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},wo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},wo.prototype.addFeature=function(t,e,n){for(var r=0,i=e;r<i.length;r+=1)for(var o=0,a=i[r];o<a.length;o+=1){var s=a[o],u=s.x,c=s.y;if(!(u<0||u>=go||c<0||c>=go)){var l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),h=l.vertexLength;bo(this.layoutVertexArray,u,c,-1,-1),bo(this.layoutVertexArray,u,c,1,-1),bo(this.layoutVertexArray,u,c,1,1),bo(this.layoutVertexArray,u,c,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),l.vertexLength+=4,l.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{})},br("CircleBucket",wo,{omit:["layers"]});var Lo,Fo=new ai({"circle-sort-key":new ni(It.layout_circle["circle-sort-key"])}),jo={paint:new ai({"circle-radius":new ni(It.paint_circle["circle-radius"]),"circle-color":new ni(It.paint_circle["circle-color"]),"circle-blur":new ni(It.paint_circle["circle-blur"]),"circle-opacity":new ni(It.paint_circle["circle-opacity"]),"circle-translate":new ei(It.paint_circle["circle-translate"]),"circle-translate-anchor":new ei(It.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ei(It.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ei(It.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ni(It.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ni(It.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ni(It.paint_circle["circle-stroke-opacity"])}),layout:Fo},zo="undefined"!=typeof Float32Array?Float32Array:Array;function Bo(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,n=arguments.length;n--;)e+=t[n]*t[n];return Math.sqrt(e)}),Lo=new zo(3),zo!=Float32Array&&(Lo[0]=0,Lo[1]=0,Lo[2]=0),function(){var t=new zo(4);zo!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var Uo=function(t){function e(e){t.call(this,e,jo)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new wo(t)},e.prototype.queryRadius=function(t){var e=t;return Mo("circle-radius",this,e)+Mo("circle-stroke-width",this,e)+Ro(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,o,a,s){for(var u=No(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),c=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),l="map"===this.paint.get("circle-pitch-alignment"),h=l?u:function(t,e){return t.map((function(t){return Vo(t,e)}))}(u,s),p=l?c*a:c,f=0,d=r;f<d.length;f+=1)for(var m=0,y=d[f];m<y.length;m+=1){var g=y[m],v=l?g:Vo(g,s),_=p,b=Bo([],[g.x,g.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=b[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/b[3]),Eo(h,v,_))return!0}return!1},e}(si);function Vo(t,e){var n=Bo([],[t.x,t.y,0,1],e);return new i(n[0]/n[3],n[1]/n[3])}var qo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(wo);function Wo(t,e,n,r){var i=e.width,o=e.height;if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==i*o*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(i*o*n);return t.width=i,t.height=o,t.data=r,t}function Go(t,e,n){var r=e.width,i=e.height;if(r!==t.width||i!==t.height){var o=Wo({},{width:r,height:i},n);Ho(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,r),height:Math.min(t.height,i)},n),t.width=r,t.height=i,t.data=o.data}}function Ho(t,e,n,r,i,o){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,u=0;u<i.height;u++)for(var c=((n.y+u)*t.width+n.x)*o,l=((r.y+u)*e.width+r.x)*o,h=0;h<i.width*o;h++)s[l+h]=a[c+h];return e}br("HeatmapBucket",qo,{omit:["layers"]});var Ko=function(t,e){Wo(this,t,1,e)};Ko.prototype.resize=function(t){Go(this,t,1)},Ko.prototype.clone=function(){return new Ko({width:this.width,height:this.height},new Uint8Array(this.data))},Ko.copy=function(t,e,n,r,i){Ho(t,e,n,r,i,1)};var Qo=function(t,e){Wo(this,t,4,e)};Qo.prototype.resize=function(t){Go(this,t,4)},Qo.prototype.replace=function(t,e){e?this.data.set(t):t instanceof Uint8ClampedArray?this.data=new Uint8Array(t.buffer):this.data=t},Qo.prototype.clone=function(){return new Qo({width:this.width,height:this.height},new Uint8Array(this.data))},Qo.copy=function(t,e,n,r,i){Ho(t,e,n,r,i,4)},br("AlphaImage",Ko),br("RGBAImage",Qo);var Xo={paint:new ai({"heatmap-radius":new ni(It.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ni(It.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ei(It.paint_heatmap["heatmap-intensity"]),"heatmap-color":new oi(It.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ei(It.paint_heatmap["heatmap-opacity"])})};function Yo(t,e){for(var n=new Uint8Array(1024),r={},i=0,o=0;i<256;i++,o+=4){r[e]=i/255;var a=t.evaluate(r);n[o+0]=Math.floor(255*a.r/a.a),n[o+1]=Math.floor(255*a.g/a.a),n[o+2]=Math.floor(255*a.b/a.a),n[o+3]=Math.floor(255*a.a)}return new Qo({width:256,height:1},n)}var Zo=function(t){function e(e){t.call(this,e,Xo),this._updateColorRamp()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new qo(t)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){var t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Yo(t,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(si),Jo={paint:new ai({"hillshade-illumination-direction":new ei(It.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ei(It.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ei(It.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ei(It.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ei(It.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ei(It.paint_hillshade["hillshade-accent-color"])})},$o=function(t){function e(e){t.call(this,e,Jo)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(si),ta=hi([{name:"a_pos",components:2,type:"Int16"}],4).members,ea=ra,na=ra;function ra(t,e,n){n=n||2;var r,i,o,a,s,u,c,l=e&&e.length,h=l?e[0]*n:t.length,p=ia(t,0,h,n,!0),f=[];if(!p||p.next===p.prev)return f;if(l&&(p=function(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=ia(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(ma(a));for(s.sort(ha),i=0;i<s.length;i++)pa(s[i],n),n=oa(n,n.next);return n}(t,e,p,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<h;d+=n)(s=t[d])<r&&(r=s),(u=t[d+1])<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=0!==(c=Math.max(o-r,a-i))?1/c:0}return aa(p,f,n,r,i,c),f}function ia(t,e,n,r,i){var o,a;if(i===ka(t,e,n,r)>0)for(o=e;o<n;o+=r)a=Sa(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=Sa(o,t[o],t[o+1],a);return a&&_a(a,a.next)&&(Ca(a),a=a.next),a}function oa(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!_a(r,r.next)&&0!==va(r.prev,r,r.next))r=r.next;else{if(Ca(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function aa(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=da(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,o);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?ua(t,r,i,o):sa(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),Ca(t),t=u.next,c=u.next;else if((t=u)===c){a?1===a?aa(t=ca(oa(t),e,n),e,n,r,i,o,2):2===a&&la(t,e,n,r,i,o):aa(oa(t),e,n,r,i,o,1);break}}}function sa(t){var e=t.prev,n=t,r=t.next;if(va(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(ya(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&va(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function ua(t,e,n,r){var i=t.prev,o=t,a=t.next;if(va(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=da(s,u,e,n,r),p=da(c,l,e,n,r),f=t.prevZ,d=t.nextZ;f&&f.z>=h&&d&&d.z<=p;){if(f!==t.prev&&f!==t.next&&ya(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&va(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,d!==t.prev&&d!==t.next&&ya(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&va(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&ya(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&va(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&ya(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&va(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function ca(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!_a(i,o)&&ba(i,r,r.next,o)&&Ea(i,o)&&Ea(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Ca(r),Ca(r.next),r=t=o),r=r.next}while(r!==t);return oa(r)}function la(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&ga(a,s)){var u=Ta(a,s);return a=oa(a,a.next),u=oa(u,u.next),aa(a,e,n,r,i,o),void aa(u,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function ha(t,e){return t.x-e.x}function pa(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,h=n.y,p=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&ya(o<h?i:a,o,l,h,o<h?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),Ea(r,t)&&(u<p||u===p&&(r.x>n.x||r.x===n.x&&fa(n,r)))&&(n=r,p=u)),r=r.next}while(r!==c);return n}(t,e)){var n=Ta(e,t);oa(n,n.next)}}function fa(t,e){return va(t.prev,t,e.prev)<0&&va(e.next,t,t.next)<0}function da(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ma(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function ya(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function ga(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&ba(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Ea(t,e)&&Ea(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(va(t.prev,t,e.prev)||va(t,e.prev,e))||_a(t,e)&&va(t.prev,t,t.next)>0&&va(e.prev,e,e.next)>0)}function va(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function _a(t,e){return t.x===e.x&&t.y===e.y}function ba(t,e,n,r){var i=xa(va(t,e,n)),o=xa(va(t,e,r)),a=xa(va(n,r,t)),s=xa(va(n,r,e));return i!==o&&a!==s||!(0!==i||!wa(t,n,e))||!(0!==o||!wa(t,r,e))||!(0!==a||!wa(n,t,r))||!(0!==s||!wa(n,e,r))}function wa(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function xa(t){return t>0?1:t<0?-1:0}function Ea(t,e){return va(t.prev,t,t.next)<0?va(t,e,t.next)>=0&&va(t,t.prev,e)>=0:va(t,e,t.prev)<0||va(t,t.next,e)<0}function Ta(t,e){var n=new Ia(t.i,t.x,t.y),r=new Ia(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Sa(t,e,n,r){var i=new Ia(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ca(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ia(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ka(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}function Aa(t,e,n,r,i){!function t(e,n,r,i,o){for(;i>r;){if(i-r>600){var a=i-r+1,s=n-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),l=.5*Math.sqrt(u*c*(a-c)/a)*(s-a/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-s*c/a+l)),Math.min(i,Math.floor(n+(a-s)*c/a+l)),o)}var h=e[n],p=r,f=i;for(Oa(e,r,n),o(e[i],h)>0&&Oa(e,r,i);p<f;){for(Oa(e,p,f),p++,f--;o(e[p],h)<0;)p++;for(;o(e[f],h)>0;)f--}0===o(e[r],h)?Oa(e,r,f):Oa(e,++f,i),f<=n&&(r=f+1),n<=f&&(i=f-1)}}(t,e,n||0,r||t.length-1,i||Pa)}function Oa(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function Pa(t,e){return t<e?-1:t>e?1:0}function Da(t,e){var n=t.length;if(n<=1)return[t];for(var r,i,o=[],a=0;a<n;a++){var s=T(t[a]);0!==s&&(t[a].area=Math.abs(s),void 0===i&&(i=s<0),i===s<0?(r&&o.push(r),r=[t[a]]):r.push(t[a]))}if(r&&o.push(r),e>1)for(var u=0;u<o.length;u++)o[u].length<=e||(Aa(o[u],e,1,o[u].length-1,Ma),o[u]=o[u].slice(0,e));return o}function Ma(t,e){return e.area-t.area}function Ra(t,e,n){for(var r=n.patternDependencies,i=!1,o=0,a=e;o<a.length;o+=1){var s=a[o].paint.get(t+"-pattern");s.isConstant()||(i=!0);var u=s.constantOr(null);u&&(i=!0,r[u.to]=!0,r[u.from]=!0)}return i}function Na(t,e,n,r,i){for(var o=i.patternDependencies,a=0,s=e;a<s.length;a+=1){var u=s[a],c=u.paint.get(t+"-pattern").value;if("constant"!==c.kind){var l=c.evaluate({zoom:r-1},n,{},i.availableImages),h=c.evaluate({zoom:r},n,{},i.availableImages),p=c.evaluate({zoom:r+1},n,{},i.availableImages);l=l&&l.name?l.name:l,h=h&&h.name?h.name:h,p=p&&p.name?p.name:p,o[l]=!0,o[h]=!0,o[p]=!0,n.patterns[u.id]={min:l,mid:h,max:p}}}return n}ra.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(ka(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;a-=Math.abs(ka(t,c,l,n))}var h=0;for(s=0;s<r.length;s+=3){var p=r[s]*n,f=r[s+1]*n,d=r[s+2]*n;h+=Math.abs((t[p]-t[d])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[d+1]-t[p+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},ra.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n},ea.default=na;var La=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new fi,this.indexArray=new Ai,this.indexArray2=new Oi,this.programConfigurations=new fo(ta,t.layers,t.zoom),this.segments=new Ki,this.segments2=new Ki,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};La.prototype.populate=function(t,e){this.hasPattern=Ra("fill",this.layers,e);for(var n=this.layers[0].layout.get("fill-sort-key"),r=[],i=0,o=t;i<o.length;i+=1){var a=o[i],s=a.feature,u=a.index,c=a.sourceLayerIndex;if(this.layers[0]._featureFilter(new Hr(this.zoom),s)){var l=_o(s),h=n?n.evaluate(s,{},e.availableImages):void 0,p={id:s.id,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:l,patterns:{},sortKey:h};r.push(p)}}n&&r.sort((function(t,e){return t.sortKey-e.sortKey}));for(var f=0,d=r;f<d.length;f+=1){var m=d[f],y=m,g=y.geometry,v=y.index,_=y.sourceLayerIndex;if(this.hasPattern){var b=Na("fill",this.layers,m,this.zoom,e);this.patternFeatures.push(b)}else this.addFeature(m,g,v,{});var w=t[v].feature;e.featureIndex.insert(w,g,v,_,this.index)}},La.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},La.prototype.addFeatures=function(t,e){for(var n=0,r=this.patternFeatures;n<r.length;n+=1){var i=r[n];this.addFeature(i,i.geometry,i.index,e)}},La.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},La.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},La.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ta),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},La.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},La.prototype.addFeature=function(t,e,n,r){for(var i=0,o=Da(e,500);i<o.length;i+=1){for(var a=o[i],s=0,u=0,c=a;u<c.length;u+=1)s+=c[u].length;for(var l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),h=l.vertexLength,p=[],f=[],d=0,m=a;d<m.length;d+=1){var y=m[d];if(0!==y.length){y!==a[0]&&f.push(p.length/2);var g=this.segments2.prepareSegment(y.length,this.layoutVertexArray,this.indexArray2),v=g.vertexLength;this.layoutVertexArray.emplaceBack(y[0].x,y[0].y),this.indexArray2.emplaceBack(v+y.length-1,v),p.push(y[0].x),p.push(y[0].y);for(var _=1;_<y.length;_++)this.layoutVertexArray.emplaceBack(y[_].x,y[_].y),this.indexArray2.emplaceBack(v+_-1,v+_),p.push(y[_].x),p.push(y[_].y);g.vertexLength+=y.length,g.primitiveLength+=y.length}}for(var b=ea(p,f),w=0;w<b.length;w+=3)this.indexArray.emplaceBack(h+b[w],h+b[w+1],h+b[w+2]);l.vertexLength+=s,l.primitiveLength+=b.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r)},br("FillBucket",La,{omit:["layers","patternFeatures"]});var Fa=new ai({"fill-sort-key":new ni(It.layout_fill["fill-sort-key"])}),ja={paint:new ai({"fill-antialias":new ei(It.paint_fill["fill-antialias"]),"fill-opacity":new ni(It.paint_fill["fill-opacity"]),"fill-color":new ni(It.paint_fill["fill-color"]),"fill-outline-color":new ni(It.paint_fill["fill-outline-color"]),"fill-translate":new ei(It.paint_fill["fill-translate"]),"fill-translate-anchor":new ei(It.paint_fill["fill-translate-anchor"]),"fill-pattern":new ri(It.paint_fill["fill-pattern"])}),layout:Fa},za=function(t){function e(e){t.call(this,e,ja)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e,n){t.prototype.recalculate.call(this,e,n);var r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new La(t)},e.prototype.queryRadius=function(){return Ro(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,o,a){return To(No(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),r)},e.prototype.isTileClipped=function(){return!0},e}(si),Ba=hi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Ua=Va;function Va(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(qa,this,e)}function qa(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function Wa(t){for(var e,n,r=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],r+=((n=t[a]).x-e.x)*(e.y+n.y);return r}Va.types=["Unknown","Point","LineString","Polygon"],Va.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,r=1,o=0,a=0,s=0,u=[];t.pos<n;){if(o<=0){var c=t.readVarint();r=7&c,o=c>>3}if(o--,1===r||2===r)a+=t.readSVarint(),s+=t.readSVarint(),1===r&&(e&&u.push(e),e=[]),e.push(new i(a,s));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&u.push(e),u},Va.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;t.pos<e;){if(r<=0){var l=t.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)(i+=t.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=t.readSVarint())<u&&(u=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,u,s,c]},Va.prototype.toGeoJSON=function(t,e,n){var r,i,o=this.extent*Math.pow(2,n),a=this.extent*t,s=this.extent*e,u=this.loadGeometry(),c=Va.types[this.type];function l(t){for(var e=0;e<t.length;e++){var n=t[e],r=180-360*(n.y+s)/o;t[e]=[360*(n.x+a)/o-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(r=0;r<u.length;r++)h[r]=u[r][0];l(u=h);break;case 2:for(r=0;r<u.length;r++)l(u[r]);break;case 3:for(u=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var a=Wa(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}return n&&i.push(n),i}(u),r=0;r<u.length;r++)for(i=0;i<u[r].length;i++)l(u[r][i])}1===u.length?u=u[0]:c="Multi"+c;var p={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(p.id=this.id),p};var Ga=Ha;function Ha(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Ka,this,e),this.length=this._features.length}function Ka(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}function Qa(t,e,n){if(3===t){var r=new Ga(n,n.readVarint()+n.pos);r.length&&(e[r.name]=r)}}Ha.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Ua(this._pbf,e,this.extent,this._keys,this._values)};var Xa={VectorTile:function(t,e){this.layers=t.readFields(Qa,{},e)},VectorTileFeature:Ua,VectorTileLayer:Ga},Ya=Xa.VectorTileFeature.types,Za=Math.pow(2,13);function Ja(t,e,n,r,i,o,a,s){t.emplaceBack(e,n,2*Math.floor(r*Za)+a,i*Za*2,o*Za*2,Math.round(s))}var $a=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new mi,this.indexArray=new Ai,this.programConfigurations=new fo(Ba,t.layers,t.zoom),this.segments=new Ki,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function ts(t,e){return t.x===e.x&&(t.x<0||t.x>go)||t.y===e.y&&(t.y<0||t.y>go)}function es(t){return t.every((function(t){return t.x<0}))||t.every((function(t){return t.x>go}))||t.every((function(t){return t.y<0}))||t.every((function(t){return t.y>go}))}$a.prototype.populate=function(t,e){this.features=[],this.hasPattern=Ra("fill-extrusion",this.layers,e);for(var n=0,r=t;n<r.length;n+=1){var i=r[n],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Hr(this.zoom),o)){var u=_o(o),c={sourceLayerIndex:s,index:a,geometry:u,properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(c.id=o.id),this.hasPattern?this.features.push(Na("fill-extrusion",this.layers,c,this.zoom,e)):this.addFeature(c,u,a,{}),e.featureIndex.insert(o,u,a,s,this.index,!0)}}},$a.prototype.addFeatures=function(t,e){for(var n=0,r=this.features;n<r.length;n+=1){var i=r[n],o=i.geometry;this.addFeature(i,o,i.index,e)}},$a.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},$a.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},$a.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},$a.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ba),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},$a.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},$a.prototype.addFeature=function(t,e,n,r){for(var i=0,o=Da(e,500);i<o.length;i+=1){for(var a=o[i],s=0,u=0,c=a;u<c.length;u+=1)s+=c[u].length;for(var l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=0,p=a;h<p.length;h+=1){var f=p[h];if(0!==f.length&&!es(f))for(var d=0,m=0;m<f.length;m++){var y=f[m];if(m>=1){var g=f[m-1];if(!ts(y,g)){l.vertexLength+4>Ki.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var v=y.sub(g)._perp()._unit(),_=g.dist(y);d+_>32768&&(d=0),Ja(this.layoutVertexArray,y.x,y.y,v.x,v.y,0,0,d),Ja(this.layoutVertexArray,y.x,y.y,v.x,v.y,0,1,d),d+=_,Ja(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,0,d),Ja(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,1,d);var b=l.vertexLength;this.indexArray.emplaceBack(b,b+2,b+1),this.indexArray.emplaceBack(b+1,b+2,b+3),l.vertexLength+=4,l.primitiveLength+=2}}}}if(l.vertexLength+s>Ki.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray)),"Polygon"===Ya[t.type]){for(var w=[],x=[],E=l.vertexLength,T=0,S=a;T<S.length;T+=1){var C=S[T];if(0!==C.length){C!==a[0]&&x.push(w.length/2);for(var I=0;I<C.length;I++){var k=C[I];Ja(this.layoutVertexArray,k.x,k.y,0,0,1,1,0),w.push(k.x),w.push(k.y)}}}for(var A=ea(w,x),O=0;O<A.length;O+=3)this.indexArray.emplaceBack(E+A[O],E+A[O+2],E+A[O+1]);l.primitiveLength+=A.length/3,l.vertexLength+=s}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r)},br("FillExtrusionBucket",$a,{omit:["layers","features"]});var ns={paint:new ai({"fill-extrusion-opacity":new ei(It["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ni(It["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ei(It["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ei(It["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ri(It["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ni(It["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ni(It["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ei(It["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},rs=function(t){function e(e){t.call(this,e,ns)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new $a(t)},e.prototype.queryRadius=function(){return Ro(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(t,e,n,r,o,a,s,u){var c=No(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),l=this.paint.get("fill-extrusion-height").evaluate(e,n),h=this.paint.get("fill-extrusion-base").evaluate(e,n),p=function(t,e,n,r){for(var o=[],a=0,s=t;a<s.length;a+=1){var u=s[a],c=[u.x,u.y,0,1];Bo(c,c,e),o.push(new i(c[0]/c[3],c[1]/c[3]))}return o}(c,u),f=function(t,e,n,r){for(var o=[],a=[],s=r[8]*e,u=r[9]*e,c=r[10]*e,l=r[11]*e,h=r[8]*n,p=r[9]*n,f=r[10]*n,d=r[11]*n,m=0,y=t;m<y.length;m+=1){for(var g=[],v=[],_=0,b=y[m];_<b.length;_+=1){var w=b[_],x=w.x,E=w.y,T=r[0]*x+r[4]*E+r[12],S=r[1]*x+r[5]*E+r[13],C=r[2]*x+r[6]*E+r[14],I=r[3]*x+r[7]*E+r[15],k=C+c,A=I+l,O=T+h,P=S+p,D=C+f,M=I+d,R=new i((T+s)/A,(S+u)/A);R.z=k/A,g.push(R);var N=new i(O/M,P/M);N.z=D/M,v.push(N)}o.push(g),a.push(v)}return[o,a]}(r,h,l,u);return function(t,e,n){var r=1/0;To(n,e)&&(r=os(n,e[0]));for(var i=0;i<e.length;i++)for(var o=e[i],a=t[i],s=0;s<o.length-1;s++){var u=o[s],c=o[s+1],l=a[s],h=[u,c,a[s+1],l,u];xo(n,h)&&(r=Math.min(r,os(n,h)))}return r!==1/0&&r}(f[0],f[1],p)},e}(si);function is(t,e){return t.x*e.x+t.y*e.y}function os(t,e){if(1===t.length){var n=e[0],r=e[1],i=e[3],o=t[0],a=r.sub(n),s=i.sub(n),u=o.sub(n),c=is(a,a),l=is(a,s),h=is(s,s),p=is(u,a),f=is(u,s),d=c*h-l*l,m=(h*p-l*f)/d,y=(c*f-l*p)/d,g=1-m-y;return n.z*g+r.z*m+i.z*y}for(var v=1/0,_=0,b=e;_<b.length;_+=1){var w=b[_];v=Math.min(v,w.z)}return v}var as=hi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,ss=Xa.VectorTileFeature.types,us=Math.cos(Math.PI/180*37.5),cs=Math.pow(2,14)/.5,ls=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new yi,this.indexArray=new Ai,this.programConfigurations=new fo(as,t.layers,t.zoom),this.segments=new Ki,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};ls.prototype.populate=function(t,e){this.hasPattern=Ra("line",this.layers,e);for(var n=this.layers[0].layout.get("line-sort-key"),r=[],i=0,o=t;i<o.length;i+=1){var a=o[i],s=a.feature,u=a.index,c=a.sourceLayerIndex;if(this.layers[0]._featureFilter(new Hr(this.zoom),s)){var l=_o(s),h=n?n.evaluate(s,{}):void 0,p={id:s.id,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:l,patterns:{},sortKey:h};r.push(p)}}n&&r.sort((function(t,e){return t.sortKey-e.sortKey}));for(var f=0,d=r;f<d.length;f+=1){var m=d[f],y=m,g=y.geometry,v=y.index,_=y.sourceLayerIndex;if(this.hasPattern){var b=Na("line",this.layers,m,this.zoom,e);this.patternFeatures.push(b)}else this.addFeature(m,g,v,{});var w=t[v].feature;e.featureIndex.insert(w,g,v,_,this.index)}},ls.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},ls.prototype.addFeatures=function(t,e){for(var n=0,r=this.patternFeatures;n<r.length;n+=1){var i=r[n];this.addFeature(i,i.geometry,i.index,e)}},ls.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ls.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ls.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,as),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ls.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ls.prototype.addFeature=function(t,e,n,r){for(var i=this.layers[0].layout,o=i.get("line-join").evaluate(t,{}),a=i.get("line-cap"),s=i.get("line-miter-limit"),u=i.get("line-round-limit"),c=0,l=e;c<l.length;c+=1){var h=l[c];this.addLine(h,t,o,a,s,u,n,r)}},ls.prototype.addLine=function(t,e,n,r,i,o,a,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+e.properties.mapbox_clip_start,this.clipEnd=+e.properties.mapbox_clip_end;for(var u=0;u<t.length-1;u++)this.totalDistance+=t[u].dist(t[u+1])}for(var c="Polygon"===ss[e.type],l=t.length;l>=2&&t[l-1].equals(t[l-2]);)l--;for(var h=0;h<l-1&&t[h].equals(t[h+1]);)h++;if(!(l<(c?3:2))){"bevel"===n&&(i=1.05);var p,f=this.overscaling<=16?15*go/(512*this.overscaling):0,d=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray),m=void 0,y=void 0,g=void 0,v=void 0;this.e1=this.e2=-1,c&&(p=t[l-2],v=t[h].sub(p)._unit()._perp());for(var _=h;_<l;_++)if(!(y=c&&_===l-1?t[h+1]:t[_+1])||!t[_].equals(y)){v&&(g=v),p&&(m=p),p=t[_],v=y?y.sub(p)._unit()._perp():g;var b=(g=g||v).add(v);0===b.x&&0===b.y||b._unit();var w=g.x*v.x+g.y*v.y,x=b.x*v.x+b.y*v.y,E=0!==x?1/x:1/0,T=2*Math.sqrt(2-2*x),S=x<us&&m&&y,C=g.x*v.y-g.y*v.x>0;if(S&&_>h){var I=p.dist(m);if(I>2*f){var k=p.sub(p.sub(m)._mult(f/I)._round());this.updateDistance(m,k),this.addCurrentVertex(k,g,0,0,d),m=k}}var A=m&&y,O=A?n:c?"butt":r;if(A&&"round"===O&&(E<o?O="miter":E<=2&&(O="fakeround")),"miter"===O&&E>i&&(O="bevel"),"bevel"===O&&(E>2&&(O="flipbevel"),E<i&&(O="miter")),m&&this.updateDistance(m,p),"miter"===O)b._mult(E),this.addCurrentVertex(p,b,0,0,d);else if("flipbevel"===O){if(E>100)b=v.mult(-1);else{var P=E*g.add(v).mag()/g.sub(v).mag();b._perp()._mult(P*(C?-1:1))}this.addCurrentVertex(p,b,0,0,d),this.addCurrentVertex(p,b.mult(-1),0,0,d)}else if("bevel"===O||"fakeround"===O){var D=-Math.sqrt(E*E-1),M=C?D:0,R=C?0:D;if(m&&this.addCurrentVertex(p,g,M,R,d),"fakeround"===O)for(var N=Math.round(180*T/Math.PI/20),L=1;L<N;L++){var F=L/N;if(.5!==F){var j=F-.5;F+=F*j*(F-1)*((1.0904+w*(w*(3.55645-1.43519*w)-3.2452))*j*j+(.848013+w*(.215638*w-1.06021)))}var z=v.sub(g)._mult(F)._add(g)._unit()._mult(C?-1:1);this.addHalfVertex(p,z.x,z.y,!1,C,0,d)}y&&this.addCurrentVertex(p,v,-M,-R,d)}else if("butt"===O)this.addCurrentVertex(p,b,0,0,d);else if("square"===O){var B=m?1:-1;this.addCurrentVertex(p,b,B,B,d)}else"round"===O&&(m&&(this.addCurrentVertex(p,g,0,0,d),this.addCurrentVertex(p,g,1,1,d,!0)),y&&(this.addCurrentVertex(p,v,-1,-1,d,!0),this.addCurrentVertex(p,v,0,0,d)));if(S&&_<l-1){var U=p.dist(y);if(U>2*f){var V=p.add(y.sub(p)._mult(f/U)._round());this.updateDistance(p,V),this.addCurrentVertex(V,v,0,0,d),p=V}}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,s)}},ls.prototype.addCurrentVertex=function(t,e,n,r,i,o){void 0===o&&(o=!1);var a=e.x+e.y*n,s=e.y-e.x*n,u=-e.x+e.y*r,c=-e.y-e.x*r;this.addHalfVertex(t,a,s,o,!1,n,i),this.addHalfVertex(t,u,c,o,!0,-r,i),this.distance>cs/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,n,r,i,o))},ls.prototype.addHalfVertex=function(t,e,n,r,i,o,a){var s=t.x,u=t.y,c=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((s<<1)+(r?1:0),(u<<1)+(i?1:0),Math.round(63*e)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1)|(63&c)<<2,c>>6);var l=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),a.primitiveLength++),i?this.e2=l:this.e1=l},ls.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(cs-1):this.distance},br("LineBucket",ls,{omit:["layers","patternFeatures"]});var hs=new ai({"line-cap":new ei(It.layout_line["line-cap"]),"line-join":new ni(It.layout_line["line-join"]),"line-miter-limit":new ei(It.layout_line["line-miter-limit"]),"line-round-limit":new ei(It.layout_line["line-round-limit"]),"line-sort-key":new ni(It.layout_line["line-sort-key"])}),ps={paint:new ai({"line-opacity":new ni(It.paint_line["line-opacity"]),"line-color":new ni(It.paint_line["line-color"]),"line-translate":new ei(It.paint_line["line-translate"]),"line-translate-anchor":new ei(It.paint_line["line-translate-anchor"]),"line-width":new ni(It.paint_line["line-width"]),"line-gap-width":new ni(It.paint_line["line-gap-width"]),"line-offset":new ni(It.paint_line["line-offset"]),"line-blur":new ni(It.paint_line["line-blur"]),"line-dasharray":new ii(It.paint_line["line-dasharray"]),"line-pattern":new ri(It.paint_line["line-pattern"]),"line-gradient":new oi(It.paint_line["line-gradient"])}),layout:hs},fs=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(e,n){return n=new Hr(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),t.prototype.possiblyEvaluate.call(this,e,n)},e.prototype.evaluate=function(e,n,r,i){return n=h({},n,{zoom:Math.floor(n.zoom)}),t.prototype.evaluate.call(this,e,n,r,i)},e}(ni))(ps.paint.properties["line-width"].specification);fs.useIntegerZoom=!0;var ds=function(t){function e(e){t.call(this,e,ps)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},e.prototype._updateGradient=function(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Yo(t,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(e,n){t.prototype.recalculate.call(this,e,n),this.paint._values["line-floorwidth"]=fs.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new ls(t)},e.prototype.queryRadius=function(t){var e=t,n=ms(Mo("line-width",this,e),Mo("line-gap-width",this,e)),r=Mo("line-offset",this,e);return n/2+Math.abs(r)+Ro(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,o,a,s){var u=No(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),c=s/2*ms(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),l=this.paint.get("line-offset").evaluate(e,n);return l&&(r=function(t,e){for(var n=[],r=new i(0,0),o=0;o<t.length;o++){for(var a=t[o],s=[],u=0;u<a.length;u++){var c=a[u-1],l=a[u],h=a[u+1],p=0===u?r:l.sub(c)._unit()._perp(),f=u===a.length-1?r:h.sub(l)._unit()._perp(),d=p._add(f)._unit(),m=d.x*f.x+d.y*f.y;d._mult(1/m),s.push(d._mult(e)._add(l))}n.push(s)}return n}(r,l*s)),function(t,e,n){for(var r=0;r<e.length;r++){var i=e[r];if(t.length>=3)for(var o=0;o<i.length;o++)if(Po(t,i[o]))return!0;if(So(t,i,n))return!0}return!1}(u,r,c)},e.prototype.isTileClipped=function(){return!0},e}(si);function ms(t,e){return e>0?e+2*t:t}var ys=hi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),gs=hi([{name:"a_projected_pos",components:3,type:"Float32"}],4),vs=(hi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),hi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),_s=(hi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),hi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),bs=hi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);function ws(t,e,n){return t.sections.forEach((function(t){t.text=function(t,e,n){var r=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),Gr.applyArabicShaping&&(t=Gr.applyArabicShaping(t)),t}(t.text,e,n)})),t}hi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),hi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"}]),hi([{type:"Float32",name:"offsetX"}]),hi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var xs={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},Es=24,Ts=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,p=n?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-l)-1,f>>=-l,l+=s;l>0;o=256*o+t[e+h],h+=p,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+h],h+=p,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=c}return(f?-1:1)*a*Math.pow(2,o-r)},Ss=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+h>=1?p/u:p*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(e*u-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+f]=255&s,f+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+f]=255&a,f+=d,a/=256,c-=8);t[n+f-d]|=128*m},Cs=Is;function Is(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Is.Varint=0,Is.Fixed64=1,Is.Bytes=2,Is.Fixed32=5;var ks="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function As(t){return t.type===Is.Bytes?t.readVarint()+t.pos:t.pos+1}function Os(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Ps(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function Ds(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function Ms(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function Rs(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Ns(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function Ls(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Fs(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function js(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function zs(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function Bs(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Us(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Vs(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function qs(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Is.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Us(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=qs(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Us(this.buf,this.pos)+4294967296*Us(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Us(this.buf,this.pos)+4294967296*qs(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Ts(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Ts(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return Os(t,r,e);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return Os(t,r,e);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return Os(t,r,e);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return Os(t,r,e);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return Os(t,r,e);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return Os(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&ks?function(t,e,n){return ks.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var r="",i=e;i<n;){var o,a,s,u=t[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>n)break;1===l?u<128&&(c=u):2===l?128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=l}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Is.Bytes)return t.push(this.readVarint(e));var n=As(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Is.Bytes)return t.push(this.readSVarint());var e=As(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Is.Bytes)return t.push(this.readBoolean());var e=As(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Is.Bytes)return t.push(this.readFloat());var e=As(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Is.Bytes)return t.push(this.readDouble());var e=As(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Is.Bytes)return t.push(this.readFixed32());var e=As(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Is.Bytes)return t.push(this.readSFixed32());var e=As(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Is.Bytes)return t.push(this.readFixed64());var e=As(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Is.Bytes)return t.push(this.readSFixed64());var e=As(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Is.Varint)for(;this.buf[this.pos++]>127;);else if(e===Is.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Is.Fixed32)this.pos+=4;else{if(e!==Is.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Vs(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Vs(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Vs(this.buf,-1&t,this.pos),Vs(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Vs(this.buf,-1&t,this.pos),Vs(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Ps(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Ss(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Ss(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&Ps(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,Is.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Ds,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Ms,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Ls,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Rs,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Ns,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Fs,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,js,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,zs,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Bs,e)},writeBytesField:function(t,e){this.writeTag(t,Is.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Is.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Is.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Is.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Is.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Is.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Is.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Is.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Is.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Is.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Ws=3;function Gs(t,e,n){1===t&&n.readMessage(Hs,e)}function Hs(t,e,n){if(3===t){var r=n.readMessage(Ks,{}),i=r.id,o=r.bitmap,a=r.width,s=r.height,u=r.left,c=r.top,l=r.advance;e.push({id:i,bitmap:new Ko({width:a+2*Ws,height:s+2*Ws},o),metrics:{width:a,height:s,left:u,top:c,advance:l}})}}function Ks(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}var Qs=Ws;function Xs(t){for(var e=0,n=0,r=0,i=t;r<i.length;r+=1){var o=i[r];e+=o.w*o.h,n=Math.max(n,o.w)}t.sort((function(t,e){return e.h-t.h}));for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}],s=0,u=0,c=0,l=t;c<l.length;c+=1)for(var h=l[c],p=a.length-1;p>=0;p--){var f=a[p];if(!(h.w>f.w||h.h>f.h)){if(h.x=f.x,h.y=f.y,u=Math.max(u,h.y+h.h),s=Math.max(s,h.x+h.w),h.w===f.w&&h.h===f.h){var d=a.pop();p<a.length&&(a[p]=d)}else h.h===f.h?(f.x+=h.w,f.w-=h.w):h.w===f.w?(f.y+=h.h,f.h-=h.h):(a.push({x:f.x+h.w,y:f.y,w:f.w-h.w,h:h.h}),f.y+=h.h,f.h-=h.h);break}}return{w:s,h:u,fill:e/(s*u)||0}}var Ys=1,Zs=function(t,e){var n=e.pixelRatio,r=e.version,i=e.stretchX,o=e.stretchY,a=e.content;this.paddedRect=t,this.pixelRatio=n,this.stretchX=i,this.stretchY=o,this.content=a,this.version=r},Js={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Js.tl.get=function(){return[this.paddedRect.x+Ys,this.paddedRect.y+Ys]},Js.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-Ys,this.paddedRect.y+this.paddedRect.h-Ys]},Js.tlbr.get=function(){return this.tl.concat(this.br)},Js.displaySize.get=function(){return[(this.paddedRect.w-2*Ys)/this.pixelRatio,(this.paddedRect.h-2*Ys)/this.pixelRatio]},Object.defineProperties(Zs.prototype,Js);var $s=function(t,e){var n={},r={};this.haveRenderCallbacks=[];var i=[];this.addImages(t,n,i),this.addImages(e,r,i);var o=Xs(i),a=o.w,s=o.h,u=new Qo({width:a||1,height:s||1});for(var c in t){var l=t[c],h=n[c].paddedRect;Qo.copy(l.data,u,{x:0,y:0},{x:h.x+Ys,y:h.y+Ys},l.data)}for(var p in e){var f=e[p],d=r[p].paddedRect,m=d.x+Ys,y=d.y+Ys,g=f.data.width,v=f.data.height;Qo.copy(f.data,u,{x:0,y:0},{x:m,y:y},f.data),Qo.copy(f.data,u,{x:0,y:v-1},{x:m,y:y-1},{width:g,height:1}),Qo.copy(f.data,u,{x:0,y:0},{x:m,y:y+v},{width:g,height:1}),Qo.copy(f.data,u,{x:g-1,y:0},{x:m-1,y:y},{width:1,height:v}),Qo.copy(f.data,u,{x:0,y:0},{x:m+g,y:y},{width:1,height:v})}this.image=u,this.iconPositions=n,this.patternPositions=r};$s.prototype.addImages=function(t,e,n){for(var r in t){var i=t[r],o={x:0,y:0,w:i.data.width+2*Ys,h:i.data.height+2*Ys};n.push(o),e[r]=new Zs(o,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(r)}},$s.prototype.patchUpdatedImages=function(t,e){for(var n in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)},$s.prototype.patchUpdatedImage=function(t,e,n){if(t&&e&&t.version!==e.version){t.version=e.version;var r=t.tl,i=r[0],o=r[1];n.update(e.data,void 0,{x:i,y:o})}},br("ImagePosition",Zs),br("ImageAtlas",$s);var tu={horizontal:1,vertical:2,horizontalOnly:3},eu=-17,nu=function(){this.scale=1,this.fontStack="",this.imageName=null};nu.forText=function(t,e){var n=new nu;return n.scale=t||1,n.fontStack=e,n},nu.forImage=function(t){var e=new nu;return e.imageName=t,e};var ru=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function iu(t,e,n,r,i,o,a,s,u,c,l,h,p,f,d,m){var y,g=ru.fromFeature(t,i);h===tu.vertical&&g.verticalizePunctuation();var v=Gr.processBidirectionalText,_=Gr.processStyledBidirectionalText;if(v&&1===g.sections.length){y=[];for(var b=0,w=v(g.toString(),hu(g,c,o,e,r,f,d));b<w.length;b+=1){var x=w[b],E=new ru;E.text=x,E.sections=g.sections;for(var T=0;T<x.length;T++)E.sectionIndex.push(0);y.push(E)}}else if(_){y=[];for(var S=0,C=_(g.text,g.sectionIndex,hu(g,c,o,e,r,f,d));S<C.length;S+=1){var I=C[S],k=new ru;k.text=I[0],k.sectionIndex=I[1],k.sections=g.sections,y.push(k)}}else y=function(t,e){for(var n=[],r=t.text,i=0,o=0,a=e;o<a.length;o+=1){var s=a[o];n.push(t.substring(i,s)),i=s}return i<r.length&&n.push(t.substring(i,r.length)),n}(g,hu(g,c,o,e,r,f,d));var A=[],O={positionedLines:A,text:g.toString(),top:l[1],bottom:l[1],left:l[0],right:l[0],writingMode:h,iconsInText:!1,verticalizable:!1};return function(t,e,n,r,i,o,a,s,u,c,l,h){for(var p=0,f=eu,d=0,m=0,y="right"===s?1:"left"===s?0:.5,g=0,v=0,_=i;v<_.length;v+=1){var b=_[v];b.trim();var w=b.getMaxScale(),x=(w-1)*Es,E={positionedGlyphs:[],lineOffset:0};t.positionedLines[g]=E;var T=E.positionedGlyphs,S=0;if(b.length()){for(var C=0;C<b.length();C++){var I=b.getSection(C),k=b.getSectionIndex(C),A=b.getCharCode(C),O=0,P=null,D=null,M=null,R=Es,N=!(u===tu.horizontal||!l&&!Ar(A)||l&&(ou[A]||(G=A,Cr.Arabic(G)||Cr["Arabic Supplement"](G)||Cr["Arabic Extended-A"](G)||Cr["Arabic Presentation Forms-A"](G)||Cr["Arabic Presentation Forms-B"](G))));if(I.imageName){var L=r[I.imageName];if(!L)continue;M=I.imageName,t.iconsInText=t.iconsInText||!0,D=L.paddedRect;var F=L.displaySize;I.scale=I.scale*Es/h,P={width:F[0],height:F[1],left:Ys,top:-Qs,advance:N?F[1]:F[0]},O=x+(Es-F[1]*I.scale),R=P.advance;var j=N?F[0]*I.scale-Es*w:F[1]*I.scale-Es*w;j>0&&j>S&&(S=j)}else{var z=n[I.fontStack],B=z&&z[A];if(B&&B.rect)D=B.rect,P=B.metrics;else{var U=e[I.fontStack],V=U&&U[A];if(!V)continue;P=V.metrics}O=(w-I.scale)*Es}N?(t.verticalizable=!0,T.push({glyph:A,imageName:M,x:p,y:f+O,vertical:N,scale:I.scale,fontStack:I.fontStack,sectionIndex:k,metrics:P,rect:D}),p+=R*I.scale+c):(T.push({glyph:A,imageName:M,x:p,y:f+O,vertical:N,scale:I.scale,fontStack:I.fontStack,sectionIndex:k,metrics:P,rect:D}),p+=P.advance*I.scale+c)}if(0!==T.length){var q=p-c;d=Math.max(q,d),fu(T,0,T.length-1,y,S)}p=0;var W=o*w+S;E.lineOffset=Math.max(S,x),f+=W,m=Math.max(W,m),++g}else f+=o,++g}var G,H=f-eu,K=pu(a),Q=K.horizontalAlign,X=K.verticalAlign;(function(t,e,n,r,i,o,a,s,u){var c,l=(e-n)*i;c=o!==a?-s*r-eu:(-r*u+.5)*a;for(var h=0,p=t;h<p.length;h+=1)for(var f=0,d=p[h].positionedGlyphs;f<d.length;f+=1){var m=d[f];m.x+=l,m.y+=c}})(t.positionedLines,y,Q,X,d,m,o,H,i.length),t.top+=-X*H,t.bottom=t.top+H,t.left+=-Q*d,t.right=t.left+d}(O,e,n,r,y,a,s,u,h,c,p,m),!function(t){for(var e=0,n=t;e<n.length;e+=1)if(0!==n[e].positionedGlyphs.length)return!1;return!0}(A)&&O}ru.fromFeature=function(t,e){for(var n=new ru,r=0;r<t.sections.length;r++){var i=t.sections[r];i.image?n.addImageSection(i):n.addTextSection(i,e)}return n},ru.prototype.length=function(){return this.text.length},ru.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},ru.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},ru.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},ru.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n+1)||null,i=t.charCodeAt(n-1)||null;r&&Or(r)&&!xs[t[n+1]]||i&&Or(i)&&!xs[t[n-1]]||!xs[t[n]]?e+=t[n]:e+=xs[t[n]]}return e}(this.text)},ru.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&ou[this.text.charCodeAt(e)];e++)t++;for(var n=this.text.length,r=this.text.length-1;r>=0&&r>=t&&ou[this.text.charCodeAt(r)];r--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)},ru.prototype.substring=function(t,e){var n=new ru;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n},ru.prototype.toString=function(){return this.text},ru.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce((function(e,n){return Math.max(e,t.sections[n].scale)}),0)},ru.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(nu.forText(t.scale,t.fontStack||e));for(var n=this.sections.length-1,r=0;r<t.text.length;++r)this.sectionIndex.push(n)},ru.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(0!==e.length){var n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(nu.forImage(e)),this.sectionIndex.push(this.sections.length-1)):x("Reached maximum number of images 6401")}else x("Can't add FormattedSection with an empty image.")},ru.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var ou={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},au={};function su(t,e,n,r,i,o){if(e.imageName){var a=r[e.imageName];return a?a.displaySize[0]*e.scale*Es/o+i:0}var s=n[e.fontStack],u=s&&s[t];return u?u.metrics.advance*e.scale+i:0}function uu(t,e,n,r){var i=Math.pow(t-e,2);return r?t<e?i/2:2*i:i+Math.abs(n)*n}function cu(t,e,n){var r=0;return 10===t&&(r-=1e4),n&&(r+=150),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function lu(t,e,n,r,i,o){for(var a=null,s=uu(e,n,i,o),u=0,c=r;u<c.length;u+=1){var l=c[u],h=uu(e-l.x,n,i,o)+l.badness;h<=s&&(a=l,s=h)}return{index:t,x:e,priorBreak:a,badness:s}}function hu(t,e,n,r,i,o,a){if("point"!==o)return[];if(!t)return[];for(var s,u=[],c=function(t,e,n,r,i,o){for(var a=0,s=0;s<t.length();s++){var u=t.getSection(s);a+=su(t.getCharCode(s),u,r,i,e,o)}return a/Math.max(1,Math.ceil(a/n))}(t,e,n,r,i,a),l=t.text.indexOf("\u200b")>=0,h=0,p=0;p<t.length();p++){var f=t.getSection(p),d=t.getCharCode(p);if(ou[d]||(h+=su(d,f,r,i,e,a)),p<t.length()-1){var m=!((s=d)<11904||!(Cr["Bopomofo Extended"](s)||Cr.Bopomofo(s)||Cr["CJK Compatibility Forms"](s)||Cr["CJK Compatibility Ideographs"](s)||Cr["CJK Compatibility"](s)||Cr["CJK Radicals Supplement"](s)||Cr["CJK Strokes"](s)||Cr["CJK Symbols and Punctuation"](s)||Cr["CJK Unified Ideographs Extension A"](s)||Cr["CJK Unified Ideographs"](s)||Cr["Enclosed CJK Letters and Months"](s)||Cr["Halfwidth and Fullwidth Forms"](s)||Cr.Hiragana(s)||Cr["Ideographic Description Characters"](s)||Cr["Kangxi Radicals"](s)||Cr["Katakana Phonetic Extensions"](s)||Cr.Katakana(s)||Cr["Vertical Forms"](s)||Cr["Yi Radicals"](s)||Cr["Yi Syllables"](s)));(au[d]||m||f.imageName)&&u.push(lu(p+1,h,c,u,cu(d,t.getCharCode(p+1),m&&l),!1))}}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(lu(t.length(),h,c,u,0,!0))}function pu(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function fu(t,e,n,r,i){if(r||i)for(var o=t[n],a=o.metrics.advance*o.scale,s=(t[n].x+a)*r,u=e;u<=n;u++)t[u].x-=s,t[u].y+=i}function du(t,e,n,r,i,o){var a,s=t.image;if(s.content){var u=s.content,c=s.pixelRatio||1;a=[u[0]/c,u[1]/c,s.displaySize[0]-u[2]/c,s.displaySize[1]-u[3]/c]}var l,h,p,f,d=e.left*o,m=e.right*o;"width"===n||"both"===n?(f=i[0]+d-r[3],h=i[0]+m+r[1]):h=(f=i[0]+(d+m-s.displaySize[0])/2)+s.displaySize[0];var y=e.top*o,g=e.bottom*o;return"height"===n||"both"===n?(l=i[1]+y-r[0],p=i[1]+g+r[2]):p=(l=i[1]+(y+g-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:l,right:h,bottom:p,left:f,collisionPadding:a}}au[10]=!0,au[32]=!0,au[38]=!0,au[40]=!0,au[41]=!0,au[43]=!0,au[45]=!0,au[47]=!0,au[173]=!0,au[183]=!0,au[8203]=!0,au[8208]=!0,au[8211]=!0,au[8231]=!0;var mu=function(t){function e(e,n,r,i){t.call(this,e,n),this.angle=r,void 0!==i&&(this.segment=i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(i);br("Anchor",mu);var yu=128;function gu(t,e){var n=e.expression;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new Hr(t+1))};if("source"===n.kind)return{kind:"source"};for(var r=n.zoomStops,i=n.interpolationType,o=0;o<r.length&&r[o]<=t;)o++;for(var a=o=Math.max(0,o-1);a<r.length&&r[a]<t+1;)a++;a=Math.min(r.length-1,a);var s=r[o],u=r[a];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:u,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:u,minSize:n.evaluate(new Hr(s)),maxSize:n.evaluate(new Hr(u)),interpolationType:i}}function vu(t,e,n){var r=e.uSize,i=e.uSizeT,o=n.lowerSize,a=n.upperSize;return"source"===t.kind?o/yu:"composite"===t.kind?Ee(o/yu,a/yu,i):r}function _u(t,e){var n=0,r=0;if("constant"===t.kind)r=t.layoutSize;else if("source"!==t.kind){var i=t.interpolationType,o=t.minZoom,a=t.maxZoom,s=i?c(We.interpolationFactor(i,e,o,a),0,1):0;"camera"===t.kind?r=Ee(t.minSize,t.maxSize,s):n=s}return{uSizeT:n,uSize:r}}var bu=Object.freeze({__proto__:null,getSizeData:gu,evaluateSizeForFeature:vu,evaluateSizeForZoom:_u,SIZE_PACK_FACTOR:yu});function wu(t,e,n,r,i){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-n/2;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var u=[],c=0;s<n/2;){var l=t[a-1],h=t[a],p=t[a+1];if(!p)return!1;var f=l.angleTo(h)-h.angleTo(p);for(f=Math.abs((f+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:s,angleDelta:f}),c+=f;s-u[0].distance>r;)c-=u.shift().angleDelta;if(c>i)return!1;a++,s+=h.dist(p)}return!0}function xu(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function Eu(t,e,n){return t?.6*e*n:0}function Tu(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Su(t,e,n,r,i,o){for(var a=Eu(n,i,o),s=Tu(n,r)*o,u=0,c=xu(t)/2,l=0;l<t.length-1;l++){var h=t[l],p=t[l+1],f=h.dist(p);if(u+f>c){var d=(c-u)/f,m=Ee(h.x,p.x,d),y=Ee(h.y,p.y,d),g=new mu(m,y,p.angleTo(h),l);return g._round(),!a||wu(t,g,s,a,e)?g:void 0}u+=f}}function Cu(t,e,n,r,i,o,a,s,u){var c=Eu(r,o,a),l=Tu(r,i),h=l*a,p=0===t[0].x||t[0].x===u||0===t[0].y||t[0].y===u;return e-h<e/4&&(e=h+e/4),function t(e,n,r,i,o,a,s,u,c){for(var l=a/2,h=xu(e),p=0,f=n-r,d=[],m=0;m<e.length-1;m++){for(var y=e[m],g=e[m+1],v=y.dist(g),_=g.angleTo(y);f+r<p+v;){var b=((f+=r)-p)/v,w=Ee(y.x,g.x,b),x=Ee(y.y,g.y,b);if(w>=0&&w<c&&x>=0&&x<c&&f-l>=0&&f+l<=h){var E=new mu(w,x,_,m);E._round(),i&&!wu(e,E,a,i,o)||d.push(E)}}p+=v}return u||d.length||s||(d=t(e,p/2,r,i,o,a,s,!0,c)),d}(t,p?e/2*s%e:(l/2+2*o)*a*s%e,e,c,n,h,p,!1,u)}var Iu=Ys;function ku(t,e,n,r){var o=[],a=t.image,s=a.pixelRatio,u=a.paddedRect.w-2*Iu,c=a.paddedRect.h-2*Iu,l=t.right-t.left,h=t.bottom-t.top,p=a.stretchX||[[0,u]],f=a.stretchY||[[0,c]],d=function(t,e){return t+e[1]-e[0]},m=p.reduce(d,0),y=f.reduce(d,0),g=u-m,v=c-y,_=0,b=m,w=0,x=y,E=0,T=g,S=0,C=v;if(a.content&&r){var I=a.content;_=Au(p,0,I[0]),w=Au(f,0,I[1]),b=Au(p,I[0],I[2]),x=Au(f,I[1],I[3]),E=I[0]-_,S=I[1]-w,T=I[2]-I[0]-b,C=I[3]-I[1]-x}var k=function(r,o,u,c){var p=Pu(r.stretch-_,b,l,t.left),f=Du(r.fixed-E,T,r.stretch,m),d=Pu(o.stretch-w,x,h,t.top),g=Du(o.fixed-S,C,o.stretch,y),v=Pu(u.stretch-_,b,l,t.left),I=Du(u.fixed-E,T,u.stretch,m),k=Pu(c.stretch-w,x,h,t.top),A=Du(c.fixed-S,C,c.stretch,y),O=new i(p,d),P=new i(v,d),D=new i(v,k),M=new i(p,k),R=new i(f/s,g/s),N=new i(I/s,A/s),L=e*Math.PI/180;if(L){var F=Math.sin(L),j=Math.cos(L),z=[j,-F,F,j];O._matMult(z),P._matMult(z),M._matMult(z),D._matMult(z)}var B=r.stretch+r.fixed,U=u.stretch+u.fixed,V=o.stretch+o.fixed,q=c.stretch+c.fixed;return{tl:O,tr:P,bl:M,br:D,tex:{x:a.paddedRect.x+Iu+B,y:a.paddedRect.y+Iu+V,w:U-B,h:q-V},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:R,pixelOffsetBR:N,minFontScaleX:T/s/l,minFontScaleY:C/s/h,isSDF:n}};if(r&&(a.stretchX||a.stretchY))for(var A=Ou(p,g,m),O=Ou(f,v,y),P=0;P<A.length-1;P++)for(var D=A[P],M=A[P+1],R=0;R<O.length-1;R++){var N=O[R],L=O[R+1];o.push(k(D,N,M,L))}else o.push(k({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:u+1},{fixed:0,stretch:c+1}));return o}function Au(t,e,n){for(var r=0,i=0,o=t;i<o.length;i+=1){var a=o[i];r+=Math.max(e,Math.min(n,a[1]))-Math.max(e,Math.min(n,a[0]))}return r}function Ou(t,e,n){for(var r=[{fixed:-Iu,stretch:0}],i=0,o=t;i<o.length;i+=1){var a=o[i],s=a[0],u=a[1],c=r[r.length-1];r.push({fixed:s-c.stretch,stretch:c.stretch}),r.push({fixed:s-c.stretch,stretch:c.stretch+(u-s)})}return r.push({fixed:e+Iu,stretch:n}),r}function Pu(t,e,n,r){return t/e*n+r}function Du(t,e,n,r){return t-e*n/r}var Mu=function(t,e,n,r,o,a,s,u,c,l,h,p){var f=s.top*u-c,d=s.bottom*u+c,m=s.left*u-c,y=s.right*u+c,g=s.collisionPadding;if(g&&(m-=g[0]*u,f-=g[1]*u,y+=g[2]*u,d+=g[3]*u),this.boxStartIndex=t.length,l){var v=d-f,_=y-m;v>0&&(v=Math.max(10*u,v),this._addLineCollisionCircles(t,e,n,n.segment,_,v,r,o,a,h))}else{if(p){var b=new i(m,f),w=new i(y,f),x=new i(m,d),E=new i(y,d),T=p*Math.PI/180;b._rotate(T),w._rotate(T),x._rotate(T),E._rotate(T),m=Math.min(b.x,w.x,x.x,E.x),y=Math.max(b.x,w.x,x.x,E.x),f=Math.min(b.y,w.y,x.y,E.y),d=Math.max(b.y,w.y,x.y,E.y)}t.emplaceBack(n.x,n.y,m,f,y,d,r,o,a,0,0)}this.boxEndIndex=t.length};Mu.prototype._addLineCollisionCircles=function(t,e,n,r,i,o,a,s,u,c){var l=o/2,h=Math.floor(i/l)||1,p=1+.4*Math.log(c)/Math.LN2,f=Math.floor(h*p/2),d=-o/2,m=n,y=r+1,g=d,v=-i/2,_=v-i/4;do{if(--y<0){if(g>v)return;y=0;break}g-=e[y].dist(m),m=e[y]}while(g>_);for(var b=e[y].dist(e[y+1]),w=-f;w<h+f;w++){var x=w*l,E=v+x;if(x<0&&(E+=x),x>i&&(E+=x-i),!(E<g)){for(;g+b<E;){if(g+=b,++y+1>=e.length)return;b=e[y].dist(e[y+1])}var T=E-g,S=e[y],C=e[y+1].sub(S)._unit()._mult(T)._add(S)._round(),I=Math.abs(E-d)<l?0:.8*(E-d);t.emplaceBack(C.x,C.y,-o/2,-o/2,o/2,o/2,a,s,u,o/2,I)}}};var Ru=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=Nu),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)};function Nu(t,e){return t<e?-1:t>e?1:0}function Lu(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!1);for(var r=1/0,o=1/0,a=-1/0,s=-1/0,u=t[0],c=0;c<u.length;c++){var l=u[c];(!c||l.x<r)&&(r=l.x),(!c||l.y<o)&&(o=l.y),(!c||l.x>a)&&(a=l.x),(!c||l.y>s)&&(s=l.y)}var h=a-r,p=s-o,f=Math.min(h,p),d=f/2,m=new Ru([],Fu);if(0===f)return new i(r,o);for(var y=r;y<a;y+=f)for(var g=o;g<s;g+=f)m.push(new ju(y+d,g+d,d,t));for(var v=function(t){for(var e=0,n=0,r=0,i=t[0],o=0,a=i.length,s=a-1;o<a;s=o++){var u=i[o],c=i[s],l=u.x*c.y-c.x*u.y;n+=(u.x+c.x)*l,r+=(u.y+c.y)*l,e+=3*l}return new ju(n/e,r/e,0,t)}(t),_=m.length;m.length;){var b=m.pop();(b.d>v.d||!v.d)&&(v=b,n&&console.log("found best %d after %d probes",Math.round(1e4*b.d)/1e4,_)),b.max-v.d<=e||(d=b.h/2,m.push(new ju(b.p.x-d,b.p.y-d,d,t)),m.push(new ju(b.p.x+d,b.p.y-d,d,t)),m.push(new ju(b.p.x-d,b.p.y+d,d,t)),m.push(new ju(b.p.x+d,b.p.y+d,d,t)),_+=4)}return n&&(console.log("num probes: "+_),console.log("best distance: "+v.d)),v.p}function Fu(t,e){return e.max-t.max}function ju(t,e,n,r){this.p=new i(t,e),this.h=n,this.d=function(t,e){for(var n=!1,r=1/0,i=0;i<e.length;i++)for(var o=e[i],a=0,s=o.length,u=s-1;a<s;u=a++){var c=o[a],l=o[u];c.y>t.y!=l.y>t.y&&t.x<(l.x-c.x)*(t.y-c.y)/(l.y-c.y)+c.x&&(n=!n),r=Math.min(r,Ao(t,c,l))}return(n?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}Ru.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Ru.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},Ru.prototype.peek=function(){return this.data[0]},Ru.prototype._up=function(t){for(var e=this.data,n=this.compare,r=e[t];t>0;){var i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r},Ru.prototype._down=function(t){for(var e=this.data,n=this.compare,r=this.length>>1,i=e[t];t<r;){var o=1+(t<<1),a=e[o],s=o+1;if(s<this.length&&n(e[s],a)<0&&(o=s,a=e[s]),n(a,i)>=0)break;e[t]=a,t=o}e[t]=i};var zu=e((function(t){t.exports=function(t,e){var n,r,i,o,a,s,u,c;for(n=3&t.length,r=t.length-n,i=e,a=3432918353,s=461845907,c=0;c<r;)u=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,i=27492+(65535&(o=5*(65535&(i=(i^=u=(65535&(u=(u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(u=0,n){case 3:u^=(255&t.charCodeAt(c+2))<<16;case 2:u^=(255&t.charCodeAt(c+1))<<8;case 1:i^=u=(65535&(u=(u=(65535&(u^=255&t.charCodeAt(c)))*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}})),Bu=e((function(t){t.exports=function(t,e){for(var n,r=t.length,i=e^r,o=0;r>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++o;switch(r){case 3:i^=(255&t.charCodeAt(o+2))<<16;case 2:i^=(255&t.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}})),Uu=zu,Vu=zu,qu=Bu;Uu.murmur3=Vu,Uu.murmur2=qu;var Wu=7,Gu=Number.POSITIVE_INFINITY;function Hu(t,e){return e[1]!==Gu?function(t,e,n){var r=0,i=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":i=n-Wu;break;case"bottom-right":case"bottom-left":case"bottom":i=-n+Wu}switch(t){case"top-right":case"bottom-right":case"right":r=-e;break;case"top-left":case"bottom-left":case"left":r=e}return[r,i]}(t,e[0],e[1]):function(t,e){var n=0,r=0;e<0&&(e=0);var i=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":r=i-Wu;break;case"bottom-right":case"bottom-left":r=-i+Wu;break;case"bottom":r=-e+Wu;break;case"top":r=e-Wu}switch(t){case"top-right":case"bottom-right":n=-i;break;case"top-left":case"bottom-left":n=i;break;case"left":n=e;break;case"right":n=-e}return[n,r]}(t,e[0])}function Ku(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}var Qu=255,Xu=Qu*yu;function Yu(t,e,n,r,o,a,s,u,c,l,h,p,f,d){var m=function(t,e,n,r,o,a,s,u){for(var c=r.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,l=[],h=0,p=e.positionedLines;h<p.length;h+=1)for(var f=p[h],d=0,m=f.positionedGlyphs;d<m.length;d+=1){var y=m[d];if(y.rect){var g=y.rect||{},v=Qs+1,_=!0,b=1,w=0,x=(o||u)&&y.vertical,E=y.metrics.advance*y.scale/2;if(u&&e.verticalizable){var T=(y.scale-1)*Es,S=(Es-y.metrics.width*y.scale)/2;w=f.lineOffset/2-(y.imageName?-S:T)}if(y.imageName){var C=s[y.imageName];_=C.sdf,b=C.pixelRatio,v=Ys/b}var I=o?[y.x+E,y.y]:[0,0],k=o?[0,0]:[y.x+E+n[0],y.y+n[1]-w],A=[0,0];x&&(A=k,k=[0,0]);var O=(y.metrics.left-v)*y.scale-E+k[0],P=(-y.metrics.top-v)*y.scale+k[1],D=O+g.w*y.scale/b,M=P+g.h*y.scale/b,R=new i(O,P),N=new i(D,P),L=new i(O,M),F=new i(D,M);if(x){var j=new i(-E,E-eu),z=-Math.PI/2,B=Es/2-E,U=y.imageName?B:0,V=new i(5-eu-B,-U),q=new(Function.prototype.bind.apply(i,[null].concat(A)));R._rotateAround(z,j)._add(V)._add(q),N._rotateAround(z,j)._add(V)._add(q),L._rotateAround(z,j)._add(V)._add(q),F._rotateAround(z,j)._add(V)._add(q)}if(c){var W=Math.sin(c),G=Math.cos(c),H=[G,-W,W,G];R._matMult(H),N._matMult(H),L._matMult(H),F._matMult(H)}var K=new i(0,0),Q=new i(0,0);l.push({tl:R,tr:N,bl:L,br:F,tex:g,writingMode:e.writingMode,glyphOffset:I,sectionIndex:y.sectionIndex,isSDF:_,pixelOffsetTL:K,pixelOffsetBR:Q,minFontScaleX:0,minFontScaleY:0})}}return l}(0,n,u,o,a,s,r,t.allowVerticalPlacement),y=t.textSizeData,g=null;"source"===y.kind?(g=[yu*o.layout.get("text-size").evaluate(s,{})])[0]>Xu&&x(t.layerIds[0]+': Value for "text-size" is >= '+Qu+'. Reduce your "text-size".'):"composite"===y.kind&&((g=[yu*d.compositeTextSizes[0].evaluate(s,{}),yu*d.compositeTextSizes[1].evaluate(s,{})])[0]>Xu||g[1]>Xu)&&x(t.layerIds[0]+': Value for "text-size" is >= '+Qu+'. Reduce your "text-size".'),t.addSymbols(t.text,m,g,u,a,s,l,e,c.lineStartIndex,c.lineLength,f);for(var v=0,_=h;v<_.length;v+=1)p[_[v]]=t.text.placedSymbolArray.length-1;return 4*m.length}function Zu(t){for(var e in t)return t[e];return null}function Ju(t,e,n,r){var i=t.compareText;if(e in i){for(var o=i[e],a=o.length-1;a>=0;a--)if(r.dist(o[a])<n)return!0}else i[e]=[];return i[e].push(r),!1}var $u=Xa.VectorTileFeature.types,tc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ec(t,e,n,r,i,o,a,s,u,c,l,h,p){var f=s?Math.min(Xu,Math.round(s[0])):0,d=s?Math.min(Xu,Math.round(s[1])):0;t.emplaceBack(e,n,Math.round(32*r),Math.round(32*i),o,a,(f<<1)+(u?1:0),d,16*c,16*l,256*h,256*p)}function nc(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function rc(t){for(var e=0,n=t.sections;e<n.length;e+=1)if(Mr(n[e].text))return!0;return!1}var ic=function(t){this.layoutVertexArray=new vi,this.indexArray=new Ai,this.programConfigurations=t,this.segments=new Ki,this.dynamicLayoutVertexArray=new _i,this.opacityVertexArray=new bi,this.placedSymbolArray=new Fi};ic.prototype.upload=function(t,e,n,r){n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ys.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,gs.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,tc,!0),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(t)},ic.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},br("SymbolBuffers",ic);var oc=function(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new Ki,this.collisionVertexArray=new Ei};oc.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,vs.members,!0)},oc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},br("CollisionBuffers",oc);var ac=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasPaintOverrides=!1,this.hasRTLText=!1;var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=gu(this.zoom,e["text-size"]),this.iconSizeData=gu(this.zoom,e["icon-size"]);var n=this.layers[0].layout,r=n.get("symbol-sort-key"),i=n.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==i&&void 0!==r.constantOr(1);var o="viewport-y"===i||"auto"===i&&!this.sortFeaturesByKey;this.sortFeaturesByY=o&&(n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement")),"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map((function(t){return tu[t]}))),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id})),this.sourceID=t.sourceID};ac.prototype.createArrays=function(){var t=this.layers[0].layout;this.hasPaintOverrides=lc.hasPaintOverrides(t),this.text=new ic(new fo(ys.members,this.layers,this.zoom,(function(t){return/^text/.test(t)}))),this.icon=new ic(new fo(ys.members,this.layers,this.zoom,(function(t){return/^icon/.test(t)}))),this.textCollisionBox=new oc(xi,_s.members,Oi),this.iconCollisionBox=new oc(xi,_s.members,Oi),this.textCollisionCircle=new oc(xi,bs.members,Ai),this.iconCollisionCircle=new oc(xi,bs.members,Ai),this.glyphOffsetArray=new Ui,this.lineVertexArray=new qi,this.symbolInstances=new zi},ac.prototype.calculateGlyphDependencies=function(t,e,n,r,i){for(var o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(n||r)&&i){var a=xs[t.charAt(o)];a&&(e[a.charCodeAt(0)]=!0)}},ac.prototype.populate=function(t,e){var n=this.layers[0],r=n.layout,i=r.get("text-font"),o=r.get("text-field"),a=r.get("icon-image"),s=("constant"!==o.value.kind||o.value.value instanceof $t&&!o.value.value.isEmpty()||o.value.value.toString().length>0)&&("constant"!==i.value.kind||i.value.value.length>0),u=("constant"!==a.value.kind||!!a.value.value)&&Object.keys(a.parameters).length>0,c=r.get("symbol-sort-key");if(this.features=[],s||u){for(var l=e.iconDependencies,h=e.glyphDependencies,p=e.availableImages,f=new Hr(this.zoom),d=0,m=t;d<m.length;d+=1){var y=m[d],g=y.feature,v=y.index,_=y.sourceLayerIndex;if(n._featureFilter(f,g)){var b=void 0;if(s){var w=n.getValueAndResolveTokens("text-field",g,p),x=$t.factory(w);rc(x)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===qr()||this.hasRTLText&&Gr.isParsed())&&(b=ws(x,n,g))}var E=void 0;if(u){var T=n.getValueAndResolveTokens("icon-image",g,p);E=T instanceof te?T:te.fromString(T)}if(b||E){var S=this.sortFeaturesByKey?c.evaluate(g,{}):void 0,C={text:b,icon:E,index:v,sourceLayerIndex:_,geometry:_o(g),properties:g.properties,type:$u[g.type],sortKey:S};if(void 0!==g.id&&(C.id=g.id),this.features.push(C),E&&(l[E.name]=!0),b){var I=i.evaluate(g,{}).join(","),k="map"===r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(tu.vertical)>=0;for(var A=0,O=b.sections;A<O.length;A+=1){var P=O[A];if(P.image)l[P.image.name]=!0;else{var D=Ir(b.toString()),M=P.fontStack||I,R=h[M]=h[M]||{};this.calculateGlyphDependencies(P.text,R,k,this.allowVerticalPlacement,D)}}}}}}"line"===r.get("symbol-placement")&&(this.features=function(t){var e={},n={},r=[],i=0;function o(e){r.push(t[e]),i++}function a(t,e,i){var o=n[t];return delete n[t],n[e]=o,r[o].geometry[0].pop(),r[o].geometry[0]=r[o].geometry[0].concat(i[0]),o}function s(t,n,i){var o=e[n];return delete e[n],e[t]=o,r[o].geometry[0].shift(),r[o].geometry[0]=i[0].concat(r[o].geometry[0]),o}function u(t,e,n){var r=n?e[0][e[0].length-1]:e[0][0];return t+":"+r.x+":"+r.y}for(var c=0;c<t.length;c++){var l=t[c],h=l.geometry,p=l.text?l.text.toString():null;if(p){var f=u(p,h),d=u(p,h,!0);if(f in n&&d in e&&n[f]!==e[d]){var m=s(f,d,h),y=a(f,d,r[m].geometry);delete e[f],delete n[d],n[u(p,r[y].geometry,!0)]=y,r[m].geometry=null}else f in n?a(f,d,h):d in e?s(f,d,h):(o(c),e[f]=i-1,n[d]=i-1)}else o(c)}return r.filter((function(t){return t.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(t,e){return t.sortKey-e.sortKey}))}},ac.prototype.update=function(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))},ac.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},ac.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ac.prototype.upload=function(t){this.uploaded||(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t),this.textCollisionCircle.upload(t),this.iconCollisionCircle.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ac.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.textCollisionBox.destroy(),this.iconCollisionBox.destroy(),this.textCollisionCircle.destroy(),this.iconCollisionCircle.destroy()},ac.prototype.addToLineVertexArray=function(t,e){var n=this.lineVertexArray.length;if(void 0!==t.segment){for(var r=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:r},a<e.length-1&&(r+=e[a+1].dist(e[a]));for(var s=t.segment||0;s>=0;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=e[s-1].dist(e[s]));for(var u=0;u<e.length;u++){var c=o[u];this.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}},ac.prototype.addSymbols=function(t,e,n,r,i,o,a,s,u,c,l){var h=this,p=t.indexArray,f=t.layoutVertexArray,d=t.dynamicLayoutVertexArray,m=t.segments.prepareSegment(4*e.length,t.layoutVertexArray,t.indexArray,o.sortKey),y=this.glyphOffsetArray.length,g=m.vertexLength,v=this.allowVerticalPlacement&&a===tu.vertical?Math.PI/2:0,_=function(t){var e=t.tl,r=t.tr,i=t.bl,o=t.br,a=t.tex,u=t.pixelOffsetTL,c=t.pixelOffsetBR,l=t.minFontScaleX,y=t.minFontScaleY,g=m.vertexLength,_=t.glyphOffset[1];ec(f,s.x,s.y,e.x,_+e.y,a.x,a.y,n,t.isSDF,u.x,u.y,l,y),ec(f,s.x,s.y,r.x,_+r.y,a.x+a.w,a.y,n,t.isSDF,c.x,u.y,l,y),ec(f,s.x,s.y,i.x,_+i.y,a.x,a.y+a.h,n,t.isSDF,u.x,c.y,l,y),ec(f,s.x,s.y,o.x,_+o.y,a.x+a.w,a.y+a.h,n,t.isSDF,c.x,c.y,l,y),nc(d,s,v),p.emplaceBack(g,g+1,g+2),p.emplaceBack(g+1,g+2,g+3),m.vertexLength+=4,m.primitiveLength+=2,h.glyphOffsetArray.emplaceBack(t.glyphOffset[0])};if(o.text&&o.text.sections){var b=o.text.sections;if(this.hasPaintOverrides){for(var w,x=function(e,n){void 0===w||w===e&&!n||t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index,{},b[w]),w=e},E=0,T=e;E<T.length;E+=1){var S=T[E];x(S.sectionIndex,!1),_(S)}x(w,!0)}else{for(var C=0,I=e;C<I.length;C+=1)_(I[C]);t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index,{},b[0])}}else{for(var k=0,A=e;k<A.length;k+=1)_(A[k]);t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index,{})}t.placedSymbolArray.emplaceBack(s.x,s.y,y,this.glyphOffsetArray.length-y,g,u,c,s.segment,n?n[0]:0,n?n[1]:0,r[0],r[1],a,0,!1,0,l)},ac.prototype._addCollisionDebugVertex=function(t,e,n,r,i,o){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,r,i,Math.round(o.x),Math.round(o.y))},ac.prototype.addCollisionDebugVertices=function(t,e,n,r,o,a,s,u){var c=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),l=c.vertexLength,h=o.layoutVertexArray,p=o.collisionVertexArray,f=s.anchorX,d=s.anchorY;if(this._addCollisionDebugVertex(h,p,a,f,d,new i(t,e)),this._addCollisionDebugVertex(h,p,a,f,d,new i(n,e)),this._addCollisionDebugVertex(h,p,a,f,d,new i(n,r)),this._addCollisionDebugVertex(h,p,a,f,d,new i(t,r)),c.vertexLength+=4,u){var m=o.indexArray;m.emplaceBack(l,l+1,l+2),m.emplaceBack(l,l+2,l+3),c.primitiveLength+=2}else{var y=o.indexArray;y.emplaceBack(l,l+1),y.emplaceBack(l+1,l+2),y.emplaceBack(l+2,l+3),y.emplaceBack(l+3,l),c.primitiveLength+=4}},ac.prototype.addDebugCollisionBoxes=function(t,e,n,r){for(var i=t;i<e;i++){var o=this.collisionBoxArray.get(i),a=o.x1,s=o.y1,u=o.x2,c=o.y2,l=o.radius>0;this.addCollisionDebugVertices(a,s,u,c,l?r?this.textCollisionCircle:this.iconCollisionCircle:r?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,n,l)}},ac.prototype.generateCollisionDebugBuffers=function(){for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},ac.prototype._deserializeCollisionBoxesForSymbol=function(t,e,n,r,i,o,a,s,u){for(var c={},l=e;l<n;l++){var h=t.get(l);if(0===h.radius){c.textBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,anchorPointX:h.anchorPointX,anchorPointY:h.anchorPointY},c.textFeatureIndex=h.featureIndex;break}c.textCircles||(c.textCircles=[],c.textFeatureIndex=h.featureIndex),c.textCircles.push(h.anchorPointX,h.anchorPointY,h.radius,h.signedDistanceFromAnchor,1)}for(var p=r;p<i;p++){var f=t.get(p);if(0===f.radius){c.verticalTextBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalTextFeatureIndex=f.featureIndex;break}}for(var d=o;d<a;d++){var m=t.get(d);if(0===m.radius){c.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},c.iconFeatureIndex=m.featureIndex;break}}for(var y=s;y<u;y++){var g=t.get(y);if(0===g.radius){c.verticalIconBox={x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2,anchorPointX:g.anchorPointX,anchorPointY:g.anchorPointY},c.verticalIconFeatureIndex=g.featureIndex;break}}return c},ac.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}},ac.prototype.hasTextData=function(){return this.text.segments.get().length>0},ac.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ac.prototype.hasTextCollisionBoxData=function(){return this.textCollisionBox.segments.get().length>0},ac.prototype.hasIconCollisionBoxData=function(){return this.iconCollisionBox.segments.get().length>0},ac.prototype.hasTextCollisionCircleData=function(){return this.textCollisionCircle.segments.get().length>0},ac.prototype.hasIconCollisionCircleData=function(){return this.iconCollisionCircle.segments.get().length>0},ac.prototype.addIndicesForPlacedSymbol=function(t,e){for(var n=t.placedSymbolArray.get(e),r=n.vertexStartIndex+4*n.numGlyphs,i=n.vertexStartIndex;i<r;i+=4)t.indexArray.emplaceBack(i,i+1,i+2),t.indexArray.emplaceBack(i+1,i+2,i+3)},ac.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),n=Math.cos(t),r=[],i=[],o=[],a=0;a<this.symbolInstances.length;++a){o.push(a);var s=this.symbolInstances.get(a);r.push(0|Math.round(e*s.anchorX+n*s.anchorY)),i.push(s.featureIndex)}return o.sort((function(t,e){return r[t]-r[e]||i[e]-i[t]})),o},ac.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var n=0,r=this.symbolInstanceIndexes;n<r.length;n+=1){var i=r[n],o=this.symbolInstances.get(i);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(t,n,r){t>=0&&r.indexOf(t)===n&&e.addIndicesForPlacedSymbol(e.text,t)})),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},br("SymbolBucket",ac,{omit:["layers","collisionBoxArray","features","compareText"]}),ac.MAX_GLYPHS=65535,ac.addDynamicAttributes=nc;var sc=new ai({"symbol-placement":new ei(It.layout_symbol["symbol-placement"]),"symbol-spacing":new ei(It.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ei(It.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ni(It.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ei(It.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ei(It.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ei(It.layout_symbol["icon-ignore-placement"]),"icon-optional":new ei(It.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ei(It.layout_symbol["icon-rotation-alignment"]),"icon-size":new ni(It.layout_symbol["icon-size"]),"icon-text-fit":new ei(It.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ei(It.layout_symbol["icon-text-fit-padding"]),"icon-image":new ni(It.layout_symbol["icon-image"]),"icon-rotate":new ni(It.layout_symbol["icon-rotate"]),"icon-padding":new ei(It.layout_symbol["icon-padding"]),"icon-keep-upright":new ei(It.layout_symbol["icon-keep-upright"]),"icon-offset":new ni(It.layout_symbol["icon-offset"]),"icon-anchor":new ni(It.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ei(It.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ei(It.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ei(It.layout_symbol["text-rotation-alignment"]),"text-field":new ni(It.layout_symbol["text-field"]),"text-font":new ni(It.layout_symbol["text-font"]),"text-size":new ni(It.layout_symbol["text-size"]),"text-max-width":new ni(It.layout_symbol["text-max-width"]),"text-line-height":new ei(It.layout_symbol["text-line-height"]),"text-letter-spacing":new ni(It.layout_symbol["text-letter-spacing"]),"text-justify":new ni(It.layout_symbol["text-justify"]),"text-radial-offset":new ni(It.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ei(It.layout_symbol["text-variable-anchor"]),"text-anchor":new ni(It.layout_symbol["text-anchor"]),"text-max-angle":new ei(It.layout_symbol["text-max-angle"]),"text-writing-mode":new ei(It.layout_symbol["text-writing-mode"]),"text-rotate":new ni(It.layout_symbol["text-rotate"]),"text-padding":new ei(It.layout_symbol["text-padding"]),"text-keep-upright":new ei(It.layout_symbol["text-keep-upright"]),"text-transform":new ni(It.layout_symbol["text-transform"]),"text-offset":new ni(It.layout_symbol["text-offset"]),"text-allow-overlap":new ei(It.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ei(It.layout_symbol["text-ignore-placement"]),"text-optional":new ei(It.layout_symbol["text-optional"])}),uc={paint:new ai({"icon-opacity":new ni(It.paint_symbol["icon-opacity"]),"icon-color":new ni(It.paint_symbol["icon-color"]),"icon-halo-color":new ni(It.paint_symbol["icon-halo-color"]),"icon-halo-width":new ni(It.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ni(It.paint_symbol["icon-halo-blur"]),"icon-translate":new ei(It.paint_symbol["icon-translate"]),"icon-translate-anchor":new ei(It.paint_symbol["icon-translate-anchor"]),"text-opacity":new ni(It.paint_symbol["text-opacity"]),"text-color":new ni(It.paint_symbol["text-color"],{runtimeType:zt,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new ni(It.paint_symbol["text-halo-color"]),"text-halo-width":new ni(It.paint_symbol["text-halo-width"]),"text-halo-blur":new ni(It.paint_symbol["text-halo-blur"]),"text-translate":new ei(It.paint_symbol["text-translate"]),"text-translate-anchor":new ei(It.paint_symbol["text-translate-anchor"])}),layout:sc},cc=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Nt,this.defaultValue=t};cc.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},cc.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},cc.prototype.possibleOutputs=function(){return[void 0]},cc.prototype.serialize=function(){return null},br("FormatSectionOverride",cc,{omit:["defaultValue"]});var lc=function(t){function e(e){t.call(this,e,uc)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e,n){if(t.prototype.recalculate.call(this,e,n),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var r=this.layout.get("text-writing-mode");if(r){for(var i=[],o=0,a=r;o<a.length;o+=1){var s=a[o];i.indexOf(s)<0&&i.push(s)}this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(t,e,n){var r=this.layout.get(t).evaluate(e,{},n),i=this._unevaluatedLayout._values[t];return i.isDataDriven()||An(i.value)||!r?r:function(t,e){return e.replace(/{([^{}]+)}/g,(function(e,n){return n in t?String(t[n]):""}))}(e.properties,r)},e.prototype.createBucket=function(t){return new ac(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var t=0,n=uc.paint.overridableProperties;t<n.length;t+=1){var r=n[t];if(e.hasPaintOverride(this.layout,r)){var i,o=this.paint.get(r),a=new cc(o),s=new kn(a,o.property.specification);i="constant"===o.value.kind||"source"===o.value.kind?new Pn("source",s):new Dn("composite",s,o.value.zoomStops,o.value._interpolationType),this.paint._values[r]=new $r(o.property,i,o.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(t,n,r){return!(!this.layout||n.isDataDriven()||r.isDataDriven())&&e.hasPaintOverride(this.layout,t)},e.hasPaintOverride=function(t,e){var n=t.get("text-field"),r=uc.paint.properties[e],i=!1,o=function(t){for(var e=0,n=t;e<n.length;e+=1){var o=n[e];if(r.overrides&&r.overrides.hasOverride(o))return void(i=!0)}};if("constant"===n.value.kind&&n.value.value instanceof $t)o(n.value.value.sections);else if("source"===n.value.kind){var a=n.value;a._styleExpression&&function t(e){if(!i)if(e instanceof ie&&ne(e.value)===qt){var n=e.value;o(n.sections)}else e instanceof ue?o(e.sections):e.eachChild(t)}(a._styleExpression.expression)}return i},e.hasPaintOverrides=function(t){for(var n=0,r=uc.paint.overridableProperties;n<r.length;n+=1){var i=r[n];if(e.hasPaintOverride(t,i))return!0}return!1},e}(si),hc={paint:new ai({"background-color":new ei(It.paint_background["background-color"]),"background-pattern":new ii(It.paint_background["background-pattern"]),"background-opacity":new ei(It.paint_background["background-opacity"])})},pc=function(t){function e(e){t.call(this,e,hc)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(si),fc={paint:new ai({"raster-opacity":new ei(It.paint_raster["raster-opacity"]),"raster-hue-rotate":new ei(It.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ei(It.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ei(It.paint_raster["raster-brightness-max"]),"raster-saturation":new ei(It.paint_raster["raster-saturation"]),"raster-contrast":new ei(It.paint_raster["raster-contrast"]),"raster-resampling":new ei(It.paint_raster["raster-resampling"]),"raster-fade-duration":new ei(It.paint_raster["raster-fade-duration"])})},dc=function(t){function e(e){t.call(this,e,fc)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(si),mc=function(t){function e(e){t.call(this,e,{}),this.implementation=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},e.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},e}(si),yc={circle:Uo,heatmap:Zo,hillshade:$o,fill:za,"fill-extrusion":rs,line:ds,symbol:lc,background:pc,raster:dc},gc=self.HTMLImageElement,vc=self.HTMLCanvasElement,_c=self.HTMLVideoElement,bc=self.ImageData,wc=function(t,e,n,r){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,r)};wc.prototype.update=function(t,e,n){var r=t.width,i=t.height,o=!(this.size&&this.size[0]===r&&this.size[1]===i||n),a=this.context,s=a.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!e||!1!==e.premultiply)),o)this.size=[r,i],t instanceof gc||t instanceof vc||t instanceof _c||t instanceof bc?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,t):s.texImage2D(s.TEXTURE_2D,0,this.format,r,i,0,this.format,s.UNSIGNED_BYTE,t.data);else{var u=n||{x:0,y:0},c=u.x,l=u.y;t instanceof gc||t instanceof vc||t instanceof _c||t instanceof bc?s.texSubImage2D(s.TEXTURE_2D,0,c,l,s.RGBA,s.UNSIGNED_BYTE,t):s.texSubImage2D(s.TEXTURE_2D,0,c,l,r,i,s.RGBA,s.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)},wc.prototype.bind=function(t,e,n){var r=this.context.gl;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)},wc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},wc.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var xc=function(t){var e=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};xc.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){t._triggered=!1,t._callback()}),0))},xc.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Ec=function(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},y(["receive","process"],this),this.invoker=new xc(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=S()?t:self};function Tc(t,e,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}Ec.prototype.send=function(t,e,n,r,i){var o=this;void 0===i&&(i=!1);var a=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(this.callbacks[a]=n);var s=k(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:t,hasCallback:!!n,targetMapId:r,mustQueue:i,sourceMapId:this.mapId,data:Er(e,s)},s),{cancel:function(){n&&delete o.callbacks[a],o.target.postMessage({id:a,type:"<cancel>",targetMapId:r,sourceMapId:o.mapId})}}},Ec.prototype.receive=function(t){var e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[n];var r=this.cancelCallbacks[n];delete this.cancelCallbacks[n],r&&r()}else S()||e.mustQueue?(this.tasks[n]=e,this.taskQueue.push(n),this.invoker.trigger()):this.processTask(n,e)},Ec.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},Ec.prototype.processTask=function(t,e){var n=this;if("<response>"===e.type){var r=this.callbacks[t];delete this.callbacks[t],r&&(e.error?r(Tr(e.error)):r(null,Tr(e.data)))}else{var i=!1,o=k(this.globalScope)?void 0:[],a=e.hasCallback?function(e,r){i=!0,delete n.cancelCallbacks[t],n.target.postMessage({id:t,type:"<response>",sourceMapId:n.mapId,error:e?Er(e):null,data:Er(r,o)},o)}:function(t){i=!0},s=null,u=Tr(e.data);if(this.parent[e.type])s=this.parent[e.type](e.sourceMapId,u,a);else if(this.parent.getWorkerSource){var c=e.type.split(".");s=this.parent.getWorkerSource(e.sourceMapId,c[0],u.source)[c[1]](u,a)}else a(new Error("Could not find function "+e.type));!i&&s&&s.cancel&&(this.cancelCallbacks[t]=s.cancel)}},Ec.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Sc=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Sc.prototype.setNorthEast=function(t){return this._ne=t instanceof Cc?new Cc(t.lng,t.lat):Cc.convert(t),this},Sc.prototype.setSouthWest=function(t){return this._sw=t instanceof Cc?new Cc(t.lng,t.lat):Cc.convert(t),this},Sc.prototype.extend=function(t){var e,n,r=this._sw,i=this._ne;if(t instanceof Cc)e=t,n=t;else{if(!(t instanceof Sc))return Array.isArray(t)?t.every(Array.isArray)?this.extend(Sc.convert(t)):this.extend(Cc.convert(t)):this;if(e=t._sw,n=t._ne,!e||!n)return this}return r||i?(r.lng=Math.min(e.lng,r.lng),r.lat=Math.min(e.lat,r.lat),i.lng=Math.max(n.lng,i.lng),i.lat=Math.max(n.lat,i.lat)):(this._sw=new Cc(e.lng,e.lat),this._ne=new Cc(n.lng,n.lat)),this},Sc.prototype.getCenter=function(){return new Cc((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Sc.prototype.getSouthWest=function(){return this._sw},Sc.prototype.getNorthEast=function(){return this._ne},Sc.prototype.getNorthWest=function(){return new Cc(this.getWest(),this.getNorth())},Sc.prototype.getSouthEast=function(){return new Cc(this.getEast(),this.getSouth())},Sc.prototype.getWest=function(){return this._sw.lng},Sc.prototype.getSouth=function(){return this._sw.lat},Sc.prototype.getEast=function(){return this._ne.lng},Sc.prototype.getNorth=function(){return this._ne.lat},Sc.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Sc.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Sc.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Sc.prototype.contains=function(t){var e=Cc.convert(t),n=e.lng,r=e.lat,i=this._sw.lat<=r&&r<=this._ne.lat,o=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(o=this._sw.lng>=n&&n>=this._ne.lng),i&&o},Sc.convert=function(t){return!t||t instanceof Sc?t:new Sc(t)};var Cc=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Cc.prototype.wrap=function(){return new Cc(l(this.lng,-180,180),this.lat)},Cc.prototype.toArray=function(){return[this.lng,this.lat]},Cc.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Cc.prototype.toBounds=function(t){void 0===t&&(t=0);var e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new Sc(new Cc(this.lng-n,this.lat-e),new Cc(this.lng+n,this.lat+e))},Cc.convert=function(t){if(t instanceof Cc)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Cc(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Cc(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ic=2*Math.PI*6378137;function kc(t){return Ic*Math.cos(t*Math.PI/180)}function Ac(t){return(180+t)/360}function Oc(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Pc(t,e){return t/kc(e)}function Dc(t){var e=180-360*t;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}var Mc=function(t,e,n){void 0===n&&(n=0),this.x=+t,this.y=+e,this.z=+n};Mc.fromLngLat=function(t,e){void 0===e&&(e=0);var n=Cc.convert(t);return new Mc(Ac(n.lng),Oc(n.lat),Pc(e,n.lat))},Mc.prototype.toLngLat=function(){return new Cc(360*this.x-180,Dc(this.y))},Mc.prototype.toAltitude=function(){return this.z*kc(Dc(this.y))},Mc.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ic*(t=Dc(this.y),1/Math.cos(t*Math.PI/180));var t};var Rc=function(t,e,n){this.z=t,this.x=e,this.y=n,this.key=Fc(0,t,e,n)};Rc.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Rc.prototype.url=function(t,e){var n,r,i,o,a,s=(n=this.x,r=this.y,i=this.z,o=Tc(256*n,256*(r=Math.pow(2,i)-r-1),i),a=Tc(256*(n+1),256*(r+1),i),o[0]+","+o[1]+","+a[0]+","+a[1]),u=function(t,e,n){for(var r,i="",o=t;o>0;o--)i+=(e&(r=1<<o-1)?1:0)+(n&r?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)},Rc.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new i((t.x*e-this.x)*go,(t.y*e-this.y)*go)},Rc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Nc=function(t,e){this.wrap=t,this.canonical=e,this.key=Fc(t,e.z,e.x,e.y)},Lc=function(t,e,n,r,i){this.overscaledZ=t,this.wrap=e,this.canonical=new Rc(n,+r,+i),this.key=Fc(e,t,r,i)};function Fc(t,e,n,r){(t*=2)<0&&(t=-1*t-1);var i=1<<e;return 32*(i*i*t+i*r+n)+e}Lc.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Lc.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new Lc(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Lc(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},Lc.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},Lc.prototype.children=function(t){if(this.overscaledZ>=t)return[new Lc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new Lc(e,this.wrap,e,n,r),new Lc(e,this.wrap,e,n+1,r),new Lc(e,this.wrap,e,n,r+1),new Lc(e,this.wrap,e,n+1,r+1)]},Lc.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Lc.prototype.wrapped=function(){return new Lc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Lc.prototype.unwrapTo=function(t){return new Lc(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Lc.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Lc.prototype.toUnwrapped=function(){return new Nc(this.wrap,this.canonical)},Lc.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Lc.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new Mc(t.x-this.wrap,t.y))},br("CanonicalTileID",Rc),br("OverscaledTileID",Lc,{omit:["posMatrix"]});var jc=function(t,e,n){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return x('"'+n+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var r=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=n||"mapbox";for(var i=0;i<r;i++)this.data[this._idx(-1,i)]=this.data[this._idx(0,i)],this.data[this._idx(r,i)]=this.data[this._idx(r-1,i)],this.data[this._idx(i,-1)]=this.data[this._idx(i,0)],this.data[this._idx(i,r)]=this.data[this._idx(i,r-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(r,-1)]=this.data[this._idx(r-1,0)],this.data[this._idx(-1,r)]=this.data[this._idx(0,r-1)],this.data[this._idx(r,r)]=this.data[this._idx(r-1,r-1)]};jc.prototype.get=function(t,e){var n=new Uint8Array(this.data.buffer),r=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[r],n[r+1],n[r+2])},jc.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},jc.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},jc.prototype._unpackMapbox=function(t,e,n){return(256*t*256+256*e+n)/10-1e4},jc.prototype._unpackTerrarium=function(t,e,n){return 256*t+e+n/256-32768},jc.prototype.getPixels=function(){return new Qo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},jc.prototype.backfillBorder=function(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var r=e*this.dim,i=e*this.dim+this.dim,o=n*this.dim,a=n*this.dim+this.dim;switch(e){case-1:r=i-1;break;case 1:i=r+1}switch(n){case-1:o=a-1;break;case 1:a=o+1}for(var s=-e*this.dim,u=-n*this.dim,c=o;c<a;c++)for(var l=r;l<i;l++)this.data[this._idx(l,c)]=t.data[this._idx(l+s,c+u)]},br("DEMData",jc);var zc=hi([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Bc=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}};Bc.prototype.encode=function(t){return this._stringToNumber[t]},Bc.prototype.decode=function(t){return this._numberToString[t]};var Uc=function(t,e,n,r){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=r,this.properties=t.properties,null!=t.id&&(this.id=t.id)},Vc={geometry:{configurable:!0}};Vc.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Vc.geometry.set=function(t){this._geometry=t},Uc.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Uc.prototype,Vc);var qc=function(){this.state={},this.stateChanges={},this.deletedStates={}};qc.prototype.updateState=function(t,e,n){var r=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},h(this.stateChanges[t][r],n),null===this.deletedStates[t])for(var i in this.deletedStates[t]={},this.state[t])i!==r&&(this.deletedStates[t][i]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][r])for(var o in this.deletedStates[t][r]={},this.state[t][r])n[o]||(this.deletedStates[t][r][o]=null);else for(var a in n)this.deletedStates[t]&&this.deletedStates[t][r]&&null===this.deletedStates[t][r][a]&&delete this.deletedStates[t][r][a]},qc.prototype.removeFeatureState=function(t,e,n){if(null!==this.deletedStates[t]){var r=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e&&e>=0)null!==this.deletedStates[t][r]&&(this.deletedStates[t][r]=this.deletedStates[t][r]||{},this.deletedStates[t][r][n]=null);else if(void 0!==e&&e>=0)if(this.stateChanges[t]&&this.stateChanges[t][r])for(n in this.deletedStates[t][r]={},this.stateChanges[t][r])this.deletedStates[t][r][n]=null;else this.deletedStates[t][r]=null;else this.deletedStates[t]=null}},qc.prototype.getState=function(t,e){var n=String(e),r=this.state[t]||{},i=this.stateChanges[t]||{},o=h({},r[n],i[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var a=this.deletedStates[t][e];if(null===a)return{};for(var s in a)delete o[s]}return o},qc.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},qc.prototype.coalesceChanges=function(t,e){var n={};for(var r in this.stateChanges){this.state[r]=this.state[r]||{};var i={};for(var o in this.stateChanges[r])this.state[r][o]||(this.state[r][o]={}),h(this.state[r][o],this.stateChanges[r][o]),i[o]=this.state[r][o];n[r]=i}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var s={};if(null===this.deletedStates[a])for(var u in this.state[a])s[u]={},this.state[a][u]={};else for(var c in this.deletedStates[a]){if(null===this.deletedStates[a][c])this.state[a][c]={};else for(var l=0,p=Object.keys(this.deletedStates[a][c]);l<p.length;l+=1){var f=p[l];delete this.state[a][c][f]}s[c]=this.state[a][c]}n[a]=n[a]||{},h(n[a],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(var d in t)t[d].setFeatureState(n,e)};var Wc=function(t,e,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=e||new mr(go,16,0),this.grid3D=new mr(go,16,0),this.featureIndexArray=n||new Gi};function Gc(t){for(var e=1/0,n=1/0,r=-1/0,i=-1/0,o=0,a=t;o<a.length;o+=1){var s=a[o];e=Math.min(e,s.x),n=Math.min(n,s.y),r=Math.max(r,s.x),i=Math.max(i,s.y)}return{minX:e,minY:n,maxX:r,maxY:i}}function Hc(t,e){return e-t}Wc.prototype.insert=function(t,e,n,r,i,o){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,i);for(var s=o?this.grid3D:this.grid,u=0;u<e.length;u++){for(var c=e[u],l=[1/0,1/0,-1/0,-1/0],h=0;h<c.length;h++){var p=c[h];l[0]=Math.min(l[0],p.x),l[1]=Math.min(l[1],p.y),l[2]=Math.max(l[2],p.x),l[3]=Math.max(l[3],p.y)}l[0]<go&&l[1]<go&&l[2]>=0&&l[3]>=0&&s.insert(a,l[0],l[1],l[2],l[3])}},Wc.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Xa.VectorTile(new Cs(this.rawTileData)).layers,this.sourceLayerCoder=new Bc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Wc.prototype.query=function(t,e,n){var r=this;this.loadVTLayers();for(var o=t.params||{},a=go/t.tileSize/t.scale,s=qn(o.filter),u=t.queryGeometry,c=t.queryPadding*a,l=Gc(u),h=this.grid.query(l.minX-c,l.minY-c,l.maxX+c,l.maxY+c),p=Gc(t.cameraQueryGeometry),f=0,d=this.grid3D.query(p.minX-c,p.minY-c,p.maxX+c,p.maxY+c,(function(e,n,r,o){return function(t,e,n,r,o){for(var a=0,s=t;a<s.length;a+=1){var u=s[a];if(e<=u.x&&n<=u.y&&r>=u.x&&o>=u.y)return!0}var c=[new i(e,n),new i(e,o),new i(r,o),new i(r,n)];if(t.length>2)for(var l=0,h=c;l<h.length;l+=1)if(Po(t,h[l]))return!0;for(var p=0;p<t.length-1;p++)if(Do(t[p],t[p+1],c))return!0;return!1}(t.cameraQueryGeometry,e-c,n-c,r+c,o+c)}));f<d.length;f+=1){var m=d[f];h.push(m)}h.sort(Hc);for(var y,g={},v=function(i){var c=h[i];if(c!==y){y=c;var l=r.featureIndexArray.get(c),p=null;r.loadMatchingFeature(g,l.bucketIndex,l.sourceLayerIndex,l.featureIndex,s,o.layers,e,(function(e,i){p||(p=_o(e));var o={};return e.id&&(o=n.getState(i.sourceLayer||"_geojsonTileLayer",e.id)),i.queryIntersectsFeature(u,e,o,p,r.z,t.transform,a,t.pixelPosMatrix)}))}},_=0;_<h.length;_++)v(_);return g},Wc.prototype.loadMatchingFeature=function(t,e,n,r,i,o,a,s){var u=this.bucketLayerIDs[e];if(!o||function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(o,u)){var c=this.sourceLayerCoder.decode(n),l=this.vtLayers[c].feature(r);if(i(new Hr(this.tileID.overscaledZ),l))for(var h=0;h<u.length;h++){var p=u[h];if(!(o&&o.indexOf(p)<0)){var f=a[p];if(f){var d=!s||s(l,f);if(d){var m=new Uc(l,this.z,this.x,this.y);m.layer=f.serialize();var y=t[p];void 0===y&&(y=t[p]=[]),y.push({featureIndex:r,feature:m,intersectionZ:d})}}}}}},Wc.prototype.lookupSymbolFeatures=function(t,e,n,r,i,o){var a={};this.loadVTLayers();for(var s=qn(r),u=0,c=t;u<c.length;u+=1){var l=c[u];this.loadMatchingFeature(a,e,n,l,s,i,o)}return a},Wc.prototype.hasLayer=function(t){for(var e=0,n=this.bucketLayerIDs;e<n.length;e+=1)for(var r=0,i=n[e];r<i.length;r+=1)if(t===i[r])return!0;return!1},br("FeatureIndex",Wc,{omit:["rawTileData","sourceLayerCoder"]});var Kc=function(t,e){this.tileID=t,this.uid=f(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Kc.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<F.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},Kc.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Kc.prototype.loadVectorData=function(t,e,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var r in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var n={};if(!e)return n;for(var r=function(){var t=o[i],r=t.layerIds.map((function(t){return e.getLayer(t)})).filter(Boolean);if(0!==r.length){t.layers=r,t.stateDependentLayerIds&&(t.stateDependentLayers=t.stateDependentLayerIds.map((function(t){return r.filter((function(e){return e.id===t}))[0]})));for(var a=0,s=r;a<s.length;a+=1){var u=s[a];n[u.id]=t}}},i=0,o=t;i<o.length;i+=1)r();return n}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var i=this.buckets[r];if(i instanceof ac){if(this.hasSymbolBuckets=!0,!n)break;i.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var o in this.buckets){var a=this.buckets[o];if(a instanceof ac&&a.hasRTLText){this.hasRTLText=!0,Gr.isLoading()||Gr.isLoaded()||"deferred"!==qr()||Wr();break}}for(var s in this.queryPadding=0,this.buckets){var u=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(s).queryRadius(u))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Ni},Kc.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Kc.prototype.getBucket=function(t){return this.buckets[t.id]},Kc.prototype.upload=function(t){for(var e in this.buckets){var n=this.buckets[e];n.uploadPending()&&n.upload(t)}var r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new wc(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new wc(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)},Kc.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},Kc.prototype.queryRenderedFeatures=function(t,e,n,r,i,o,a,s,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:r,scale:i,tileSize:this.tileSize,pixelPosMatrix:u,transform:a,params:o,queryPadding:this.queryPadding*s},t,e):{}},Kc.prototype.querySourceFeatures=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var n=this.latestFeatureIndex.loadVTLayers(),r=e?e.sourceLayer:"",i=n._geojsonTileLayer||n[r];if(i)for(var o=qn(e&&e.filter),a=this.tileID.canonical,s=a.z,u=a.x,c=a.y,l={z:s,x:u,y:c},h=0;h<i.length;h++){var p=i.feature(h);if(o(new Hr(this.tileID.overscaledZ),p)){var f=new Uc(p,s,u,c);f.tile=l,t.push(f)}}}},Kc.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer),delete this.mask},Kc.prototype.setMask=function(t,e){if(!a(this.mask,t)&&(this.clearMask(),this.mask=t,!a(t,{0:!0}))){var n=new di,r=new Ai;this.segments=new Ki,this.segments.prepareSegment(0,n,r);for(var o=Object.keys(t),s=0;s<o.length;s++){var u=t[+o[s]],c=go>>u.z,l=new i(u.x*c,u.y*c),h=new i(l.x+c,l.y+c),p=this.segments.prepareSegment(4,n,r);n.emplaceBack(l.x,l.y,l.x,l.y),n.emplaceBack(h.x,l.y,h.x,l.y),n.emplaceBack(l.x,h.y,l.x,h.y),n.emplaceBack(h.x,h.y,h.x,h.y);var f=p.vertexLength;r.emplaceBack(f,f+1,f+2),r.emplaceBack(f+1,f+2,f+3),p.vertexLength+=4,p.primitiveLength+=2}this.maskedBoundsBuffer=e.createVertexBuffer(n,zc.members),this.maskedIndexBuffer=e.createIndexBuffer(r)}},Kc.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Kc.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Kc.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var n=C(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var r=Date.now(),i=!1;if(this.expirationTime>r)i=!1;else if(e)if(this.expirationTime<e)i=!0;else{var o=this.expirationTime-e;o?this.expirationTime=r+Math.max(o,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Kc.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Kc.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var n=this.latestFeatureIndex.loadVTLayers();for(var r in this.buckets){var i=this.buckets[r],o=i.layers[0].sourceLayer||"_geojsonTileLayer",a=n[o],s=t[o];a&&s&&0!==Object.keys(s).length&&(i.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{}),e&&e.style&&(this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(r).queryRadius(i))))}}},Kc.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Kc.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<F.now()},Kc.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Kc.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=F.now()+t},Kc.prototype.setDependencies=function(t,e){for(var n={},r=0,i=e;r<i.length;r+=1)n[i[r]]=!0;this.dependencies[t]=n},Kc.prototype.hasDependency=function(t,e){for(var n=0,r=t;n<r.length;n+=1){var i=r[n],o=this.dependencies[i];if(o)for(var a=0,s=e;a<s.length;a+=1)if(o[s[a]])return!0}return!1},t.Actor=Ec,t.AlphaImage=Ko,t.CanonicalTileID=Rc,t.CollisionBoxArray=Ni,t.Color=Yt,t.DEMData=jc,t.DataConstantProperty=ei,t.DictionaryCoder=Bc,t.EXTENT=go,t.ErrorEvent=St,t.EvaluationParameters=Hr,t.Event=Tt,t.Evented=Ct,t.FeatureIndex=Wc,t.FillBucket=La,t.FillExtrusionBucket=$a,t.ImageAtlas=$s,t.ImagePosition=Zs,t.LineBucket=ls,t.LngLat=Cc,t.LngLatBounds=Sc,t.MercatorCoordinate=Mc,t.ONE_EM=Es,t.OverscaledTileID=Lc,t.Point=i,t.Point$1=i,t.ProgramConfiguration=po,t.Properties=ai,t.Protobuf=Cs,t.RGBAImage=Qo,t.RequestManager=W,t.ResourceType=ft,t.SegmentVector=Ki,t.SourceFeatureState=qc,t.StructArrayLayout1ui2=Pi,t.StructArrayLayout2i4=fi,t.StructArrayLayout2ui4=Oi,t.StructArrayLayout3ui6=Ai,t.StructArrayLayout4i8=di,t.SymbolBucket=ac,t.Texture=wc,t.Tile=Kc,t.Transitionable=Xr,t.Uniform1f=$i,t.Uniform1i=Ji,t.Uniform2f=to,t.Uniform3f=eo,t.Uniform4f=no,t.UniformColor=ro,t.UniformMatrix4f=oo,t.UnwrappedTileID=Nc,t.ValidationError=kt,t.WritingMode=tu,t.ZoomHistory=Sr,t.addDynamicAttributes=nc,t.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var r=t.length,i=new Array(t.length),o=null;t.forEach((function(t,a){e(t,(function(t,e){t&&(o=t),i[a]=e,0==--r&&n(o,i)}))}))},t.bezier=s,t.bindAll=y,t.browser=F,t.cacheEntryPossiblyAdded=function(t){++pt>ut&&(t.getActor().send("enforceCacheSizeLimit",st),pt=0)},t.clamp=c,t.clearTileCache=function(t){var e=self.caches.delete(at);t&&e.catch(t).then((function(){return t()}))},t.clone=function(t){var e=new zo(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=b,t.config=j,t.create=function(){var t=new zo(16);return zo!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=function(){var t=new zo(9);return zo!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},t.create$2=function(){var t=new zo(4);return zo!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},t.createCommonjsModule=e,t.createExpression=On,t.createLayout=hi,t.createStyleLayer=function(t){return"custom"===t.type?new mc(t):new yc[t.type](t)},t.deepEqual=a,t.ease=u,t.emitValidationErrors=dr,t.endsWith=g,t.enforceCacheSizeLimit=function(t){lt(),$&&$.then((function(e){e.keys().then((function(n){for(var r=0;r<n.length-t;r++)e.delete(n[r])}))}))},t.evaluateSizeForFeature=vu,t.evaluateSizeForZoom=_u,t.evaluateVariableOffset=Hu,t.evented=Vr,t.extend=h,t.featureFilter=qn,t.filterObject=_,t.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.getAnchorAlignment=pu,t.getAnchorJustification=Ku,t.getArrayBuffer=bt,t.getImage=function t(e,n){if(z.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),vt>=j.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return gt.push(r),r}vt++;var i=!1,o=function(){if(!i)for(i=!0,vt--;gt.length&&vt<j.MAX_PARALLEL_IMAGE_REQUESTS;){var e=gt.shift(),n=e.requestParameters,r=e.callback;e.cancelled||(e.cancel=t(n,r).cancel)}},a=bt(e,(function(t,e,r,i){if(o(),t)n(t);else if(e){var a=new self.Image;a.onload=function(){n(null,a),self.URL.revokeObjectURL(a.src)},a.onerror=function(){return n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var s=new self.Blob([new Uint8Array(e)],{type:"image/png"});a.cacheControl=r,a.expires=i,a.src=e.byteLength?self.URL.createObjectURL(s):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}}));return{cancel:function(){a.cancel(),o()}}},t.getJSON=function(t,e){return _t(h(t,{type:"json"}),e)},t.getRTLTextPluginStatus=qr,t.getReferrer=mt,t.getVideo=function(t,e){var n,r,i=self.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(var o=0;o<t.length;o++){var a=self.document.createElement("source");n=t[o],r=void 0,(r=self.document.createElement("a")).href=n,(r.protocol!==self.document.location.protocol||r.host!==self.document.location.host)&&(i.crossOrigin="Anonymous"),a.src=t[o],i.appendChild(a)}return{cancel:function(){}}},t.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],p=e[10],f=e[11],d=e[12],m=e[13],y=e[14],g=e[15],v=n*s-r*a,_=n*u-i*a,b=n*c-o*a,w=r*u-i*s,x=r*c-o*s,E=i*c-o*u,T=l*m-h*d,S=l*y-p*d,C=l*g-f*d,I=h*y-p*m,k=h*g-f*m,A=p*g-f*y,O=v*A-_*k+b*I+w*C-x*S+E*T;return O?(O=1/O,t[0]=(s*A-u*k+c*I)*O,t[1]=(i*k-r*A-o*I)*O,t[2]=(m*E-y*x+g*w)*O,t[3]=(p*x-h*E-f*w)*O,t[4]=(u*C-a*A-c*S)*O,t[5]=(n*A-i*C+o*S)*O,t[6]=(y*b-d*E-g*_)*O,t[7]=(l*E-p*b+f*_)*O,t[8]=(a*k-s*C+c*T)*O,t[9]=(r*C-n*k-o*T)*O,t[10]=(d*x-m*b+g*v)*O,t[11]=(h*b-l*x-f*v)*O,t[12]=(s*S-a*I-u*T)*O,t[13]=(n*I-r*S+i*T)*O,t[14]=(m*_-d*w-y*v)*O,t[15]=(l*w-h*_+p*v)*O,t):null},t.isChar=Cr,t.isMapboxURL=G,t.keysDifference=function(t,e){var n=[];for(var r in t)r in e||n.push(r);return n},t.makeRequest=_t,t.mapObject=v,t.mercatorXfromLng=Ac,t.mercatorYfromLat=Oc,t.mercatorZfromAltitude=Pc,t.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],p=e[9],f=e[10],d=e[11],m=e[12],y=e[13],g=e[14],v=e[15],_=n[0],b=n[1],w=n[2],x=n[3];return t[0]=_*r+b*s+w*h+x*m,t[1]=_*i+b*u+w*p+x*y,t[2]=_*o+b*c+w*f+x*g,t[3]=_*a+b*l+w*d+x*v,_=n[4],b=n[5],w=n[6],x=n[7],t[4]=_*r+b*s+w*h+x*m,t[5]=_*i+b*u+w*p+x*y,t[6]=_*o+b*c+w*f+x*g,t[7]=_*a+b*l+w*d+x*v,_=n[8],b=n[9],w=n[10],x=n[11],t[8]=_*r+b*s+w*h+x*m,t[9]=_*i+b*u+w*p+x*y,t[10]=_*o+b*c+w*f+x*g,t[11]=_*a+b*l+w*d+x*v,_=n[12],b=n[13],w=n[14],x=n[15],t[12]=_*r+b*s+w*h+x*m,t[13]=_*i+b*u+w*p+x*y,t[14]=_*o+b*c+w*f+x*g,t[15]=_*a+b*l+w*d+x*v,t},t.mvt=Xa,t.number=Ee,t.ortho=function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t},t.parseGlyphPBF=function(t){return new Cs(t).readFields(Gs,[])},t.pbf=Cs,t.performSymbolLayout=function(t,e,n,r,o,a){t.createArrays();var s=512*t.overscaling;t.tilePixelRatio=go/s,t.compareText={},t.iconsNeedLinear=!1;var u=t.layers[0].layout,c=t.layers[0]._unevaluatedLayout._values,l={};if("composite"===t.textSizeData.kind){var h=t.textSizeData,p=h.minZoom,f=h.maxZoom;l.compositeTextSizes=[c["text-size"].possiblyEvaluate(new Hr(p)),c["text-size"].possiblyEvaluate(new Hr(f))]}if("composite"===t.iconSizeData.kind){var d=t.iconSizeData,m=d.minZoom,y=d.maxZoom;l.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new Hr(m)),c["icon-size"].possiblyEvaluate(new Hr(y))]}l.layoutTextSize=c["text-size"].possiblyEvaluate(new Hr(t.zoom+1)),l.layoutIconSize=c["icon-size"].possiblyEvaluate(new Hr(t.zoom+1)),l.textMaxSize=c["text-size"].possiblyEvaluate(new Hr(18));for(var g=u.get("text-line-height")*Es,v="map"===u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement"),_=u.get("text-keep-upright"),b=u.get("text-size"),w=function(){var a=T[E],s=u.get("text-font").evaluate(a,{}).join(","),c=b.evaluate(a,{}),h=l.layoutTextSize.evaluate(a,{}),p=l.layoutIconSize.evaluate(a,{}),f={horizontal:{},vertical:void 0},d=a.text,m=[0,0];if(d){var y=d.toString(),w=u.get("text-letter-spacing").evaluate(a,{})*Es,S=function(t){for(var e=0,n=t;e<n.length;e+=1)if(!kr(n[e].charCodeAt(0)))return!1;return!0}(y)?w:0,C=u.get("text-anchor").evaluate(a,{}),I=u.get("text-variable-anchor");if(!I){var k=u.get("text-radial-offset").evaluate(a,{});m=k?Hu(C,[k*Es,Gu]):u.get("text-offset").evaluate(a,{}).map((function(t){return t*Es}))}var A=v?"center":u.get("text-justify").evaluate(a,{}),O=u.get("symbol-placement"),P="point"===O?u.get("text-max-width").evaluate(a,{})*Es:0,D=function(){t.allowVerticalPlacement&&Ir(y)&&(f.vertical=iu(d,e,n,o,s,P,g,C,"left",S,m,tu.vertical,!0,O,h,c))};if(!v&&I){for(var M="auto"===A?I.map((function(t){return Ku(t)})):[A],R=!1,N=0;N<M.length;N++){var L=M[N];if(!f.horizontal[L])if(R)f.horizontal[L]=f.horizontal[0];else{var F=iu(d,e,n,o,s,P,g,"center",L,S,m,tu.horizontal,!1,O,h,c);F&&(f.horizontal[L]=F,R=1===F.positionedLines.length)}}D()}else{"auto"===A&&(A=Ku(C));var j=iu(d,e,n,o,s,P,g,C,A,S,m,tu.horizontal,!1,O,h,c);j&&(f.horizontal[A]=j),D(),Ir(y)&&v&&_&&(f.vertical=iu(d,e,n,o,s,P,g,C,A,S,m,tu.vertical,!1,O,h,c))}}var z=void 0,B=!1;if(a.icon&&a.icon.name){var U=r[a.icon.name];U&&(z=function(t,e,n){var r=pu(n),i=r.horizontalAlign,o=r.verticalAlign,a=e[0],s=e[1],u=a-t.displaySize[0]*i,c=u+t.displaySize[0],l=s-t.displaySize[1]*o;return{image:t,top:l,bottom:l+t.displaySize[1],left:u,right:c}}(o[a.icon.name],u.get("icon-offset").evaluate(a,{}),u.get("icon-anchor").evaluate(a,{})),B=U.sdf,void 0===t.sdfIcons?t.sdfIcons=U.sdf:t.sdfIcons!==U.sdf&&x("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),U.pixelRatio!==t.pixelRatio?t.iconsNeedLinear=!0:0!==u.get("icon-rotate").constantOr(1)&&(t.iconsNeedLinear=!0))}var V=Zu(f.horizontal)||f.vertical;t.iconsInText=!!V&&V.iconsInText,(V||z)&&function(t,e,n,r,o,a,s,u,c,l){var h=a.textMaxSize.evaluate(e,{});void 0===h&&(h=s);var p,f=t.layers[0].layout,d=f.get("icon-offset").evaluate(e,{}),m=Zu(n.horizontal),y=s/24,g=t.tilePixelRatio*y,v=t.tilePixelRatio*h/24,_=t.tilePixelRatio*u,b=t.tilePixelRatio*f.get("symbol-spacing"),w=f.get("text-padding")*t.tilePixelRatio,E=f.get("icon-padding")*t.tilePixelRatio,T=f.get("text-max-angle")/180*Math.PI,S="map"===f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),C="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),I=f.get("symbol-placement"),k=b/2,A=f.get("icon-text-fit");r&&"none"!==A&&(t.allowVerticalPlacement&&n.vertical&&(p=du(r,n.vertical,A,f.get("icon-text-fit-padding"),d,y)),m&&(r=du(r,m,A,f.get("icon-text-fit-padding"),d,y)));var O=function(i,s){s.x<0||s.x>=go||s.y<0||s.y>=go||function(t,e,n,r,i,o,a,s,u,c,l,h,p,f,d,m,y,g,v,_,b,w,E){var T,S,C,I,k,A=t.addToLineVertexArray(e,n),O=0,P=0,D=0,M=0,R=-1,N=-1,L={},F=Uu(""),j=0,z=0;if(void 0===s._unevaluatedLayout.getValue("text-radial-offset")?(j=(T=s.layout.get("text-offset").evaluate(b,{}).map((function(t){return t*Es})))[0],z=T[1]):(j=s.layout.get("text-radial-offset").evaluate(b,{})*Es,z=Gu),t.allowVerticalPlacement&&r.vertical){var B=s.layout.get("text-rotate").evaluate(b,{})+90,U=r.vertical;I=new Mu(u,n,e,c,l,h,U,p,f,d,t.overscaling,B),a&&(k=new Mu(u,n,e,c,l,h,a,y,g,d,t.overscaling,B))}if(i){var V=s.layout.get("icon-rotate").evaluate(b,{}),q="none"!==s.layout.get("icon-text-fit"),W=ku(i,V,E,q),G=a?ku(a,V,E,q):void 0;C=new Mu(u,n,e,c,l,h,i,y,g,!1,t.overscaling,V),O=4*W.length;var H=t.iconSizeData,K=null;"source"===H.kind?(K=[yu*s.layout.get("icon-size").evaluate(b,{})])[0]>Xu&&x(t.layerIds[0]+': Value for "icon-size" is >= '+Qu+'. Reduce your "icon-size".'):"composite"===H.kind&&((K=[yu*w.compositeIconSizes[0].evaluate(b,{}),yu*w.compositeIconSizes[1].evaluate(b,{})])[0]>Xu||K[1]>Xu)&&x(t.layerIds[0]+': Value for "icon-size" is >= '+Qu+'. Reduce your "icon-size".'),t.addSymbols(t.icon,W,K,_,v,b,!1,e,A.lineStartIndex,A.lineLength,-1),R=t.icon.placedSymbolArray.length-1,G&&(P=4*G.length,t.addSymbols(t.icon,G,K,_,v,b,tu.vertical,e,A.lineStartIndex,A.lineLength,-1),N=t.icon.placedSymbolArray.length-1)}for(var Q in r.horizontal){var X=r.horizontal[Q];if(!S){F=Uu(X.text);var Y=s.layout.get("text-rotate").evaluate(b,{});S=new Mu(u,n,e,c,l,h,X,p,f,d,t.overscaling,Y)}var Z=1===X.positionedLines.length;if(D+=Yu(t,e,X,o,s,d,b,m,A,r.vertical?tu.horizontal:tu.horizontalOnly,Z?Object.keys(r.horizontal):[Q],L,R,w),Z)break}r.vertical&&(M+=Yu(t,e,r.vertical,o,s,d,b,m,A,tu.vertical,["vertical"],L,N,w));var J=S?S.boxStartIndex:t.collisionBoxArray.length,$=S?S.boxEndIndex:t.collisionBoxArray.length,tt=I?I.boxStartIndex:t.collisionBoxArray.length,et=I?I.boxEndIndex:t.collisionBoxArray.length,nt=C?C.boxStartIndex:t.collisionBoxArray.length,rt=C?C.boxEndIndex:t.collisionBoxArray.length,it=k?k.boxStartIndex:t.collisionBoxArray.length,ot=k?k.boxEndIndex:t.collisionBoxArray.length;t.glyphOffsetArray.length>=ac.MAX_GLYPHS&&x("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),t.symbolInstances.emplaceBack(e.x,e.y,L.right>=0?L.right:-1,L.center>=0?L.center:-1,L.left>=0?L.left:-1,L.vertical||-1,R,N,F,J,$,tt,et,nt,rt,it,ot,c,D,M,O,P,0,p,j,z)}(t,s,i,n,r,o,p,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,g,w,S,c,_,E,C,d,e,a,l)};if("line"===I)for(var P=0,D=function(t,e,n,r,o){for(var a=[],s=0;s<t.length;s++)for(var u=t[s],c=void 0,l=0;l<u.length-1;l++){var h=u[l],p=u[l+1];h.x<0&&p.x<0||(h.x<0?h=new i(0,h.y+(p.y-h.y)*((0-h.x)/(p.x-h.x)))._round():p.x<0&&(p=new i(0,h.y+(p.y-h.y)*((0-h.x)/(p.x-h.x)))._round()),h.y<0&&p.y<0||(h.y<0?h=new i(h.x+(p.x-h.x)*((0-h.y)/(p.y-h.y)),0)._round():p.y<0&&(p=new i(h.x+(p.x-h.x)*((0-h.y)/(p.y-h.y)),0)._round()),h.x>=r&&p.x>=r||(h.x>=r?h=new i(r,h.y+(p.y-h.y)*((r-h.x)/(p.x-h.x)))._round():p.x>=r&&(p=new i(r,h.y+(p.y-h.y)*((r-h.x)/(p.x-h.x)))._round()),h.y>=o&&p.y>=o||(h.y>=o?h=new i(h.x+(p.x-h.x)*((o-h.y)/(p.y-h.y)),o)._round():p.y>=o&&(p=new i(h.x+(p.x-h.x)*((o-h.y)/(p.y-h.y)),o)._round()),c&&h.equals(c[c.length-1])||(c=[h],a.push(c)),c.push(p)))))}return a}(e.geometry,0,0,go,go);P<D.length;P+=1)for(var M=D[P],R=0,N=Cu(M,b,T,n.vertical||m,r,24,v,t.overscaling,go);R<N.length;R+=1){var L=N[R];m&&Ju(t,m.text,k,L)||O(M,L)}else if("line-center"===I)for(var F=0,j=e.geometry;F<j.length;F+=1){var z=j[F];if(z.length>1){var B=Su(z,T,n.vertical||m,r,24,v);B&&O(z,B)}}else if("Polygon"===e.type)for(var U=0,V=Da(e.geometry,0);U<V.length;U+=1){var q=V[U],W=Lu(q,16);O(q[0],new mu(W.x,W.y,0))}else if("LineString"===e.type)for(var G=0,H=e.geometry;G<H.length;G+=1){var K=H[G];O(K,new mu(K[0].x,K[0].y,0))}else if("Point"===e.type)for(var Q=0,X=e.geometry;Q<X.length;Q+=1)for(var Y=0,Z=X[Q];Y<Z.length;Y+=1){var J=Z[Y];O([J],new mu(J.x,J.y,0))}}(t,a,f,z,r,l,h,p,m,B)},E=0,T=t.features;E<T.length;E+=1)w();a&&t.generateCollisionDebugBuffers()},t.perspective=function(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t},t.pick=function(t,e){for(var n={},r=0;r<e.length;r++){var i=e[r];i in t&&(n[i]=t[i])}return n},t.plugin=Gr,t.polygonIntersectsPolygon=xo,t.postMapLoadEvent=ot,t.postTurnstileEvent=rt,t.potpack=Xs,t.rasterBoundsAttributes=zc,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=br,t.registerForPluginStateChange=function(t){return t({pluginStatus:jr,pluginURL:zr}),Vr.on("pluginStateChange",t),t},t.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*-s+o*u,t[3]=i*-s+a*u,t},t.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+h*r,t[7]=u*i+p*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=h*i-s*r,t[11]=p*i-u*r,t},t.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+h*r,t[3]=u*i+p*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=h*i-s*r,t[7]=p*i-u*r,t},t.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.setCacheLimits=function(t,e){st=t,ut=e},t.setRTLTextPlugin=function(t,e,n){if(void 0===n&&(n=!1),jr===Rr||jr===Nr||jr===Lr)throw new Error("setRTLTextPlugin cannot be called multiple times.");zr=F.resolveURL(t),jr=Rr,Fr=e,Ur(),n||Wr()},t.sphericalToCartesian=function(t){var e=t[0],n=t[1],r=t[2];return n+=90,n*=Math.PI/180,r*=Math.PI/180,{x:e*Math.cos(n)*Math.sin(r),y:e*Math.sin(n)*Math.sin(r),z:e*Math.cos(r)}},t.styleSpec=It,t.symbolSize=bu,t.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},t.transformMat4=Bo,t.translate=function(t,e,n){var r,i,o,a,s,u,c,l,h,p,f,d,m=n[0],y=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*y+e[8]*g+e[12],t[13]=e[1]*m+e[5]*y+e[9]*g+e[13],t[14]=e[2]*m+e[6]*y+e[10]*g+e[14],t[15]=e[3]*m+e[7]*y+e[11]*g+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],p=e[9],f=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=p,t[10]=f,t[11]=d,t[12]=r*m+s*y+h*g+e[12],t[13]=i*m+u*y+p*g+e[13],t[14]=o*m+c*y+f*g+e[14],t[15]=a*m+l*y+d*g+e[15]),t},t.triggerPluginCompletionEvent=Br,t.uniqueId=f,t.validateCustomStyleLayer=function(t){var e=[],n=t.id;return void 0===n&&e.push({message:"layers."+n+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+n+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+n+': property "renderingMode" must be either "2d" or "3d"'}),e},t.validateLight=hr,t.validateStyle=lr,t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.vectorTile=Xa,t.version="1.6.1",t.warnOnce=x,t.webpSupported=z,t.window=self,t.wrap=l})),r(0,(function(t){function e(t){var n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var r="[",i=0,o=t;i<o.length;i+=1)r+=e(o[i])+",";return r+"]"}for(var a=Object.keys(t).sort(),s="{",u=0;u<a.length;u++)s+=JSON.stringify(a[u])+":"+e(t[a[u]])+",";return s+"}"}function n(n){for(var r="",i=0,o=t.refProperties;i<o.length;i+=1)r+="/"+e(n[o[i]]);return r}var r=function(t){this.keyCache={},t&&this.replace(t)};r.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},r.prototype.update=function(e,r){for(var i=this,o=0,a=e;o<a.length;o+=1){var s=a[o];this._layerConfigs[s.id]=s;var u=this._layers[s.id]=t.createStyleLayer(s);u._featureFilter=t.featureFilter(u.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}for(var c=0,l=r;c<l.length;c+=1){var h=l[c];delete this.keyCache[h],delete this._layerConfigs[h],delete this._layers[h]}this.familiesBySource={};for(var p=0,f=function(t,e){for(var r={},i=0;i<t.length;i++){var o=e&&e[t[i].id]||n(t[i]);e&&(e[t[i].id]=o);var a=r[o];a||(a=r[o]=[]),a.push(t[i])}var s=[];for(var u in r)s.push(r[u]);return s}(t.values(this._layerConfigs),this.keyCache);p<f.length;p+=1){var d=f[p].map((function(t){return i._layers[t.id]})),m=d[0];if("none"!==m.visibility){var y=m.source||"",g=this.familiesBySource[y];g||(g=this.familiesBySource[y]={});var v=m.sourceLayer||"_geojsonTileLayer",_=g[v];_||(_=g[v]=[]),_.push(d)}}};var i=function(e){var n={},r=[];for(var i in e){var o=e[i],a=n[i]={};for(var s in o){var u=o[+s];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c={x:0,y:0,w:u.bitmap.width+2,h:u.bitmap.height+2};r.push(c),a[s]={rect:c,metrics:u.metrics}}}}var l=t.potpack(r),h=l.w,p=l.h,f=new t.AlphaImage({width:h||1,height:p||1});for(var d in e){var m=e[d];for(var y in m){var g=m[+y];if(g&&0!==g.bitmap.width&&0!==g.bitmap.height){var v=n[d][y].rect;t.AlphaImage.copy(g.bitmap,f,{x:0,y:0},{x:v.x+1,y:v.y+1},g.bitmap)}}}this.image=f,this.positions=n};t.register("GlyphAtlas",i);var o=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies};function a(e,n,r){for(var i=new t.EvaluationParameters(n),o=0,a=e;o<a.length;o+=1)a[o].recalculate(i,r)}o.prototype.parse=function(e,n,r,o,s){var u=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var c=new t.DictionaryCoder(Object.keys(e.layers).sort()),l=new t.FeatureIndex(this.tileID);l.bucketLayerIDs=[];var h,p,f,d,m={},y={featureIndex:l,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:r},g=n.familiesBySource[this.source];for(var v in g){var _=e.layers[v];if(_){1===_.version&&t.warnOnce('Vector tile source "'+this.source+'" layer "'+v+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var b=c.encode(v),w=[],x=0;x<_.length;x++){var E=_.feature(x);w.push({feature:E,index:x,sourceLayerIndex:b})}for(var T=0,S=g[v];T<S.length;T+=1){var C=S[T],I=C[0];I.minzoom&&this.zoom<Math.floor(I.minzoom)||I.maxzoom&&this.zoom>=I.maxzoom||"none"!==I.visibility&&(a(C,this.zoom,r),(m[I.id]=I.createBucket({index:l.bucketLayerIDs.length,layers:C,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:b,sourceID:this.source})).populate(w,y),l.bucketLayerIDs.push(C.map((function(t){return t.id}))))}}}var k=t.mapObject(y.glyphDependencies,(function(t){return Object.keys(t).map(Number)}));Object.keys(k).length?o.send("getGlyphs",{uid:this.uid,stacks:k},(function(t,e){h||(h=t,p=e,P.call(u))})):p={};var A=Object.keys(y.iconDependencies);A.length?o.send("getImages",{icons:A,source:this.source,tileID:this.tileID,type:"icons"},(function(t,e){h||(h=t,f=e,P.call(u))})):f={};var O=Object.keys(y.patternDependencies);function P(){if(h)return s(h);if(p&&f&&d){var e=new i(p),n=new t.ImageAtlas(f,d);for(var o in m){var u=m[o];u instanceof t.SymbolBucket?(a(u.layers,this.zoom,r),t.performSymbolLayout(u,p,e.positions,f,n.iconPositions,this.showCollisionBoxes)):u.hasPattern&&(u instanceof t.LineBucket||u instanceof t.FillBucket||u instanceof t.FillExtrusionBucket)&&(a(u.layers,this.zoom,r),u.addFeatures(y,n.patternPositions))}this.status="done",s(null,{buckets:t.values(m).filter((function(t){return!t.isEmpty()})),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:n,glyphMap:this.returnDependencies?p:null,iconMap:this.returnDependencies?f:null,glyphPositions:this.returnDependencies?e.positions:null})}}O.length?o.send("getImages",{icons:O,source:this.source,tileID:this.tileID,type:"patterns"},(function(t,e){h||(h=t,d=e,P.call(u))})):d={},P.call(this)};var s="undefined"!=typeof performance,u={getEntriesByName:function(t){return!!(s&&performance&&performance.getEntriesByName)&&performance.getEntriesByName(t)},mark:function(t){return!!(s&&performance&&performance.mark)&&performance.mark(t)},measure:function(t,e,n){return!!(s&&performance&&performance.measure)&&performance.measure(t,e,n)},clearMarks:function(t){return!!(s&&performance&&performance.clearMarks)&&performance.clearMarks(t)},clearMeasures:function(t){return!!(s&&performance&&performance.clearMeasures)&&performance.clearMeasures(t)}},c=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},u.mark(this._marks.start)};function l(e,n){var r=t.getArrayBuffer(e.request,(function(e,r,i,o){e?n(e):r&&n(null,{vectorTile:new t.vectorTile.VectorTile(new t.pbf(r)),rawData:r,cacheControl:i,expires:o})}));return function(){r.cancel(),n()}}c.prototype.finish=function(){u.mark(this._marks.end);var t=u.getEntriesByName(this._marks.measure);return 0===t.length&&(u.measure(this._marks.measure,this._marks.start,this._marks.end),t=u.getEntriesByName(this._marks.measure),u.clearMarks(this._marks.start),u.clearMarks(this._marks.end),u.clearMeasures(this._marks.measure)),t},u.Performance=c;var h=function(t,e,n,r){this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=r||l,this.loading={},this.loaded={}};h.prototype.loadTile=function(e,n){var r=this,i=e.uid;this.loading||(this.loading={});var a=!!(e&&e.request&&e.request.collectResourceTiming)&&new u.Performance(e.request),s=this.loading[i]=new o(e);s.abort=this.loadVectorData(e,(function(e,o){if(delete r.loading[i],e||!o)return s.status="done",r.loaded[i]=s,n(e);var u=o.rawData,c={};o.expires&&(c.expires=o.expires),o.cacheControl&&(c.cacheControl=o.cacheControl);var l={};if(a){var h=a.finish();h&&(l.resourceTiming=JSON.parse(JSON.stringify(h)))}s.vectorTile=o.vectorTile,s.parse(o.vectorTile,r.layerIndex,r.availableImages,r.actor,(function(e,r){if(e||!r)return n(e);n(null,t.extend({rawTileData:u.slice(0)},r,c,l))})),r.loaded=r.loaded||{},r.loaded[i]=s}))},h.prototype.reloadTile=function(t,e){var n=this,r=this.loaded,i=t.uid,o=this;if(r&&r[i]){var a=r[i];a.showCollisionBoxes=t.showCollisionBoxes;var s=function(t,r){var i=a.reloadCallback;i&&(delete a.reloadCallback,a.parse(a.vectorTile,o.layerIndex,n.availableImages,o.actor,i)),e(t,r)};"parsing"===a.status?a.reloadCallback=s:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}},h.prototype.abortTile=function(t,e){var n=this.loading,r=t.uid;n&&n[r]&&n[r].abort&&(n[r].abort(),delete n[r]),e()},h.prototype.removeTile=function(t,e){var n=this.loaded,r=t.uid;n&&n[r]&&delete n[r],e()};var p=function(){this.loaded={}};p.prototype.loadTile=function(e,n){var r=e.uid,i=e.encoding,o=e.rawImageData,a=new t.DEMData(r,o,i);this.loaded=this.loaded||{},this.loaded[r]=a,n(null,a)},p.prototype.removeTile=function(t){var e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]};var f={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function d(t){var e=0;if(t&&t.length>0){e+=Math.abs(m(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(m(t[n]))}return e}function m(t){var e,n,r,i,o,a,s=0,u=t.length;if(u>2){for(a=0;a<u;a++)a===u-2?(r=u-2,i=u-1,o=0):a===u-1?(r=u-1,i=0,o=1):(r=a,i=a+1,o=a+2),e=t[r],n=t[i],s+=(y(t[o][0])-y(e[0]))*Math.sin(y(n[1]));s=s*f.RADIUS*f.RADIUS/2}return s}function y(t){return t*Math.PI/180}var g={geometry:function t(e){var n,r=0;switch(e.type){case"Polygon":return d(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)r+=d(e.coordinates[n]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)r+=t(e.geometries[n]);return r}},ring:m};function v(t,e){return function(n){return t(n,e)}}function _(t,e){e=!!e,t[0]=b(t[0],e);for(var n=1;n<t.length;n++)t[n]=b(t[n],!e);return t}function b(t,e){return function(t){return g.ring(t)>=0}(t)===e?t:t.reverse()}var w=t.vectorTile.VectorTileFeature.prototype.toGeoJSON,x=function(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};x.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],n=0,r=this._feature.geometry;n<r.length;n+=1){var i=r[n];e.push([new t.Point$1(i[0],i[1])])}return e}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var u=[],c=0,l=s[a];c<l.length;c+=1){var h=l[c];u.push(new t.Point$1(h[0],h[1]))}o.push(u)}return o},x.prototype.toGeoJSON=function(t,e,n){return w.call(this,t,e,n)};var E=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e};E.prototype.feature=function(t){return new x(this._features[t])};var T=t.vectorTile.VectorTileFeature,S=C;function C(t,e){this.options=e||{},this.features=t,this.length=t.length}function I(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}C.prototype.feature=function(t){return new I(this.features[t],this.options.extent)},I.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var r=e[n],i=[],o=0;o<r.length;o++)i.push(new t.Point$1(r[o][0],r[o][1]));this.geometry.push(i)}return this.geometry},I.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,r=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var u=a[s];e=Math.min(e,u.x),n=Math.max(n,u.x),r=Math.min(r,u.y),i=Math.max(i,u.y)}return[e,r,n,i]},I.prototype.toGeoJSON=T.prototype.toGeoJSON;var k=P,A=P,O=S;function P(e){var n=new t.pbf;return function(t,e){for(var n in t.layers)e.writeMessage(3,D,t.layers[n])}(e,n),n.finish()}function D(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)r.feature=t.feature(n),e.writeMessage(2,M,r);var i=r.keys;for(n=0;n<i.length;n++)e.writeStringField(3,i[n]);var o=r.values;for(n=0;n<o.length;n++)e.writeMessage(4,j,o[n])}function M(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,R,t),e.writeVarintField(3,n.type),e.writeMessage(4,F,n)}function R(t,e){var n=t.feature,r=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in n.properties){var u=o[s];void 0===u&&(r.push(s),u=r.length-1,o[s]=u),e.writeVarint(u);var c=n.properties[s],l=typeof c;"string"!==l&&"boolean"!==l&&"number"!==l&&(c=JSON.stringify(c));var h=l+":"+c,p=a[h];void 0===p&&(i.push(c),p=i.length-1,a[h]=p),e.writeVarint(p)}}function N(t,e){return(e<<3)+(7&t)}function L(t){return t<<1^t>>31}function F(t,e){for(var n=t.loadGeometry(),r=t.type,i=0,o=0,a=n.length,s=0;s<a;s++){var u=n[s],c=1;1===r&&(c=u.length),e.writeVarint(N(1,c));for(var l=3===r?u.length-1:u.length,h=0;h<l;h++){1===h&&1!==r&&e.writeVarint(N(2,l-1));var p=u[h].x-i,f=u[h].y-o;e.writeVarint(L(p)),e.writeVarint(L(f)),i+=p,o+=f}3===r&&e.writeVarint(N(7,1))}}function j(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function z(t,e,n,r){B(t,n,r),B(e,2*n,2*r),B(e,2*n+1,2*r+1)}function B(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function U(t,e,n,r){var i=t-n,o=e-r;return i*i+o*o}k.fromVectorTileJs=A,k.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var r in t)n[r]=new S(t[r].features,e),n[r].name=r,n[r].version=e.version,n[r].extent=e.extent;return P({layers:n})},k.GeoJSONWrapper=O;var V=function(t){return t[0]},q=function(t){return t[1]},W=function(t,e,n,r,i){void 0===e&&(e=V),void 0===n&&(n=q),void 0===r&&(r=64),void 0===i&&(i=Float64Array),this.nodeSize=r,this.points=t;for(var o=t.length<65536?Uint16Array:Uint32Array,a=this.ids=new o(t.length),s=this.coords=new i(2*t.length),u=0;u<t.length;u++)a[u]=u,s[2*u]=e(t[u]),s[2*u+1]=n(t[u]);!function t(e,n,r,i,o,a){if(!(o-i<=r)){var s=i+o>>1;!function t(e,n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1);t(e,n,r,Math.max(i,Math.floor(r-u*l/s+h)),Math.min(o,Math.floor(r+(s-u)*l/s+h)),a)}var p=n[2*r+a],f=i,d=o;for(z(e,n,i,r),n[2*o+a]>p&&z(e,n,i,o);f<d;){for(z(e,n,f,d),f++,d--;n[2*f+a]<p;)f++;for(;n[2*d+a]>p;)d--}n[2*i+a]===p?z(e,n,i,d):z(e,n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(e,n,s,i,o,a%2),t(e,n,r,i,s-1,a+1),t(e,n,r,s+1,o,a+1)}}(a,s,r,0,a.length-1,0)};W.prototype.range=function(t,e,n,r){return function(t,e,n,r,i,o,a){for(var s,u,c=[0,t.length-1,0],l=[];c.length;){var h=c.pop(),p=c.pop(),f=c.pop();if(p-f<=a)for(var d=f;d<=p;d++)s=e[2*d],u=e[2*d+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[d]);else{var m=Math.floor((f+p)/2);s=e[2*m],u=e[2*m+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[m]);var y=(h+1)%2;(0===h?n<=s:r<=u)&&(c.push(f),c.push(m-1),c.push(y)),(0===h?i>=s:o>=u)&&(c.push(m+1),c.push(p),c.push(y))}}return l}(this.ids,this.coords,t,e,n,r,this.nodeSize)},W.prototype.within=function(t,e,n){return function(t,e,n,r,i,o){for(var a=[0,t.length-1,0],s=[],u=i*i;a.length;){var c=a.pop(),l=a.pop(),h=a.pop();if(l-h<=o)for(var p=h;p<=l;p++)U(e[2*p],e[2*p+1],n,r)<=u&&s.push(t[p]);else{var f=Math.floor((h+l)/2),d=e[2*f],m=e[2*f+1];U(d,m,n,r)<=u&&s.push(t[f]);var y=(c+1)%2;(0===c?n-i<=d:r-i<=m)&&(a.push(h),a.push(f-1),a.push(y)),(0===c?n+i>=d:r+i>=m)&&(a.push(f+1),a.push(l),a.push(y))}}return s}(this.ids,this.coords,t,e,n,this.nodeSize)};var G={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(t){return t}},H=function(t){this.options=$(Object.create(G),t),this.trees=new Array(this.options.maxZoom+1)};function K(t,e,n,r,i){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function Q(t,e){var n=t.geometry.coordinates,r=n[0],i=n[1];return{x:Z(r),y:J(i),zoom:1/0,index:e,parentId:-1}}function X(t){return{type:"Feature",id:t.id,properties:Y(t),geometry:{type:"Point",coordinates:[(r=t.x,360*(r-.5)),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n,r}function Y(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return $($({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function Z(t){return t/360+.5}function J(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function $(t,e){for(var n in e)t[n]=e[n];return t}function tt(t){return t.x}function et(t){return t.y}function nt(t,e,n,r,i,o){var a=i-n,s=o-r;if(0!==a||0!==s){var u=((t-n)*a+(e-r)*s)/(a*a+s*s);u>1?(n=i,r=o):u>0&&(n+=a*u,r+=s*u)}return(a=t-n)*a+(s=e-r)*s}function rt(t,e,n,r){var i={id:void 0===t?null:t,type:e,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)it(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<e.length;r++)it(t,e[r]);else if("MultiPolygon"===n)for(r=0;r<e.length;r++)for(var i=0;i<e[r].length;i++)it(t,e[r][i])}(i),i}function it(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function ot(t,e,n,r){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],u=e.id;if(n.promoteId?u=e.properties[n.promoteId]:n.generateId&&(u=r||0),"Point"===o)at(i,s);else if("MultiPoint"===o)for(var c=0;c<i.length;c++)at(i[c],s);else if("LineString"===o)st(i,s,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(c=0;c<i.length;c++)s=[],st(i[c],s,a,!1),t.push(rt(u,"LineString",s,e.properties));return}ut(i,s,a,!1)}else if("Polygon"===o)ut(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(c=0;c<e.geometry.geometries.length;c++)ot(t,{id:u,geometry:e.geometry.geometries[c],properties:e.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<i.length;c++){var l=[];ut(i[c],l,a,!0),s.push(l)}}t.push(rt(u,o,s,e.properties))}}function at(t,e){e.push(ct(t[0])),e.push(lt(t[1])),e.push(0)}function st(t,e,n,r){for(var i,o,a=0,s=0;s<t.length;s++){var u=ct(t[s][0]),c=lt(t[s][1]);e.push(u),e.push(c),e.push(0),s>0&&(a+=r?(i*c-u*o)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(c-o,2))),i=u,o=c}var l=e.length-3;e[2]=1,function t(e,n,r,i){for(var o,a=i,s=r-n>>1,u=r-n,c=e[n],l=e[n+1],h=e[r],p=e[r+1],f=n+3;f<r;f+=3){var d=nt(e[f],e[f+1],c,l,h,p);if(d>a)o=f,a=d;else if(d===a){var m=Math.abs(f-s);m<u&&(o=f,u=m)}}a>i&&(o-n>3&&t(e,n,o,i),e[o+2]=a,r-o>3&&t(e,o,r,i))}(e,0,l,n),e[l+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function ut(t,e,n,r){for(var i=0;i<t.length;i++){var o=[];st(t[i],o,n,r),e.push(o)}}function ct(t){return t/360+.5}function lt(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function ht(t,e,n,r,i,o,a,s){if(r/=e,o>=(n/=e)&&a<r)return t;if(a<n||o>=r)return null;for(var u=[],c=0;c<t.length;c++){var l=t[c],h=l.geometry,p=l.type,f=0===i?l.minX:l.minY,d=0===i?l.maxX:l.maxY;if(f>=n&&d<r)u.push(l);else if(!(d<n||f>=r)){var m=[];if("Point"===p||"MultiPoint"===p)pt(h,m,n,r,i);else if("LineString"===p)ft(h,m,n,r,i,!1,s.lineMetrics);else if("MultiLineString"===p)mt(h,m,n,r,i,!1);else if("Polygon"===p)mt(h,m,n,r,i,!0);else if("MultiPolygon"===p)for(var y=0;y<h.length;y++){var g=[];mt(h[y],g,n,r,i,!0),g.length&&m.push(g)}if(m.length){if(s.lineMetrics&&"LineString"===p){for(y=0;y<m.length;y++)u.push(rt(l.id,p,m[y],l.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===m.length?(p="LineString",m=m[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===m.length?"Point":"MultiPoint"),u.push(rt(l.id,p,m,l.tags))}}}return u.length?u:null}function pt(t,e,n,r,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=n&&a<=r&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function ft(t,e,n,r,i,o,a){for(var s,u,c=dt(t),l=0===i?gt:vt,h=t.start,p=0;p<t.length-3;p+=3){var f=t[p],d=t[p+1],m=t[p+2],y=t[p+3],g=t[p+4],v=0===i?f:d,_=0===i?y:g,b=!1;a&&(s=Math.sqrt(Math.pow(f-y,2)+Math.pow(d-g,2))),v<n?_>n&&(u=l(c,f,d,y,g,n),a&&(c.start=h+s*u)):v>r?_<r&&(u=l(c,f,d,y,g,r),a&&(c.start=h+s*u)):yt(c,f,d,m),_<n&&v>=n&&(u=l(c,f,d,y,g,n),b=!0),_>r&&v<=r&&(u=l(c,f,d,y,g,r),b=!0),!o&&b&&(a&&(c.end=h+s*u),e.push(c),c=dt(t)),a&&(h+=s)}var w=t.length-3;f=t[w],d=t[w+1],m=t[w+2],(v=0===i?f:d)>=n&&v<=r&&yt(c,f,d,m),w=c.length-3,o&&w>=3&&(c[w]!==c[0]||c[w+1]!==c[1])&&yt(c,c[0],c[1],c[2]),c.length&&e.push(c)}function dt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function mt(t,e,n,r,i,o){for(var a=0;a<t.length;a++)ft(t[a],e,n,r,i,o,!1)}function yt(t,e,n,r){t.push(e),t.push(n),t.push(r)}function gt(t,e,n,r,i,o){var a=(o-e)/(r-e);return t.push(o),t.push(n+(i-n)*a),t.push(1),a}function vt(t,e,n,r,i,o){var a=(o-n)/(i-n);return t.push(e+(r-e)*a),t.push(o),t.push(1),a}function _t(t,e){for(var n=[],r=0;r<t.length;r++){var i,o=t[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=bt(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(bt(o.geometry[s],e))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var u=[],c=0;c<o.geometry[s].length;c++)u.push(bt(o.geometry[s][c],e));i.push(u)}n.push(rt(o.id,a,i,o.tags))}return n}function bt(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var r=0;r<t.length;r+=3)n.push(t[r]+e,t[r+1],t[r+2]);return n}function wt(t,e){if(t.transformed)return t;var n,r,i,o=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var u=t.features[n],c=u.geometry,l=u.type;if(u.geometry=[],1===l)for(r=0;r<c.length;r+=2)u.geometry.push(xt(c[r],c[r+1],e,o,a,s));else for(r=0;r<c.length;r++){var h=[];for(i=0;i<c[r].length;i+=2)h.push(xt(c[r][i],c[r][i+1],e,o,a,s));u.geometry.push(h)}}return t.transformed=!0,t}function xt(t,e,n,r,i,o){return[Math.round(n*(t*r-i)),Math.round(n*(e*r-o))]}function Et(t,e,n,r,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,Tt(a,t[s],o,i);var u=t[s].minX,c=t[s].minY,l=t[s].maxX,h=t[s].maxY;u<a.minX&&(a.minX=u),c<a.minY&&(a.minY=c),l>a.maxX&&(a.maxX=l),h>a.maxY&&(a.maxY=h)}return a}function Tt(t,e,n,r){var i=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)St(a,i,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)St(a,i[s],t,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var c=i[u];for(s=0;s<c.length;s++)St(a,c[s],t,n,!0,0===s)}if(a.length){var l=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var h in l={},e.tags)l[h]=e.tags[h];l.mapbox_clip_start=i.start/i.size,l.mapbox_clip_end=i.end/i.size}var p={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:l};null!==e.id&&(p.id=e.id),t.features.push(p)}}function St(t,e,n,r,i,o){var a=r*r;if(r>0&&e.size<(i?a:r))n.numPoints+=e.length/3;else{for(var s=[],u=0;u<e.length;u+=3)(0===r||e[u+2]>a)&&(n.numSimplified++,s.push(e[u]),s.push(e[u+1])),n.numPoints++;i&&function(t,e){for(var n=0,r=0,i=t.length,o=i-2;r<i;o=r,r+=2)n+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(n>0===e)for(r=0,i=t.length;r<i/2;r+=2){var a=t[r],s=t[r+1];t[r]=t[i-2-r],t[r+1]=t[i-1-r],t[i-2-r]=a,t[i-1-r]=s}}(s,o),t.push(s)}}function Ct(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)ot(n,t.features[r],e,r);else"Feature"===t.type?ot(n,t,e):ot(n,{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=function(t,e){var n=e.buffer/e.extent,r=t,i=ht(t,1,-1-n,n,0,-1,2,e),o=ht(t,1,1-n,2+n,0,-1,2,e);return(i||o)&&(r=ht(t,1,-n,1+n,0,-1,2,e)||[],i&&(r=_t(i,1).concat(r)),o&&(r=r.concat(_t(o,-1)))),r}(r,e)).length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function It(t,e,n){return 32*((1<<t)*n+e)+t}function kt(t,e){var n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return e(null,null);var i=new E(r.features),o=k(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:i,rawData:o.buffer})}H.prototype.load=function(t){var e=this.options,n=e.log,r=e.minZoom,i=e.maxZoom,o=e.nodeSize;n&&console.time("total time");var a="prepare "+t.length+" points";n&&console.time(a),this.points=t;for(var s=[],u=0;u<t.length;u++)t[u].geometry&&s.push(Q(t[u],u));this.trees[i+1]=new W(s,tt,et,o,Float32Array),n&&console.timeEnd(a);for(var c=i;c>=r;c--){var l=+Date.now();s=this._cluster(s,c),this.trees[c]=new W(s,tt,et,o,Float32Array),n&&console.log("z%d: %d clusters in %dms",c,s.length,+Date.now()-l)}return n&&console.timeEnd("total time"),this},H.prototype.getClusters=function(t,e){var n=((t[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,t[1])),i=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){var a=this.getClusters([n,r,180,o],e),s=this.getClusters([-180,r,i,o],e);return a.concat(s)}for(var u=this.trees[this._limitZoom(e)],c=[],l=0,h=u.range(Z(n),J(o),Z(i),J(r));l<h.length;l+=1){var p=h[l],f=u.points[p];c.push(f.numPoints?X(f):this.points[f.index])}return c},H.prototype.getChildren=function(t){var e=this._getOriginId(t),n=this._getOriginZoom(t),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[e];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=[],u=0,c=i.within(o.x,o.y,a);u<c.length;u+=1){var l=c[u],h=i.points[l];h.parentId===t&&s.push(h.numPoints?X(h):this.points[h.index])}if(0===s.length)throw new Error(r);return s},H.prototype.getLeaves=function(t,e,n){e=e||10,n=n||0;var r=[];return this._appendLeaves(r,t,e,n,0),r},H.prototype.getTile=function(t,e,n){var r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),o=this.options,a=o.extent,s=o.radius/a,u=(n-s)/i,c=(n+1+s)/i,l={features:[]};return this._addTileFeatures(r.range((e-s)/i,u,(e+1+s)/i,c),r.points,e,n,i,l),0===e&&this._addTileFeatures(r.range(1-s/i,u,1,c),r.points,i,n,i,l),e===i-1&&this._addTileFeatures(r.range(0,u,s/i,c),r.points,-1,n,i,l),l.features.length?l:null},H.prototype.getClusterExpansionZoom=function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},H.prototype._appendLeaves=function(t,e,n,r,i){for(var o=0,a=this.getChildren(e);o<a.length;o+=1){var s=a[o],u=s.properties;if(u&&u.cluster?i+u.point_count<=r?i+=u.point_count:i=this._appendLeaves(t,u.cluster_id,n,r,i):i<r?i++:t.push(s),t.length===n)break}return i},H.prototype._addTileFeatures=function(t,e,n,r,i,o){for(var a=0,s=t;a<s.length;a+=1){var u=e[s[a]],c=u.numPoints,l={type:1,geometry:[[Math.round(this.options.extent*(u.x*i-n)),Math.round(this.options.extent*(u.y*i-r))]],tags:c?Y(u):this.points[u.index].properties},h=void 0;c?h=u.id:this.options.generateId?h=u.index:this.points[u.index].id&&(h=this.points[u.index].id),void 0!==h&&(l.id=h),o.features.push(l)}},H.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},H.prototype._cluster=function(t,e){for(var n=[],r=this.options,i=r.radius,o=r.extent,a=r.reduce,s=i/(o*Math.pow(2,e)),u=0;u<t.length;u++){var c=t[u];if(!(c.zoom<=e)){c.zoom=e;for(var l=this.trees[e+1],h=l.within(c.x,c.y,s),p=c.numPoints||1,f=c.x*p,d=c.y*p,m=a&&p>1?this._map(c,!0):null,y=(u<<5)+(e+1)+this.points.length,g=0,v=h;g<v.length;g+=1){var _=v[g],b=l.points[_];if(!(b.zoom<=e)){b.zoom=e;var w=b.numPoints||1;f+=b.x*w,d+=b.y*w,p+=w,b.parentId=y,a&&(m||(m=this._map(c,!0)),a(m,this._map(b)))}}1===p?n.push(c):(c.parentId=y,n.push(K(f/p,d/p,y,p,m)))}}return n},H.prototype._getOriginId=function(t){return t-this.points.length>>5},H.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},H.prototype._map=function(t,e){if(t.numPoints)return e?$({},t.properties):t.properties;var n=this.points[t.index].properties,r=this.options.map(n);return e&&r===n?$({},r):r},Ct.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ct.prototype.splitTile=function(t,e,n,r,i,o,a){for(var s=[t,e,n,r],u=this.options,c=u.debug;s.length;){r=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var l=1<<e,h=It(e,n,r),p=this.tiles[h];if(!p&&(c>1&&console.time("creation"),p=this.tiles[h]=Et(t,e,n,r,u),this.tileCoords.push({z:e,x:n,y:r}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,r,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var f="z"+e;this.stats[f]=(this.stats[f]||0)+1,this.total++}if(p.source=t,i){if(e===u.maxZoom||e===i)continue;var d=1<<i-e;if(n!==Math.floor(o/d)||r!==Math.floor(a/d))continue}else if(e===u.indexMaxZoom||p.numPoints<=u.indexMaxPoints)continue;if(p.source=null,0!==t.length){c>1&&console.time("clipping");var m,y,g,v,_,b,w=.5*u.buffer/u.extent,x=.5-w,E=.5+w,T=1+w;m=y=g=v=null,_=ht(t,l,n-w,n+E,0,p.minX,p.maxX,u),b=ht(t,l,n+x,n+T,0,p.minX,p.maxX,u),t=null,_&&(m=ht(_,l,r-w,r+E,1,p.minY,p.maxY,u),y=ht(_,l,r+x,r+T,1,p.minY,p.maxY,u),_=null),b&&(g=ht(b,l,r-w,r+E,1,p.minY,p.maxY,u),v=ht(b,l,r+x,r+T,1,p.minY,p.maxY,u),b=null),c>1&&console.timeEnd("clipping"),s.push(m||[],e+1,2*n,2*r),s.push(y||[],e+1,2*n,2*r+1),s.push(g||[],e+1,2*n+1,2*r),s.push(v||[],e+1,2*n+1,2*r+1)}}},Ct.prototype.getTile=function(t,e,n){var r=this.options,i=r.extent,o=r.debug;if(t<0||t>24)return null;var a=1<<t,s=It(t,e=(e%a+a)%a,n);if(this.tiles[s])return wt(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var u,c=t,l=e,h=n;!u&&c>0;)c--,l=Math.floor(l/2),h=Math.floor(h/2),u=this.tiles[It(c,l,h)];return u&&u.source?(o>1&&console.log("found parent tile z%d-%d-%d",c,l,h),o>1&&console.time("drilling down"),this.splitTile(u.source,c,l,h,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?wt(this.tiles[s],i):null):null};var At=function(e){function n(t,n,r,i){e.call(this,t,n,r,kt),i&&(this.loadGeoJSON=i)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},n.prototype._loadData=function(){var e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var n=this._pendingCallback,r=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var i=!!(r&&r.request&&r.request.collectResourceTiming)&&new u.Performance(r.request);this.loadGeoJSON(r,(function(o,a){if(o||!a)return n(o);if("object"!=typeof a)return n(new Error("Input data given to '"+r.source+"' is not a valid GeoJSON object."));!function t(e,n){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(v(t,n)),e;case"GeometryCollection":return e.geometries=e.geometries.map(v(t,n)),e;case"Feature":return e.geometry=t(e.geometry,n),e;case"Polygon":case"MultiPolygon":return function(t,e){return"Polygon"===t.type?t.coordinates=_(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(v(_,e))),t}(e,n);default:return e}}(a,!0);try{e._geoJSONIndex=r.cluster?new H(function(e){var n=e.superclusterOptions,r=e.clusterProperties;if(!r||!n)return n;for(var i={},o={},a={accumulated:null,zoom:0},s={properties:null},u=Object.keys(r),c=0,l=u;c<l.length;c+=1){var h=l[c],p=r[h],f=p[0],d=p[1],m=t.createExpression(d),y=t.createExpression("string"==typeof f?[f,["accumulated"],["get",h]]:f);i[h]=m.value,o[h]=y.value}return n.map=function(t){s.properties=t;for(var e={},n=0,r=u;n<r.length;n+=1){var o=r[n];e[o]=i[o].evaluate(a,s)}return e},n.reduce=function(t,e){s.properties=e;for(var n=0,r=u;n<r.length;n+=1){var i=r[n];a.accumulated=t[i],t[i]=o[i].evaluate(a,s)}},n}(r)).load(a.features):function(t,e){return new Ct(t,e)}(a,r.geojsonVtOptions)}catch(o){return n(o)}e.loaded={};var s={};if(i){var u=i.finish();u&&(s.resourceTiming={},s.resourceTiming[r.source]=JSON.parse(JSON.stringify(u)))}n(null,s)}))}},n.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},n.prototype.reloadTile=function(t,n){var r=this.loaded,i=t.uid;return r&&r[i]?e.prototype.reloadTile.call(this,t,n):this.loadTile(t,n)},n.prototype.loadGeoJSON=function(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."))}}},n.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},n.prototype.getClusterExpansionZoom=function(t,e){e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))},n.prototype.getClusterChildren=function(t,e){e(null,this._geoJSONIndex.getChildren(t.clusterId))},n.prototype.getClusterLeaves=function(t,e){e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))},n}(h),Ot=function(e){var n=this;this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:h,geojson:At},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(n.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');n.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return Ot.prototype.setReferrer=function(t,e){this.referrer=e},Ot.prototype.setImages=function(t,e,n){this.availableImages[t]=e,n()},Ot.prototype.setLayers=function(t,e,n){this.getLayerIndex(t).replace(e),n()},Ot.prototype.updateLayers=function(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()},Ot.prototype.loadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).loadTile(e,n)},Ot.prototype.loadDEMTile=function(t,e,n){this.getDEMWorkerSource(t,e.source).loadTile(e,n)},Ot.prototype.reloadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).reloadTile(e,n)},Ot.prototype.abortTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)},Ot.prototype.removeTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)},Ot.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},Ot.prototype.removeSource=function(t,e,n){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var r=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==r.removeSource?r.removeSource(e,n):n()}},Ot.prototype.loadWorkerSource=function(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}},Ot.prototype.syncRTLPluginState=function(e,n,r){try{t.plugin.setState(n);var i=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=i){this.self.importScripts(i);var o=t.plugin.isParsed();r(o?void 0:new Error("RTL Text Plugin failed to import scripts from "+i),o)}}catch(t){r(t.toString())}},Ot.prototype.getAvailableImages=function(t){var e=this.availableImages[t];return e||(e=[]),e},Ot.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new r),e},Ot.prototype.getWorkerSource=function(t,e,n){var r=this;if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][n]){var i={send:function(e,n,i){r.actor.send(e,n,i,t)}};this.workerSources[t][e][n]=new this.workerSourceTypes[e](i,this.getLayerIndex(t),this.getAvailableImages(t))}return this.workerSources[t][e][n]},Ot.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new p),this.demWorkerSources[t][e]},Ot.prototype.enforceCacheSizeLimit=function(e,n){t.enforceCacheSizeLimit(n)},"undefined"!=typeof WorkerGlobalScope&&void 0!==t.window&&t.window instanceof WorkerGlobalScope&&(t.window.worker=new Ot(t.window)),Ot})),r(0,(function(t){var e=t.createCommonjsModule((function(t){function e(t){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(n);try{e=new Worker(r),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(r),t}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&function(t){return void 0===n[t]&&(n[t]=function(t){var n=document.createElement("canvas"),r=Object.create(e.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=t,n.probablySupportsContext?n.probablySupportsContext("webgl",r)||n.probablySupportsContext("experimental-webgl",r):n.supportsContext?n.supportsContext("webgl",r)||n.supportsContext("experimental-webgl",r):n.getContext("webgl",r)||n.getContext("experimental-webgl",r)}(t)),n[t]}(t&&t.failIfMajorPerformanceCaveat))}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e);var n={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),n={create:function(e,n,r){var i=t.window.document.createElement(e);return void 0!==n&&(i.className=n),r&&r.appendChild(i),i},createNS:function(e,n){return t.window.document.createElementNS(e,n)}},r=t.window.document.documentElement.style;function i(t){if(!r)return t[0];for(var e=0;e<t.length;e++)if(t[e]in r)return t[e];return t[0]}var o,a=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){r&&a&&(o=r[a],r[a]="none")},n.enableDrag=function(){r&&a&&(r[a]=o)};var s=i(["transform","WebkitTransform"]);n.setTransform=function(t,e){t.style[s]=e};var u=!1;try{var c=Object.defineProperty({},"passive",{get:function(){u=!0}});t.window.addEventListener("test",c,c),t.window.removeEventListener("test",c,c)}catch(t){u=!1}n.addEventListener=function(t,e,n,r){void 0===r&&(r={}),"passive"in r&&u?t.addEventListener(e,n,r):t.addEventListener(e,n,r.capture)},n.removeEventListener=function(t,e,n,r){void 0===r&&(r={}),"passive"in r&&u?t.removeEventListener(e,n,r):t.removeEventListener(e,n,r.capture)};var l=function e(n){n.preventDefault(),n.stopPropagation(),t.window.removeEventListener("click",e,!0)};function h(t){var e=t.userImage;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}n.suppressClick=function(){t.window.addEventListener("click",l,!0),t.window.setTimeout((function(){t.window.removeEventListener("click",l,!0)}),0)},n.mousePos=function(e,n){var r=e.getBoundingClientRect(),i=t.window.TouchEvent&&n instanceof t.window.TouchEvent?n.touches[0]:n;return new t.Point(i.clientX-r.left-e.clientLeft,i.clientY-r.top-e.clientTop)},n.touchPos=function(e,n){for(var r=e.getBoundingClientRect(),i=[],o="touchend"===n.type?n.changedTouches:n.touches,a=0;a<o.length;a++)i.push(new t.Point(o[a].clientX-r.left-e.clientLeft,o[a].clientY-r.top-e.clientTop));return i},n.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},n.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var p=function(e){function n(){e.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.isLoaded=function(){return this.loaded},n.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,n=this.requestors;e<n.length;e+=1){var r=n[e],i=r.ids,o=r.callback;this._notify(i,o)}this.requestors=[]}},n.prototype.getImage=function(t){return this.images[t]},n.prototype.addImage=function(t,e){this._validate(t,e)&&(this.images[t]=e)},n.prototype._validate=function(e,n){var r=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchX" value'))),r=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchY" value'))),r=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "content" value'))),r=!1),r},n.prototype._validateStretch=function(t,e){if(!t)return!0;for(var n=0,r=0,i=t;r<i.length;r+=1){var o=i[r];if(o[0]<n||o[1]<o[0]||e<o[1])return!1;n=o[1]}return!0},n.prototype._validateContent=function(t,e){return!t||4===t.length&&!(t[0]<0||e.data.width<t[0])&&!(t[1]<0||e.data.height<t[1])&&!(t[2]<0||e.data.width<t[2])&&!(t[3]<0||e.data.height<t[3])&&!(t[2]<t[0])&&!(t[3]<t[1])},n.prototype.updateImage=function(t,e){var n=this.images[t];e.version=n.version+1,this.images[t]=e,this.updatedImages[t]=!0},n.prototype.removeImage=function(t){var e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()},n.prototype.listImages=function(){return Object.keys(this.images)},n.prototype.getImages=function(t,e){var n=!0;if(!this.isLoaded())for(var r=0,i=t;r<i.length;r+=1){var o=i[r];this.images[o]||(n=!1)}this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})},n.prototype._notify=function(e,n){for(var r={},i=0,o=e;i<o.length;i+=1){var a=o[i];this.images[a]||this.fire(new t.Event("styleimagemissing",{id:a}));var s=this.images[a];s?r[a]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:t.warnOnce('Image "'+a+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}n(null,r)},n.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},n.prototype.getPattern=function(e){var n=this.patterns[e],r=this.getImage(e);if(!r)return null;if(n&&n.position.version===r.version)return n.position;if(n)n.position.version=r.version;else{var i={w:r.data.width+2,h:r.data.height+2,x:0,y:0},o=new t.ImagePosition(i,r);this.patterns[e]={bin:i,position:o}}return this._updatePatternAtlas(),this.patterns[e].position},n.prototype.bind=function(e){var n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)},n.prototype._updatePatternAtlas=function(){var e=[];for(var n in this.patterns)e.push(this.patterns[n].bin);var r=t.potpack(e),i=r.w,o=r.h,a=this.atlasImage;for(var s in a.resize({width:i||1,height:o||1}),this.patterns){var u=this.patterns[s].bin,c=u.x+1,l=u.y+1,h=this.images[s].data,p=h.width,f=h.height;t.RGBAImage.copy(h,a,{x:0,y:0},{x:c,y:l},{width:p,height:f}),t.RGBAImage.copy(h,a,{x:0,y:f-1},{x:c,y:l-1},{width:p,height:1}),t.RGBAImage.copy(h,a,{x:0,y:0},{x:c,y:l+f},{width:p,height:1}),t.RGBAImage.copy(h,a,{x:p-1,y:0},{x:c-1,y:l},{width:1,height:f}),t.RGBAImage.copy(h,a,{x:0,y:0},{x:c+p,y:l},{width:1,height:f})}this.dirty=!0},n.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},n.prototype.dispatchRenderCallbacks=function(t){for(var e=0,n=t;e<n.length;e+=1){var r=n[e];if(!this.callbackDispatchedThisFrame[r]){this.callbackDispatchedThisFrame[r]=!0;var i=this.images[r];h(i)&&this.updateImage(r,i)}}},n}(t.Evented),f=y,d=y,m=1e20;function y(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function g(t,e,n,r,i,o,a){for(var s=0;s<e;s++){for(var u=0;u<n;u++)r[u]=t[u*e+s];for(v(r,i,o,a,n),u=0;u<n;u++)t[u*e+s]=i[u]}for(u=0;u<n;u++){for(s=0;s<e;s++)r[s]=t[u*e+s];for(v(r,i,o,a,e),s=0;s<e;s++)t[u*e+s]=Math.sqrt(i[s])}}function v(t,e,n,r,i){n[0]=0,r[0]=-m,r[1]=+m;for(var o=1,a=0;o<i;o++){for(var s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=r[a];)a--,s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,r[a]=s,r[a+1]=+m}for(o=0,a=0;o<i;o++){for(;r[a+1]<o;)a++;e[o]=(o-n[a])*(o-n[a])+t[n[a]]}}y.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var i=e.data[4*r+3]/255;this.gridOuter[r]=1===i?0:0===i?m:Math.pow(Math.max(0,.5-i),2),this.gridInner[r]=1===i?m:0===i?0:Math.pow(Math.max(0,i-.5),2)}for(g(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),g(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++){var o=this.gridOuter[r]-this.gridInner[r];n[r]=Math.max(0,Math.min(255,Math.round(255-255*(o/this.radius+this.cutoff))))}return n},f.default=d;var _=function(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}};_.prototype.setURL=function(t){this.url=t},_.prototype.getGlyphs=function(e,n){var r=this,i=[];for(var o in e)for(var a=0,s=e[o];a<s.length;a+=1){var u=s[a];i.push({stack:o,id:u})}t.asyncAll(i,(function(t,e){var n=t.stack,i=t.id,o=r.entries[n];o||(o=r.entries[n]={glyphs:{},requests:{}});var a=o.glyphs[i];if(void 0===a){if(a=r._tinySDF(o,n,i))return o.glyphs[i]=a,void e(null,{stack:n,id:i,glyph:a});var s=Math.floor(i/256);if(256*s>65535)e(new Error("glyphs > 65535 not supported"));else{var u=o.requests[s];u||(u=o.requests[s]=[],_.loadGlyphRange(n,s,r.url,r.requestManager,(function(t,e){if(e)for(var n in e)r._doesCharSupportLocalGlyph(+n)||(o.glyphs[+n]=e[+n]);for(var i=0,a=u;i<a.length;i+=1)(0,a[i])(t,e);delete o.requests[s]}))),u.push((function(t,r){t?e(t):r&&e(null,{stack:n,id:i,glyph:r[i]||null})}))}}else e(null,{stack:n,id:i,glyph:a})}),(function(t,e){if(t)n(t);else if(e){for(var r={},i=0,o=e;i<o.length;i+=1){var a=o[i],s=a.stack,u=a.id,c=a.glyph;(r[s]||(r[s]={}))[u]=c&&{id:c.id,bitmap:c.bitmap.clone(),metrics:c.metrics}}n(null,r)}}))},_.prototype._doesCharSupportLocalGlyph=function(e){return!!this.localIdeographFontFamily&&(t.isChar["CJK Unified Ideographs"](e)||t.isChar["Hangul Syllables"](e)||t.isChar.Hiragana(e)||t.isChar.Katakana(e))},_.prototype._tinySDF=function(e,n,r){var i=this.localIdeographFontFamily;if(i&&this._doesCharSupportLocalGlyph(r)){var o=e.tinySDF;if(!o){var a="400";/bold/i.test(n)?a="900":/medium/i.test(n)?a="500":/light/i.test(n)&&(a="200"),o=e.tinySDF=new _.TinySDF(24,3,8,.25,i,a)}return{id:r,bitmap:new t.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(r))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},_.loadGlyphRange=function(e,n,r,i,o){var a=256*n,s=a+255,u=i.transformRequest(i.normalizeGlyphsURL(r).replace("{fontstack}",e).replace("{range}",a+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(u,(function(e,n){if(e)o(e);else if(n){for(var r={},i=0,a=t.parseGlyphPBF(n);i<a.length;i+=1){var s=a[i];r[s.id]=s}o(null,r)}}))},_.TinySDF=f;var b=function(){this.specification=t.styleSpec.light.position};b.prototype.possiblyEvaluate=function(e,n){return t.sphericalToCartesian(e.expression.evaluate(n))},b.prototype.interpolate=function(e,n,r){return{x:t.number(e.x,n.x,r),y:t.number(e.y,n.y,r),z:t.number(e.z,n.z,r)}};var w=new t.Properties({anchor:new t.DataConstantProperty(t.styleSpec.light.anchor),position:new b,color:new t.DataConstantProperty(t.styleSpec.light.color),intensity:new t.DataConstantProperty(t.styleSpec.light.intensity)}),x=function(e){function n(n){e.call(this),this._transitionable=new t.Transitionable(w),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getLight=function(){return this._transitionable.serialize()},n.prototype.setLight=function(e,n){if(void 0===n&&(n={}),!this._validate(t.validateLight,e,n))for(var r in e){var i=e[r];t.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-"-transition".length),i):this._transitionable.setValue(r,i)}},n.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},n.prototype.hasTransition=function(){return this._transitioning.hasTransition()},n.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},n.prototype._validate=function(e,n,r){return(!r||!1!==r.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.styleSpec})))},n}(t.Evented),E=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};E.prototype.getDash=function(t,e){var n=t.join(",")+String(e);return this.positions[n]||(this.positions[n]=this.addDash(t,e)),this.positions[n]},E.prototype.addDash=function(e,n){var r=n?7:0,i=2*r+1;if(this.nextRow+i>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];for(var s=this.width/o,u=s/2,c=e.length%2==1,l=-r;l<=r;l++)for(var h=this.nextRow+r+l,p=this.width*h,f=c?-e[e.length-1]:0,d=e[0],m=1,y=0;y<this.width;y++){for(;d<y/s;)f=d,d+=e[m],c&&m===e.length-1&&(d+=e[0]),m++;var g=Math.abs(y-f*s),v=Math.abs(y-d*s),_=Math.min(g,v),b=m%2==1,w=void 0;if(n){var x=r?l/r*(u+1):0;if(b){var E=u-Math.abs(x);w=Math.sqrt(_*_+E*E)}else w=u-Math.sqrt(_*_+x*x)}else w=(b?1:-1)*_;this.data[3+4*(p+y)]=Math.max(0,Math.min(255,w+128))}var T={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:o};return this.nextRow+=i,this.dirty=!0,T},E.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,this.data))};var T=function e(n,r){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var i=this.workerPool.acquire(this.id),o=0;o<i.length;o++){var a=i[o],s=new e.Actor(a,r,this.id);s.name="Worker "+o,this.actors.push(s)}};function S(e,n,r){var i=function(i,o){if(i)return r(i);if(o){var a=t.pick(t.extend(o,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);o.vector_layers&&(a.vectorLayers=o.vector_layers,a.vectorLayerIds=a.vectorLayers.map((function(t){return t.id}))),e.url&&(a.tiles=n.canonicalizeTileset(a,e.url)),r(null,a)}};return e.url?t.getJSON(n.transformRequest(n.normalizeSourceURL(e.url),t.ResourceType.Source),i):t.browser.frame((function(){return i(null,e)}))}T.prototype.broadcast=function(e,n,r){r=r||function(){},t.asyncAll(this.actors,(function(t,r){t.send(e,n,r)}),r)},T.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},T.prototype.remove=function(){this.actors.forEach((function(t){t.remove()})),this.actors=[],this.workerPool.release(this.id)},T.Actor=t.Actor;var C=function(e,n,r){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=r||24};C.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},C.prototype.contains=function(e){var n=Math.pow(2,e.z),r=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),i=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),o=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),a=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=r&&e.x<o&&e.y>=i&&e.y<a};var I=function(e){function n(n,r,i,o){if(e.call(this),this.id=n,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(r,["url","scheme","tileSize"])),this._options=t.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=S(this._options,this.map._requestManager,(function(n,r){e._tileJSONRequest=null,e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new C(r.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(r.tiles,e.map._requestManager._customAccessToken),t.postMapLoadEvent(r.tiles,e.map._getMapId(),e.map._requestManager._skuToken,e.map._requestManager._customAccessToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.loadTile=function(e,n){var r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.url,null),i={request:this.map._requestManager.transformRequest(r,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};function o(r,i){return delete e.request,e.aborted?n(null):r&&404!==r.status?n(r):(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state?"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",i,o.bind(this)):(e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",i,o.bind(this)))},n.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)},n.prototype.unloadTile=function(t){t.unloadVectorData(),t.clearMask(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)},n.prototype.hasTransition=function(){return!1},n}(t.Evented),k=function(e){function n(n,r,i,o){e.call(this),this.id=n,this.dispatcher=i,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},r),t.extend(this,t.pick(r,["url","scheme","tileSize"]))}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=S(this._options,this.map._requestManager,(function(n,r){e._tileJSONRequest=null,e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new C(r.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(r.tiles),t.postMapLoadEvent(r.tiles,e.map._getMapId(),e.map._requestManager._skuToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.loadTile=function(e,n){var r=this,i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(i,t.ResourceType.Tile),(function(i,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(o){r.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=r.map.painter.context,s=a.gl;e.texture=r.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new t.Texture(a,o,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(r.dispatcher),n(null)}}))},n.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},n.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),t.clearMask(),e()},n.prototype.hasTransition=function(){return!1},n}(t.Evented),A=function(e){function n(n,r,i,o){e.call(this,n,r,i,o),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},n.prototype.loadTile=function(e,n){var r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);function i(t,r){t&&(e.state="errored",n(t)),r&&(e.dem=r,e.needsHillshadePrepare=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),function(r,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(o){this.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=t.browser.getImageData(o,1),s={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:a,encoding:this.encoding};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",s,i.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},n.prototype._getNeighboringTiles=function(e){var n=e.canonical,r=Math.pow(2,n.z),i=(n.x-1+r)%r,o=0===n.x?e.wrap-1:e.wrap,a=(n.x+1+r)%r,s=n.x+1===r?e.wrap+1:e.wrap,u={};return u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y-1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<r&&(u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y+1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1}),u},n.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.clearMask(),t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})},n}(k),O=function(e){function n(n,r,i,o){e.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(o),this._data=r.data,this._options=t.extend({},r),this._collectResourceTiming=r.collectResourceTiming,this._resourceTiming=[],void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution);var a=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*a,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*a,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?Math.min(r.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:t.EXTENT,radius:(r.clusterRadius||50)*a,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties},r.workerOptions)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(n){if(n)e.fire(new t.ErrorEvent(n));else{var r={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(r.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",r))}}))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setData=function(e){var n=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(e){if(e)n.fire(new t.ErrorEvent(e));else{var r={dataType:"source",sourceDataType:"content"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(r.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new t.Event("data",r))}})),this},n.prototype.getClusterExpansionZoom=function(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this},n.prototype.getClusterChildren=function(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this},n.prototype.getClusterLeaves=function(t,e,n,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},r),this},n.prototype._updateWorkerData=function(e){var n=this;this._loaded=!1;var r=t.extend({},this.workerOptions),i=this._data;"string"==typeof i?(r.request=this.map._requestManager.transformRequest(t.browser.resolveURL(i),t.ResourceType.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(i),this.actor.send(this.type+".loadData",r,(function(t,i){n._removed||i&&i.abandoned||(n._loaded=!0,i&&i.resourceTiming&&i.resourceTiming[n.id]&&(n._resourceTiming=i.resourceTiming[n.id].slice(0)),n.actor.send(n.type+".coalesce",{source:r.source},null),e(t))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.loadTile=function(e,n){var r=this,i=e.actor?"reloadTile":"loadTile";e.actor=this.actor;var o={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};e.request=this.actor.send(i,o,(function(t,o){return delete e.request,e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(o,r.map.painter,"reloadTile"===i),n(null))}))},n.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0},n.prototype.unloadTile=function(t){t.unloadVectorData(),t.clearMask(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})},n.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},n.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},n.prototype.hasTransition=function(){return!1},n}(t.Evented),P=function(e){function n(t,n,r,i){e.call(this),this.id=t,this.dispatcher=r,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=n}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(e,n){var r=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(function(i,o){r._loaded=!0,i?r.fire(new t.ErrorEvent(i)):o&&(r.image=o,e&&(r.coordinates=e),n&&n(),r._finishLoading())}))},n.prototype.loaded=function(){return this._loaded},n.prototype.updateImage=function(t){var e=this;return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,(function(){e.texture=null})),this):this},n.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setCoordinates=function(e){var n=this;this.coordinates=e;var r=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){for(var n=1/0,r=1/0,i=-1/0,o=-1/0,a=0,s=e;a<s.length;a+=1){var u=s[a];n=Math.min(n,u.x),r=Math.min(r,u.y),i=Math.max(i,u.x),o=Math.max(o,u.y)}var c=i-n,l=o-r,h=Math.max(c,l),p=Math.max(0,Math.floor(-Math.log(h)/Math.LN2)),f=Math.pow(2,p);return new t.CanonicalTileID(p,Math.floor((n+i)/2*f),Math.floor((r+o)/2*f))}(r),this.minzoom=this.maxzoom=this.tileID.z;var i=r.map((function(t){return n.tileID.getTilePoint(t)._round()}));return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},n.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},n.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return!1},n}(t.Evented),D=function(e){function n(t,n,r,i){e.call(this,t,n,r,i),this.roundZoom=!0,this.type="video",this.options=n}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1;var n=this.options;this.urls=[];for(var r=0,i=n.urls;r<i.length;r+=1){var o=i[r];this.urls.push(this.map._requestManager.transformRequest(o,t.ResourceType.Source).url)}t.getVideo(this.urls,(function(n,r){e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):r&&(e.video=r,e.video.loop=!0,e.video.addEventListener("playing",(function(){e.map.triggerRepaint()})),e.map&&e.video.play(),e._finishLoading())}))},n.prototype.pause=function(){this.video&&this.video.pause()},n.prototype.play=function(){this.video&&this.video.play()},n.prototype.seek=function(e){if(this.video){var n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+n.start(0)+" and "+n.end(0)+"-second mark."))):this.video.currentTime=e}},n.prototype.getVideo=function(){return this.video},n.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},n.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this.video&&!this.video.paused},n}(P),M=function(e){function n(n,r,i,o){e.call(this,n,r,i,o),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((function(t){return!Array.isArray(t)||2!==t.length||t.some((function(t){return"number"!=typeof t}))}))||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},n.prototype.getCanvas=function(){return this.canvas},n.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},n.prototype.onRemove=function(){this.pause()},n.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,r=n.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,r.RGBA,{premultiply:!0}),this.tiles){var o=this.tiles[i];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this._playing},n.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var n=e[t];if(isNaN(n)||n<=0)return!0}return!1},n}(P),R={vector:I,raster:k,"raster-dem":A,geojson:O,video:D,image:P,canvas:M},N=function(e,n,r,i){var o=new R[n.type](e,n,r,i);if(o.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+o.id);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o};function L(e,n){var r=t.identity([]);return t.translate(r,r,[1,1,0]),t.scale(r,r,[.5*e.width,.5*e.height,1]),t.multiply(r,r,e.calculatePosMatrix(n.toUnwrapped()))}function F(t,e,n,r,i){var o=function(t,e,n){if(t)for(var r=0,i=t;r<i.length;r+=1){var o=e[i[r]];if(o&&o.source===n&&"fill-extrusion"===o.type)return!0}else for(var a in e){var s=e[a];if(s.source===n&&"fill-extrusion"===s.type)return!0}return!1}(r&&r.layers,e,t.id),a=i.maxPitchScaleFactor(),s=t.tilesIn(n,a,o);s.sort(j);for(var u=[],c=0,l=s;c<l.length;c+=1){var h=l[c];u.push({wrappedTileID:h.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(e,t._state,h.queryGeometry,h.cameraQueryGeometry,h.scale,r,i,a,L(t.transform,h.tileID))})}var p=function(t){for(var e={},n={},r=0,i=t;r<i.length;r+=1){var o=i[r],a=o.queryResults,s=o.wrappedTileID,u=n[s]=n[s]||{};for(var c in a)for(var l=a[c],h=u[c]=u[c]||{},p=e[c]=e[c]||[],f=0,d=l;f<d.length;f+=1){var m=d[f];h[m.featureIndex]||(h[m.featureIndex]=!0,p.push(m))}}return e}(u);for(var f in p)p[f].forEach((function(e){var n=e.feature,r=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=r}));return p}function j(t,e){var n=t.tileID,r=e.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}var z=function(t,e){this.max=t,this.onRemove=e,this.reset()};z.prototype.reset=function(){for(var t in this.data)for(var e=0,n=this.data[t];e<n.length;e+=1){var r=n[e];r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value)}return this.data={},this.order=[],this},z.prototype.add=function(t,e,n){var r=this,i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);var o={value:e,timeout:void 0};if(void 0!==n&&(o.timeout=setTimeout((function(){r.remove(t,o)}),n)),this.data[i].push(o),this.order.push(i),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},z.prototype.has=function(t){return t.wrapped().key in this.data},z.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},z.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},z.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},z.prototype.remove=function(t,e){if(!this.has(t))return this;var n=t.wrapped().key,r=void 0===e?0:this.data[n].indexOf(e),i=this.data[n][r];return this.data[n].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(i.value),this.order.splice(this.order.indexOf(n),1),this},z.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this},z.prototype.filter=function(t){var e=[];for(var n in this.data)for(var r=0,i=this.data[n];r<i.length;r+=1){var o=i[r];t(o.value)||e.push(o)}for(var a=0,s=e;a<s.length;a+=1){var u=s[a];this.remove(u.value.tileID,u)}};var B=function(t,e,n){this.context=t;var r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};B.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},B.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},B.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var U={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},V=function(t,e,n,r){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;var i=t.gl;this.buffer=i.createBuffer(),t.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};V.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},V.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},V.prototype.enableAttributes=function(t,e){for(var n=0;n<this.attributes.length;n++){var r=this.attributes[n],i=e.attributes[r.name];void 0!==i&&t.enableVertexAttribArray(i)}},V.prototype.setVertexAttribPointers=function(t,e,n){for(var r=0;r<this.attributes.length;r++){var i=this.attributes[r],o=e.attributes[i.name];void 0!==o&&t.vertexAttribPointer(o,i.components,t[U[i.type]],!1,this.itemSize,i.offset+this.itemSize*(n||0))}},V.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var q=function(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};q.prototype.get=function(){return this.current},q.prototype.set=function(t){},q.prototype.getDefault=function(){return this.default},q.prototype.setDefault=function(){this.set(this.default)};var W=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(q),G=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return 1},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)},e}(q),H=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return 0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)},e}(q),K=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return[!0,!0,!0,!0]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(q),Q=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)},e}(q),X=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return 255},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)},e}(q),Y=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},e.prototype.set=function(t){var e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)},e}(q),Z=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)},e}(q),J=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}},e}(q),$=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return[0,1]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)},e}(q),tt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}},e}(q),et=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return this.gl.LESS},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)},e}(q),nt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}},e}(q),rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.ONE,t.ZERO]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)},e}(q),it=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(q),ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return this.gl.FUNC_ADD},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)},e}(q),at=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}},e}(q),st=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return this.gl.BACK},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)},e}(q),ut=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return this.gl.CCW},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)},e}(q),ct=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)},e}(q),lt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return this.gl.TEXTURE0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)},e}(q),ht=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(q),pt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}},e}(q),ft=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(q),dt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}},e}(q),mt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}},e}(q),yt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1},e}(q),gt=function(t){function e(e){t.call(this,e),this.vao=e.extVertexArrayObject}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)},e}(q),vt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return 4},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}},e}(q),_t=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}},e}(q),bt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}},e}(q),wt=function(t){function e(e,n){t.call(this,e),this.context=e,this.parent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e}(q),xt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setDirty=function(){this.dirty=!0},e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e}(wt),Et=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(wt),Tt=function(t,e,n){this.context=t,this.width=e,this.height=n;var r=t.gl,i=this.framebuffer=r.createFramebuffer();this.colorAttachment=new xt(t,i),this.depthAttachment=new Et(t,i)};Tt.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();e&&t.deleteTexture(e);var n=this.depthAttachment.get();n&&t.deleteRenderbuffer(n),t.deleteFramebuffer(this.framebuffer)};var St=function(t,e,n){this.func=t,this.mask=e,this.range=n};St.ReadOnly=!1,St.ReadWrite=!0,St.disabled=new St(519,St.ReadOnly,[0,1]);var Ct=function(t,e,n,r,i,o){this.test=t,this.ref=e,this.mask=n,this.fail=r,this.depthFail=i,this.pass=o};Ct.disabled=new Ct({func:519,mask:0},0,0,7680,7680,7680);var It=function(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n};It.disabled=new It(It.Replace=[1,0],t.Color.transparent,[!1,!1,!1,!1]),It.unblended=new It(It.Replace,t.Color.transparent,[!0,!0,!0,!0]),It.alphaBlended=new It([1,771],t.Color.transparent,[!0,!0,!0,!0]);var kt=function(t,e,n){this.enable=t,this.mode=e,this.frontFace=n};kt.disabled=new kt(!1,1029,2305),kt.backCCW=new kt(!0,1029,2305);var At=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new W(this),this.clearDepth=new G(this),this.clearStencil=new H(this),this.colorMask=new K(this),this.depthMask=new Q(this),this.stencilMask=new X(this),this.stencilFunc=new Y(this),this.stencilOp=new Z(this),this.stencilTest=new J(this),this.depthRange=new $(this),this.depthTest=new tt(this),this.depthFunc=new et(this),this.blend=new nt(this),this.blendFunc=new rt(this),this.blendColor=new it(this),this.blendEquation=new ot(this),this.cullFace=new at(this),this.cullFaceSide=new st(this),this.frontFace=new ut(this),this.program=new ct(this),this.activeTexture=new lt(this),this.viewport=new ht(this),this.bindFramebuffer=new pt(this),this.bindRenderbuffer=new ft(this),this.bindTexture=new dt(this),this.bindVertexBuffer=new mt(this),this.bindElementBuffer=new yt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new gt(this),this.pixelStoreUnpack=new vt(this),this.pixelStoreUnpackPremultiplyAlpha=new _t(this),this.pixelStoreUnpackFlipY=new bt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&t.getExtension("OES_texture_half_float_linear"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query")};At.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},At.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},At.prototype.createIndexBuffer=function(t,e){return new B(this,t,e)},At.prototype.createVertexBuffer=function(t,e,n){return new V(this,t,e,n)},At.prototype.createRenderbuffer=function(t,e,n){var r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),i},At.prototype.createFramebuffer=function(t,e){return new Tt(this,t,e)},At.prototype.clear=function(t){var e=t.color,n=t.depth,r=this.gl,i=0;e&&(i|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(i|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),r.clear(i)},At.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},At.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},At.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},At.prototype.setColorMode=function(e){t.deepEqual(e.blendFunction,It.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)},At.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ot=function(e){function n(n,r,i){var o=this;e.call(this),this.id=n,this.dispatcher=i,this.on("data",(function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))})),this.on("error",(function(){o._sourceErrored=!0})),this._source=N(n,r,i,this),this._tiles={},this._cache=new z(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._coveredTiles={},this._state=new t.SourceFeatureState}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},n.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},n.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},n.prototype.getSource=function(){return this._source},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},n.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},n.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,(function(){}))},n.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,(function(){}))},n.prototype.serialize=function(){return this._source.serialize()},n.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}},n.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(Pt)},n.prototype.getRenderableIds=function(e){var n=this,r=[];for(var i in this._tiles)this._isIdRenderable(+i,e)&&r.push(+i);return e?r.sort((function(e,r){var i=n._tiles[e].tileID,o=n._tiles[r].tileID,a=new t.Point(i.canonical.x,i.canonical.y)._rotate(n.transform.angle),s=new t.Point(o.canonical.x,o.canonical.y)._rotate(n.transform.angle);return i.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x})):r.sort(Pt)},n.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},n.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},n.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},n.prototype._reloadTile=function(t,e){var n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))},n.prototype._tileLoaded=function(e,n,r,i){if(i)return e.state="errored",void(404!==i.status?this._source.fire(new t.ErrorEvent(i,{tile:e})):this.update(this.transform));e.timeAdded=t.browser.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))},n.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),n=0;n<e.length;n++){var r=e[n];if(t.neighboringTiles&&t.neighboringTiles[r]){var i=this.getTileByID(r);o(t,i),o(i,t)}}function o(t,e){t.needsHillshadePrepare=!0;var n=e.tileID.canonical.x-t.tileID.canonical.x,r=e.tileID.canonical.y-t.tileID.canonical.y,i=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+i)?n+=i:1===Math.abs(n-i)&&(n-=i)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,r),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},n.prototype.getTile=function(t){return this.getTileByID(t.key)},n.prototype.getTileByID=function(t){return this._tiles[t]},n.prototype._retainLoadedChildren=function(t,e,n,r){for(var i in this._tiles){var o=this._tiles[i];if(!(r[i]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>n)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var u=a;u.overscaledZ>e;)if(t[(u=u.scaledTo(u.overscaledZ-1)).key]){r[a.key]=a;break}}}},n.prototype.findLoadedParent=function(t,e){for(var n=t.overscaledZ-1;n>=e;n--){var r=t.scaledTo(n);if(!r)return;var i=String(r.key),o=this._tiles[i];if(o&&o.hasData())return o;if(this._cache.has(r))return this._cache.get(r)}},n.prototype.updateCacheSize=function(t){var e=(Math.ceil(t.width/this._source.tileSize)+1)*(Math.ceil(t.height/this._source.tileSize)+1),n=Math.floor(5*e),r="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(r)},n.prototype.handleWrapJump=function(t){var e=(t-(void 0===this._prevLng?t:this._prevLng))/360,n=Math.round(e);if(this._prevLng=t,n){var r={};for(var i in this._tiles){var o=this._tiles[i];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+n),r[o.tileID.key]=o}for(var a in this._tiles=r,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var s in this._tiles){var u=this._tiles[s];this._setTileReloadTimer(s,u)}}},n.prototype.update=function(e){var r=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(i=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter((function(t){return r._source.hasTile(t)})))):i=[];var o=e.coveringZoomLevel(this._source),a=Math.max(o-n.maxOverzooming,this._source.minzoom),s=Math.max(o+n.maxUnderzooming,this._source.minzoom),u=this._updateRetainedTiles(i,o);if(Dt(this._source.type)){for(var c={},l={},h=0,p=Object.keys(u);h<p.length;h+=1){var f=p[h],d=u[f],m=this._tiles[f];if(m&&!(m.fadeEndTime&&m.fadeEndTime<=t.browser.now())){var y=this.findLoadedParent(d,a);y&&(this._addTile(y.tileID),c[y.tileID.key]=y.tileID),l[f]=d}}for(var g in this._retainLoadedChildren(l,o,s,u),c)u[g]||(this._coveredTiles[g]=!0,u[g]=c[g])}for(var v in u)this._tiles[v].clearFadeHold();for(var _=0,b=t.keysDifference(this._tiles,u);_<b.length;_+=1){var w=b[_],x=this._tiles[w];x.hasSymbolBuckets&&!x.holdingForFade()?x.setHoldDuration(this.map._fadeDuration):x.hasSymbolBuckets&&!x.symbolFadeFinished()||this._removeTile(w)}}},n.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},n.prototype._updateRetainedTiles=function(t,e){for(var r={},i={},o=Math.max(e-n.maxOverzooming,this._source.minzoom),a=Math.max(e+n.maxUnderzooming,this._source.minzoom),s={},u=0,c=t;u<c.length;u+=1){var l=c[u],h=this._addTile(l);r[l.key]=l,h.hasData()||e<this._source.maxzoom&&(s[l.key]=l)}this._retainLoadedChildren(s,e,a,r);for(var p=0,f=t;p<f.length;p+=1){var d=f[p],m=this._tiles[d.key];if(!m.hasData()){if(e+1>this._source.maxzoom){var y=d.children(this._source.maxzoom)[0],g=this.getTile(y);if(g&&g.hasData()){r[y.key]=y;continue}}else{var v=d.children(this._source.maxzoom);if(r[v[0].key]&&r[v[1].key]&&r[v[2].key]&&r[v[3].key])continue}for(var _=m.wasRequested(),b=d.overscaledZ-1;b>=o;--b){var w=d.scaledTo(b);if(i[w.key])break;if(i[w.key]=!0,!(m=this.getTile(w))&&_&&(m=this._addTile(w)),m&&(r[w.key]=w,_=m.wasRequested(),m.hasData()))break}}}return r},n.prototype._addTile=function(e){var n=this._tiles[e.key];if(n)return n;(n=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));var r=Boolean(n);return r||(n=new t.Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))),n?(n.uses++,this._tiles[e.key]=n,r||this._source.fire(new t.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null},n.prototype._setTileReloadTimer=function(t,e){var n=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var r=e.getExpiryTimeout();r&&(this._timers[t]=setTimeout((function(){n._reloadTile(t,"expired"),delete n._timers[t]}),r))},n.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},n.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},n.prototype.tilesIn=function(e,n,r){var i=this,o=[],a=this.transform;if(!a)return o;for(var s=r?a.getCameraQueryGeometry(e):e,u=e.map((function(t){return a.pointCoordinate(t)})),c=s.map((function(t){return a.pointCoordinate(t)})),l=this.getIds(),h=1/0,p=1/0,f=-1/0,d=-1/0,m=0,y=c;m<y.length;m+=1){var g=y[m];h=Math.min(h,g.x),p=Math.min(p,g.y),f=Math.max(f,g.x),d=Math.max(d,g.y)}for(var v=function(e){var r=i._tiles[l[e]];if(!r.holdingForFade()){var s=r.tileID,m=Math.pow(2,a.zoom-r.tileID.overscaledZ),y=n*r.queryPadding*t.EXTENT/r.tileSize/m,g=[s.getTilePoint(new t.MercatorCoordinate(h,p)),s.getTilePoint(new t.MercatorCoordinate(f,d))];if(g[0].x-y<t.EXTENT&&g[0].y-y<t.EXTENT&&g[1].x+y>=0&&g[1].y+y>=0){var v=u.map((function(t){return s.getTilePoint(t)})),_=c.map((function(t){return s.getTilePoint(t)}));o.push({tile:r,tileID:s,queryGeometry:v,cameraQueryGeometry:_,scale:m})}}},_=0;_<l.length;_++)v(_);return o},n.prototype.getVisibleCoordinates=function(t){for(var e=this,n=this.getRenderableIds(t).map((function(t){return e._tiles[t].tileID})),r=0,i=n;r<i.length;r+=1){var o=i[r];o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}return n},n.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Dt(this._source.type))for(var e in this._tiles){var n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=t.browser.now())return!0}return!1},n.prototype.setFeatureState=function(t,e,n){t=t||"_geojsonTileLayer",this._state.updateState(t,e,n)},n.prototype.removeFeatureState=function(t,e,n){t=t||"_geojsonTileLayer",this._state.removeFeatureState(t,e,n)},n.prototype.getFeatureState=function(t,e){return t=t||"_geojsonTileLayer",this._state.getState(t,e)},n.prototype.setDependencies=function(t,e,n){var r=this._tiles[t];r&&r.setDependencies(e,n)},n.prototype.reloadTilesForDependencies=function(t,e){for(var n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(n,"reloading");this._cache.filter((function(n){return!n.hasDependency(t,e)}))},n}(t.Evented);function Pt(t,e){return t%32-e%32||e-t}function Dt(t){return"raster"===t||"image"===t||"video"===t}function Mt(){return new t.window.Worker(si.workerUrl)}Ot.maxOverzooming=10,Ot.maxUnderzooming=3;var Rt=function(){this.active={}};Rt.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<Rt.workerCount;)this.workers.push(new Mt);return this.active[t]=!0,this.workers.slice()},Rt.prototype.release=function(t){delete this.active[t],0===Object.keys(this.active).length&&(this.workers.forEach((function(t){t.terminate()})),this.workers=null)};var Nt,Lt=Math.floor(t.browser.hardwareConcurrency/2);function Ft(e,n){var r={};for(var i in e)"ref"!==i&&(r[i]=e[i]);return t.refProperties.forEach((function(t){t in n&&(r[t]=n[t])})),r}function jt(t){t=t.slice();for(var e=Object.create(null),n=0;n<t.length;n++)e[t[n].id]=t[n];for(var r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=Ft(t[r],e[t[r].ref]));return t}Rt.workerCount=Math.max(Math.min(Lt,6),1);var zt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Bt(t,e,n){n.push({command:zt.addSource,args:[t,e[t]]})}function Ut(t,e,n){e.push({command:zt.removeSource,args:[t]}),n[t]=!0}function Vt(t,e,n,r){Ut(t,n,r),Bt(t,e,n)}function qt(e,n,r){var i;for(i in e[r])if(e[r].hasOwnProperty(i)&&"data"!==i&&!t.deepEqual(e[r][i],n[r][i]))return!1;for(i in n[r])if(n[r].hasOwnProperty(i)&&"data"!==i&&!t.deepEqual(e[r][i],n[r][i]))return!1;return!0}function Wt(e,n,r,i,o,a){var s;for(s in n=n||{},e=e||{})e.hasOwnProperty(s)&&(t.deepEqual(e[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}));for(s in n)n.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.deepEqual(e[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}))}function Gt(t){return t.id}function Ht(t,e){return t[e.id]=e,t}var Kt=function(t,e,n){var r=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(var o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};function Qt(e,n,r,i,o){var a=t.create();return n?(t.scale(a,a,[1/o,1/o,1]),r||t.rotateZ(a,a,i.angle)):t.multiply(a,i.labelPlaneMatrix,e),a}function Xt(e,n,r,i,o){if(n){var a=t.clone(e);return t.scale(a,a,[o,o,1]),r||t.rotateZ(a,a,-i.angle),a}return i.glCoordMatrix}function Yt(e,n){var r=[e.x,e.y,0,1];ae(r,r,n);var i=r[3];return{point:new t.Point(r[0]/i,r[1]/i),signedDistanceFromCamera:i}}function Zt(t,e){var n=t[0]/t[3],r=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&r>=-e[1]&&r<=e[1]}function Jt(e,n,r,i,o,a,s,u){var c=i?e.textSizeData:e.iconSizeData,l=t.evaluateSizeForZoom(c,r.transform.zoom),h=[256/r.width*2+1,256/r.height*2+1],p=i?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;p.clear();for(var f=e.lineVertexArray,d=i?e.text.placedSymbolArray:e.icon.placedSymbolArray,m=r.transform.width/r.transform.height,y=!1,g=0;g<d.length;g++){var v=d.get(g);if(v.hidden||v.writingMode===t.WritingMode.vertical&&!y)oe(v.numGlyphs,p);else{y=!1;var _=[v.anchorX,v.anchorY,0,1];if(t.transformMat4(_,_,n),Zt(_,h)){var b=.5+_[3]/r.transform.cameraToCenterDistance*.5,w=t.evaluateSizeForFeature(c,l,v),x=s?w*b:w/b,E=new t.Point(v.anchorX,v.anchorY),T=Yt(E,o).point,S={},C=ee(v,x,!1,u,n,o,a,e.glyphOffsetArray,f,p,T,E,S,m);y=C.useVertical,(C.notEnoughRoom||y||C.needsFlipping&&ee(v,x,!0,u,n,o,a,e.glyphOffsetArray,f,p,T,E,S,m).notEnoughRoom)&&oe(v.numGlyphs,p)}else oe(v.numGlyphs,p)}}i?e.text.dynamicLayoutVertexBuffer.updateData(p):e.icon.dynamicLayoutVertexBuffer.updateData(p)}function $t(t,e,n,r,i,o,a,s,u,c,l,h){var p=s.glyphStartIndex+s.numGlyphs,f=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,m=e.getoffsetX(s.glyphStartIndex),y=e.getoffsetX(p-1),g=re(t*m,n,r,i,o,a,s.segment,f,d,u,c,l,h);if(!g)return null;var v=re(t*y,n,r,i,o,a,s.segment,f,d,u,c,l,h);return v?{first:g,last:v}:null}function te(e,n,r,i){return e===t.WritingMode.horizontal&&Math.abs(r.y-n.y)>Math.abs(r.x-n.x)*i?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<r.y:n.x>r.x)?{needsFlipping:!0}:null}function ee(e,n,r,i,o,a,s,u,c,l,h,p,f,d){var m,y=n/24,g=e.lineOffsetX*y,v=e.lineOffsetY*y;if(e.numGlyphs>1){var _=e.glyphStartIndex+e.numGlyphs,b=e.lineStartIndex,w=e.lineStartIndex+e.lineLength,x=$t(y,u,g,v,r,h,p,e,c,a,f,!1);if(!x)return{notEnoughRoom:!0};var E=Yt(x.first.point,s).point,T=Yt(x.last.point,s).point;if(i&&!r){var S=te(e.writingMode,E,T,d);if(S)return S}m=[x.first];for(var C=e.glyphStartIndex+1;C<_-1;C++)m.push(re(y*u.getoffsetX(C),g,v,r,h,p,e.segment,b,w,c,a,f,!1));m.push(x.last)}else{if(i&&!r){var I=Yt(p,o).point,k=e.lineStartIndex+e.segment+1,A=new t.Point(c.getx(k),c.gety(k)),O=Yt(A,o),P=O.signedDistanceFromCamera>0?O.point:ne(p,A,I,1,o),D=te(e.writingMode,I,P,d);if(D)return D}var M=re(y*u.getoffsetX(e.glyphStartIndex),g,v,r,h,p,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,a,f,!1);if(!M)return{notEnoughRoom:!0};m=[M]}for(var R=0,N=m;R<N.length;R+=1){var L=N[R];t.addDynamicAttributes(l,L.point,L.angle)}return{}}function ne(t,e,n,r,i){var o=Yt(t.add(t.sub(e)._unit()),i).point,a=n.sub(o);return n.add(a._mult(r/a.mag()))}function re(e,n,r,i,o,a,s,u,c,l,h,p,f){var d=i?e-n:e+n,m=d>0?1:-1,y=0;i&&(m*=-1,y=Math.PI),m<0&&(y+=Math.PI);for(var g=m>0?u+s:u+s+1,v=g,_=o,b=o,w=0,x=0,E=Math.abs(d);w+x<=E;){if((g+=m)<u||g>=c)return null;if(b=_,void 0===(_=p[g])){var T=new t.Point(l.getx(g),l.gety(g)),S=Yt(T,h);if(S.signedDistanceFromCamera>0)_=p[g]=S.point;else{var C=g-m;_=ne(0===w?a:new t.Point(l.getx(C),l.gety(C)),T,b,E-w+1,h)}}w+=x,x=b.dist(_)}var I=(E-w)/x,k=_.sub(b),A=k.mult(I)._add(b);return A._add(k._unit()._perp()._mult(r*m)),{point:A,angle:y+Math.atan2(_.y-b.y,_.x-b.x),tileDistance:f?{prevTileDistance:g-m===v?0:l.gettileUnitDistanceFromAnchor(g-m),lastSegmentViewportDistance:E-w}:null}}Kt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Kt.prototype.insert=function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},Kt.prototype.insertCircle=function(t,e,n,r){this._forEachCell(e-r,n-r,e+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(r)},Kt.prototype._insertBoxCell=function(t,e,n,r,i,o){this.boxCells[i].push(o)},Kt.prototype._insertCircleCell=function(t,e,n,r,i,o){this.circleCells[i].push(o)},Kt.prototype._query=function(t,e,n,r,i,o){if(n<0||t>this.width||r<0||e>this.height)return!i&&[];var a=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var u=0;u<this.circleKeys.length;u++){var c=this.circles[3*u],l=this.circles[3*u+1],h=this.circles[3*u+2];a.push({key:this.circleKeys[u],x1:c-h,y1:l-h,x2:c+h,y2:l+h})}return o?a.filter(o):a}var p={hitTest:i,seenUids:{box:{},circle:{}}};return this._forEachCell(t,e,n,r,this._queryCell,a,p,o),i?a.length>0:a},Kt.prototype._queryCircle=function(t,e,n,r,i){var o=t-n,a=t+n,s=e-n,u=e+n;if(a<0||o>this.width||u<0||s>this.height)return!r&&[];var c=[],l={hitTest:r,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,a,u,this._queryCellCircle,c,l,i),r?c.length>0:c},Kt.prototype.query=function(t,e,n,r,i){return this._query(t,e,n,r,!1,i)},Kt.prototype.hitTest=function(t,e,n,r,i){return this._query(t,e,n,r,!0,i)},Kt.prototype.hitTestCircle=function(t,e,n,r){return this._queryCircle(t,e,n,!0,r)},Kt.prototype._queryCell=function(t,e,n,r,i,o,a,s){var u=a.seenUids,c=this.boxCells[i];if(null!==c)for(var l=this.bboxes,h=0,p=c;h<p.length;h+=1){var f=p[h];if(!u.box[f]){u.box[f]=!0;var d=4*f;if(t<=l[d+2]&&e<=l[d+3]&&n>=l[d+0]&&r>=l[d+1]&&(!s||s(this.boxKeys[f]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[f],x1:l[d],y1:l[d+1],x2:l[d+2],y2:l[d+3]})}}}var m=this.circleCells[i];if(null!==m)for(var y=this.circles,g=0,v=m;g<v.length;g+=1){var _=v[g];if(!u.circle[_]){u.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(y[b],y[b+1],y[b+2],t,e,n,r)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var w=y[b],x=y[b+1],E=y[b+2];o.push({key:this.circleKeys[_],x1:w-E,y1:x-E,x2:w+E,y2:x+E})}}}},Kt.prototype._queryCellCircle=function(t,e,n,r,i,o,a,s){var u=a.circle,c=a.seenUids,l=this.boxCells[i];if(null!==l)for(var h=this.bboxes,p=0,f=l;p<f.length;p+=1){var d=f[p];if(!c.box[d]){c.box[d]=!0;var m=4*d;if(this._circleAndRectCollide(u.x,u.y,u.radius,h[m+0],h[m+1],h[m+2],h[m+3])&&(!s||s(this.boxKeys[d])))return o.push(!0),!0}}var y=this.circleCells[i];if(null!==y)for(var g=this.circles,v=0,_=y;v<_.length;v+=1){var b=_[v];if(!c.circle[b]){c.circle[b]=!0;var w=3*b;if(this._circlesCollide(g[w],g[w+1],g[w+2],u.x,u.y,u.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}},Kt.prototype._forEachCell=function(t,e,n,r,i,o,a,s){for(var u=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),l=this._convertToXCellCoord(n),h=this._convertToYCellCoord(r),p=u;p<=l;p++)for(var f=c;f<=h;f++){var d=this.xCellCount*f+p;if(i.call(this,t,e,n,r,d,o,a,s))return}},Kt.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},Kt.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},Kt.prototype._circlesCollide=function(t,e,n,r,i,o){var a=r-t,s=i-e,u=n+o;return u*u>a*a+s*s},Kt.prototype._circleAndRectCollide=function(t,e,n,r,i,o,a){var s=(o-r)/2,u=Math.abs(t-(r+s));if(u>s+n)return!1;var c=(a-i)/2,l=Math.abs(e-(i+c));if(l>c+n)return!1;if(u<=s||l<=c)return!0;var h=u-s,p=l-c;return h*h+p*p<=n*n};var ie=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function oe(t,e){for(var n=0;n<t;n++){var r=e.length;e.resize(r+4),e.float32.set(ie,3*r)}}function ae(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t[3]=n[3]*r+n[7]*i+n[15],t}var se=function(t,e,n){void 0===e&&(e=new Kt(t.width+200,t.height+200,25)),void 0===n&&(n=new Kt(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200};function ue(t,e,n){t[e+4]=n?1:0}function ce(e,n,r){return n*(t.EXTENT/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}se.prototype.placeCollisionBox=function(t,e,n,r,i){var o=this.projectAndGetPerspectiveRatio(r,t.anchorPointX,t.anchorPointY),a=n*o.perspectiveRatio,s=t.x1*a+o.point.x,u=t.y1*a+o.point.y,c=t.x2*a+o.point.x,l=t.y2*a+o.point.y;return!this.isInsideGrid(s,u,c,l)||!e&&this.grid.hitTest(s,u,c,l,i)?{box:[],offscreen:!1}:{box:[s,u,c,l],offscreen:this.isOffscreen(s,u,c,l)}},se.prototype.approximateTileDistance=function(t,e,n,r,i){var o=i?1:r/this.pitchfactor,a=t.lastSegmentViewportDistance*n;return t.prevTileDistance+a+(o-1)*a*Math.abs(Math.sin(e))},se.prototype.placeCollisionCircles=function(e,n,r,i,o,a,s,u,c,l,h,p,f){var d=[],m=this.projectAnchor(c,o.anchorX,o.anchorY),y=u/24,g=o.lineOffsetX*u,v=o.lineOffsetY*u,_=new t.Point(o.anchorX,o.anchorY),b=$t(y,s,g,v,!1,Yt(_,l).point,_,o,a,l,{},!0),w=!1,x=!1,E=!0,T=m.perspectiveRatio*i,S=1/(i*r),C=0,I=0;b&&(C=this.approximateTileDistance(b.first.tileDistance,b.first.angle,S,m.cameraDistance,p),I=this.approximateTileDistance(b.last.tileDistance,b.last.angle,S,m.cameraDistance,p));for(var k=0;k<e.length;k+=5){var A=e[k],O=e[k+1],P=e[k+2],D=e[k+3];if(!b||D<-C||D>I)ue(e,k,!1);else{var M=this.projectPoint(c,A,O),R=P*T;if(d.length>0){var N=M.x-d[d.length-4],L=M.y-d[d.length-3];if(R*R*2>N*N+L*L&&k+8<e.length){var F=e[k+8];if(F>-C&&F<I){ue(e,k,!1);continue}}}var j=k/5;d.push(M.x,M.y,R,j),ue(e,k,!0);var z=M.x-R,B=M.y-R,U=M.x+R,V=M.y+R;if(E=E&&this.isOffscreen(z,B,U,V),x=x||this.isInsideGrid(z,B,U,V),!n&&this.grid.hitTestCircle(M.x,M.y,R,f)){if(!h)return{circles:[],offscreen:!1};w=!0}}}return{circles:w||!x?[]:d,offscreen:E}},se.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var n=[],r=1/0,i=1/0,o=-1/0,a=-1/0,s=0,u=e;s<u.length;s+=1){var c=u[s],l=new t.Point(c.x+100,c.y+100);r=Math.min(r,l.x),i=Math.min(i,l.y),o=Math.max(o,l.x),a=Math.max(a,l.y),n.push(l)}for(var h={},p={},f=0,d=this.grid.query(r,i,o,a).concat(this.ignoredGrid.query(r,i,o,a));f<d.length;f+=1){var m=d[f],y=m.key;if(void 0===h[y.bucketInstanceId]&&(h[y.bucketInstanceId]={}),!h[y.bucketInstanceId][y.featureIndex]){var g=[new t.Point(m.x1,m.y1),new t.Point(m.x2,m.y1),new t.Point(m.x2,m.y2),new t.Point(m.x1,m.y2)];t.polygonIntersectsPolygon(n,g)&&(h[y.bucketInstanceId][y.featureIndex]=!0,void 0===p[y.bucketInstanceId]&&(p[y.bucketInstanceId]=[]),p[y.bucketInstanceId].push(y.featureIndex))}}return p},se.prototype.insertCollisionBox=function(t,e,n,r,i){var o={bucketInstanceId:n,featureIndex:r,collisionGroupID:i};(e?this.ignoredGrid:this.grid).insert(o,t[0],t[1],t[2],t[3])},se.prototype.insertCollisionCircles=function(t,e,n,r,i){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:n,featureIndex:r,collisionGroupID:i},s=0;s<t.length;s+=4)o.insertCircle(a,t[s],t[s+1],t[s+2])},se.prototype.projectAnchor=function(t,e,n){var r=[e,n,0,1];return ae(r,r,t),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/r[3]*.5,cameraDistance:r[3]}},se.prototype.projectPoint=function(e,n,r){var i=[n,r,0,1];return ae(i,i,e),new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100)},se.prototype.projectAndGetPerspectiveRatio=function(e,n,r){var i=[n,r,0,1];return ae(i,i,e),{point:new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5}},se.prototype.isOffscreen=function(t,e,n,r){return n<100||t>=this.screenRightBoundary||r<100||e>this.screenBottomBoundary},se.prototype.isInsideGrid=function(t,e,n,r){return n>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary};var le=function(t,e,n,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&n?1:0,this.placed=n};le.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var he=function(t,e,n,r,i){this.text=new le(t?t.text:null,e,n,i),this.icon=new le(t?t.icon:null,e,r,i)};he.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var pe=function(t,e,n){this.text=t,this.icon=e,this.skipFade=n},fe=function(t,e,n,r,i){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=i},de=function(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}};function me(e,n,r,i,o){var a=t.getAnchorAlignment(e),s=-(a.horizontalAlign-.5)*n,u=-(a.verticalAlign-.5)*r,c=t.evaluateVariableOffset(e,i);return new t.Point(s+c[0]*o,u+c[1]*o)}function ye(e,n,r,i,o,a){var s=e.x1,u=e.x2,c=e.y1,l=e.y2,h=e.anchorPointX,p=e.anchorPointY,f=new t.Point(n,r);return i&&f._rotate(o?a:-a),{x1:s+f.x,y1:c+f.y,x2:u+f.x,y2:l+f.y,anchorPointX:h,anchorPointY:p}}de.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]};var ge=function(t,e,n,r){this.transform=t.clone(),this.collisionIndex=new se(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new de(n),this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}};function ve(t,e,n,r,i){t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0)}ge.prototype.placeLayerTile=function(e,n,r,i){var o=n.getBucket(e),a=n.latestFeatureIndex;if(o&&a&&e.id===o.layerIds[0]){var s=n.collisionBoxArray,u=o.layers[0].layout,c=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),l=n.tileSize/t.EXTENT,h=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),p=Qt(h,"map"===u.get("text-pitch-alignment"),"map"===u.get("text-rotation-alignment"),this.transform,ce(n,1,this.transform.zoom)),f=Qt(h,"map"===u.get("icon-pitch-alignment"),"map"===u.get("icon-rotation-alignment"),this.transform,ce(n,1,this.transform.zoom));this.retainedQueryData[o.bucketInstanceId]=new fe(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,n.tileID),this.placeLayerBucket(o,h,p,f,c,l,r,n.holdingForFade(),i,s)}},ge.prototype.attemptAnchorPlacement=function(t,e,n,r,i,o,a,s,u,c,l,h,p,f,d){var m,y=[h.textOffset0,h.textOffset1],g=me(t,n,r,y,i),v=this.collisionIndex.placeCollisionBox(ye(e,g.x,g.y,o,a,this.transform.angle),l,s,u,c.predicate);if(!d||0!==this.collisionIndex.placeCollisionBox(ye(d,g.x,g.y,o,a,this.transform.angle),l,s,u,c.predicate).box.length)return v.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(m=this.prevPlacement.variableOffsets[h.crossTileID].anchor),this.variableOffsets[h.crossTileID]={textOffset:y,width:n,height:r,anchor:t,textBoxScale:i,prevAnchor:m},this.markUsedJustification(p,t,h,f),p.allowVerticalPlacement&&(this.markUsedOrientation(p,f,h),this.placedOrientations[h.crossTileID]=f),{shift:g,placedGlyphBoxes:v}):void 0},ge.prototype.placeLayerBucket=function(e,n,r,i,o,a,s,u,c,l){var h=this,p=e.layers[0].layout,f=t.evaluateSizeForZoom(e.textSizeData,this.transform.zoom),d=p.get("text-optional"),m=p.get("icon-optional"),y=p.get("text-allow-overlap"),g=p.get("icon-allow-overlap"),v=y&&(g||!e.hasIconData()||m),_=g&&(y||!e.hasTextData()||d),b=this.collisionGroups.get(e.sourceID),w="map"===p.get("text-rotation-alignment"),x="map"===p.get("text-pitch-alignment"),E="none"!==p.get("icon-text-fit"),T="viewport-y"===p.get("symbol-z-order");!e.collisionArrays&&l&&e.deserializeCollisionBoxes(l);var S=function(i,l){if(!c[i.crossTileID])if(u)h.placements[i.crossTileID]=new pe(!1,!1,!1);else{var T,S=!1,C=!1,I=!0,k=null,A={box:null,offscreen:null},O={box:null,offscreen:null},P=null,D=null,M=0,R=0,N=0;l.textFeatureIndex&&(M=l.textFeatureIndex),l.verticalTextFeatureIndex&&(R=l.verticalTextFeatureIndex);var L=l.textBox;if(L){var F=function(n){var r=t.WritingMode.horizontal;if(e.allowVerticalPlacement&&!n&&h.prevPlacement){var o=h.prevPlacement.placedOrientations[i.crossTileID];o&&(h.placedOrientations[i.crossTileID]=o,r=o,h.markUsedOrientation(e,r,i))}return r},j=function(n,r){if(e.allowVerticalPlacement&&i.numVerticalGlyphVertices>0&&l.verticalTextBox)for(var o=0,a=e.writingModes;o<a.length&&(a[o]===t.WritingMode.vertical?(A=r(),O=A):A=n(),!(A&&A.box&&A.box.length));o+=1);else A=n()};if(p.get("text-variable-anchor")){var z=p.get("text-variable-anchor");if(h.prevPlacement&&h.prevPlacement.variableOffsets[i.crossTileID]){var B=h.prevPlacement.variableOffsets[i.crossTileID];z.indexOf(B.anchor)>0&&(z=z.filter((function(t){return t!==B.anchor}))).unshift(B.anchor)}var U=function(t,r,o){for(var s=t.x2-t.x1,u=t.y2-t.y1,c=i.textBoxScale,l=E&&!g?r:null,p={box:[],offscreen:!1},f=y?2*z.length:z.length,d=0;d<f;++d){var m=z[d%z.length],v=d>=z.length,_=h.attemptAnchorPlacement(m,t,s,u,c,w,x,a,n,b,v,i,e,o,l);if(_&&(p=_.placedGlyphBoxes)&&p.box&&p.box.length){S=!0,k=_.shift;break}}return p};j((function(){return U(L,l.iconBox,t.WritingMode.horizontal)}),(function(){var n=l.verticalTextBox,r=A&&A.box&&A.box.length;return e.allowVerticalPlacement&&!r&&i.numVerticalGlyphVertices>0&&n?U(n,l.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),A&&(S=A.box,I=A.offscreen);var V=F(A&&A.box);if(!S&&h.prevPlacement){var q=h.prevPlacement.variableOffsets[i.crossTileID];q&&(h.variableOffsets[i.crossTileID]=q,h.markUsedJustification(e,q.anchor,i,V))}}else{var W=function(t,r){var o=h.collisionIndex.placeCollisionBox(t,p.get("text-allow-overlap"),a,n,b.predicate);return o&&o.box&&o.box.length&&(h.markUsedOrientation(e,r,i),h.placedOrientations[i.crossTileID]=r),o};j((function(){return W(L,t.WritingMode.horizontal)}),(function(){var n=l.verticalTextBox;return e.allowVerticalPlacement&&i.numVerticalGlyphVertices>0&&n?W(n,t.WritingMode.vertical):{box:null,offscreen:null}})),F(A&&A.box&&A.box.length)}}S=(T=A)&&T.box&&T.box.length>0,I=T&&T.offscreen;var G=l.textCircles;if(G){var H=e.text.placedSymbolArray.get(i.centerJustifiedTextSymbolIndex),K=t.evaluateSizeForFeature(e.textSizeData,f,H);P=h.collisionIndex.placeCollisionCircles(G,p.get("text-allow-overlap"),o,a,H,e.lineVertexArray,e.glyphOffsetArray,K,n,r,s,x,b.predicate),S=p.get("text-allow-overlap")||P.circles.length>0,I=I&&P.offscreen}if(l.iconFeatureIndex&&(N=l.iconFeatureIndex),l.iconBox){var Q=function(t){var e=E&&k?ye(t,k.x,k.y,w,x,h.transform.angle):t;return h.collisionIndex.placeCollisionBox(e,p.get("icon-allow-overlap"),a,n,b.predicate)};C=O&&O.box&&O.box.length&&l.verticalIconBox?(D=Q(l.verticalIconBox)).box.length>0:(D=Q(l.iconBox)).box.length>0,I=I&&D.offscreen}var X=d||0===i.numHorizontalGlyphVertices&&0===i.numVerticalGlyphVertices,Y=m||0===i.numIconVertices;X||Y?Y?X||(C=C&&S):S=C&&S:C=S=C&&S,S&&T&&T.box&&(O&&O.box&&R?h.collisionIndex.insertCollisionBox(T.box,p.get("text-ignore-placement"),e.bucketInstanceId,R,b.ID):h.collisionIndex.insertCollisionBox(T.box,p.get("text-ignore-placement"),e.bucketInstanceId,M,b.ID)),C&&D&&h.collisionIndex.insertCollisionBox(D.box,p.get("icon-ignore-placement"),e.bucketInstanceId,N,b.ID),S&&P&&h.collisionIndex.insertCollisionCircles(P.circles,p.get("text-ignore-placement"),e.bucketInstanceId,M,b.ID),h.placements[i.crossTileID]=new pe(S||v,C||_,I||e.justReloaded),c[i.crossTileID]=!0}};if(T)for(var C=e.getSortedSymbolIndexes(this.transform.angle),I=C.length-1;I>=0;--I){var k=C[I];S(e.symbolInstances.get(k),e.collisionArrays[k])}else for(var A=0;A<e.symbolInstances.length;++A)S(e.symbolInstances.get(A),e.collisionArrays[A]);e.justReloaded=!1},ge.prototype.markUsedJustification=function(e,n,r,i){var o,a={left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex};o=i===t.WritingMode.vertical?r.verticalPlacedTextSymbolIndex:a[t.getAnchorJustification(n)];for(var s=0,u=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];s<u.length;s+=1){var c=u[s];c>=0&&(e.text.placedSymbolArray.get(c).crossTileID=o>=0&&c!==o?0:r.crossTileID)}},ge.prototype.markUsedOrientation=function(e,n,r){for(var i=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,o=n===t.WritingMode.vertical?n:0,a=0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];a<s.length;a+=1){var u=s[a];e.text.placedSymbolArray.get(u).placedOrientation=i}r.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=o)},ge.prototype.commit=function(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;var e=this.prevPlacement,n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;var r=e?e.symbolFadeChange(t):1,i=e?e.opacities:{},o=e?e.variableOffsets:{},a=e?e.placedOrientations:{};for(var s in this.placements){var u=this.placements[s],c=i[s];c?(this.opacities[s]=new he(c,r,u.text,u.icon),n=n||u.text!==c.text.placed||u.icon!==c.icon.placed):(this.opacities[s]=new he(null,r,u.text,u.icon,u.skipFade),n=n||u.text||u.icon)}for(var l in i){var h=i[l];if(!this.opacities[l]){var p=new he(h,r,!1,!1);p.isHidden()||(this.opacities[l]=p,n=n||h.text.placed||h.icon.placed)}}for(var f in o)this.variableOffsets[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.variableOffsets[f]=o[f]);for(var d in a)this.placedOrientations[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.placedOrientations[d]=a[d]);n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)},ge.prototype.updateLayerOpacities=function(t,e){for(var n={},r=0,i=e;r<i.length;r+=1){var o=i[r],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,n,o.collisionBoxArray)}},ge.prototype.updateBucketOpacities=function(e,n,r){var i=this;e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear(),e.hasIconCollisionCircleData()&&e.iconCollisionCircle.collisionVertexArray.clear(),e.hasTextCollisionCircleData()&&e.textCollisionCircle.collisionVertexArray.clear();var o=e.layers[0].layout,a=new he(null,0,!1,!1,!0),s=o.get("text-allow-overlap"),u=o.get("icon-allow-overlap"),c=o.get("text-variable-anchor"),l="map"===o.get("text-rotation-alignment"),h="map"===o.get("text-pitch-alignment"),p="none"!==o.get("icon-text-fit"),f=new he(null,0,s&&(u||!e.hasIconData()||o.get("icon-optional")),u&&(s||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasIconCollisionCircleData()||e.hasTextCollisionBoxData()||e.hasTextCollisionCircleData())&&e.deserializeCollisionBoxes(r);for(var d=function(t,e,n){for(var r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(n)},m=function(r){var o=e.symbolInstances.get(r),s=o.numHorizontalGlyphVertices,u=o.numVerticalGlyphVertices,m=o.crossTileID,y=n[m],g=i.opacities[m];y?g=a:g||(g=f,i.opacities[m]=g),n[m]=!0;var v=s>0||u>0,_=o.numIconVertices>0,b=i.placedOrientations[o.crossTileID],w=b===t.WritingMode.vertical,x=b===t.WritingMode.horizontal||b===t.WritingMode.horizontalOnly;if(v){var E=Ce(g.text),T=w?Ie:E;d(e.text,s,T);var S=x?Ie:E;d(e.text,u,S);var C=g.text.isHidden();[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(t){t>=0&&(e.text.placedSymbolArray.get(t).hidden=C||w?1:0)})),o.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).hidden=C||x?1:0);var I=i.variableOffsets[o.crossTileID];I&&i.markUsedJustification(e,I.anchor,o,b);var k=i.placedOrientations[o.crossTileID];k&&(i.markUsedJustification(e,"left",o,k),i.markUsedOrientation(e,k,o))}if(_){var A=Ce(g.icon),O=!(p&&o.verticalPlacedIconSymbolIndex&&w);if(o.placedIconSymbolIndex>=0){var P=O?A:Ie;d(e.icon,o.numIconVertices,P),e.icon.placedSymbolArray.get(o.placedIconSymbolIndex).hidden=g.icon.isHidden()}if(o.verticalPlacedIconSymbolIndex>=0){var D=O?Ie:A;d(e.icon,o.numVerticalIconVertices,D),e.icon.placedSymbolArray.get(o.verticalPlacedIconSymbolIndex).hidden=g.icon.isHidden()}}if(e.hasIconCollisionBoxData()||e.hasIconCollisionCircleData()||e.hasTextCollisionBoxData()||e.hasTextCollisionCircleData()){var M=e.collisionArrays[r];if(M){var R=new t.Point(0,0);if(M.textBox||M.verticalTextBox){var N=!0;if(c){var L=i.variableOffsets[m];L?(R=me(L.anchor,L.width,L.height,L.textOffset,L.textBoxScale),l&&R._rotate(h?i.transform.angle:-i.transform.angle)):N=!1}M.textBox&&ve(e.textCollisionBox.collisionVertexArray,g.text.placed,!N||w,R.x,R.y),M.verticalTextBox&&ve(e.textCollisionBox.collisionVertexArray,g.text.placed,!N||x,R.x,R.y)}var F=Boolean(!x&&M.verticalIconBox);M.iconBox&&ve(e.iconCollisionBox.collisionVertexArray,g.icon.placed,F,p?R.x:0,p?R.y:0),M.verticalIconBox&&ve(e.iconCollisionBox.collisionVertexArray,g.icon.placed,!F,p?R.x:0,p?R.y:0);var j=M.textCircles;if(j&&e.hasTextCollisionCircleData())for(var z=0;z<j.length;z+=5){var B=y||0===j[z+4];ve(e.textCollisionCircle.collisionVertexArray,g.text.placed,B)}}}},y=0;y<e.symbolInstances.length;y++)m(y);e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.hasIconCollisionCircleData()&&e.iconCollisionCircle.collisionVertexBuffer&&e.iconCollisionCircle.collisionVertexBuffer.updateData(e.iconCollisionCircle.collisionVertexArray),e.hasTextCollisionCircleData()&&e.textCollisionCircle.collisionVertexBuffer&&e.textCollisionCircle.collisionVertexBuffer.updateData(e.textCollisionCircle.collisionVertexArray)},ge.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ge.prototype.zoomAdjustment=function(t){return Math.max(0,(this.transform.zoom-t)/1.5)},ge.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},ge.prototype.stillRecent=function(t,e){var n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t},ge.prototype.setStale=function(){this.stale=!0};var _e=Math.pow(2,25),be=Math.pow(2,24),we=Math.pow(2,17),xe=Math.pow(2,16),Ee=Math.pow(2,9),Te=Math.pow(2,8),Se=Math.pow(2,1);function Ce(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*_e+e*be+n*we+e*xe+n*Ee+e*Te+n*Se+e}var Ie=0,ke=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};ke.prototype.continuePlacement=function(t,e,n,r,i){for(;this._currentTileIndex<t.length;){var o=t[this._currentTileIndex];if(e.placeLayerTile(r,o,n,this._seenCrossTileIDs),this._currentTileIndex++,i())return!0}};var Ae=function(t,e,n,r,i,o,a){this.placement=new ge(t,i,o,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1};Ae.prototype.isDone=function(){return this._done},Ae.prototype.continuePlacement=function(e,n,r){for(var i=this,o=t.browser.now(),a=function(){var e=t.browser.now()-o;return!i._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var s=n[e[this._currentPlacementIndex]],u=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=u)&&(!s.maxzoom||s.maxzoom>u)){if(this._inProgressLayer||(this._inProgressLayer=new ke),this._inProgressLayer.continuePlacement(r[s.source],this.placement,this._showCollisionBoxes,s,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ae.prototype.commit=function(t){return this.placement.commit(t),this.placement};var Oe=512/t.EXTENT/2,Pe=function(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var r=0;r<e.length;r++){var i=e.get(r),o=i.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:i.crossTileID,coord:this.getScaledCoordinates(i,t)})}};Pe.prototype.getScaledCoordinates=function(e,n){var r=n.canonical.z-this.tileID.canonical.z,i=Oe/Math.pow(2,r);return{x:Math.floor((n.canonical.x*t.EXTENT+e.anchorX)*i),y:Math.floor((n.canonical.y*t.EXTENT+e.anchorY)*i)}},Pe.prototype.findMatches=function(t,e,n){for(var r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),i=0;i<t.length;i++){var o=t.get(i);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var s=this.getScaledCoordinates(o,e),u=0,c=a;u<c.length;u+=1){var l=c[u];if(Math.abs(l.coord.x-s.x)<=r&&Math.abs(l.coord.y-s.y)<=r&&!n[l.crossTileID]){n[l.crossTileID]=!0,o.crossTileID=l.crossTileID;break}}}}};var De=function(){this.maxCrossTileID=0};De.prototype.generate=function(){return++this.maxCrossTileID};var Me=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Me.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var n in this.indexes){var r=this.indexes[n],i={};for(var o in r){var a=r[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),i[a.tileID.key]=a}this.indexes[n]=i}this.lng=t},Me.prototype.addBucket=function(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var i=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>t.overscaledZ)for(var s in a){var u=a[s];u.tileID.isChildOf(t)&&u.findMatches(e.symbolInstances,t,i)}else{var c=a[t.scaledTo(Number(o)).key];c&&c.findMatches(e.symbolInstances,t,i)}}for(var l=0;l<e.symbolInstances.length;l++){var h=e.symbolInstances.get(l);h.crossTileID||(h.crossTileID=n.generate(),i[h.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Pe(t,e.symbolInstances,e.bucketInstanceId),!0},Me.prototype.removeBucketCrossTileIDs=function(t,e){for(var n in e.indexedSymbolInstances)for(var r=0,i=e.indexedSymbolInstances[n];r<i.length;r+=1){var o=i[r];delete this.usedCrossTileIDs[t][o.crossTileID]}},Me.prototype.removeStaleBuckets=function(t){var e=!1;for(var n in this.indexes){var r=this.indexes[n];for(var i in r)t[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],e=!0)}return e};var Re=function(){this.layerIndexes={},this.crossTileIDs=new De,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Re.prototype.addLayer=function(t,e,n){var r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new Me);var i=!1,o={};r.handleWrapJump(n);for(var a=0,s=e;a<s.length;a+=1){var u=s[a],c=u.getBucket(t);c&&t.id===c.layerIds[0]&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(u.tileID,c,this.crossTileIDs)&&(i=!0),o[c.bucketInstanceId]=!0)}return r.removeStaleBuckets(o)&&(i=!0),i},Re.prototype.pruneUnusedLayers=function(t){var e={};for(var n in t.forEach((function(t){e[t]=!0})),this.layerIndexes)e[n]||delete this.layerIndexes[n]};var Ne=function(e,n){return t.emitValidationErrors(e,n&&n.filter((function(t){return"source.canvas"!==t.identifier})))},Le=t.pick(zt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Fe=t.pick(zt,["setCenter","setZoom","setBearing","setPitch"]),je=function(e){function n(r,i){var o=this;void 0===i&&(i={}),e.call(this),this.map=r,this.dispatcher=new T((Nt||(Nt=new Rt),Nt),this),this.imageManager=new p,this.imageManager.setEventedParent(this),this.glyphManager=new _(r._requestManager,i.localIdeographFontFamily),this.lineAtlas=new E(256,512),this.crossTileSymbolIndex=new Re,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());var a=this;this._rtlTextPluginCallback=n.registerForPluginStateChange((function(e){var n={pluginStatus:e.pluginStatus,pluginURL:e.pluginURL};a.dispatcher.broadcast("syncRTLPluginState",n,(function(e,n){if(t.triggerPluginCompletionEvent(e),n&&n.every((function(t){return t})))for(var r in a.sourceCaches)a.sourceCaches[r].reload()}))})),this.on("data",(function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var n=e.getSource();if(n&&n.vectorLayerIds)for(var r in o._layers){var i=o._layers[r];i.source===n.id&&o._validateLayer(i)}}}}))}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.loadURL=function(e,n){var r=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var i="boolean"==typeof n.validate?n.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,n.accessToken);var o=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(o,(function(e,n){r._request=null,e?r.fire(new t.ErrorEvent(e)):n&&r._load(n,i)}))},n.prototype.loadJSON=function(e,n){var r=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.browser.frame((function(){r._request=null,r._load(e,!1!==n.validate)}))},n.prototype._load=function(e,n){var r=this;if(!n||!Ne(this,t.validateStyle(e))){for(var i in this._loaded=!0,this.stylesheet=e,e.sources)this.addSource(i,e.sources[i],{validate:!1});e.sprite?this._spriteRequest=function(e,n,r){var i,o,a,s=t.browser.devicePixelRatio>1?"@2x":"",u=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,s,".json"),t.ResourceType.SpriteJSON),(function(t,e){u=null,a||(a=t,i=e,l())})),c=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,s,".png"),t.ResourceType.SpriteImage),(function(t,e){c=null,a||(a=t,o=e,l())}));function l(){if(a)r(a);else if(i&&o){var e=t.browser.getImageData(o),n={};for(var s in i){var u=i[s],c=u.width,l=u.height,h=u.x,p=u.y,f=u.sdf,d=u.pixelRatio,m=u.stretchX,y=u.stretchY,g=u.content,v=new t.RGBAImage({width:c,height:l});t.RGBAImage.copy(e,v,{x:h,y:p},{x:0,y:0},{width:c,height:l}),n[s]={data:v,pixelRatio:d,sdf:f,stretchX:m,stretchY:y,content:g}}r(null,n)}}return{cancel:function(){u&&(u.cancel(),u=null),c&&(c.cancel(),c=null)}}}(e.sprite,this.map._requestManager,(function(e,n){if(r._spriteRequest=null,e)r.fire(new t.ErrorEvent(e));else if(n)for(var i in n)r.imageManager.addImage(i,n[i]);r.imageManager.setLoaded(!0),r.dispatcher.broadcast("setImages",r.imageManager.listImages()),r.fire(new t.Event("data",{dataType:"style"}))})):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var o=jt(this.stylesheet.layers);this._order=o.map((function(t){return t.id})),this._layers={};for(var a=0,s=o;a<s.length;a+=1){var u=s[a];(u=t.createStyleLayer(u)).setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=u}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new x(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},n.prototype._validateLayer=function(e){var n=this.sourceCaches[e.source];if(n){var r=e.sourceLayer;if(r){var i=n.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(r))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+r+'" does not exist on source "'+i.id+'" as specified by style layer "'+e.id+'"')))}}},n.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},n.prototype._serializeLayers=function(t){for(var e=[],n=0,r=t;n<r.length;n+=1){var i=r[n],o=this._layers[i];"custom"!==o.type&&e.push(o.serialize())}return e},n.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},n.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},n.prototype.update=function(e){if(this._loaded){var n=this._changed;if(this._changed){var r=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);for(var o in(r.length||i.length)&&this._updateWorkerLayers(r,i),this._updatedSources){var a=this._updatedSources[o];"reload"===a?this._reloadSource(o):"clear"===a&&this._clearSource(o)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}for(var u in this.sourceCaches)this.sourceCaches[u].used=!1;for(var c=0,l=this._order;c<l.length;c+=1){var h=l[c],p=this._layers[h];p.recalculate(e,this.imageManager.listImages()),!p.isHidden(e.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}this.light.recalculate(e),this.z=e.zoom,n&&this.fire(new t.Event("data",{dataType:"style"}))}},n.prototype._updateTilesForChangedImages=function(){var t=Object.keys(this._changedImages);if(t.length){for(var e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}},n.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},n.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},n.prototype.setState=function(e){var n=this;if(this._checkLoaded(),Ne(this,t.validateStyle(e)))return!1;(e=t.clone$1(e)).layers=jt(e.layers);var r=function(e,n){if(!e)return[{command:zt.setStyle,args:[n]}];var r=[];try{if(!t.deepEqual(e.version,n.version))return[{command:zt.setStyle,args:[n]}];t.deepEqual(e.center,n.center)||r.push({command:zt.setCenter,args:[n.center]}),t.deepEqual(e.zoom,n.zoom)||r.push({command:zt.setZoom,args:[n.zoom]}),t.deepEqual(e.bearing,n.bearing)||r.push({command:zt.setBearing,args:[n.bearing]}),t.deepEqual(e.pitch,n.pitch)||r.push({command:zt.setPitch,args:[n.pitch]}),t.deepEqual(e.sprite,n.sprite)||r.push({command:zt.setSprite,args:[n.sprite]}),t.deepEqual(e.glyphs,n.glyphs)||r.push({command:zt.setGlyphs,args:[n.glyphs]}),t.deepEqual(e.transition,n.transition)||r.push({command:zt.setTransition,args:[n.transition]}),t.deepEqual(e.light,n.light)||r.push({command:zt.setLight,args:[n.light]});var i={},o=[];!function(e,n,r,i){var o;for(o in n=n||{},e=e||{})e.hasOwnProperty(o)&&(n.hasOwnProperty(o)||Ut(o,r,i));for(o in n)n.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t.deepEqual(e[o],n[o])||("geojson"===e[o].type&&"geojson"===n[o].type&&qt(e,n,o)?r.push({command:zt.setGeoJSONSourceData,args:[o,n[o].data]}):Vt(o,n,r,i)):Bt(o,n,r))}(e.sources,n.sources,o,i);var a=[];e.layers&&e.layers.forEach((function(t){i[t.source]?r.push({command:zt.removeLayer,args:[t.id]}):a.push(t)})),r=r.concat(o),function(e,n,r){n=n||[];var i,o,a,s,u,c,l,h=(e=e||[]).map(Gt),p=n.map(Gt),f=e.reduce(Ht,{}),d=n.reduce(Ht,{}),m=h.slice(),y=Object.create(null);for(i=0,o=0;i<h.length;i++)a=h[i],d.hasOwnProperty(a)?o++:(r.push({command:zt.removeLayer,args:[a]}),m.splice(m.indexOf(a,o),1));for(i=0,o=0;i<p.length;i++)a=p[p.length-1-i],m[m.length-1-i]!==a&&(f.hasOwnProperty(a)?(r.push({command:zt.removeLayer,args:[a]}),m.splice(m.lastIndexOf(a,m.length-o),1)):o++,c=m[m.length-i],r.push({command:zt.addLayer,args:[d[a],c]}),m.splice(m.length-i,0,a),y[a]=!0);for(i=0;i<p.length;i++)if(s=f[a=p[i]],u=d[a],!y[a]&&!t.deepEqual(s,u))if(t.deepEqual(s.source,u.source)&&t.deepEqual(s["source-layer"],u["source-layer"])&&t.deepEqual(s.type,u.type)){for(l in Wt(s.layout,u.layout,r,a,null,zt.setLayoutProperty),Wt(s.paint,u.paint,r,a,null,zt.setPaintProperty),t.deepEqual(s.filter,u.filter)||r.push({command:zt.setFilter,args:[a,u.filter]}),t.deepEqual(s.minzoom,u.minzoom)&&t.deepEqual(s.maxzoom,u.maxzoom)||r.push({command:zt.setLayerZoomRange,args:[a,u.minzoom,u.maxzoom]}),s)s.hasOwnProperty(l)&&"layout"!==l&&"paint"!==l&&"filter"!==l&&"metadata"!==l&&"minzoom"!==l&&"maxzoom"!==l&&(0===l.indexOf("paint.")?Wt(s[l],u[l],r,a,l.slice(6),zt.setPaintProperty):t.deepEqual(s[l],u[l])||r.push({command:zt.setLayerProperty,args:[a,l,u[l]]}));for(l in u)u.hasOwnProperty(l)&&!s.hasOwnProperty(l)&&"layout"!==l&&"paint"!==l&&"filter"!==l&&"metadata"!==l&&"minzoom"!==l&&"maxzoom"!==l&&(0===l.indexOf("paint.")?Wt(s[l],u[l],r,a,l.slice(6),zt.setPaintProperty):t.deepEqual(s[l],u[l])||r.push({command:zt.setLayerProperty,args:[a,l,u[l]]}))}else r.push({command:zt.removeLayer,args:[a]}),c=m[m.lastIndexOf(a)+1],r.push({command:zt.addLayer,args:[u,c]})}(a,n.layers,r)}catch(t){console.warn("Unable to compute style diff:",t),r=[{command:zt.setStyle,args:[n]}]}return r}(this.serialize(),e).filter((function(t){return!(t.command in Fe)}));if(0===r.length)return!1;var i=r.filter((function(t){return!(t.command in Le)}));if(i.length>0)throw new Error("Unimplemented: "+i.map((function(t){return t.command})).join(", ")+".");return r.forEach((function(t){"setTransition"!==t.command&&n[t.command].apply(n,t.args)})),this.stylesheet=e,!0},n.prototype.addImage=function(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this._changedImages[e]=!0,this._changed=!0,this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.updateImage=function(t,e){this.imageManager.updateImage(t,e)},n.prototype.getImage=function(t){return this.imageManager.getImage(t)},n.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this._changedImages[e]=!0,this._changed=!0,this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},n.prototype.addSource=function(e,n,r){var i=this;if(void 0===r&&(r={}),this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(n).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0)||!this._validate(t.validateStyle.source,"sources."+e,n,null,r)){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var o=this.sourceCaches[e]=new Ot(e,n,this.dispatcher);o.style=this,o.setEventedParent(this,(function(){return{isSourceLoaded:i.loaded(),source:o.serialize(),sourceId:e}})),o.onAdd(this.map),this._changed=!0}},n.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+n+'" is using it.')));var r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.clearTiles(),r.onRemove&&r.onRemove(this.map),this._changed=!0},n.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},n.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},n.prototype.addLayer=function(e,n,r){void 0===r&&(r={}),this._checkLoaded();var i=e.id;if(this.getLayer(i))this.fire(new t.ErrorEvent(new Error('Layer with id "'+i+'" already exists on this map')));else{var o;if("custom"===e.type){if(Ne(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(i,e.source),e=t.clone$1(e),e=t.extend(e,{source:i})),this._validate(t.validateStyle.layer,"layers."+i,e,{arrayIndex:-1},r))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}})}var a=n?this._order.indexOf(n):this._order.length;if(n&&-1===a)this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.')));else{if(this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o,this._removedLayers[i]&&o.source&&"custom"!==o.type){var s=this._removedLayers[i];delete this._removedLayers[i],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}},n.prototype.moveLayer=function(e,n){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==n){var r=this._order.indexOf(e);this._order.splice(r,1);var i=n?this._order.indexOf(n):this._order.length;n&&-1===i?this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.'))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},n.prototype.removeLayer=function(e){this._checkLoaded();var n=this._layers[e];if(n){n.setEventedParent(null);var r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},n.prototype.getLayer=function(t){return this._layers[t]},n.prototype.setLayerZoomRange=function(e,n,r){this._checkLoaded();var i=this.getLayer(e);i?i.minzoom===n&&i.maxzoom===r||(null!=n&&(i.minzoom=n),null!=r&&(i.maxzoom=r),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},n.prototype.setFilter=function(e,n,r){void 0===r&&(r={}),this._checkLoaded();var i=this.getLayer(e);if(i){if(!t.deepEqual(i.filter,n))return null==n?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(t.validateStyle.filter,"layers."+i.id+".filter",n,null,r)||(i.filter=t.clone$1(n),this._updateLayer(i)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},n.prototype.getFilter=function(e){return t.clone$1(this.getLayer(e).filter)},n.prototype.setLayoutProperty=function(e,n,r,i){void 0===i&&(i={}),this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getLayoutProperty(n),r)||(o.setLayoutProperty(n,r,i),this._updateLayer(o)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getLayoutProperty=function(e,n){var r=this.getLayer(e);if(r)return r.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style.")))},n.prototype.setPaintProperty=function(e,n,r,i){void 0===i&&(i={}),this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getPaintProperty(n),r)||(o.setPaintProperty(n,r,i)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},n.prototype.setFeatureState=function(e,n){this._checkLoaded();var r=e.source,i=e.sourceLayer,o=this.sourceCaches[r],a=parseInt(e.id,10);if(void 0!==o){var s=o.getSource().type;"geojson"===s&&i?this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==s||i?isNaN(a)||a<0?this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided and non-negative."))):o.setFeatureState(i,a,n):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},n.prototype.removeFeatureState=function(e,n){this._checkLoaded();var r=e.source,i=this.sourceCaches[r];if(void 0!==i){var o=i.getSource().type,a="vector"===o?e.sourceLayer:void 0,s=parseInt(e.id,10);"vector"!==o||a?void 0!==e.id&&isNaN(s)||s<0?this.fire(new t.ErrorEvent(new Error("The feature id parameter must be non-negative."))):n&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):i.removeFeatureState(a,s,n):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},n.prototype.getFeatureState=function(e){this._checkLoaded();var n=e.source,r=e.sourceLayer,i=this.sourceCaches[n],o=parseInt(e.id,10);if(void 0!==i)if("vector"!==i.getSource().type||r){if(!(isNaN(o)||o<0))return i.getFeatureState(r,o);this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided and non-negative.")))}else this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));else this.fire(new t.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},n.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},n.prototype.serialize=function(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,(function(t){return t.serialize()})),layers:this._serializeLayers(this._order)},(function(t){return void 0!==t}))},n.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},n.prototype._flattenAndSortRenderedFeatures=function(t){for(var e=this,n=function(t){return"fill-extrusion"===e._layers[t].type},r={},i=[],o=this._order.length-1;o>=0;o--){var a=this._order[o];if(n(a)){r[a]=o;for(var s=0,u=t;s<u.length;s+=1){var c=u[s][a];if(c)for(var l=0,h=c;l<h.length;l+=1){var p=h[l];i.push(p)}}}}i.sort((function(t,e){return e.intersectionZ-t.intersectionZ}));for(var f=[],d=this._order.length-1;d>=0;d--){var m=this._order[d];if(n(m))for(var y=i.length-1;y>=0;y--){var g=i[y].feature;if(r[g.layer.id]<d)break;f.push(g),i.pop()}else for(var v=0,_=t;v<_.length;v+=1){var b=_[v][m];if(b)for(var w=0,x=b;w<x.length;w+=1){var E=x[w];f.push(E.feature)}}}return f},n.prototype.queryRenderedFeatures=function(e,n,r){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);var i={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=n.layers;o<a.length;o+=1){var s=a[o],u=this._layers[s];if(!u)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];i[u.source]=!0}}var c=[];for(var l in this.sourceCaches)n.layers&&!i[l]||c.push(F(this.sourceCaches[l],this._layers,e,n,r));return this.placement&&c.push(function(t,e,n,r,i,o){for(var a={},s=i.queryRenderedSymbols(n),u=[],c=0,l=Object.keys(s).map(Number);c<l.length;c+=1){var h=l[c];u.push(o[h])}u.sort(j);for(var p=function(){var e=d[f],n=e.featureIndex.lookupSymbolFeatures(s[e.bucketInstanceId],e.bucketIndex,e.sourceLayerIndex,r.filter,r.layers,t);for(var i in n){var o=a[i]=a[i]||[],u=n[i];u.sort((function(t,n){var r=e.featureSortOrder;if(r){var i=r.indexOf(t.featureIndex);return r.indexOf(n.featureIndex)-i}return n.featureIndex-t.featureIndex}));for(var c=0,l=u;c<l.length;c+=1){var h=l[c];o.push(h)}}},f=0,d=u;f<d.length;f+=1)p();var m=function(n){a[n].forEach((function(r){var i=r.feature,o=t[n],a=e[o.source].getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=a}))};for(var y in a)m(y);return a}(this._layers,this.sourceCaches,e,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(c)},n.prototype.querySourceFeatures=function(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);var r=this.sourceCaches[e];return r?function(t,e){for(var n=t.getRenderableIds().map((function(e){return t.getTileByID(e)})),r=[],i={},o=0;o<n.length;o++){var a=n[o],s=a.tileID.canonical.key;i[s]||(i[s]=!0,a.querySourceFeatures(r,e))}return r}(r,n):[]},n.prototype.addSourceType=function(t,e,r){return n.getSourceType(t)?r(new Error('A source type called "'+t+'" already exists.')):(n.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},r):r(null,null))},n.prototype.getLight=function(){return this.light.getLight()},n.prototype.setLight=function(e,n){void 0===n&&(n={}),this._checkLoaded();var r=this.light.getLight(),i=!1;for(var o in e)if(!t.deepEqual(e[o],r[o])){i=!0;break}if(i){var a={now:t.browser.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(a)}},n.prototype._validate=function(e,n,r,i,o){return void 0===o&&(o={}),(!o||!1!==o.validate)&&Ne(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:r,styleSpec:t.styleSpec},i)))},n.prototype._remove=function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[e].setEventedParent(null);for(var n in this.sourceCaches)this.sourceCaches[n].clearTiles(),this.sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},n.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},n.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},n.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},n.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},n.prototype._updatePlacement=function(e,n,r,i){for(var o=!1,a=!1,s={},u=0,c=this._order;u<c.length;u+=1){var l=c[u],h=this._layers[l];if("symbol"===h.type){if(!s[h.source]){var p=this.sourceCaches[h.source];s[h.source]=p.getRenderableIds(!0).map((function(t){return p.getTileByID(t)})).sort((function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)}))}var f=this.crossTileSymbolIndex.addLayer(h,s[h.source],e.center.lng);o=o||f}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var d=this._layerOrderChanged||0===r;if((d||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.browser.now(),e.zoom))&&(this.pauseablePlacement=new Ae(e,this._order,d,n,r,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,s),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.browser.now()),a=!0),o&&this.pauseablePlacement.placement.setStale()),a||o)for(var m=0,y=this._order;m<y.length;m+=1){var g=y[m],v=this._layers[g];"symbol"===v.type&&this.placement.updateLayerOpacities(v,s[v.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.browser.now())},n.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},n.prototype.getImages=function(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();var r=this.sourceCaches[e.source];r&&r.setDependencies(e.tileID.key,e.type,e.icons)},n.prototype.getGlyphs=function(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)},n.prototype.getResource=function(e,n,r){return t.makeRequest(n,r)},n}(t.Evented);je.getSourceType=function(t){return R[t]},je.setSourceType=function(t,e){R[t]=e},je.registerForPluginStateChange=t.registerForPluginStateChange;var ze=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),Be=fn("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Ue=fn("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ve=fn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),qe=fn("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),We=fn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ge=fn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),He=fn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ke=fn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Qe=fn("uniform float u_overscale_factor;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {float alpha=0.5;vec4 color=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {color=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {color*=.2;}float extrude_scale_length=length(v_extrude_scale);float extrude_length=length(v_extrude)*extrude_scale_length;float stroke_width=15.0*extrude_scale_length/u_overscale_factor;float radius=v_radius*extrude_scale_length;float distance_to_edge=abs(extrude_length-radius);float opacity_t=smoothstep(-stroke_width,0.0,-distance_to_edge);gl_FragColor=opacity_t*color;}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);highp float padding_factor=1.2;gl_Position.xy+=a_extrude*u_extrude_scale*padding_factor*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;v_radius=abs(a_extrude.y);v_extrude=a_extrude*padding_factor;v_extrude_scale=u_extrude_scale*u_camera_to_center_distance*collision_perspective_ratio;}"),Xe=fn("uniform highp vec4 u_color;void main() {gl_FragColor=u_color;}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ye=fn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Ze=fn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Je=fn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),$e=fn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),tn=fn("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),en=fn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec4 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),nn=fn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),rn=fn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),on=fn("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),an=fn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),sn=fn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec4 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x,1.0);float x_b=mod(v_linesofar/pattern_size_b.x,1.0);float y_a=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_a.y+2.0)/2.0)/pattern_size_a.y);float y_b=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_b.y+2.0)/2.0)/pattern_size_b.y);vec2 pos_a=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,vec2(x_a,y_a));vec2 pos_b=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,vec2(x_b,y_b));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);}"),un=fn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),cn=fn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ln=fn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),hn=fn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),pn=fn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function fn(t,e){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r={};return{fragmentSource:t=t.replace(n,(function(t,e,n,i,o){return r[o]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+n+" "+i+" "+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n"})),vertexSource:e=e.replace(n,(function(t,e,n,i,o){var a="float"===i?"vec2":"vec4",s=o.match(/color/)?"color":a;return r[o]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float u_"+o+"_t;\nattribute "+n+" "+a+" a_"+o+";\nvarying "+n+" "+i+" "+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = a_"+o+";\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+s+"(a_"+o+", u_"+o+"_t);\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float u_"+o+"_t;\nattribute "+n+" "+a+" a_"+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = a_"+o+";\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = unpack_mix_"+s+"(a_"+o+", u_"+o+"_t);\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n"}))}}var dn=Object.freeze({__proto__:null,prelude:Be,background:Ue,backgroundPattern:Ve,circle:qe,clippingMask:We,heatmap:Ge,heatmapTexture:He,collisionBox:Ke,collisionCircle:Qe,debug:Xe,fill:Ye,fillOutline:Ze,fillOutlinePattern:Je,fillPattern:$e,fillExtrusion:tn,fillExtrusionPattern:en,hillshadePrepare:nn,hillshade:rn,line:on,lineGradient:an,linePattern:sn,lineSDF:un,raster:cn,symbolIcon:ln,symbolSDF:hn,symbolTextAndIcon:pn}),mn=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};mn.prototype.bind=function(t,e,n,r,i,o,a,s){this.context=t;for(var u=this.boundPaintVertexBuffers.length!==r.length,c=0;!u&&c<r.length;c++)this.boundPaintVertexBuffers[c]!==r[c]&&(u=!0);var l=!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==n||u||this.boundIndexBuffer!==i||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==a||this.boundDynamicVertexBuffer2!==s;!t.extVertexArrayObject||l?this.freshBind(e,n,r,i,o,a,s):(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind())},mn.prototype.freshBind=function(t,e,n,r,i,o,a){var s,u=t.numAttributes,c=this.context,l=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=c.currentNumAttributes||0;for(var h=u;h<s;h++)l.disableVertexAttribArray(h)}e.enableAttributes(l,t);for(var p=0,f=n;p<f.length;p+=1)f[p].enableAttributes(l,t);o&&o.enableAttributes(l,t),a&&a.enableAttributes(l,t),e.bind(),e.setVertexAttribPointers(l,t,i);for(var d=0,m=n;d<m.length;d+=1){var y=m[d];y.bind(),y.setVertexAttribPointers(l,t,i)}o&&(o.bind(),o.setVertexAttribPointers(l,t,i)),r&&r.bind(),a&&(a.bind(),a.setVertexAttribPointers(l,t,i)),c.currentNumAttributes=u},mn.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var yn=function(t,e,n,r,i){var o=t.gl;this.program=o.createProgram();var a=n.defines();i&&a.push("#define OVERDRAW_INSPECTOR;");var s=a.concat(Be.fragmentSource,e.fragmentSource).join("\n"),u=a.concat(Be.vertexSource,e.vertexSource).join("\n"),c=o.createShader(o.FRAGMENT_SHADER);if(o.isContextLost())this.failedToCreate=!0;else{o.shaderSource(c,s),o.compileShader(c),o.attachShader(this.program,c);var l=o.createShader(o.VERTEX_SHADER);if(o.isContextLost())this.failedToCreate=!0;else{o.shaderSource(l,u),o.compileShader(l),o.attachShader(this.program,l);for(var h=n.layoutAttributes||[],p=0;p<h.length;p++)o.bindAttribLocation(this.program,p,h[p].name);o.linkProgram(this.program),this.numAttributes=o.getProgramParameter(this.program,o.ACTIVE_ATTRIBUTES),this.attributes={};for(var f={},d=0;d<this.numAttributes;d++){var m=o.getActiveAttrib(this.program,d);m&&(this.attributes[m.name]=o.getAttribLocation(this.program,m.name))}for(var y=o.getProgramParameter(this.program,o.ACTIVE_UNIFORMS),g=0;g<y;g++){var v=o.getActiveUniform(this.program,g);v&&(f[v.name]=o.getUniformLocation(this.program,v.name))}this.fixedUniforms=r(t,f),this.binderUniforms=n.getUniforms(t,f)}}};function gn(e,n,r){var i=1/ce(r,1,n.transform.tileZoom),o=Math.pow(2,r.tileID.overscaledZ),a=r.tileSize*Math.pow(2,n.transform.tileZoom)/o,s=a*(r.tileID.canonical.x+r.tileID.wrap*o),u=a*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[t.browser.devicePixelRatio,i,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[s>>16,u>>16],u_pixel_coord_lower:[65535&s,65535&u]}}yn.prototype.draw=function(t,e,n,r,i,o,a,s,u,c,l,h,p,f,d,m){var y,g=t.gl;if(!this.failedToCreate){for(var v in t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(r),t.setColorMode(i),t.setCullFace(o),this.fixedUniforms)this.fixedUniforms[v].set(a[v]);f&&f.setUniforms(t,this.binderUniforms,h,{zoom:p});for(var _=(y={},y[g.LINES]=2,y[g.TRIANGLES]=3,y[g.LINE_STRIP]=1,y)[e],b=0,w=l.get();b<w.length;b+=1){var x=w[b],E=x.vaos||(x.vaos={});(E[s]||(E[s]=new mn)).bind(t,this,u,f?f.getPaintVertexBuffers():[],c,x.vertexOffset,d,m),g.drawElements(e,x.primitiveLength*_,g.UNSIGNED_SHORT,x.primitiveOffset*_*2)}}};var vn=function(e,n,r,i){var o=n.style.light,a=o.properties.get("position"),s=[a.x,a.y,a.z],u=t.create$1();"viewport"===o.properties.get("anchor")&&t.fromRotation(u,-n.transform.angle),t.transformMat3(s,s,u);var c=o.properties.get("color");return{u_matrix:e,u_lightpos:s,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+r,u_opacity:i}},_n=function(e,n,r,i,o,a,s){return t.extend(vn(e,n,r,i),gn(a,n,s),{u_height_factor:-Math.pow(2,o.overscaledZ)/s.tileSize/8})},bn=function(t){return{u_matrix:t}},wn=function(e,n,r,i){return t.extend(bn(e),gn(r,n,i))},xn=function(t,e){return{u_matrix:t,u_world:e}},En=function(e,n,r,i,o){return t.extend(wn(e,n,r,i),{u_world:o})},Tn=function(e,n,r,i){var o,a,s=e.transform;if("map"===i.paint.get("circle-pitch-alignment")){var u=ce(r,1,s.zoom);o=!0,a=[u,u]}else o=!1,a=s.pixelsToGLUnits;return{u_camera_to_center_distance:s.cameraToCenterDistance,u_scale_with_map:+("map"===i.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(n.posMatrix,r,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_pitch_with_map:+o,u_device_pixel_ratio:t.browser.devicePixelRatio,u_extrude_scale:a}},Sn=function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,n.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,n.u_overscale_factor)}},Cn=function(t,e,n){var r=ce(n,1,e.zoom),i=Math.pow(2,e.zoom-n.tileID.overscaledZ),o=n.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*i),e.pixelsToGLUnits[1]/(r*i)],u_overscale_factor:o}},In=function(t,e){return{u_matrix:t,u_color:e}},kn=function(t){return{u_matrix:t}},An=function(t,e,n,r){return{u_matrix:t,u_extrude_scale:ce(e,1,n),u_intensity:r}},On=function(t,e,n){var r=n.paint.get("hillshade-shadow-color"),i=n.paint.get("hillshade-highlight-color"),o=n.paint.get("hillshade-accent-color"),a=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(a-=t.transform.angle);var s=!t.options.moving;return{u_matrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),s),u_image:0,u_latrange:Dn(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),a],u_shadow:r,u_highlight:i,u_accent:o}},Pn=function(e,n,r){var i=n.stride,o=t.create();return t.ortho(o,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(o,o,[0,-t.EXTENT,0]),{u_matrix:o,u_image:1,u_dimension:[i,i],u_zoom:e.overscaledZ,u_maxzoom:r,u_unpack:n.getUnpackVector()}};function Dn(e,n){var r=Math.pow(2,n.canonical.z),i=n.canonical.y;return[new t.MercatorCoordinate(0,i/r).toLngLat().lat,new t.MercatorCoordinate(0,(i+1)/r).toLngLat().lat]}var Mn=function(e,n,r){var i=e.transform;return{u_matrix:jn(e,n,r),u_ratio:1/ce(n,1,i.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}},Rn=function(e,n,r){return t.extend(Mn(e,n,r),{u_image:0})},Nn=function(e,n,r,i){var o=e.transform,a=Fn(n,o);return{u_matrix:jn(e,n,r),u_texsize:n.imageAtlasTexture.size,u_ratio:1/ce(n,1,o.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_image:0,u_scale:[t.browser.devicePixelRatio,a,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},Ln=function(e,n,r,i,o){var a=e.transform,s=e.lineAtlas,u=Fn(n,a),c="round"===r.layout.get("line-cap"),l=s.getDash(i.from,c),h=s.getDash(i.to,c),p=l.width*o.fromScale,f=h.width*o.toScale;return t.extend(Mn(e,n,r),{u_patternscale_a:[u/p,-l.height/2],u_patternscale_b:[u/f,-h.height/2],u_sdfgamma:s.width/(256*Math.min(p,f)*t.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:l.y,u_tex_y_b:h.y,u_mix:o.t})};function Fn(t,e){return 1/ce(t,1,e.tileZoom)}function jn(t,e,n){return t.translatePosMatrix(e.tileID.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var zn=function(t,e,n,r,i){return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(a=i.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=i.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Bn(i.paint.get("raster-hue-rotate"))};var o,a};function Bn(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}var Un=function(t,e,n,r,i,o,a,s,u,c){var l=i.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:l.cameraToCenterDistance,u_pitch:l.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:l.width/l.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+u,u_pitch_with_map:+r,u_texsize:c,u_texture:0}},Vn=function(e,n,r,i,o,a,s,u,c,l,h){var p=o.transform;return t.extend(Un(e,n,r,i,o,a,s,u,c,l),{u_gamma_scale:i?Math.cos(p._pitch)*p.cameraToCenterDistance:1,u_device_pixel_ratio:t.browser.devicePixelRatio,u_is_halo:+h})},qn=function(e,n,r,i,o,a,s,u,c,l){return t.extend(Vn(e,n,r,i,o,a,s,u,!0,c,!0),{u_texsize_icon:l,u_texture_icon:1})},Wn=function(t,e,n){return{u_matrix:t,u_opacity:e,u_color:n}},Gn=function(e,n,r,i,o,a){return t.extend(function(t,e,n,r){var i=n.imageManager.getPattern(t.from.toString()),o=n.imageManager.getPattern(t.to.toString()),a=n.imageManager.getPixelSize(),s=a.width,u=a.height,c=Math.pow(2,r.tileID.overscaledZ),l=r.tileSize*Math.pow(2,n.transform.tileZoom)/c,h=l*(r.tileID.canonical.x+r.tileID.wrap*c),p=l*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,u],u_mix:e.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/ce(r,1,n.transform.tileZoom),u_pixel_coord_upper:[h>>16,p>>16],u_pixel_coord_lower:[65535&h,65535&p]}}(i,a,r,o),{u_matrix:e,u_opacity:n})},Hn={fillExtrusion:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fillExtrusionPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fill:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},fillPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},fillOutline:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}},fillOutlinePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},circle:function(e,n){return{u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,n.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},collisionBox:Sn,collisionCircle:Sn,debug:function(e,n){return{u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},clippingMask:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmap:function(e,n){return{u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmapTexture:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}},hillshade:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}},hillshadePrepare:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_maxzoom:new t.Uniform1f(e,n.u_maxzoom),u_unpack:new t.Uniform4f(e,n.u_unpack)}},line:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels)}},lineGradient:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image)}},linePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_image:new t.Uniform1i(e,n.u_image),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},lineSDF:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,n.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,n.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,n.u_sdfgamma),u_image:new t.Uniform1i(e,n.u_image),u_tex_y_a:new t.Uniform1f(e,n.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,n.u_tex_y_b),u_mix:new t.Uniform1f(e,n.u_mix)}},raster:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}},symbolIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1f(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}},symbolSDF:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1f(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1f(e,n.u_is_halo)}},symbolTextAndIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1f(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texsize_icon:new t.Uniform2f(e,n.u_texsize_icon),u_texture:new t.Uniform1i(e,n.u_texture),u_texture_icon:new t.Uniform1i(e,n.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1f(e,n.u_is_halo)}},background:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}},backgroundPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}}};function Kn(e,n){for(var r=e.sort((function(t,e){return t.tileID.isLessThan(e.tileID)?-1:e.tileID.isLessThan(t.tileID)?1:0})),i=0;i<r.length;i++){var o={},a=r[i],s=r.slice(i+1);Qn(a.tileID.wrapped(),a.tileID,s,new t.OverscaledTileID(0,a.tileID.wrap+1,0,0,0),o),a.setMask(o,n)}}function Qn(e,n,r,i,o){for(var a=0;a<r.length;a++){var s=r[a];if(i.isLessThan(s.tileID))break;if(n.key===s.tileID.key)return;if(s.tileID.isChildOf(n)){for(var u=n.children(1/0),c=0;c<u.length;c++)Qn(e,u[c],r.slice(a),i,o);return}}var l=n.overscaledZ-e.overscaledZ,h=new t.CanonicalTileID(l,n.canonical.x-(e.canonical.x<<l),n.canonical.y-(e.canonical.y<<l));o[h.key]=o[h.key]||h}function Xn(t,e,n,r,i,o,a,s){for(var u=t.context,c=u.gl,l=i?t.useProgram("collisionCircle"):t.useProgram("collisionBox"),h=0;h<r.length;h++){var p=r[h],f=e.getTile(p),d=f.getBucket(n);if(d){var m=i?s?d.textCollisionCircle:d.iconCollisionCircle:s?d.textCollisionBox:d.iconCollisionBox;if(m){var y=p.posMatrix;0===o[0]&&0===o[1]||(y=t.translatePosMatrix(p.posMatrix,f,o,a)),l.draw(u,i?c.TRIANGLES:c.LINES,St.disabled,Ct.disabled,t.colorModeForRenderPass(),kt.disabled,Cn(y,t.transform,f),n.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,t.transform.zoom,null,null,m.collisionVertexBuffer)}}}}function Yn(t,e,n,r,i,o,a){Xn(t,e,n,r,!1,i,o,a),Xn(t,e,n,r,!0,i,o,a)}var Zn=t.identity(new Float32Array(16));function Jn(e,n,r,i,o,a){var s=t.getAnchorAlignment(e),u=-(s.horizontalAlign-.5)*n,c=-(s.verticalAlign-.5)*r,l=t.evaluateVariableOffset(e,i);return new t.Point((u/o+l[0])*a,(c/o+l[1])*a)}function $n(e,n,r,i,o,a,s,u,c,l,h){var p=e.text.placedSymbolArray,f=e.text.dynamicLayoutVertexArray,d=e.icon.dynamicLayoutVertexArray,m={};f.clear();for(var y=0;y<p.length;y++){var g=p.get(y),v=e.allowVerticalPlacement&&!g.placedOrientation,_=g.hidden||!g.crossTileID||v?null:i[g.crossTileID];if(_){var b=new t.Point(g.anchorX,g.anchorY),w=Yt(b,r?u:s),x=.5+a.cameraToCenterDistance/w.signedDistanceFromCamera*.5,E=o.evaluateSizeForFeature(e.textSizeData,l,g)*x/t.ONE_EM;r&&(E*=e.tilePixelRatio/c);for(var T=_.width,S=_.height,C=Jn(_.anchor,T,S,_.textOffset,_.textBoxScale,E),I=r?Yt(b.add(C),s).point:w.point.add(n?C.rotate(-a.angle):C),k=e.allowVerticalPlacement&&g.placedOrientation===t.WritingMode.vertical?Math.PI/2:0,A=0;A<g.numGlyphs;A++)t.addDynamicAttributes(f,I,k);h&&g.associatedIconIndex>=0&&(m[g.associatedIconIndex]={shiftedAnchor:I,angle:k})}else oe(g.numGlyphs,f)}if(h){d.clear();for(var O=e.icon.placedSymbolArray,P=0;P<O.length;P++){var D=O.get(P);if(D.hidden)oe(D.numGlyphs,d);else{var M=m[P];if(M)for(var R=0;R<D.numGlyphs;R++)t.addDynamicAttributes(d,M.shiftedAnchor,M.angle);else oe(D.numGlyphs,d)}}e.icon.dynamicLayoutVertexBuffer.updateData(d)}e.text.dynamicLayoutVertexBuffer.updateData(f)}function tr(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function er(e,n,r,i,o,a,s,u,c,l,h,p){for(var f,d,m=e.context,y=m.gl,g=e.transform,v="map"===u,_="map"===c,b=v&&"point"!==r.layout.get("symbol-placement"),w=v&&!_&&!b,x=void 0!==r.layout.get("symbol-sort-key").constantOr(1),E=e.depthModeForSublayer(0,St.ReadOnly),T=r.layout.get("text-variable-anchor"),S=[],C=0,I=i;C<I.length;C+=1){var k=I[C],A=n.getTile(k),O=A.getBucket(r);if(O){var P=o?O.text:O.icon;if(P&&P.segments.get().length){var D=P.programConfigurations.get(r.id),M=o||O.sdfIcons,R=o?O.textSizeData:O.iconSizeData,N=_||0!==g.pitch;f||(f=e.useProgram(tr(M,o,O),D),d=t.evaluateSizeForZoom(R,g.zoom));var L=void 0,F=[0,0],j=void 0,z=void 0,B=null,U=void 0;if(o){if(j=A.glyphAtlasTexture,z=y.LINEAR,L=A.glyphAtlasTexture.size,O.iconsInText){F=A.imageAtlasTexture.size,B=A.imageAtlasTexture;var V="composite"===R.kind||"camera"===R.kind;U=N||e.options.rotating||e.options.zooming||V?y.LINEAR:y.NEAREST}}else{var q=1!==r.layout.get("icon-size").constantOr(0)||O.iconsNeedLinear;j=A.imageAtlasTexture,z=M||e.options.rotating||e.options.zooming||q||N?y.LINEAR:y.NEAREST,L=A.imageAtlasTexture.size}var W=ce(A,1,e.transform.zoom),G=Qt(k.posMatrix,_,v,e.transform,W),H=Xt(k.posMatrix,_,v,e.transform,W),K=T&&O.hasTextData(),Q="none"!==r.layout.get("icon-text-fit")&&K&&O.hasIconData();b&&Jt(O,k.posMatrix,e,o,G,H,_,l);var X=e.translatePosMatrix(k.posMatrix,A,a,s),Y=b||o&&T||Q?Zn:G,Z=e.translatePosMatrix(H,A,a,s,!0),J=M&&0!==r.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1),$={program:f,buffers:P,uniformValues:M?O.iconsInText?qn(R.kind,d,w,_,e,X,Y,Z,L,F):Vn(R.kind,d,w,_,e,X,Y,Z,o,L,!0):Un(R.kind,d,w,_,e,X,Y,Z,o,L),atlasTexture:j,atlasTextureIcon:B,atlasInterpolation:z,atlasInterpolationIcon:U,isSDF:M,hasHalo:J};if(x)for(var tt=0,et=P.segments.get();tt<et.length;tt+=1){var nt=et[tt];S.push({segments:new t.SegmentVector([nt]),sortKey:nt.sortKey,state:$})}else S.push({segments:P.segments,sortKey:0,state:$})}}}x&&S.sort((function(t,e){return t.sortKey-e.sortKey}));for(var rt=0,it=S;rt<it.length;rt+=1){var ot=it[rt],at=ot.state;if(m.activeTexture.set(y.TEXTURE0),at.atlasTexture.bind(at.atlasInterpolation,y.CLAMP_TO_EDGE),at.atlasTextureIcon&&(m.activeTexture.set(y.TEXTURE1),at.atlasTextureIcon&&at.atlasTextureIcon.bind(at.atlasInterpolationIcon,y.CLAMP_TO_EDGE)),at.isSDF){var st=at.uniformValues;at.hasHalo&&(st.u_is_halo=1,nr(at.buffers,ot.segments,r,e,at.program,E,h,p,st)),st.u_is_halo=0}nr(at.buffers,ot.segments,r,e,at.program,E,h,p,at.uniformValues)}}function nr(t,e,n,r,i,o,a,s,u){var c=r.context,l=c.gl;i.draw(c,l.TRIANGLES,o,a,s,kt.disabled,u,n.id,t.layoutVertexBuffer,t.indexBuffer,e,n.paint,r.transform.zoom,t.programConfigurations.get(n.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function rr(t,e,n,r,i,o,a){var s,u,c,l,h,p=t.context.gl,f=n.paint.get("fill-pattern"),d=f&&f.constantOr(1),m=n.getCrossfadeParameters();a?(u=d&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s=p.LINES):(u=d?"fillPattern":"fill",s=p.TRIANGLES);for(var y=0,g=r;y<g.length;y+=1){var v=g[y],_=e.getTile(v);if(!d||_.patternsLoaded()){var b=_.getBucket(n);if(b){var w=b.programConfigurations.get(n.id),x=t.useProgram(u,w);d&&(t.context.activeTexture.set(p.TEXTURE0),_.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),w.updatePatternPaintBuffers(m));var E=f.constantOr(null);if(E&&_.imageAtlas){var T=_.imageAtlas,S=T.patternPositions[E.to.toString()],C=T.patternPositions[E.from.toString()];S&&C&&w.setConstantPatternPositions(S,C)}var I=t.translatePosMatrix(v.posMatrix,_,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(a){l=b.indexBuffer2,h=b.segments2;var k=[p.drawingBufferWidth,p.drawingBufferHeight];c="fillOutlinePattern"===u&&d?En(I,t,m,_,k):xn(I,k)}else l=b.indexBuffer,h=b.segments,c=d?wn(I,t,m,_):bn(I);x.draw(t.context,s,i,t.stencilModeForClipping(v),o,kt.disabled,c,n.id,b.layoutVertexBuffer,l,h,n.paint,t.transform.zoom,w)}}}}function ir(t,e,n,r,i,o,a){for(var s=t.context,u=s.gl,c=n.paint.get("fill-extrusion-pattern"),l=c.constantOr(1),h=n.getCrossfadeParameters(),p=n.paint.get("fill-extrusion-opacity"),f=0,d=r;f<d.length;f+=1){var m=d[f],y=e.getTile(m),g=y.getBucket(n);if(g){var v=g.programConfigurations.get(n.id),_=t.useProgram(l?"fillExtrusionPattern":"fillExtrusion",v);l&&(t.context.activeTexture.set(u.TEXTURE0),y.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),v.updatePatternPaintBuffers(h));var b=c.constantOr(null);if(b&&y.imageAtlas){var w=y.imageAtlas,x=w.patternPositions[b.to.toString()],E=w.patternPositions[b.from.toString()];x&&E&&v.setConstantPatternPositions(x,E)}var T=t.translatePosMatrix(m.posMatrix,y,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),S=n.paint.get("fill-extrusion-vertical-gradient"),C=l?_n(T,t,S,p,m,h,y):vn(T,t,S,p);_.draw(s,s.gl.TRIANGLES,i,o,a,kt.backCCW,C,n.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,n.paint,t.transform.zoom,v)}}}function or(t,e,n,r,i,o){var a=t.context,s=a.gl,u=e.fbo;if(u){var c=t.useProgram("hillshade");a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,u.colorAttachment.get());var l=On(t,e,n);e.maskedBoundsBuffer&&e.maskedIndexBuffer&&e.segments?c.draw(a,s.TRIANGLES,r,i,o,kt.disabled,l,n.id,e.maskedBoundsBuffer,e.maskedIndexBuffer,e.segments):c.draw(a,s.TRIANGLES,r,i,o,kt.disabled,l,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function ar(e,n,r,i,o,a,s){var u=e.context,c=u.gl,l=n.dem;if(l&&l.data){var h=l.dim,p=l.stride,f=l.getPixels();if(u.activeTexture.set(c.TEXTURE1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(p),n.demTexture){var d=n.demTexture;d.update(f,{premultiply:!1}),d.bind(c.NEAREST,c.CLAMP_TO_EDGE)}else n.demTexture=new t.Texture(u,f,c.RGBA,{premultiply:!1}),n.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);u.activeTexture.set(c.TEXTURE0);var m=n.fbo;if(!m){var y=new t.Texture(u,{width:h,height:h,data:null},c.RGBA);y.bind(c.LINEAR,c.CLAMP_TO_EDGE),(m=n.fbo=u.createFramebuffer(h,h)).colorAttachment.set(y.texture)}u.bindFramebuffer.set(m.framebuffer),u.viewport.set([0,0,h,h]),e.useProgram("hillshadePrepare").draw(u,c.TRIANGLES,o,a,s,kt.disabled,Pn(n.tileID,l,i),r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function sr(e,n,r,i,o){var a=i.paint.get("raster-fade-duration");if(a>0){var s=t.browser.now(),u=(s-e.timeAdded)/a,c=n?(s-n.timeAdded)/a:-1,l=r.getSource(),h=o.coveringZoomLevel({tileSize:l.tileSize,roundZoom:l.roundZoom}),p=!n||Math.abs(n.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),f=p&&e.refreshedUponExpiration?1:t.clamp(p?u:1-c,0,1);return e.refreshedUponExpiration&&u>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-f}:{opacity:f,mix:0}}return{opacity:1,mix:0}}function ur(e,n,r){var i=e.context,o=i.gl,a=r.posMatrix,s=e.useProgram("debug"),u=St.disabled,c=Ct.disabled,l=e.colorModeForRenderPass(),h="$debug";s.draw(i,o.LINE_STRIP,u,c,l,kt.disabled,In(a,t.Color.red),h,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);var p=n.getTileByID(r.key).latestRawTileData,f=p&&p.byteLength||0,d=Math.floor(f/1024),m=n.getTile(r).tileSize,y=512/Math.min(m,512),g=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(g+=" => "+r.overscaledZ);for(var v=function(t,e,n,r){r=r||1;var i,o,a,s,u,c,l,h,p=[];for(i=0,o=t.length;i<o;i++)if(u=cr[t[i]]){for(h=null,a=0,s=u[1].length;a<s;a+=2)-1===u[1][a]&&-1===u[1][a+1]?h=null:(c=e+u[1][a]*r,l=n-u[1][a+1]*r,h&&p.push(h.x,h.y,c,l),h={x:c,y:l});e+=u[0]*r}return p}(g+" "+d+"kb",50,200*y,5*y),_=new t.StructArrayLayout2i4,b=new t.StructArrayLayout2ui4,w=0;w<v.length;w+=2)_.emplaceBack(v[w],v[w+1]),b.emplaceBack(w,w+1);for(var x=i.createVertexBuffer(_,ze.members),E=i.createIndexBuffer(b),T=t.SegmentVector.simpleSegment(0,0,_.length/2,_.length/2),S=t.EXTENT/(Math.pow(2,e.transform.zoom-r.overscaledZ)*m*y),C=[],I=-1;I<=1;I++)for(var k=-1;k<=1&&(0!==I||0!==k);k++)C.push([I,k]);for(var A=0;A<C.length;A++){var O=C[A];s.draw(i,o.LINES,u,c,l,kt.disabled,In(t.translate([],a,[S*O[0],S*O[1],0]),t.Color.white),h,x,E,T)}s.draw(i,o.LINES,u,c,l,kt.disabled,In(a,t.Color.black),h,x,E,T),x.destroy(),E.destroy(),T.destroy()}var cr={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},lr={symbol:function(e,n,r,i,o){if("translucent"===e.renderPass){var a=Ct.disabled,s=e.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(e,n,r,i,o,a,s){for(var u=n.transform,c="map"===o,l="map"===a,h=0,p=e;h<p.length;h+=1){var f=p[h],d=i.getTile(f),m=d.getBucket(r);if(m&&m.text&&m.text.segments.get().length){var y=m.textSizeData,g=t.evaluateSizeForZoom(y,u.zoom),v=ce(d,1,n.transform.zoom),_=Qt(f.posMatrix,l,c,n.transform,v),b="none"!==r.layout.get("icon-text-fit")&&m.hasIconData();if(g){var w=Math.pow(2,u.zoom-d.tileID.overscaledZ);$n(m,c,l,s,t.symbolSize,u,_,f.posMatrix,w,g,b)}}}}(i,e,r,n,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),o),0!==r.paint.get("icon-opacity").constantOr(1)&&er(e,n,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),a,s),0!==r.paint.get("text-opacity").constantOr(1)&&er(e,n,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),a,s),n.map.showCollisionBoxes&&(Yn(e,n,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),Yn(e,n,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))}},circle:function(e,n,r,i){if("translucent"===e.renderPass){var o=r.paint.get("circle-opacity"),a=r.paint.get("circle-stroke-width"),s=r.paint.get("circle-stroke-opacity"),u=void 0!==r.layout.get("circle-sort-key").constantOr(1);if(0!==o.constantOr(1)||0!==a.constantOr(1)&&0!==s.constantOr(1)){for(var c=e.context,l=c.gl,h=e.depthModeForSublayer(0,St.ReadOnly),p=Ct.disabled,f=e.colorModeForRenderPass(),d=[],m=0;m<i.length;m++){var y=i[m],g=n.getTile(y),v=g.getBucket(r);if(v){var _=v.programConfigurations.get(r.id),b={programConfiguration:_,program:e.useProgram("circle",_),layoutVertexBuffer:v.layoutVertexBuffer,indexBuffer:v.indexBuffer,uniformValues:Tn(e,y,g,r)};if(u)for(var w=0,x=v.segments.get();w<x.length;w+=1){var E=x[w];d.push({segments:new t.SegmentVector([E]),sortKey:E.sortKey,state:b})}else d.push({segments:v.segments,sortKey:0,state:b})}}u&&d.sort((function(t,e){return t.sortKey-e.sortKey}));for(var T=0,S=d;T<S.length;T+=1){var C=S[T],I=C.state,k=I.programConfiguration,A=I.program,O=I.layoutVertexBuffer,P=I.indexBuffer,D=I.uniformValues,M=C.segments;A.draw(c,l.TRIANGLES,h,p,f,kt.disabled,D,r.id,O,P,M,r.paint,e.transform.zoom,k)}}}},heatmap:function(e,n,r,i){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl,s=e.depthModeForSublayer(0,St.ReadOnly),u=Ct.disabled,c=new It([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){var r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var i=n.heatmapFbo;if(i)r.bindTexture(r.TEXTURE_2D,i.colorAttachment.get()),t.bindFramebuffer.set(i.framebuffer);else{var o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),i=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4),function t(e,n,r,i){var o=e.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,n.width/4,n.height/4,0,o.RGBA,e.extTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),i.colorAttachment.set(r),e.extTextureHalfFloat&&o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&(e.extTextureHalfFloat=null,i.colorAttachment.setDirty(),t(e,n,r,i))}(t,e,o,i)}}(o,e,r),o.clear({color:t.Color.transparent});for(var l=0;l<i.length;l++){var h=i[l];if(!n.hasRenderableParent(h)){var p=n.getTile(h),f=p.getBucket(r);if(f){var d=f.programConfigurations.get(r.id),m=e.useProgram("heatmap",d),y=e.transform.zoom;m.draw(o,a.TRIANGLES,s,u,c,kt.disabled,An(h.posMatrix,p,y,r.paint.get("heatmap-intensity")),r.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,r.paint,e.transform.zoom,d)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){var r=e.context,i=r.gl,o=n.heatmapFbo;if(o){r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);var a=n.colorRampTexture;a||(a=n.colorRampTexture=new t.Texture(r,n.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,i.TRIANGLES,St.disabled,Ct.disabled,e.colorModeForRenderPass(),kt.disabled,function(e,n,r,i){var o=t.create();t.ortho(o,0,e.width,e.height,0,0,1);var a=e.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:r,u_color_ramp:i,u_opacity:n.paint.get("heatmap-opacity")}}(e,n,0,1),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}}(e,r))},line:function(e,n,r,i){if("translucent"===e.renderPass){var o=r.paint.get("line-opacity"),a=r.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1)){var s=e.depthModeForSublayer(0,St.ReadOnly),u=e.colorModeForRenderPass(),c=r.paint.get("line-dasharray"),l=r.paint.get("line-pattern"),h=l.constantOr(1),p=r.paint.get("line-gradient"),f=r.getCrossfadeParameters(),d=c?"lineSDF":h?"linePattern":p?"lineGradient":"line",m=e.context,y=m.gl,g=!0;if(p){m.activeTexture.set(y.TEXTURE0);var v=r.gradientTexture;if(!r.gradient)return;v||(v=r.gradientTexture=new t.Texture(m,r.gradient,y.RGBA)),v.bind(y.LINEAR,y.CLAMP_TO_EDGE)}for(var _=0,b=i;_<b.length;_+=1){var w=b[_],x=n.getTile(w);if(!h||x.patternsLoaded()){var E=x.getBucket(r);if(E){var T=E.programConfigurations.get(r.id),S=e.context.program.get(),C=e.useProgram(d,T),I=g||C.program!==S,k=l.constantOr(null);if(k&&x.imageAtlas){var A=x.imageAtlas,O=A.patternPositions[k.to.toString()],P=A.patternPositions[k.from.toString()];O&&P&&T.setConstantPatternPositions(O,P)}var D=c?Ln(e,x,r,c,f):h?Nn(e,x,r,f):p?Rn(e,x,r):Mn(e,x,r);c&&(I||e.lineAtlas.dirty)?(m.activeTexture.set(y.TEXTURE0),e.lineAtlas.bind(m)):h&&(m.activeTexture.set(y.TEXTURE0),x.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),T.updatePatternPaintBuffers(f)),C.draw(m,y.TRIANGLES,s,e.stencilModeForClipping(w),u,kt.disabled,D,r.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,r.paint,e.transform.zoom,T),g=!1}}}}}},fill:function(e,n,r,i){var o=r.paint.get("fill-color"),a=r.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=e.colorModeForRenderPass(),u=r.paint.get("fill-pattern"),c=e.opaquePassEnabledForLayer()&&!u.constantOr(1)&&1===o.constantOr(t.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(e.renderPass===c){var l=e.depthModeForSublayer(1,"opaque"===e.renderPass?St.ReadWrite:St.ReadOnly);rr(e,n,r,i,l,s,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){var h=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,St.ReadOnly);rr(e,n,r,i,h,s,!0)}}},"fill-extrusion":function(t,e,n,r){var i=n.paint.get("fill-extrusion-opacity");if(0!==i&&"translucent"===t.renderPass){var o=new St(t.context.gl.LEQUAL,St.ReadWrite,t.depthRangeFor3D);if(1!==i||n.paint.get("fill-extrusion-pattern").constantOr(1))ir(t,e,n,r,o,Ct.disabled,It.disabled),ir(t,e,n,r,o,t.stencilModeFor3D(),t.colorModeForRenderPass());else{var a=t.colorModeForRenderPass();ir(t,e,n,r,o,Ct.disabled,a)}}},hillshade:function(t,e,n,r){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var i=t.context,o=e.getSource().maxzoom,a=t.depthModeForSublayer(0,St.ReadOnly),s=Ct.disabled,u=t.colorModeForRenderPass(),c=0,l=r;c<l.length;c+=1){var h=l[c],p=e.getTile(h);p.needsHillshadePrepare&&"offscreen"===t.renderPass?ar(t,p,n,o,a,s,u):"translucent"===t.renderPass&&or(t,p,n,a,s,u)}i.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,n,r){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity"))for(var i=t.context,o=i.gl,a=e.getSource(),s=t.useProgram("raster"),u=Ct.disabled,c=t.colorModeForRenderPass(),l=r.length&&r[0].overscaledZ,h=!t.options.moving,p=0,f=r;p<f.length;p+=1){var d=f[p],m=t.depthModeForSublayer(d.overscaledZ-l,1===n.paint.get("raster-opacity")?St.ReadWrite:St.ReadOnly,o.LESS),y=e.getTile(d),g=t.transform.calculatePosMatrix(d.toUnwrapped(),h);y.registerFadeDuration(n.paint.get("raster-fade-duration"));var v=e.findLoadedParent(d,0),_=sr(y,v,e,n,t.transform),b=void 0,w=void 0,x="nearest"===n.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;i.activeTexture.set(o.TEXTURE0),y.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),i.activeTexture.set(o.TEXTURE1),v?(v.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),b=Math.pow(2,v.tileID.overscaledZ-y.tileID.overscaledZ),w=[y.tileID.canonical.x*b%1,y.tileID.canonical.y*b%1]):y.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var E=zn(g,w||[0,0],b||1,_,n);a instanceof P?s.draw(i,o.TRIANGLES,m,u,c,kt.disabled,E,n.id,a.boundsBuffer,t.quadTriangleIndexBuffer,a.boundsSegments):y.maskedBoundsBuffer&&y.maskedIndexBuffer&&y.segments?s.draw(i,o.TRIANGLES,m,u,c,kt.disabled,E,n.id,y.maskedBoundsBuffer,y.maskedIndexBuffer,y.segments,n.paint,t.transform.zoom):s.draw(i,o.TRIANGLES,m,u,c,kt.disabled,E,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,n){var r=n.paint.get("background-color"),i=n.paint.get("background-opacity");if(0!==i){var o=t.context,a=o.gl,s=t.transform,u=s.tileSize,c=n.paint.get("background-pattern");if(!t.isPatternMissing(c)){var l=!c&&1===r.a&&1===i&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===l){var h=Ct.disabled,p=t.depthModeForSublayer(0,"opaque"===l?St.ReadWrite:St.ReadOnly),f=t.colorModeForRenderPass(),d=t.useProgram(c?"backgroundPattern":"background"),m=s.coveringTiles({tileSize:u});c&&(o.activeTexture.set(a.TEXTURE0),t.imageManager.bind(t.context));for(var y=n.getCrossfadeParameters(),g=0,v=m;g<v.length;g+=1){var _=v[g],b=t.transform.calculatePosMatrix(_.toUnwrapped()),w=c?Gn(b,i,t,c,{tileID:_,tileSize:u},y):Wn(b,i,r);d.draw(o,a.TRIANGLES,p,h,f,kt.disabled,w,n.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(t,e,n){for(var r=0;r<n.length;r++)ur(t,e,n[r])},custom:function(t,e,n){var r=t.context,i=n.implementation;if("offscreen"===t.renderPass){var o=i.prerender;o&&(t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),o.call(i,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),r.setStencilMode(Ct.disabled);var a="3d"===i.renderingMode?new St(t.context.gl.LEQUAL,St.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,St.ReadOnly);r.setDepthMode(a),i.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}},hr=function(e,n){this.context=new At(e),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=Ot.maxUnderzooming+Ot.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new t.ProgramConfiguration,this.crossTileSymbolIndex=new Re,this.gpuTimers={}};function pr(t,e){if(t.y>e.y){var n=t;t=e,e=n}return{x0:t.x,y0:t.y,x1:e.x,y1:e.y,dx:e.x-t.x,dy:e.y-t.y}}function fr(t,e,n,r,i){var o=Math.max(n,Math.floor(e.y0)),a=Math.min(r,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var u=t.dx/t.dy,c=e.dx/e.dy,l=t.dx>0,h=e.dx<0,p=o;p<a;p++){var f=u*Math.max(0,Math.min(t.dy,p+l-t.y0))+t.x0,d=c*Math.max(0,Math.min(e.dy,p+h-e.y0))+e.x0;i(Math.floor(d),Math.ceil(f),p)}}function dr(t,e,n,r,i,o){var a,s=pr(t,e),u=pr(e,n),c=pr(n,t);s.dy>u.dy&&(a=s,s=u,u=a),s.dy>c.dy&&(a=s,s=c,c=a),u.dy>c.dy&&(a=u,u=c,c=a),s.dy&&fr(c,s,r,i,o),u.dy&&fr(c,u,r,i,o)}hr.prototype.resize=function(e,n){var r=this.context.gl;if(this.width=e*t.browser.devicePixelRatio,this.height=n*t.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,o=this.style._order;i<o.length;i+=1){var a=o[i];this.style._layers[a].resize()}this.depthRbo&&(r.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},hr.prototype.setup=function(){var e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,ze.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);var r=new t.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(r,ze.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);var i=new t.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(i,t.rasterBoundsAttributes.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);var o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,ze.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);var a=new t.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(a);var s=new t.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);var u=this.context.gl;this.stencilClearMode=new Ct({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)},hr.prototype.clearStencil=function(){var e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var r=t.create();t.ortho(r,0,this.width,this.height,0,0,1),t.scale(r,r,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,St.disabled,this.stencilClearMode,It.disabled,kt.disabled,kn(r),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},hr.prototype._renderTileClippingMasks=function(t,e){if(this.currentStencilSource!==t.source&&t.isTileClipped()&&e&&e.length){this.currentStencilSource=t.source;var n=this.context,r=n.gl;this.nextStencilID+e.length>256&&this.clearStencil(),n.setColorMode(It.disabled),n.setDepthMode(St.disabled);var i=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var o=0,a=e;o<a.length;o+=1){var s=a[o],u=this._tileClippingMaskIDs[s.key]=this.nextStencilID++;i.draw(n,r.TRIANGLES,St.disabled,new Ct({func:r.ALWAYS,mask:0},u,255,r.KEEP,r.KEEP,r.REPLACE),It.disabled,kt.disabled,kn(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},hr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var t=this.nextStencilID++,e=this.context.gl;return new Ct({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)},hr.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new Ct({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},hr.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new It([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?It.unblended:It.alphaBlended},hr.prototype.depthModeForSublayer=function(t,e,n){if(!this.opaquePassEnabledForLayer())return St.disabled;var r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new St(n||this.context.gl.LEQUAL,e,[r,r])},hr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},hr.prototype.render=function(e,n){var r=this;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.browser.now()),this.imageManager.beginFrame();var i=this.style._order,o=this.style.sourceCaches;for(var a in o){var s=o[a];s.used&&s.prepare(this.context)}var u,c,l={},h={},p={};for(var f in o){var d=o[f];l[f]=d.getVisibleCoordinates(),h[f]=l[f].slice().reverse(),p[f]=d.getVisibleCoordinates(!0).reverse()}for(var m in o){var y=o[m],g=y.getSource();if("raster"===g.type||"raster-dem"===g.type){for(var v=[],_=0,b=l[m];_<b.length;_+=1){var w=b[_];v.push(y.getTile(w))}Kn(v,this.context)}}this.opaquePassCutoff=1/0;for(var x=0;x<i.length;x++){var E=i[x];if(this.style._layers[E].is3D()){this.opaquePassCutoff=x;break}}this.renderPass="offscreen",this.depthRboNeedsClear=!0;for(var T=0,S=i;T<S.length;T+=1){var C=S[T],I=this.style._layers[C];if(I.hasOffscreenPass()&&!I.isHidden(this.transform.zoom)){var k=h[I.source];("custom"===I.type||k.length)&&this.renderLayer(this,o[I.source],I,k)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){var A=this.style._layers[i[this.currentLayer]],O=o[A.source],P=l[A.source];this._renderTileClippingMasks(A,P),this.renderLayer(this,O,A,P)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){var D=this.style._layers[i[this.currentLayer]],M=o[D.source],R=("symbol"===D.type?p:h)[D.source];this._renderTileClippingMasks(D,l[D.source]),this.renderLayer(this,M,D,R)}this.options.showTileBoundaries&&(t.values(this.style._layers).forEach((function(t){t.source&&!t.isHidden(r.transform.zoom)&&(t.source!==(c&&c.id)&&(c=r.style.sourceCaches[t.source]),(!u||u.getSource().maxzoom<c.getSource().maxzoom)&&(u=c))})),u&&lr.debug(this,u,u.getVisibleCoordinates())),this.context.setDefault()},hr.prototype.setupOffscreenDepthRenderbuffer=function(){var t=this.context;this.depthRbo||(this.depthRbo=t.createRenderbuffer(t.gl.DEPTH_COMPONENT16,this.width,this.height))},hr.prototype.renderLayer=function(t,e,n,r){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||r.length)&&(this.id=n.id,this.gpuTimingStart(n),lr[n.type](t,e,n,r,this.style.placement.variableOffsets),this.gpuTimingEnd())},hr.prototype.gpuTimingStart=function(t){if(this.options.gpuTiming){var e=this.context.extTimerQuery,n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}},hr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}},hr.prototype.collectGpuTimers=function(){var t=this.gpuTimers;return this.gpuTimers={},t},hr.prototype.queryGpuTimers=function(t){var e={};for(var n in t){var r=t[n],i=this.context.extTimerQuery,o=i.getQueryObjectEXT(r.query,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(r.query),e[n]=o}return e},hr.prototype.translatePosMatrix=function(e,n,r,i,o){if(!r[0]&&!r[1])return e;var a=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){var s=Math.sin(a),u=Math.cos(a);r=[r[0]*u-r[1]*s,r[0]*s+r[1]*u]}var c=[o?r[0]:ce(n,r[0],this.transform.zoom),o?r[1]:ce(n,r[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,c),l},hr.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},hr.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},hr.prototype.isPatternMissing=function(t){if(!t)return!1;var e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n},hr.prototype.useProgram=function(t,e){void 0===e&&(e=this.emptyProgramConfiguration),this.cache=this.cache||{};var n=""+t+(e.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new yn(this.context,dn[t],e,Hn[t],this._showOverdrawInspector)),this.cache[n]},hr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},hr.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)};var mr=function(e,n,r,i,o){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===o||o,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==r?0:r,this._maxPitch=null==i?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},yr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};mr.prototype.clone=function(){var t=new mr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._calcMatrices(),t},yr.minZoom.get=function(){return this._minZoom},yr.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},yr.maxZoom.get=function(){return this._maxZoom},yr.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},yr.minPitch.get=function(){return this._minPitch},yr.minPitch.set=function(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))},yr.maxPitch.get=function(){return this._maxPitch},yr.maxPitch.set=function(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))},yr.renderWorldCopies.get=function(){return this._renderWorldCopies},yr.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},yr.worldSize.get=function(){return this.tileSize*this.scale},yr.centerPoint.get=function(){return this.size._div(2)},yr.size.get=function(){return new t.Point(this.width,this.height)},yr.bearing.get=function(){return-this.angle/Math.PI*180},yr.bearing.set=function(e){var n=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=t.create$2(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},yr.pitch.get=function(){return this._pitch/Math.PI*180},yr.pitch.set=function(e){var n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())},yr.fov.get=function(){return this._fov/Math.PI*180},yr.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},yr.zoom.get=function(){return this._zoom},yr.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},yr.center.get=function(){return this._center},yr.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},mr.prototype.coveringZoomLevel=function(t){var e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)},mr.prototype.getVisibleUnwrappedCoordinates=function(e){var n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var r=this.pointCoordinate(new t.Point(0,0)),i=this.pointCoordinate(new t.Point(this.width,0)),o=this.pointCoordinate(new t.Point(this.width,this.height)),a=this.pointCoordinate(new t.Point(0,this.height)),s=Math.floor(Math.min(r.x,i.x,o.x,a.x)),u=Math.floor(Math.max(r.x,i.x,o.x,a.x)),c=s-1;c<=u+1;c++)0!==c&&n.push(new t.UnwrappedTileID(c,e));return n},mr.prototype.coveringTiles=function(e){var n=this.coveringZoomLevel(e),r=n;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);var i=t.MercatorCoordinate.fromLngLat(this.center),o=Math.pow(2,n),a=new t.Point(o*i.x-.5,o*i.y-.5);return function(e,n,r,i){void 0===i&&(i=!0);var o=1<<e,a={};function s(n,s,u){var c,l,h,p;if(u>=0&&u<=o)for(c=n;c<s;c++)l=Math.floor(c/o),h=(c%o+o)%o,0!==l&&!0!==i||(p=new t.OverscaledTileID(r,l,e,h,u),a[p.key]=p)}var u=n.map((function(e){return new t.Point(e.x,e.y)._mult(o)}));return dr(u[0],u[1],u[2],0,o,s),dr(u[2],u[3],u[0],0,o,s),Object.keys(a).map((function(t){return a[t]}))}(n,[this.pointCoordinate(new t.Point(0,0)),this.pointCoordinate(new t.Point(this.width,0)),this.pointCoordinate(new t.Point(this.width,this.height)),this.pointCoordinate(new t.Point(0,this.height))],e.reparseOverscaled?r:n,this._renderWorldCopies).sort((function(t,e){return a.dist(t.canonical)-a.dist(e.canonical)}))},mr.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},yr.unmodified.get=function(){return this._unmodified},mr.prototype.zoomScale=function(t){return Math.pow(2,t)},mr.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},mr.prototype.project=function(e){var n=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.Point(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(n)*this.worldSize)},mr.prototype.unproject=function(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()},yr.point.get=function(){return this.project(this.center)},mr.prototype.setLocationAtPoint=function(e,n){var r=this.pointCoordinate(n),i=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(e),a=new t.MercatorCoordinate(o.x-(r.x-i.x),o.y-(r.y-i.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())},mr.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},mr.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},mr.prototype.locationCoordinate=function(e){return t.MercatorCoordinate.fromLngLat(e)},mr.prototype.coordinateLocation=function(t){return t.toLngLat()},mr.prototype.pointCoordinate=function(e){var n=[e.x,e.y,0,1],r=[e.x,e.y,1,1];t.transformMat4(n,n,this.pixelMatrixInverse),t.transformMat4(r,r,this.pixelMatrixInverse);var i=n[3],o=r[3],a=n[0]/i,s=r[0]/o,u=n[1]/i,c=r[1]/o,l=n[2]/i,h=r[2]/o,p=l===h?0:(0-l)/(h-l);return new t.MercatorCoordinate(t.number(a,s,p)/this.worldSize,t.number(u,c,p)/this.worldSize)},mr.prototype.coordinatePoint=function(e){var n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix),new t.Point(n[0]/n[3],n[1]/n[3])},mr.prototype.getBounds=function(){return(new t.LngLatBounds).extend(this.pointLocation(new t.Point(0,0))).extend(this.pointLocation(new t.Point(this.width,0))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))},mr.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},mr.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},mr.prototype.calculatePosMatrix=function(e,n){void 0===n&&(n=!1);var r=e.key,i=n?this._alignedPosMatrixCache:this._posMatrixCache;if(i[r])return i[r];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,u=t.identity(new Float64Array(16));return t.translate(u,u,[s*a,o.y*a,0]),t.scale(u,u,[a/t.EXTENT,a/t.EXTENT,1]),t.multiply(u,n?this.alignedProjMatrix:this.projMatrix,u),i[r]=new Float32Array(u),i[r]},mr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},mr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,n,r,i,o=-90,a=90,s=-180,u=180,c=this.size,l=this._unmodified;if(this.latRange){var h=this.latRange;o=t.mercatorYfromLat(h[1])*this.worldSize,e=(a=t.mercatorYfromLat(h[0])*this.worldSize)-o<c.y?c.y/(a-o):0}if(this.lngRange){var p=this.lngRange;s=t.mercatorXfromLng(p[0])*this.worldSize,n=(u=t.mercatorXfromLng(p[1])*this.worldSize)-s<c.x?c.x/(u-s):0}var f=this.point,d=Math.max(n||0,e||0);if(d)return this.center=this.unproject(new t.Point(n?(u+s)/2:f.x,e?(a+o)/2:f.y)),this.zoom+=this.scaleZoom(d),this._unmodified=l,void(this._constraining=!1);if(this.latRange){var m=f.y,y=c.y/2;m-y<o&&(i=o+y),m+y>a&&(i=a-y)}if(this.lngRange){var g=f.x,v=c.x/2;g-v<s&&(r=s+v),g+v>u&&(r=u-v)}void 0===r&&void 0===i||(this.center=this.unproject(new t.Point(void 0!==r?r:f.x,void 0!==i?i:f.y))),this._unmodified=l,this._constraining=!1}},mr.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var e=this._fov/2,n=Math.PI/2+this._pitch,r=Math.sin(e)*this.cameraToCenterDistance/Math.sin(Math.PI-n-e),i=this.point,o=i.x,a=i.y,s=1.01*(Math.cos(Math.PI/2-this._pitch)*r+this.cameraToCenterDistance),u=this.height/50,c=new Float64Array(16);t.perspective(c,this._fov,this.width/this.height,u,s),t.scale(c,c,[1,-1,1]),t.translate(c,c,[0,0,-this.cameraToCenterDistance]),t.rotateX(c,c,this._pitch),t.rotateZ(c,c,this.angle),t.translate(c,c,[-o,-a,0]),this.mercatorMatrix=t.scale([],c,[this.worldSize,this.worldSize,this.worldSize]),t.scale(c,c,[1,1,t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=c;var l=this.width%2/2,h=this.height%2/2,p=Math.cos(this.angle),f=Math.sin(this.angle),d=o-Math.round(o)+p*l+f*h,m=a-Math.round(a)+p*h+f*l,y=new Float64Array(c);if(t.translate(y,y,[d>.5?d-1:d,m>.5?m-1:m,0]),this.alignedProjMatrix=y,c=t.create(),t.scale(c,c,[this.width/2,-this.height/2,1]),t.translate(c,c,[1,-1,0]),this.labelPlaneMatrix=c,c=t.create(),t.scale(c,c,[1,-1,1]),t.translate(c,c,[-1,-1,0]),t.scale(c,c,[2/this.width,2/this.height,1]),this.glCoordMatrix=c,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(c=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=c,this._posMatrixCache={},this._alignedPosMatrixCache={}}},mr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.Point(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance},mr.prototype.getCameraPoint=function(){var e=this._pitch,n=Math.tan(e)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,n))},mr.prototype.getCameraQueryGeometry=function(e){var n=this.getCameraPoint();if(1===e.length)return[e[0],n];for(var r=n.x,i=n.y,o=n.x,a=n.y,s=0,u=e;s<u.length;s+=1){var c=u[s];r=Math.min(r,c.x),i=Math.min(i,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y)}return[new t.Point(r,i),new t.Point(o,i),new t.Point(o,a),new t.Point(r,a),new t.Point(r,i)]},Object.defineProperties(mr.prototype,yr);var gr=function(e){var n,r,i,o;this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),r=!1,i=null,o=function(){i=null,r&&(n(),i=setTimeout(o,300),r=!1)},function(){return r=!0,i||o(),i})};gr.prototype.addTo=function(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},gr.prototype.remove=function(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},gr.prototype.getHashString=function(e){var n=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,i=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,i),a=Math.round(n.lng*o)/o,s=Math.round(n.lat*o)/o,u=this._map.getBearing(),c=this._map.getPitch(),l="";if(l+=e?"/"+a+"/"+s+"/"+r:r+"/"+s+"/"+a,(u||c)&&(l+="/"+Math.round(10*u)/10),c&&(l+="/"+Math.round(c)),this._hashName){var h=this._hashName,p=!1,f=t.window.location.hash.slice(1).split("&").map((function(t){var e=t.split("=")[0];return e===h?(p=!0,e+"="+l):t})).filter((function(t){return t}));return p||f.push(h+"="+l),"#"+f.join("&")}return"#"+l},gr.prototype._getCurrentHash=function(){var e,n=this,r=t.window.location.hash.replace("#","");return this._hashName?(r.split("&").map((function(t){return t.split("=")})).forEach((function(t){t[0]===n._hashName&&(e=t)})),(e&&e[1]||"").split("/")):r.split("/")},gr.prototype._onHashChange=function(){var t=this._getCurrentHash();return t.length>=3&&!t.some((function(t){return isNaN(t)}))&&(this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:+(t[3]||0),pitch:+(t[4]||0)}),!0)},gr.prototype._updateHashUnthrottled=function(){var e=this.getHashString();try{t.window.history.replaceState(t.window.history.state,"",e)}catch(t){}};var vr=function(e){function r(r,i,o,a){void 0===a&&(a={});var s=n.mousePos(i.getCanvasContainer(),o),u=i.unproject(s);e.call(this,r,t.extend({point:s,lngLat:u,originalEvent:o},a)),this._defaultPrevented=!1,this.target=i}e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(t.Event),_r=function(e){function r(r,i,o){var a=n.touchPos(i.getCanvasContainer(),o),s=a.map((function(t){return i.unproject(t)})),u=a.reduce((function(t,e,n,r){return t.add(e.div(r.length))}),new t.Point(0,0)),c=i.unproject(u);e.call(this,r,{points:a,point:u,lngLats:s,lngLat:c,originalEvent:o}),this._defaultPrevented=!1}e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(t.Event),br=function(t){function e(e,n,r){t.call(this,e,{originalEvent:r}),this._defaultPrevented=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,n),e}(t.Event),wr=function(e){this._map=e,this._el=e.getCanvasContainer(),this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};wr.prototype.setZoomRate=function(t){this._defaultZoomRate=t},wr.prototype.setWheelZoomRate=function(t){this._wheelZoomRate=t},wr.prototype.isEnabled=function(){return!!this._enabled},wr.prototype.isActive=function(){return!!this._active},wr.prototype.isZooming=function(){return!!this._zooming},wr.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},wr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},wr.prototype.onWheel=function(e){if(this.isEnabled()){var n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,r=t.browser.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==n&&n%4.000244140625==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(i*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this.isActive()||this._start(e)),e.preventDefault()}},wr.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(t)},wr.prototype._start=function(e){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0,this._map.fire(new t.Event("movestart",{originalEvent:e})),this._map.fire(new t.Event("zoomstart",{originalEvent:e}))),this._finishTimeout&&clearTimeout(this._finishTimeout);var r=n.mousePos(this._el,e);this._around=t.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(r)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},wr.prototype._onScrollFrame=function(){var e=this;if(this._frameId=null,this.isActive()){var n=this._map.transform;if(0!==this._delta){var r="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,i=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==i&&(i=1/i);var o="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a="number"==typeof this._targetZoom?this._targetZoom:n.zoom,s=this._startZoom,u=this._easing,c=!1;if("wheel"===this._type&&s&&u){var l=Math.min((t.browser.now()-this._lastWheelEventTime)/200,1),h=u(l);n.zoom=t.number(s,a,h),l<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):c=!0}else n.zoom=a,c=!0;n.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new t.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new t.Event("zoom",{originalEvent:this._lastWheelEvent})),c&&(this._active=!1,this._finishTimeout=setTimeout((function(){e._zooming=!1,e._map.fire(new t.Event("zoomend",{originalEvent:e._lastWheelEvent})),e._map.fire(new t.Event("moveend",{originalEvent:e._lastWheelEvent})),delete e._targetZoom}),200))}},wr.prototype._smoothOutEasing=function(e){var n=t.ease;if(this._prevEase){var r=this._prevEase,i=(t.browser.now()-r.start)/r.duration,o=r.easing(i+.01)-r.easing(i),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);n=t.bezier(a,s,.25,1)}return this._prevEase={start:t.browser.now(),duration:e,easing:n},n};var xr=function(e,n){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1,t.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};xr.prototype.isEnabled=function(){return!!this._enabled},xr.prototype.isActive=function(){return!!this._active},xr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},xr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},xr.prototype.onMouseDown=function(e){this.isEnabled()&&e.shiftKey&&0===e.button&&(t.window.document.addEventListener("mousemove",this._onMouseMove,!1),t.window.document.addEventListener("keydown",this._onKeyDown,!1),t.window.document.addEventListener("mouseup",this._onMouseUp,!1),n.disableDrag(),this._startPos=this._lastPos=n.mousePos(this._el,e),this._active=!0)},xr.prototype._onMouseMove=function(t){var e=n.mousePos(this._el,t);if(!(this._lastPos.equals(e)||!this._box&&e.dist(this._startPos)<this._clickTolerance)){var r=this._startPos;this._lastPos=e,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var i=Math.min(r.x,e.x),o=Math.max(r.x,e.x),a=Math.min(r.y,e.y),s=Math.max(r.y,e.y);n.setTransform(this._box,"translate("+i+"px,"+a+"px)"),this._box.style.width=o-i+"px",this._box.style.height=s-a+"px"}},xr.prototype._onMouseUp=function(e){if(0===e.button){var r=this._startPos,i=n.mousePos(this._el,e);this._finish(),n.suppressClick(),r.x===i.x&&r.y===i.y?this._fireEvent("boxzoomcancel",e):this._map.fitScreenCoordinates(r,i,this._map.getBearing(),{linear:!0}).fire(new t.Event("boxzoomend",{originalEvent:e}))}},xr.prototype._onKeyDown=function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},xr.prototype._finish=function(){this._active=!1,t.window.document.removeEventListener("mousemove",this._onMouseMove,!1),t.window.document.removeEventListener("keydown",this._onKeyDown,!1),t.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},xr.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))};var Er=t.bezier(0,0,.25,1),Tr=function(e,n){this._map=e,this._el=n.element||e.getCanvasContainer(),this._state="disabled",this._button=n.button||"right",this._bearingSnap=n.bearingSnap||0,this._pitchWithRotate=!1!==n.pitchWithRotate,t.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};Tr.prototype.isEnabled=function(){return"disabled"!==this._state},Tr.prototype.isActive=function(){return"active"===this._state},Tr.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},Tr.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Tr.prototype.onMouseDown=function(e){if("enabled"===this._state){var r="touchstart"===e.type;if(r)this._startTime=Date.now();else if("right"===this._button){if(this._eventButton=n.mouseButton(e),this._eventButton!==(e.ctrlKey?0:2))return}else{if(e.ctrlKey||0!==n.mouseButton(e))return;this._eventButton=0}n.disableDrag(),r?(t.window.document.addEventListener("touchmove",this._onMouseMove,{capture:!0}),t.window.document.addEventListener("touchend",this._onMouseUp)):(t.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),t.window.document.addEventListener("mouseup",this._onMouseUp)),t.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[t.browser.now(),this._map.getBearing()]],this._startPos=this._prevPos=this._lastPos=n.mousePos(this._el,e),this._center=this._map.transform.centerPoint,e.preventDefault()}},Tr.prototype._onMouseMove=function(t){var e=n.mousePos(this._el,t);this._lastPos.equals(e)||(this._lastMoveEvent=t,this._lastPos=e,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},Tr.prototype._onDragFrame=function(){this._frameId=null;var e=this._lastMoveEvent;if(e){var n=this._map.transform,r=this._prevPos,i=this._lastPos,o=.8*(r.x-i.x),a=-.5*(r.y-i.y),s=n.bearing-o,u=n.pitch-a,c=this._inertia,l=c[c.length-1];this._drainInertiaBuffer(),c.push([t.browser.now(),this._map._normalizeBearing(s,l[1])]);var h=n.bearing;if(n.bearing=s,this._pitchWithRotate){var p=n.pitch;n.pitch=u,n.pitch!==p&&this._fireEvent("pitch",e)}n.bearing!==h&&this._fireEvent("rotate",e),this._fireEvent("move",e),delete this._lastMoveEvent,this._prevPos=this._lastPos}},Tr.prototype._onMouseUp=function(t){if("touchend"===t.type&&this._startPos===this._lastPos&&Date.now()-this._startTime<300&&this._el.click(),n.mouseButton(t)===this._eventButton)switch(this._state){case"active":this._state="enabled",n.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(t);break;case"pending":this._state="enabled",this._unbind()}},Tr.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",t),this._pitchWithRotate&&this._fireEvent("pitchend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},Tr.prototype._unbind=function(){t.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),t.window.document.removeEventListener("mouseup",this._onMouseUp),t.window.document.removeEventListener("touchmove",this._onMouseMove,{capture:!0}),t.window.document.removeEventListener("touchend",this._onMouseUp),t.window.removeEventListener("blur",this._onBlur),n.enableDrag()},Tr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._prevPos,delete this._lastPos},Tr.prototype._inertialRotate=function(t){var e=this;this._fireEvent("rotateend",t),this._drainInertiaBuffer();var n=this._map,r=n.getBearing(),i=this._inertia,o=function(){Math.abs(r)<e._bearingSnap?n.resetNorth({noMoveStart:!0},{originalEvent:t}):e._fireEvent("moveend",t),e._pitchWithRotate&&e._fireEvent("pitchend",t)};if(i.length<2)o();else{var a=i[0],s=i[i.length-1],u=i[i.length-2],c=n._normalizeBearing(r,u[1]),l=s[1]-a[1],h=l<0?-1:1,p=(s[0]-a[0])/1e3;if(0!==l&&0!==p){var f=Math.abs(l*(.25/p));f>180&&(f=180);var d=f/180;c+=h*f*(d/2),Math.abs(n._normalizeBearing(c,0))<this._bearingSnap&&(c=n._normalizeBearing(0,c)),n.rotateTo(c,{duration:1e3*d,easing:Er,noMoveStart:!0},{originalEvent:t})}else o()}},Tr.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},Tr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.browser.now();e.length>0&&n-e[0][0]>160;)e.shift()};var Sr={linearity:.3,easing:t.bezier(0,0,.3,1),maxSpeed:1400,deceleration:2500},Cr=function(e,n){this._map=e,this._el=e.getCanvasContainer(),this._state="disabled",this._clickTolerance=n.clickTolerance||1,this._inertiaOptions=Sr,t.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};Cr.prototype.isEnabled=function(){return"disabled"!==this._state},Cr.prototype.isActive=function(){return"active"===this._state},Cr.prototype.enable=function(e){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled",this._inertiaOptions=t.extend(Sr,e))},Cr.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Cr.prototype.onMouseDown=function(e){"enabled"===this._state&&(e.ctrlKey||0!==n.mouseButton(e)||(n.addEventListener(t.window.document,"mousemove",this._onMove,{capture:!0}),n.addEventListener(t.window.document,"mouseup",this._onMouseUp),this._start(e)))},Cr.prototype.onTouchStart=function(e){this.isEnabled()&&(e.touches&&e.touches.length>1&&("pending"===this._state||"active"===this._state)||(n.addEventListener(t.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),n.addEventListener(t.window.document,"touchend",this._onTouchEnd),this._start(e)))},Cr.prototype._start=function(e){t.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._prevPos=this._lastPos=n.mousePos(this._el,e),this._startTouch=this._lastTouch=t.window.TouchEvent&&e instanceof t.window.TouchEvent?n.touchPos(this._el,e):null,this._inertia=[[t.browser.now(),this._startPos]]},Cr.prototype._touchesMatch=function(t,e){return!(!t||!e||t.length!==e.length)&&t.every((function(t,n){return e[n]===t}))},Cr.prototype._onMove=function(e){e.preventDefault();var r=t.window.TouchEvent&&e instanceof t.window.TouchEvent?n.touchPos(this._el,e):null,i=n.mousePos(this._el,e);(r?this._touchesMatch(this._lastTouch,r):this._lastPos.equals(i))||"pending"===this._state&&i.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=e,this._lastPos=i,this._lastTouch=r,this._drainInertiaBuffer(),this._inertia.push([t.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._shouldStart=!0),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},Cr.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t)if(this._map.touchZoomRotate.isActive())this._abort(t);else if(this._shouldStart&&(this._fireEvent("dragstart",t),this._fireEvent("movestart",t),this._shouldStart=!1),this.isActive()){var e=this._map.transform;e.setLocationAtPoint(e.pointLocation(this._prevPos),this._lastPos),this._fireEvent("drag",t),this._fireEvent("move",t),this._prevPos=this._lastPos,delete this._lastMoveEvent}},Cr.prototype._onMouseUp=function(t){if(0===n.mouseButton(t))switch(this._state){case"active":this._state="enabled",n.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},Cr.prototype._onTouchEnd=function(t){if(t.touches&&0!==t.touches.length)switch(this._state){case"pending":case"active":break;case"enabled":this.onTouchStart(t)}else switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind();break;case"enabled":this._unbind()}},Cr.prototype._abort=function(e){switch(this._state){case"active":this._state="enabled",this._shouldStart||(this._fireEvent("dragend",e),this._fireEvent("moveend",e)),this._unbind(),this._deactivate(),t.window.TouchEvent&&e instanceof t.window.TouchEvent&&e.touches.length>1&&n.addEventListener(t.window.document,"touchend",this._onTouchEnd);break;case"pending":this._state="enabled",this._unbind();break;case"enabled":this._unbind()}},Cr.prototype._onBlur=function(t){this._abort(t)},Cr.prototype._unbind=function(){n.removeEventListener(t.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),n.removeEventListener(t.window.document,"touchend",this._onTouchEnd),n.removeEventListener(t.window.document,"mousemove",this._onMove,{capture:!0}),n.removeEventListener(t.window.document,"mouseup",this._onMouseUp),n.removeEventListener(t.window,"blur",this._onBlur)},Cr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._prevPos,delete this._mouseDownPos,delete this._lastPos,delete this._startTouch,delete this._lastTouch,delete this._shouldStart},Cr.prototype._inertialPan=function(t){this._fireEvent("dragend",t),this._drainInertiaBuffer();var e=this._inertia;if(e.length<2)this._fireEvent("moveend",t);else{var n=e[e.length-1],r=e[0],i=n[1].sub(r[1]),o=(n[0]-r[0])/1e3;if(0===o||n[1].equals(r[1]))this._fireEvent("moveend",t);else{var a=this._inertiaOptions,s=a.linearity,u=a.easing,c=a.maxSpeed,l=a.deceleration,h=i.mult(s/o),p=h.mag();p>c&&(p=c,h._unit()._mult(p));var f=p/(l*s),d=h.mult(-f/2);this._map.panBy(d,{duration:1e3*f,easing:u,noMoveStart:!0},{originalEvent:t})}}},Cr.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},Cr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.browser.now();e.length>0&&n-e[0][0]>160;)e.shift()};var Ir=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onKeyDown"],this)};function kr(t){return t*(2-t)}Ir.prototype.isEnabled=function(){return!!this._enabled},Ir.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},Ir.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},Ir.prototype._onKeyDown=function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=0,n=0,r=0,i=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),i=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),i=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?r=-1:(o=1,t.preventDefault());break;default:return}var a=this._map,s=a.getZoom(),u={duration:300,delayEndEvents:500,easing:kr,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:a.getBearing()+15*n,pitch:a.getPitch()+10*r,offset:[100*-i,100*-o],center:a.getCenter()};a.easeTo(u,{originalEvent:t})}};var Ar=function(e){this._map=e,t.bindAll(["_onDblClick","_onZoomEnd"],this)};Ar.prototype.isEnabled=function(){return!!this._enabled},Ar.prototype.isActive=function(){return!!this._active},Ar.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Ar.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ar.prototype.onTouchStart=function(t){var e=this;if(this.isEnabled()&&!(t.points.length>1))if(this._tapped){var n=t.points[0],r=this._tappedPoint;if(r&&r.dist(n)<=30){t.originalEvent.preventDefault();var i=function(){e._tapped&&e._zoom(t),e._map.off("touchcancel",o),e._resetTapped()},o=function(){e._map.off("touchend",i),e._resetTapped()};this._map.once("touchend",i),this._map.once("touchcancel",o)}else this._resetTapped()}else this._tappedPoint=t.points[0],this._tapped=setTimeout((function(){e._tapped=null,e._tappedPoint=null}),300)},Ar.prototype._resetTapped=function(){clearTimeout(this._tapped),this._tapped=null,this._tappedPoint=null},Ar.prototype.onDblClick=function(t){this.isEnabled()&&(t.originalEvent.preventDefault(),this._zoom(t))},Ar.prototype._zoom=function(t){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)},Ar.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var Or=t.bezier(0,0,.15,1),Pr=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};Pr.prototype.isEnabled=function(){return!!this._enabled},Pr.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)},Pr.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},Pr.prototype.disableRotation=function(){this._rotationDisabled=!0},Pr.prototype.enableRotation=function(){this._rotationDisabled=!1},Pr.prototype.isActive=function(){return this.isEnabled()&&!!this._gestureIntent},Pr.prototype.onStart=function(e){if(this.isEnabled()&&2===e.touches.length){var r=n.mousePos(this._el,e.touches[0]),i=n.mousePos(this._el,e.touches[1]),o=r.add(i).div(2);this._startVec=r.sub(i),this._startAround=this._map.transform.pointLocation(o),this._gestureIntent=void 0,this._inertia=[],n.addEventListener(t.window.document,"touchmove",this._onMove,{passive:!1}),n.addEventListener(t.window.document,"touchend",this._onEnd)}},Pr.prototype._getTouchEventData=function(t){var e=n.mousePos(this._el,t.touches[0]),r=n.mousePos(this._el,t.touches[1]),i=e.sub(r);return{vec:i,center:e.add(r).div(2),scale:i.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*i.angleWith(this._startVec)/Math.PI}},Pr.prototype._onMove=function(e){if(2===e.touches.length){var n=this._getTouchEventData(e),r=n.vec,i=n.scale,o=n.bearing;if(!this._gestureIntent){var a=this._rotationDisabled&&1!==i||Math.abs(1-i)>.15;Math.abs(o)>10?this._gestureIntent="rotate":a&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new t.Event(this._gestureIntent+"start",{originalEvent:e})),this._map.fire(new t.Event("movestart",{originalEvent:e})),this._startVec=r)}this._lastTouchEvent=e,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),e.preventDefault()}},Pr.prototype._onTouchFrame=function(){this._frameId=null;var e=this._gestureIntent;if(e){var n=this._map.transform;this._startScale||(this._startScale=n.scale,this._startBearing=n.bearing);var r=this._getTouchEventData(this._lastTouchEvent),i=r.center,o=r.bearing,a=r.scale,s=n.pointLocation(i),u=n.locationPoint(s);"rotate"===e&&(n.bearing=this._startBearing+o),n.zoom=n.scaleZoom(this._startScale*a),n.setLocationAtPoint(this._startAround,u),this._map.fire(new t.Event(e,{originalEvent:this._lastTouchEvent})),this._map.fire(new t.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([t.browser.now(),a,i])}},Pr.prototype._onEnd=function(e){n.removeEventListener(t.window.document,"touchmove",this._onMove,{passive:!1}),n.removeEventListener(t.window.document,"touchend",this._onEnd);var r=this._gestureIntent,i=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,r){this._map.fire(new t.Event(r+"end",{originalEvent:e})),this._drainInertiaBuffer();var o=this._inertia,a=this._map;if(o.length<2)a.snapToNorth({},{originalEvent:e});else{var s=o[o.length-1],u=o[0],c=a.transform.scaleZoom(i*s[1]),l=a.transform.scaleZoom(i*u[1]),h=c-l,p=(s[0]-u[0])/1e3,f=s[2];if(0!==p&&c!==l){var d=.15*h/p;Math.abs(d)>2.5&&(d=d>0?2.5:-2.5);var m=1e3*Math.abs(d/(12*.15)),y=c+d*m/2e3;a.easeTo({zoom:y,duration:m,easing:Or,around:this._aroundCenter?a.getCenter():a.unproject(f),noMoveStart:!0},{originalEvent:e})}else a.snapToNorth({},{originalEvent:e})}}},Pr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.browser.now();e.length>2&&n-e[0][0]>160;)e.shift()};var Dr={scrollZoom:wr,boxZoom:xr,dragRotate:Tr,dragPan:Cr,keyboard:Ir,doubleClickZoom:Ar,touchZoomRotate:Pr},Mr=function(e){function n(n,r){e.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=r.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getCenter=function(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)},n.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},n.prototype.panBy=function(e,n,r){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),r)},n.prototype.panTo=function(e,n,r){return this.easeTo(t.extend({center:e},n),r)},n.prototype.getZoom=function(){return this.transform.zoom},n.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},n.prototype.zoomTo=function(e,n,r){return this.easeTo(t.extend({zoom:e},n),r)},n.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},n.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},n.prototype.getBearing=function(){return this.transform.bearing},n.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},n.prototype.rotateTo=function(e,n,r){return this.easeTo(t.extend({bearing:e},n),r)},n.prototype.resetNorth=function(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this},n.prototype.resetNorthPitch=function(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this},n.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},n.prototype.getPitch=function(){return this.transform.pitch},n.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},n.prototype.cameraForBounds=function(e,n){return e=t.LngLatBounds.convert(e),this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),0,n)},n.prototype._cameraForBoxAndBearing=function(e,n,r,i){if("number"==typeof(i=t.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){var o=i.padding;i.padding={top:o,bottom:o,right:o,left:o}}if(t.deepEqual(Object.keys(i.padding).sort((function(t,e){return t<e?-1:t>e?1:0})),["bottom","left","right","top"])){var a=this.transform,s=a.project(t.LngLat.convert(e)),u=a.project(t.LngLat.convert(n)),c=s.rotate(-r*Math.PI/180),l=u.rotate(-r*Math.PI/180),h=new t.Point(Math.max(c.x,l.x),Math.max(c.y,l.y)),p=new t.Point(Math.min(c.x,l.x),Math.min(c.y,l.y)),f=h.sub(p),d=(a.width-i.padding.left-i.padding.right)/f.x,m=(a.height-i.padding.top-i.padding.bottom)/f.y;if(!(m<0||d<0)){var y=Math.min(a.scaleZoom(a.scale*Math.min(d,m)),i.maxZoom),g=t.Point.convert(i.offset),v=(i.padding.left-i.padding.right)/2,_=(i.padding.top-i.padding.bottom)/2,b=new t.Point(g.x+v,g.y+_).mult(a.scale/a.zoomScale(y));return{center:a.unproject(s.add(u).div(2).sub(b)),zoom:y,bearing:r}}t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else t.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},n.prototype.fitBounds=function(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)},n.prototype.fitScreenCoordinates=function(e,n,r,i,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)),this.transform.pointLocation(t.Point.convert(n)),r,i),i,o)},n.prototype._fitInternal=function(e,n,r){return e?(n=t.extend(e,n)).linear?this.easeTo(n,r):this.flyTo(n,r):this},n.prototype.jumpTo=function(e,n){this.stop();var r=this.transform,i=!1,o=!1,a=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(i=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=t.LngLat.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(o=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(a=!0,r.pitch=+e.pitch),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),i&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),a&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))},n.prototype.easeTo=function(e,n){var r=this;this.stop(),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.browser.prefersReducedMotion)&&(e.duration=0);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),u="zoom"in e?+e.zoom:o,c="bearing"in e?this._normalizeBearing(e.bearing,a):a,l="pitch"in e?+e.pitch:s,h=i.centerPoint.add(t.Point.convert(e.offset)),p=i.pointLocation(h),f=t.LngLat.convert(e.center||p);this._normalizeCenter(f);var d,m,y=i.project(p),g=i.project(f).sub(y),v=i.zoomScale(u-o);return e.around&&(d=t.LngLat.convert(e.around),m=i.locationPoint(d)),this._zooming=u!==o,this._rotating=a!==c,this._pitching=l!==s,this._prepareEase(n,e.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease((function(e){if(r._zooming&&(i.zoom=t.number(o,u,e)),r._rotating&&(i.bearing=t.number(a,c,e)),r._pitching&&(i.pitch=t.number(s,l,e)),d)i.setLocationAtPoint(d,m);else{var p=i.zoomScale(i.zoom-o),f=u>o?Math.min(2,v):Math.max(.5,v),_=Math.pow(f,1-e),b=i.unproject(y.add(g.mult(e*_)).mult(p));i.setLocationAtPoint(i.renderWorldCopies?b.wrap():b,h)}r._fireMoveEvents(n)}),(function(){e.delayEndEvents?r._easeEndTimeoutID=setTimeout((function(){return r._afterEase(n)}),e.delayEndEvents):r._afterEase(n)}),e),this},n.prototype._prepareEase=function(e,n){this._moving=!0,n||this.fire(new t.Event("movestart",e)),this._zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&this.fire(new t.Event("pitchstart",e))},n.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},n.prototype._afterEase=function(e){var n=this._zooming,r=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,n&&this.fire(new t.Event("zoomend",e)),r&&this.fire(new t.Event("rotateend",e)),i&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))},n.prototype.flyTo=function(e,n){var r=this;if(!e.essential&&t.browser.prefersReducedMotion){var i=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var o=this.transform,a=this.getZoom(),s=this.getBearing(),u=this.getPitch(),c="zoom"in e?t.clamp(+e.zoom,o.minZoom,o.maxZoom):a,l="bearing"in e?this._normalizeBearing(e.bearing,s):s,h="pitch"in e?+e.pitch:u,p=o.zoomScale(c-a),f=o.centerPoint.add(t.Point.convert(e.offset)),d=o.pointLocation(f),m=t.LngLat.convert(e.center||d);this._normalizeCenter(m);var y=o.project(d),g=o.project(m).sub(y),v=e.curve,_=Math.max(o.width,o.height),b=_/p,w=g.mag();if("minZoom"in e){var x=t.clamp(Math.min(e.minZoom,a,c),o.minZoom,o.maxZoom),E=_/o.zoomScale(x-a);v=Math.sqrt(E/w*2)}var T=v*v;function S(t){var e=(b*b-_*_+(t?-1:1)*T*T*w*w)/(2*(t?b:_)*T*w);return Math.log(Math.sqrt(e*e+1)-e)}function C(t){return(Math.exp(t)-Math.exp(-t))/2}function I(t){return(Math.exp(t)+Math.exp(-t))/2}var k=S(0),A=function(t){return I(k)/I(k+v*t)},O=function(t){return _*((I(k)*(C(e=k+v*t)/I(e))-C(k))/T)/w;var e},P=(S(1)-k)/v;if(Math.abs(w)<1e-6||!isFinite(P)){if(Math.abs(_-b)<1e-6)return this.easeTo(e,n);var D=b<_?-1:1;P=Math.abs(Math.log(b/_))/v,O=function(){return 0},A=function(t){return Math.exp(D*v*t)}}if("duration"in e)e.duration=+e.duration;else{var M="screenSpeed"in e?+e.screenSpeed/v:+e.speed;e.duration=1e3*P/M}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=s!==l,this._pitching=h!==u,this._prepareEase(n,!1),this._ease((function(e){var i=e*P,p=1/A(i);o.zoom=1===e?c:a+o.scaleZoom(p),r._rotating&&(o.bearing=t.number(s,l,e)),r._pitching&&(o.pitch=t.number(u,h,e));var d=1===e?m:o.unproject(y.add(g.mult(O(i))).mult(p));o.setLocationAtPoint(o.renderWorldCopies?d.wrap():d,f),r._fireMoveEvents(n)}),(function(){return r._afterEase(n)}),e),this},n.prototype.isEasing=function(){return!!this._easeFrameId},n.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var t=this._onEaseEnd;delete this._onEaseEnd,t.call(this)}return this},n.prototype._ease=function(e,n,r){!1===r.animate||0===r.duration?(e(1),n()):(this._easeStart=t.browser.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},n.prototype._renderFrameCallback=function(){var e=Math.min((t.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},n.prototype._normalizeBearing=function(e,n){e=t.wrap(e,-180,180);var r=Math.abs(e-n);return Math.abs(e-360-n)<r&&(e-=360),Math.abs(e+360-n)<r&&(e+=360),e},n.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}},n}(t.Evented),Rr=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Rr.prototype.getDefaultPosition=function(){return"bottom-right"},Rr.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Rr.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Rr.prototype._updateEditLink=function(){var e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));var n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){var r=n.reduce((function(t,e,r){return e.value&&(t+=e.key+"="+e.value+(r<n.length-1?"&":"")),t}),"?");e.href=t.config.FEEDBACK_URL+"/"+r+(this._map._hash?this._map._hash.getHashString(!0):""),e.rel="noopener nofollow"}},Rr.prototype._updateData=function(t){!t||"metadata"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())},Rr.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((function(t){return"string"!=typeof t?"":t}))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var n=this._map.style.sourceCaches;for(var r in n){var i=n[r];if(i.used){var o=i.getSource();o.attribution&&t.indexOf(o.attribution)<0&&t.push(o.attribution)}}t.sort((function(t,e){return t.length-e.length}));var a=(t=t.filter((function(e,n){for(var r=n+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0}))).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,t.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Rr.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Nr=function(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)};Nr.prototype.onAdd=function(t){this._map=t,this._container=n.create("div","mapboxgl-ctrl");var e=n.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Nr.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Nr.prototype.getDefaultPosition=function(){return"bottom-left"},Nr.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Nr.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},Nr.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}};var Lr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Lr.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},Lr.prototype.remove=function(t){for(var e=this._currentlyRunning,n=0,r=e?this._queue.concat(e):this._queue;n<r.length;n+=1){var i=r[n];if(i.id===t)return void(i.cancelled=!0)}},Lr.prototype.run=function(){var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,n=t;e<n.length;e+=1){var r=n[e];if(!r.cancelled&&(r.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Lr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Fr={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},jr=t.window.HTMLImageElement,zr=t.window.HTMLElement,Br=0,Ur=60,Vr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:Br,maxPitch:Ur,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},qr=function(r){function i(e){var i=this;if(null!=(e=t.extend({},Vr,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<Br)throw new Error("minPitch must be greater than or equal to "+Br);if(null!=e.maxPitch&&e.maxPitch>Ur)throw new Error("maxPitch must be less than or equal to "+Ur);var o=new mr(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(r.call(this,o,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new Lr,this._controls=[],this._mapId=t.uniqueId(),this._locale=t.extend({},Fr,e.locale),this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken),"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else{if(!(e.container instanceof zr))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return i._update(!1)})),this.on("moveend",(function(){return i._update(!1)})),this.on("zoom",(function(){return i._update(!0)})),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1)),function(t,e){var r=t.getCanvasContainer(),i=null,o=!1,a=null;for(var s in Dr)t[s]=new Dr[s](t,e),e.interactive&&e[s]&&t[s].enable(e[s]);n.addEventListener(r,"mouseout",(function(e){t.fire(new vr("mouseout",t,e))})),n.addEventListener(r,"mousedown",(function(i){o=!0,a=n.mousePos(r,i);var s=new vr("mousedown",t,i);t.fire(s),s.defaultPrevented||(e.interactive&&!t.doubleClickZoom.isActive()&&t.stop(),t.boxZoom.onMouseDown(i),t.boxZoom.isActive()||t.dragPan.isActive()||t.dragRotate.onMouseDown(i),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onMouseDown(i))})),n.addEventListener(r,"mouseup",(function(e){var n=t.dragRotate.isActive();i&&!n&&t.fire(new vr("contextmenu",t,i)),i=null,o=!1,t.fire(new vr("mouseup",t,e))})),n.addEventListener(r,"mousemove",(function(e){if(!t.dragPan.isActive()&&!t.dragRotate.isActive()){for(var n=e.target;n&&n!==r;)n=n.parentNode;n===r&&t.fire(new vr("mousemove",t,e))}})),n.addEventListener(r,"mouseover",(function(e){for(var n=e.target;n&&n!==r;)n=n.parentNode;n===r&&t.fire(new vr("mouseover",t,e))})),n.addEventListener(r,"touchstart",(function(n){var r=new _r("touchstart",t,n);t.fire(r),r.defaultPrevented||(e.interactive&&t.stop(),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onTouchStart(n),t.touchZoomRotate.onStart(n),t.doubleClickZoom.onTouchStart(r))}),{passive:!1}),n.addEventListener(r,"touchmove",(function(e){t.fire(new _r("touchmove",t,e))}),{passive:!1}),n.addEventListener(r,"touchend",(function(e){t.fire(new _r("touchend",t,e))})),n.addEventListener(r,"touchcancel",(function(e){t.fire(new _r("touchcancel",t,e))})),n.addEventListener(r,"click",(function(i){var o=n.mousePos(r,i);(!a||o.equals(a)||o.dist(a)<e.clickTolerance)&&t.fire(new vr("click",t,i))})),n.addEventListener(r,"dblclick",(function(e){var n=new vr("dblclick",t,e);t.fire(n),n.defaultPrevented||t.doubleClickZoom.onDblClick(n)})),n.addEventListener(r,"contextmenu",(function(e){var n=t.dragRotate.isActive();o||n?o&&(i=e):t.fire(new vr("contextmenu",t,e)),(t.dragRotate.isEnabled()||t.listens("contextmenu"))&&e.preventDefault()})),n.addEventListener(r,"wheel",(function(n){e.interactive&&t.stop();var r=new br("wheel",t,n);t.fire(r),r.defaultPrevented||t.scrollZoom.onWheel(n)}),{passive:!1})}(this,e);var a="string"==typeof e.hash&&e.hash||void 0;this._hash=e.hash&&new gr(a).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new Rr({customAttribution:e.customAttribution})),this.addControl(new Nr,e.logoPosition),this.on("style.load",(function(){i.transform.unmodified&&i.jumpTo(i.style.stylesheet)})),this.on("data",(function(e){i._update("style"===e.dataType),i.fire(new t.Event(e.dataType+"data",e))})),this.on("dataloading",(function(e){i.fire(new t.Event(e.dataType+"dataloading",e))}))}r&&(i.__proto__=r),i.prototype=Object.create(r&&r.prototype),i.prototype.constructor=i;var o={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return i.prototype._getMapId=function(){return this._mapId},i.prototype.addControl=function(e,n){if(void 0===n&&e.getDefaultPosition&&(n=e.getDefaultPosition()),void 0===n&&(n="top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var r=e.onAdd(this);this._controls.push(e);var i=this._controlPositions[n];return-1!==n.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this},i.prototype.removeControl=function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this},i.prototype.resize=function(e){var n=this._containerDimensions(),r=n[0],i=n[1];return this._resizeCanvas(r,i),this.transform.resize(r,i),this.painter.resize(r,i),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)).fire(new t.Event("resize",e)).fire(new t.Event("moveend",e)),this},i.prototype.getBounds=function(){return this.transform.getBounds()},i.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},i.prototype.setMaxBounds=function(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()},i.prototype.setMinZoom=function(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.setMinPitch=function(t){if((t=null==t?Br:t)<Br)throw new Error("minPitch must be greater than or equal to "+Br);if(t>=Br&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between "+Br+" and the current maxPitch, inclusive")},i.prototype.getMinPitch=function(){return this.transform.minPitch},i.prototype.setMaxPitch=function(t){if((t=null==t?Ur:t)>Ur)throw new Error("maxPitch must be less than or equal to "+Ur);if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")},i.prototype.getMaxPitch=function(){return this.transform.maxPitch},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},i.prototype.project=function(e){return this.transform.locationPoint(t.LngLat.convert(e))},i.prototype.unproject=function(e){return this.transform.pointLocation(t.Point.convert(e))},i.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},i.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isZooming()},i.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},i.prototype.on=function(t,e,n){var i=this;if(void 0===n)return r.prototype.on.call(this,t,e);var o=function(){var r;if("mouseenter"===t||"mouseover"===t){var o=!1;return{layer:e,listener:n,delegates:{mousemove:function(r){var a=i.getLayer(e)?i.queryRenderedFeatures(r.point,{layers:[e]}):[];a.length?o||(o=!0,n.call(i,new vr(t,i,r.originalEvent,{features:a}))):o=!1},mouseout:function(){o=!1}}}}if("mouseleave"===t||"mouseout"===t){var a=!1;return{layer:e,listener:n,delegates:{mousemove:function(r){(i.getLayer(e)?i.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?a=!0:a&&(a=!1,n.call(i,new vr(t,i,r.originalEvent)))},mouseout:function(e){a&&(a=!1,n.call(i,new vr(t,i,e.originalEvent)))}}}}return{layer:e,listener:n,delegates:(r={},r[t]=function(t){var r=i.getLayer(e)?i.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,n.call(i,t),delete t.features)},r)}}();for(var a in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(o),o.delegates)this.on(a,o.delegates[a]);return this},i.prototype.off=function(t,e,n){if(void 0===n)return r.prototype.off.call(this,t,e);if(this._delegatedListeners&&this._delegatedListeners[t])for(var i=this._delegatedListeners[t],o=0;o<i.length;o++){var a=i[o];if(a.layer===e&&a.listener===n){for(var s in a.delegates)this.off(s,a.delegates[s]);return i.splice(o,1),this}}return this},i.prototype.queryRenderedFeatures=function(e,n){if(!this.style)return[];var r;if(void 0!==n||void 0===e||e instanceof t.Point||Array.isArray(e)||(n=e,e=void 0),n=n||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.Point||"number"==typeof e[0])r=[t.Point.convert(e)];else{var i=t.Point.convert(e[0]),o=t.Point.convert(e[1]);r=[i,new t.Point(o.x,i.y),o,new t.Point(i.x,o.y),i]}return this.style.queryRenderedFeatures(r,n,this.transform)},i.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},i.prototype.setStyle=function(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(e,n))},i.prototype._getUIString=function(t){var e=this._locale[t];if(null==e)throw new Error("Missing UI string '"+t+"'");return e},i.prototype._updateStyle=function(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new je(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t),this):(delete this.style,this)},i.prototype._diffStyle=function(e,n){var r=this;if("string"==typeof e){var i=this._requestManager.normalizeStyleURL(e),o=this._requestManager.transformRequest(i,t.ResourceType.Style);t.getJSON(o,(function(e,i){e?r.fire(new t.ErrorEvent(e)):i&&r._updateDiff(i,n)}))}else"object"==typeof e&&this._updateDiff(e,n)},i.prototype._updateDiff=function(e,n){try{this.style.setState(e)&&this._update(!0)}catch(r){t.warnOnce("Unable to perform style diff: "+(r.message||r.error||r)+".  Rebuilding the style from scratch."),this._updateStyle(e,n)}},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0)},i.prototype.isSourceLoaded=function(e){var n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},i.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var n=t[e]._tiles;for(var r in n){var i=n[r];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0},i.prototype.addSourceType=function(t,e,n){return this.style.addSourceType(t,e,n)},i.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},i.prototype.getSource=function(t){return this.style.getSource(t)},i.prototype.addImage=function(e,n,r){void 0===r&&(r={});var i=r.pixelRatio;void 0===i&&(i=1);var o=r.sdf;void 0===o&&(o=!1);var a=r.stretchX,s=r.stretchY,u=r.content;if(n instanceof jr){var c=t.browser.getImageData(n),l=c.width,h=c.height,p=c.data;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:h},p),pixelRatio:i,stretchX:a,stretchY:s,content:u,sdf:o,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var f=n.width,d=n.height,m=n.data,y=n;this.style.addImage(e,{data:new t.RGBAImage({width:f,height:d},new Uint8Array(m)),pixelRatio:i,stretchX:a,stretchY:s,content:u,sdf:o,version:0,userImage:y}),y.onAdd&&y.onAdd(this,e)}},i.prototype.updateImage=function(e,n){var r=this.style.getImage(e);if(!r)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var i=n instanceof jr?t.browser.getImageData(n):n,o=i.width,a=i.height,s=i.data;if(void 0===o||void 0===a)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(o!==r.data.width||a!==r.data.height)return this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var u=!(n instanceof jr);r.data.replace(s,u),this.style.updateImage(e,r)},i.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(t){this.style.removeImage(t)},i.prototype.loadImage=function(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),n)},i.prototype.listImages=function(){return this.style.listImages()},i.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0)},i.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},i.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},i.prototype.getLayer=function(t){return this.style.getLayer(t)},i.prototype.setLayerZoomRange=function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)},i.prototype.setFilter=function(t,e,n){return void 0===n&&(n={}),this.style.setFilter(t,e,n),this._update(!0)},i.prototype.getFilter=function(t){return this.style.getFilter(t)},i.prototype.setPaintProperty=function(t,e,n,r){return void 0===r&&(r={}),this.style.setPaintProperty(t,e,n,r),this._update(!0)},i.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},i.prototype.setLayoutProperty=function(t,e,n,r){return void 0===r&&(r={}),this.style.setLayoutProperty(t,e,n,r),this._update(!0)},i.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},i.prototype.setLight=function(t,e){return void 0===e&&(e={}),this.style.setLight(t,e),this._update(!0)},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},i.prototype.removeFeatureState=function(t,e){return this.style.removeFeatureState(t,e),this._update()},i.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},i.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},i.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=n.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var i=this._controlContainer=n.create("div","mapboxgl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(t){o[t]=n.create("div","mapboxgl-ctrl-"+t,i)}))},i.prototype._resizeCanvas=function(e,n){var r=t.window.devicePixelRatio||1;this._canvas.width=r*e,this._canvas.height=r*n,this._canvas.style.width=e+"px",this._canvas.style.height=n+"px"},i.prototype._setupPainter=function(){var n=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);r?(this.painter=new hr(r,this.transform),t.webpSupported.testSupport(r)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},i.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},i.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this},i.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},i.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},i.prototype._render=function(){var e,n=this,r=0,i=this.painter.context.extTimerQuery;this.listens("gpu-timing-frame")&&(e=i.createQueryEXT(),i.beginQueryEXT(i.TIME_ELAPSED_EXT,e),r=t.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run();var o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var a=this.transform.zoom,s=t.browser.now();this.style.zoomHistory.update(a,s);var u=new t.EvaluationParameters(a,{now:s,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),c=u.crossFadingFactor();1===c&&c===this._crossFadingFactor||(o=!0,this._crossFadingFactor=c),this.style.update(u)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),gpuTiming:!!this.listens("gpu-timing-layer"),fadeDuration:this._fadeDuration}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var l=t.browser.now()-r;i.endQueryEXT(i.TIME_ELAPSED_EXT,e),setTimeout((function(){var r=i.getQueryObjectEXT(e,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(e),n.fire(new t.Event("gpu-timing-frame",{cpuTime:l,gpuTime:r}))}),50)}if(this.listens("gpu-timing-layer")){var h=this.painter.collectGpuTimers();setTimeout((function(){var e=n.painter.queryGpuTimers(h);n.fire(new t.Event("gpu-timing-layer",{layerTimes:e}))}),50)}return this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.Event("idle")),this},i.prototype.remove=function(){this._hash&&this._hash.remove();for(var e=0,n=this._controls;e<n.length;e+=1)n[e].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));var r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),Wr(this._canvasContainer),Wr(this._controlContainer),Wr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new t.Event("remove"))},i.prototype.triggerRepaint=function(){var e=this;this.style&&!this._frame&&(this._frame=t.browser.frame((function(){e._frame=null,e._render()})))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(t){this._trackResize&&this.resize({originalEvent:t})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(t){this._vertices=t,this._update()},i.prototype._setCacheLimits=function(e,n){t.setCacheLimits(e,n)},o.version.get=function(){return t.version},Object.defineProperties(i.prototype,o),i}(Mr);function Wr(t){t.parentNode&&t.parentNode.removeChild(t)}var Gr={showCompass:!0,showZoom:!0,visualizePitch:!1},Hr=function(e){var r=this;this.options=t.extend({},Gr,e),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(t){return r._map.zoomIn({},{originalEvent:t})})),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(t){return r._map.zoomOut({},{originalEvent:t})})),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(t){r.options.visualizePitch?r._map.resetNorthPitch({},{originalEvent:t}):r._map.resetNorth({},{originalEvent:t})})),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};function Kr(e,n,r){if(e=new t.LngLat(e.lng,e.lat),n){var i=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),a=r.locationPoint(e).distSqr(n);r.locationPoint(i).distSqr(n)<a?e=i:r.locationPoint(o).distSqr(n)<a&&(e=o)}for(;Math.abs(e.lng-r.center.lng)>180;){var s=r.locationPoint(e);if(s.x>=0&&s.y>=0&&s.x<=r.width&&s.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}Hr.prototype._updateZoomButtons=function(){var t=this._map.getZoom();this._zoomInButton.disabled=t===this._map.getMaxZoom(),this._zoomOutButton.disabled=t===this._map.getMinZoom()},Hr.prototype._rotateCompassArrow=function(){var t=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=t},Hr.prototype.onAdd=function(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Tr(t,{button:"left",element:this._compass}),n.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),n.addEventListener(this._compass,"touchstart",this._handler.onMouseDown,{passive:!1}),this._handler.enable()),this._container},Hr.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),n.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),n.removeEventListener(this._compass,"touchstart",this._handler.onMouseDown,{passive:!1}),this._handler.disable(),delete this._handler),delete this._map},Hr.prototype._createButton=function(t,e){var r=n.create("button",t,this._container);return r.type="button",r.addEventListener("click",e),r},Hr.prototype._setButtonTitle=function(t,e){var n=this._map._getUIString("NavigationControl."+e);t.title=n,t.setAttribute("aria-label",n)};var Qr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Xr(t,e,n){var r=t.classList;for(var i in Qr)r.remove("mapboxgl-"+n+"-anchor-"+i);r.add("mapboxgl-"+n+"-anchor-"+e)}var Yr,Zr=function(e){function r(r,i){var o=this;if(e.call(this),(r instanceof t.window.HTMLElement||i)&&(r=t.extend({element:r},i)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._draggable=r&&r.draggable||!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&"auto"!==r.pitchAlignment?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=t.Point.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var a=n.createNS("http://www.w3.org/2000/svg","svg");a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height","41px"),a.setAttributeNS(null,"width","27px"),a.setAttributeNS(null,"viewBox","0 0 27 41");var s=n.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"stroke","none"),s.setAttributeNS(null,"stroke-width","1"),s.setAttributeNS(null,"fill","none"),s.setAttributeNS(null,"fill-rule","evenodd");var u=n.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill-rule","nonzero");var c=n.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"transform","translate(3.0, 29.0)"),c.setAttributeNS(null,"fill","#000000");for(var l=0,h=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];l<h.length;l+=1){var p=h[l],f=n.createNS("http://www.w3.org/2000/svg","ellipse");f.setAttributeNS(null,"opacity","0.04"),f.setAttributeNS(null,"cx","10.5"),f.setAttributeNS(null,"cy","5.80029008"),f.setAttributeNS(null,"rx",p.rx),f.setAttributeNS(null,"ry",p.ry),c.appendChild(f)}var d=n.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill",this._color);var m=n.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),d.appendChild(m);var y=n.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"opacity","0.25"),y.setAttributeNS(null,"fill","#000000");var g=n.createNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),y.appendChild(g);var v=n.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(6.0, 7.0)"),v.setAttributeNS(null,"fill","#FFFFFF");var _=n.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"transform","translate(8.0, 8.0)");var b=n.createNS("http://www.w3.org/2000/svg","circle");b.setAttributeNS(null,"fill","#000000"),b.setAttributeNS(null,"opacity","0.25"),b.setAttributeNS(null,"cx","5.5"),b.setAttributeNS(null,"cy","5.5"),b.setAttributeNS(null,"r","5.4999962");var w=n.createNS("http://www.w3.org/2000/svg","circle");w.setAttributeNS(null,"fill","#FFFFFF"),w.setAttributeNS(null,"cx","5.5"),w.setAttributeNS(null,"cy","5.5"),w.setAttributeNS(null,"r","5.4999962"),_.appendChild(b),_.appendChild(w),u.appendChild(c),u.appendChild(d),u.appendChild(y),u.appendChild(v),u.appendChild(_),a.appendChild(u),this._element.appendChild(a),this._offset=t.Point.convert(r&&r.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(function(t){t.preventDefault()})),this._element.addEventListener("mousedown",(function(t){t.preventDefault()})),this._element.addEventListener("focus",(function(){var t=o._map.getContainer();t.scrollTop=0,t.scrollLeft=0})),Xr(this._element,this._anchor,"marker"),this._popup=null}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},r.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},r.prototype.getElement=function(){return this._element},r.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},r.prototype._onKeyPress=function(t){var e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()},r.prototype._onMapClick=function(t){var e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},r.prototype.getPopup=function(){return this._popup},r.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},r.prototype._update=function(t){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Kr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(e="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var r="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?r="rotateX(0deg)":"map"===this._pitchAlignment&&(r="rotateX("+this._map.getPitch()+"deg)"),t&&"moveend"!==t.type||(this._pos=this._pos.round()),n.setTransform(this._element,Qr[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+r+" "+e)}},r.prototype.getOffset=function(){return this._offset},r.prototype.setOffset=function(e){return this._offset=t.Point.convert(e),this._update(),this},r.prototype._onMove=function(e){this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))},r.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},r.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},r.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},r.prototype.isDraggable=function(){return this._draggable},r.prototype.setRotation=function(t){return this._rotation=t||0,this._update(),this},r.prototype.getRotation=function(){return this._rotation},r.prototype.setRotationAlignment=function(t){return this._rotationAlignment=t||"auto",this._update(),this},r.prototype.getRotationAlignment=function(){return this._rotationAlignment},r.prototype.setPitchAlignment=function(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this},r.prototype.getPitchAlignment=function(){return this._pitchAlignment},r}(t.Evented),Jr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},$r=function(e){function r(n){e.call(this),this.options=t.extend({},Jr,n),t.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.onAdd=function(e){var r;return this._map=e,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,void 0!==Yr?r(Yr):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then((function(t){Yr="denied"!==t.state,r(Yr)})):(Yr=!!t.window.navigator.geolocation,r(Yr)),this._container},r.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),n.remove(this._container),this._map=void 0},r.prototype._isOutOfMapMaxBounds=function(t){var e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())},r.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},r.prototype._onSuccess=function(e){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()},r.prototype._updateCamera=function(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,i=this._map.getBearing(),o=t.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(r),o,{geolocateSource:!0})},r.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},r.prototype._onError=function(e){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),void 0!==this._geolocationWatchID&&this._clearWatch()}else this._setErrorState();"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()},r.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},r.prototype._setupUI=function(e){var r=this;if(this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{var o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Zr(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(e){var n=e.originalEvent&&"resize"===e.originalEvent.type;e.geolocateSource||"ACTIVE_LOCK"!==r._watchState||n||(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),r.fire(new t.Event("trackuserlocationend")))}))},r.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},r.prototype._clearWatch=function(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},r}(t.Evented),ti={maxWidth:100,unit:"metric"},ei=function(e){this.options=t.extend({},ti,e),t.bindAll(["_onMove","setUnit"],this)};function ni(t,e,n){var r,i,o,a,s,u,c=n&&n.maxWidth||100,l=t._container.clientHeight/2,h=(r=t.unproject([0,l]),i=t.unproject([c,l]),o=Math.PI/180,a=r.lat*o,s=i.lat*o,u=Math.sin(a)*Math.sin(s)+Math.cos(a)*Math.cos(s)*Math.cos((i.lng-r.lng)*o),6371e3*Math.acos(Math.min(u,1)));if(n&&"imperial"===n.unit){var p=3.2808*h;p>5280?ri(e,c,p/5280,t._getUIString("ScaleControl.Miles")):ri(e,c,p,t._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?ri(e,c,h/1852,t._getUIString("ScaleControl.NauticalMiles")):h>=1e3?ri(e,c,h/1e3,t._getUIString("ScaleControl.Kilometers")):ri(e,c,h,t._getUIString("ScaleControl.Meters"))}function ri(t,e,n,r){var i,o,a,s=(i=n,(o=Math.pow(10,(""+Math.floor(i)).length-1))*(a=(a=i/o)>=10?10:a>=5?5:a>=3?3:a>=2?2:a>=1?1:function(t){var e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(a))),u=s/n;t.style.width=e*u+"px",t.innerHTML=s+r}ei.prototype.getDefaultPosition=function(){return"bottom-left"},ei.prototype._onMove=function(){ni(this._map,this._container,this.options)},ei.prototype.onAdd=function(t){return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ei.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ei.prototype.setUnit=function(t){this.options.unit=t,ni(this._map,this._container,this.options)};var ii=function(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.window.document&&(this._fullscreenchange="MSFullscreenChange")};ii.prototype.onAdd=function(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},ii.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},ii.prototype._checkFullscreenSupport=function(){return!!(t.window.document.fullscreenEnabled||t.window.document.mozFullScreenEnabled||t.window.document.msFullscreenEnabled||t.window.document.webkitFullscreenEnabled)},ii.prototype._setupUI=function(){var e=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},ii.prototype._updateTitle=function(){var t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t},ii.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},ii.prototype._isFullscreen=function(){return this._fullscreen},ii.prototype._changeIcon=function(){(t.window.document.fullscreenElement||t.window.document.mozFullScreenElement||t.window.document.webkitFullscreenElement||t.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},ii.prototype._onClickFullscreen=function(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.mozCancelFullScreen?t.window.document.mozCancelFullScreen():t.window.document.msExitFullscreen?t.window.document.msExitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var oi={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},ai=function(e){function r(n){e.call(this),this.options=t.extend(Object.create(oi),n),t.bindAll(["_update","_onClickClose","remove"],this)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.addTo=function(e){var n=this;return this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",(function(t){n._update(t.point)})),this._map.on("mouseup",(function(t){n._update(t.point)})),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this},r.prototype.isOpen=function(){return!!this._map},r.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),this._map.off("remove",this.remove),this._map.off("mousemove"),delete this._map),this.fire(new t.Event("close")),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove"),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},r.prototype.trackPointer=function(){var t=this;return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",(function(e){t._update(e.point)})),this._map.on("drag",(function(e){t._update(e.point)})),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},r.prototype.getElement=function(){return this._container},r.prototype.setText=function(e){return this.setDOMContent(t.window.document.createTextNode(e))},r.prototype.setHTML=function(e){var n,r=t.window.document.createDocumentFragment(),i=t.window.document.createElement("body");for(i.innerHTML=e;n=i.firstChild;)r.appendChild(n);return this.setDOMContent(r)},r.prototype.getMaxWidth=function(){return this._container.style.maxWidth},r.prototype.setMaxWidth=function(t){return this.options.maxWidth=t,this._update(),this},r.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},r.prototype.addClassName=function(t){this._container.classList.add(t)},r.prototype.removeClassName=function(t){this._container.classList.remove(t)},r.prototype.toggleClassName=function(t){return this._container.classList.toggle(t)},r.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},r.prototype._update=function(e){var r=this,i=this._lngLat||this._trackPointer;if(this._map&&i&&this._content&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(t){return r._container.classList.add(t)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Kr(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||e)){var o=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat),a=this.options.anchor,s=function e(n){if(n){if("number"==typeof n){var r=Math.round(Math.sqrt(.5*Math.pow(n,2)));return{center:new t.Point(0,0),top:new t.Point(0,n),"top-left":new t.Point(r,r),"top-right":new t.Point(-r,r),bottom:new t.Point(0,-n),"bottom-left":new t.Point(r,-r),"bottom-right":new t.Point(-r,-r),left:new t.Point(n,0),right:new t.Point(-n,0)}}if(n instanceof t.Point||Array.isArray(n)){var i=t.Point.convert(n);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:t.Point.convert(n.center||[0,0]),top:t.Point.convert(n.top||[0,0]),"top-left":t.Point.convert(n["top-left"]||[0,0]),"top-right":t.Point.convert(n["top-right"]||[0,0]),bottom:t.Point.convert(n.bottom||[0,0]),"bottom-left":t.Point.convert(n["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(n["bottom-right"]||[0,0]),left:t.Point.convert(n.left||[0,0]),right:t.Point.convert(n.right||[0,0])}}return e(new t.Point(0,0))}(this.options.offset);if(!a){var u,c=this._container.offsetWidth,l=this._container.offsetHeight;u=o.y+s.bottom.y<l?["top"]:o.y>this._map.transform.height-l?["bottom"]:[],o.x<c/2?u.push("left"):o.x>this._map.transform.width-c/2&&u.push("right"),a=0===u.length?"bottom":u.join("-")}var h=o.add(s[a]).round();n.setTransform(this._container,Qr[a]+" translate("+h.x+"px,"+h.y+"px)"),Xr(this._container,a,"popup")}},r.prototype._onClickClose=function(){this.remove()},r}(t.Evented),si={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:qr,NavigationControl:Hr,GeolocateControl:$r,AttributionControl:Rr,ScaleControl:ei,FullscreenControl:ii,Popup:ai,Marker:Zr,Style:je,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,Evented:t.Evented,config:t.config,get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return Rt.workerCount},set workerCount(t){Rt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage:function(e){t.clearTileCache(e)},workerUrl:""};return si})),n}()},function(t,e){e.__esModule=!0;e.ATTRIBUTE_NAMES={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"};var n=e.TAG_NAMES={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"},r=(e.VALID_TAG_NAMES=Object.keys(n).map((function(t){return n[t]})),e.TAG_PROPERTIES={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src"},e.REACT_TAG_MAP={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"});e.HELMET_PROPS={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},e.HTML_TAG_MAP=Object.keys(r).reduce((function(t,e){return t[r[e]]=e,t}),{}),e.SELF_CLOSING_TAGS=[n.NOSCRIPT,n.SCRIPT,n.STYLE],e.HELMET_ATTRIBUTE="data-react-helmet"},function(t,e,n){"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}}(),t.exports=n(47)},function(t,e,n){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,a){n(i=t[e].apply(t,r)).then(o,a)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new l(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function l(t,e){this._cursor=t,this._request=e}function h(t){this._store=t}function p(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function f(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new p(n)}function d(t){this._db=t}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(l,"_cursor",["direction","key","primaryKey","value"]),a(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(l.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new l(t,e._request)}))}))})})),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(h,"_store",["name","keyPath","indexNames","autoIncrement"]),a(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(h,"_store",IDBObjectStore,["deleteIndex"]),p.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},o(p,"_tx",["objectStoreNames","mode"]),s(p,"_tx",IDBTransaction,["abort"]),f.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},o(f,"_db",["name","version","objectStoreNames"]),s(f,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new p(this._db.transaction.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[h,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,h].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=function(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new f(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new d(t)}))},t.deleteDb=function(t){return r(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}},function(t,e,n){"use strict";(function(t){var r=n(0);function i(e){var n;n="undefined"!==typeof window?window:"undefined"!==typeof self?self:t;var r="undefined"!==typeof document&&document.attachEvent;if(!r){var i=function(){var t=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||function(t){return n.setTimeout(t,20)};return function(e){return t(e)}}(),o=function(){var t=n.cancelAnimationFrame||n.mozCancelAnimationFrame||n.webkitCancelAnimationFrame||n.clearTimeout;return function(e){return t(e)}}(),a=function(t){var e=t.__resizeTriggers__,n=e.firstElementChild,r=e.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight},s=function(t){if(!(t.target.className.indexOf("contract-trigger")<0&&t.target.className.indexOf("expand-trigger")<0)){var e=this;a(this),this.__resizeRAF__&&o(this.__resizeRAF__),this.__resizeRAF__=i((function(){(function(t){return t.offsetWidth!=t.__resizeLast__.width||t.offsetHeight!=t.__resizeLast__.height})(e)&&(e.__resizeLast__.width=e.offsetWidth,e.__resizeLast__.height=e.offsetHeight,e.__resizeListeners__.forEach((function(n){n.call(e,t)})))}))}},u=!1,c="",l="animationstart",h="Webkit Moz O ms".split(" "),p="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),f=document.createElement("fakeelement");if(void 0!==f.style.animationName&&(u=!0),!1===u)for(var d=0;d<h.length;d++)if(void 0!==f.style[h[d]+"AnimationName"]){c="-"+h[d].toLowerCase()+"-",l=p[d],u=!0;break}var m="resizeanim",y="@"+c+"keyframes "+m+" { from { opacity: 0; } to { opacity: 0; } } ",g=c+"animation: 1ms "+m+"; "}return{addResizeListener:function(t,i){if(r)t.attachEvent("onresize",i);else{if(!t.__resizeTriggers__){var o=t.ownerDocument,u=n.getComputedStyle(t);u&&"static"==u.position&&(t.style.position="relative"),function(t){if(!t.getElementById("detectElementResize")){var n=(y||"")+".resize-triggers { "+(g||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',r=t.head||t.getElementsByTagName("head")[0],i=t.createElement("style");i.id="detectElementResize",i.type="text/css",null!=e&&i.setAttribute("nonce",e),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(t.createTextNode(n)),r.appendChild(i)}}(o),t.__resizeLast__={},t.__resizeListeners__=[],(t.__resizeTriggers__=o.createElement("div")).className="resize-triggers",t.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',t.appendChild(t.__resizeTriggers__),a(t),t.addEventListener("scroll",s,!0),l&&(t.__resizeTriggers__.__animationListener__=function(e){e.animationName==m&&a(t)},t.__resizeTriggers__.addEventListener(l,t.__resizeTriggers__.__animationListener__))}t.__resizeListeners__.push(i)}},removeResizeListener:function(t,e){if(r)t.detachEvent("onresize",e);else if(t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(e),1),!t.__resizeListeners__.length){t.removeEventListener("scroll",s,!0),t.__resizeTriggers__.__animationListener__&&(t.__resizeTriggers__.removeEventListener(l,t.__resizeTriggers__.__animationListener__),t.__resizeTriggers__.__animationListener__=null);try{t.__resizeTriggers__=!t.removeChild(t.__resizeTriggers__)}catch(n){}}}}}var o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e},c=function(t){function e(){var t,n,r;o(this,e);for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=r=u(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(a))),r.state={height:r.props.defaultHeight||0,width:r.props.defaultWidth||0},r._onResize=function(){var t=r.props,e=t.disableHeight,n=t.disableWidth,i=t.onResize;if(r._parentNode){var o=r._parentNode.offsetHeight||0,a=r._parentNode.offsetWidth||0,s=window.getComputedStyle(r._parentNode)||{},u=parseInt(s.paddingLeft,10)||0,c=parseInt(s.paddingRight,10)||0,l=parseInt(s.paddingTop,10)||0,h=parseInt(s.paddingBottom,10)||0,p=o-l-h,f=a-u-c;(!e&&r.state.height!==p||!n&&r.state.width!==f)&&(r.setState({height:o-l-h,width:a-u-c}),i({height:o,width:a}))}},r._setRef=function(t){r._autoSizer=t},u(r,n)}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),a(e,[{key:"componentDidMount",value:function(){var t=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=i(t),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var t=this.props,e=t.children,n=t.className,i=t.disableHeight,o=t.disableWidth,a=t.style,u=this.state,c=u.height,l=u.width,h={overflow:"visible"},p={},f=!1;return i||(0===c&&(f=!0),h.height=0,p.height=c),o||(0===l&&(f=!0),h.width=0,p.width=l),Object(r.createElement)("div",{className:n,ref:this._setRef,style:s({},h,a)},!f&&e(p))}}]),e}(r.PureComponent);c.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}},e.a=c}).call(this,n(20))},function(t,e,n){"use strict";n.d(e,"a",(function(){return C}));var r=n(6),i=n(5),o=n(9),a=n(8),s=n(10),u=n(3),c=n(0),l=n.n(c),h=n(1),p=n.n(h),f=n(19),d=n.n(f),m=n(16),y=n.n(m),g="https://platform.twitter.com/widgets.js",v=function(t){function e(t){var n;return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t))).state={isLoading:!0},n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"buildChromeOptions",value:function(t){return t.chrome="",this.props.noHeader&&(t.chrome=t.chrome+" noheader"),this.props.noFooter&&(t.chrome=t.chrome+" nofooter"),this.props.noBorders&&(t.chrome=t.chrome+" noborders"),this.props.noScrollbar&&(t.chrome=t.chrome+" noscrollbar"),this.props.transparent&&(t.chrome=t.chrome+" transparent"),t}},{key:"buildOptions",value:function(){var t=Object.assign({},this.props.options);return this.props.autoHeight&&(t.height=this.refs.embedContainer.parentNode.offsetHeight),t=Object.assign({},t,{theme:this.props.theme,linkColor:this.props.linkColor,borderColor:this.props.borderColor,lang:this.props.lang})}},{key:"renderWidget",value:function(t){var e=this,n=this.props.onLoad;this.isMountCanceled||window.twttr.widgets.createTimeline({sourceType:this.props.sourceType,screenName:this.props.screenName,userId:this.props.userId,ownerScreenName:this.props.ownerScreenName,slug:this.props.slug,id:this.props.id||this.props.widgetId,url:this.props.url},this.refs.embedContainer,t).then((function(t){e.setState({isLoading:!1}),n&&n(t)}))}},{key:"componentDidMount",value:function(){var t=this;y.a.canUseDOM&&n(17)(g,"twitter-embed",(function(){if(window.twttr){var e=t.buildOptions();e=t.buildChromeOptions(e),t.renderWidget(e)}else console.error("Failure to load window.twttr in TwitterTimelineEmbed, aborting load.")}))}},{key:"componentWillUnmount",value:function(){this.isMountCanceled=!0}},{key:"render",value:function(){var t=this.state.isLoading,e=this.props.placeholder;return l.a.createElement(l.a.Fragment,null,t&&e,l.a.createElement("div",{ref:"embedContainer"}))}}]),e}(c.Component);Object(u.a)(v,"propTypes",{sourceType:p.a.oneOf(["profile","likes","list","collection","url","widget"]).isRequired,screenName:d()(p.a.string,(function(t){return!t.hasOwnProperty("userId")&&("profile"===t.sourceType||"likes"===t.sourceType)})),userId:d()(p.a.number,(function(t){return!t.hasOwnProperty("screenName")&&("profile"===t.sourceType||"likes"===t.sourceType)})),ownerScreenName:d()(p.a.string,(function(t){return"list"===t.sourceType&&!t.hasOwnProperty("id")})),slug:d()(p.a.string,(function(t){return"list"===t.sourceType&&!t.hasOwnProperty("id")})),id:d()(p.a.oneOfType([p.a.number,p.a.string]),(function(t){return"list"===t.sourceType&&!t.hasOwnProperty("ownerScreenName")&&!t.hasOwnProperty("slug")||"collection"===t.sourceType})),url:d()(p.a.string,(function(t){return"url"===t.sourceType})),widgetId:d()(p.a.string,(function(t){return"widget"===t.sourceType})),options:p.a.object,autoHeight:p.a.bool,theme:p.a.oneOf(["dark","light"]),linkColor:p.a.string,borderColor:p.a.string,noHeader:p.a.bool,noFooter:p.a.bool,noBorders:p.a.bool,noScrollbar:p.a.bool,transparent:p.a.bool,lang:p.a.string,placeholder:p.a.oneOfType([p.a.string,p.a.element]),onLoad:p.a.func});var _=function(t){function e(t){var n;return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t))).state={isLoading:!0},n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=this.props.onLoad;y.a.canUseDOM&&n(17)(g,"twitter-embed",(function(){window.twttr?t.isMountCanceled||window.twttr.widgets.createShareButton(t.props.url,t.refs.embedContainer,t.props.options).then((function(n){t.setState({isLoading:!1}),e&&e(n)})):console.error("Failure to load window.twttr in TwitterShareButton, aborting load.")}))}},{key:"componentWillUnmount",value:function(){this.isMountCanceled=!0}},{key:"render",value:function(){var t=this.state.isLoading,e=this.props.placeholder;return l.a.createElement(l.a.Fragment,null,t&&e,l.a.createElement("div",{ref:"embedContainer"}))}}]),e}(c.Component);Object(u.a)(_,"propTypes",{url:p.a.string.isRequired,options:p.a.object,placeholder:p.a.oneOfType([p.a.string,p.a.element]),onLoad:p.a.func});var b=function(t){function e(t){var n;return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t))).state={isLoading:!0},n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=this.props.onLoad;y.a.canUseDOM&&n(17)(g,"twitter-embed",(function(){window.twttr?t.isMountCanceled||window.twttr.widgets.createFollowButton(t.props.screenName,t.refs.embedContainer,t.props.options).then((function(n){t.setState({isLoading:!1}),e&&e(n)})):console.error("Failure to load window.twttr in TwitterFollowButton, aborting load.")}))}},{key:"componentWillUnmount",value:function(){this.isMountCanceled=!0}},{key:"render",value:function(){var t=this.state.isLoading,e=this.props.placeholder;return l.a.createElement(l.a.Fragment,null,t&&e,l.a.createElement("div",{ref:"embedContainer"}))}}]),e}(c.Component);Object(u.a)(b,"propTypes",{screenName:p.a.string.isRequired,options:p.a.object,placeholder:p.a.oneOfType([p.a.string,p.a.element]),onLoad:p.a.func});var w=function(t){function e(t){var n;return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t))).state={isLoading:!0},n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=this.props.onLoad;y.a.canUseDOM&&n(17)(g,"twitter-embed",(function(){window.twttr?t.isMountCanceled||window.twttr.widgets.createHashtagButton(t.props.tag,t.refs.embedContainer,t.props.options).then((function(n){t.setState({isLoading:!1}),e&&e(n)})):console.error("Failure to load window.twttr in TwitterHashtagButton, aborting load.")}))}},{key:"componentWillUnmount",value:function(){this.isMountCanceled=!0}},{key:"render",value:function(){var t=this.state.isLoading,e=this.props.placeholder;return l.a.createElement(l.a.Fragment,null,t&&e,l.a.createElement("div",{ref:"embedContainer"}))}}]),e}(c.Component);Object(u.a)(w,"propTypes",{tag:p.a.string.isRequired,options:p.a.object,placeholder:p.a.oneOfType([p.a.string,p.a.element]),onLoad:p.a.func});var x=function(t){function e(t){var n;return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t))).state={isLoading:!0},n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=this.props.onLoad;y.a.canUseDOM&&n(17)(g,"twitter-embed",(function(){window.twttr?t.isMountCanceled||window.twttr.widgets.createMentionButton(t.props.screenName,t.refs.embedContainer,t.props.options).then((function(n){t.setState({isLoading:!1}),e&&e(n)})):console.error("Failure to load window.twttr in TwitterMentionButton, aborting load.")}))}},{key:"componentWillUnmount",value:function(){this.isMountCanceled=!0}},{key:"render",value:function(){var t=this.state.isLoading,e=this.props.placeholder;return l.a.createElement(l.a.Fragment,null,t&&e,l.a.createElement("div",{ref:"embedContainer"}))}}]),e}(c.Component);Object(u.a)(x,"propTypes",{screenName:p.a.string.isRequired,options:p.a.object,placeholder:p.a.oneOfType([p.a.string,p.a.element]),onLoad:p.a.func});var E=function(t){function e(t){var n;return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t))).state={isLoading:!0},n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"renderWidget",value:function(){var t=this,e=this.props.onLoad;window.twttr?this.isMountCanceled||window.twttr.widgets.createTweet(this.props.tweetId,this.refs.embedContainer,this.props.options).then((function(n){t.setState({isLoading:!1}),e&&e(n)})):console.error("Failure to load window.twttr in TwitterTweetEmbed, aborting load.")}},{key:"componentDidMount",value:function(){var t=this;y.a.canUseDOM&&n(17)(g,"twitter-embed",(function(){t.renderWidget()}))}},{key:"componentWillUnmount",value:function(){this.isMountCanceled=!0}},{key:"render",value:function(){var t=this.state.isLoading,e=this.props.placeholder;return l.a.createElement(l.a.Fragment,null,t&&e,l.a.createElement("div",{ref:"embedContainer"}))}}]),e}(c.Component);Object(u.a)(E,"propTypes",{tweetId:p.a.string.isRequired,options:p.a.object,placeholder:p.a.oneOfType([p.a.string,p.a.element]),onLoad:p.a.func});var T=function(t){function e(t){var n;return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t))).state={isLoading:!0},n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=this.props.onLoad;y.a.canUseDOM&&n(17)(g,"twitter-embed",(function(){window.twttr?t.isMountCanceled||window.twttr.widgets.createMoment(t.props.momentId,t.refs.shareMoment,t.props.options).then((function(n){t.setState({isLoading:!1}),e&&e(n)})):console.error("Failure to load window.twttr in TwitterMomentShare, aborting load.")}))}},{key:"componentWillUnmount",value:function(){this.isMountCanceled=!0}},{key:"render",value:function(){var t=this.state.isLoading,e=this.props.placeholder;return l.a.createElement(l.a.Fragment,null,t&&e,l.a.createElement("div",{ref:"shareMoment"}))}}]),e}(c.Component);Object(u.a)(T,"propTypes",{momentId:p.a.string.isRequired,options:p.a.object,placeholder:p.a.oneOfType([p.a.string,p.a.element]),onLoad:p.a.func});var S=function(t){function e(t){var n;return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t))).state={isLoading:!0},n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=this.props.onLoad;y.a.canUseDOM&&n(17)(g,"twitter-embed",(function(){window.twttr?t.isMountCanceled||window.twttr.widgets.createDMButton(t.props.id,t.refs.embedContainer,t.props.options).then((function(n){t.setState({isLoading:!1}),e&&e(n)})):console.error("Failure to load window.twttr in TwitterDMButton, aborting load.")}))}},{key:"componentWillUnmount",value:function(){this.isMountCanceled=!0}},{key:"render",value:function(){var t=this.state.isLoading,e=this.props.placeholder;return l.a.createElement(l.a.Fragment,null,t&&e,l.a.createElement("div",{ref:"embedContainer"}))}}]),e}(c.Component);Object(u.a)(S,"propTypes",{id:p.a.number.isRequired,options:p.a.object,placeholder:p.a.oneOfType([p.a.string,p.a.element]),onLoad:p.a.func});var C=function(t){function e(t){var n;return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t))).state={isLoading:!0},n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=this.props.onLoad;y.a.canUseDOM&&n(17)(g,"twitter-embed",(function(){window.twttr?t.isMountCanceled||window.twttr.widgets.createVideo(t.props.id,t.refs.embedContainer).then((function(n){t.setState({isLoading:!1}),e&&e(n)})):console.error("Failure to load window.twttr in TwitterVideoEmbed, aborting load.")}))}},{key:"componentWillUnmount",value:function(){this.isMountCanceled=!0}},{key:"render",value:function(){var t=this.state.isLoading,e=this.props.placeholder;return l.a.createElement(l.a.Fragment,null,t&&e,l.a.createElement("div",{ref:"embedContainer"}))}}]),e}(c.Component);Object(u.a)(C,"propTypes",{id:p.a.string.isRequired,placeholder:p.a.oneOfType([p.a.string,p.a.element]),onLoad:p.a.func});var I=function(t){function e(t){var n;return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t))).state={isLoading:!0},n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=this.props.onLoad;y.a.canUseDOM&&n(17)(g,"twitter-embed",(function(){window.twttr?t.isMountCanceled||window.twttr.widgets.createPeriscopeOnAirButton(t.props.username,t.refs.embedContainer,t.props.options).then((function(n){t.setState({isLoading:!1}),e&&e(n)})):console.error("Failure to load window.twttr in TwitterOnAirButton, aborting load.")}))}},{key:"componentWillUnmount",value:function(){this.isMountCanceled=!0}},{key:"render",value:function(){var t=this.state.isLoading,e=this.props.placeholder;return l.a.createElement(l.a.Fragment,null,t&&e,l.a.createElement("div",{ref:"embedContainer"}))}}]),e}(c.Component);Object(u.a)(I,"propTypes",{username:p.a.string.isRequired,options:p.a.object,placeholder:p.a.oneOfType([p.a.string,p.a.element]),onLoad:p.a.func})},function(t,e,n){"use strict";var r=n(0),i=n(41),o=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n},u=function(t){function e(e){var n=t.call(this,e)||this;return n.request=null,n.cancel=function(){n.request&&n.request.cancel()},n.handleFetchSuccess=function(t){n.props.onSuccess&&n.props.onSuccess(t),n.setState({html:t.html},(function(){window.instgrm.Embeds.process(),n.props.onAfterRender&&n.props.onAfterRender()}))},n.handleFetchFailure=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];clearTimeout(n.timer),n.props.onFailure&&n.props.onFailure(t)},n.createRequestPromise=function(t){var e={};return e.promise=new Promise((function(n,r){var i=fetch(t).then((function(t){return t.json()})).then((function(t){return n(t)})).catch((function(t){return r(t)}));return e.cancel=function(){return r(new Error("Cancelled"))},i})),e},n.state={html:null},n}return o(e,t),e.prototype.componentDidMount=function(){var t=this;window.instgrm?this.fetchEmbed(this.getQueryParams(this.props)):(this.props.injectScript&&!document.getElementById("react-instagram-embed-script")&&this.injectScript(),this.checkAPI().then((function(){t.fetchEmbed(t.getQueryParams(t.props))})))},e.prototype.componentDidUpdate=function(t){var e=this.props,n=e.url,r=e.hideCaption,i=e.maxWidth,o=e.containerTagName;t.url===n&&t.hideCaption===r&&t.maxWidth===i&&t.containerTagName===o||(this.request.cancel(),this.fetchEmbed(this.getQueryParams(this.props)))},e.prototype.componentWillUnmount=function(){this.cancel()},e.prototype.render=function(){var t=this.props.containerTagName;return r.createElement(t,a({},this.omitComponentProps(),{dangerouslySetInnerHTML:{__html:this.state.html||""}}))},e.prototype.fetchEmbed=function(t){this.request=this.createRequestPromise("https://api.instagram.com/oembed/?"+t),this.props.onLoading&&this.props.onLoading(),this.request.promise.then(this.handleFetchSuccess).catch(this.handleFetchFailure)},e.prototype.omitComponentProps=function(){var t=this.props;t.url,t.hideCaption,t.maxWidth,t.containerTagName,t.onLoading,t.onSuccess,t.onAfterRender,t.onFailure,t.protocol,t.injectScript;return s(t,["url","hideCaption","maxWidth","containerTagName","onLoading","onSuccess","onAfterRender","onFailure","protocol","injectScript"])},e.prototype.injectScript=function(){var t=0===window.location.protocol.indexOf("file")?this.props.protocol:"",e=document.createElement("script");e.async=e.defer=!0,e.src=t+"//platform.instagram.com/en_US/embeds.js",e.id="react-instagram-embed-script";var n=document.body;n&&n.appendChild(e)},e.prototype.checkAPI=function(){var t=this;return new Promise((function(e){!function t(n){n.timer=window.setTimeout((function(){window.instgrm?(clearTimeout(n.timer),e()):t(n)}),20)}(t)}))},e.prototype.getQueryParams=function(t){var e=t.url,n=t.hideCaption,r=t.maxWidth;return i.stringify({url:e,hidecaption:n,maxwidth:"number"===typeof r&&r>=320?r:void 0,omitscript:!0})},e.defaultProps={hideCaption:!1,containerTagName:"div",protocol:"https:",injectScript:!0},e}(r.PureComponent);e.a=u},function(t,e,n){"use strict";var r=n(64),i=n(26),o=n(65);function a(t,e){return e.encode?e.strict?r(t):encodeURIComponent(t):t}function s(t){var e=t.indexOf("?");return-1===e?"":t.slice(e+1)}function u(t,e){var n=function(t){var e;switch(t.arrayFormat){case"index":return function(t,n,r){e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===r[t]&&(r[t]={}),r[t][e[1]]=n):r[t]=n};case"bracket":return function(t,n,r){e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==r[t]?r[t]=[].concat(r[t],n):r[t]=[n]:r[t]=n};default:return function(t,e,n){void 0!==n[t]?n[t]=[].concat(n[t],e):n[t]=e}}}(e=i({arrayFormat:"none"},e)),r=Object.create(null);return"string"!==typeof t?r:(t=t.trim().replace(/^[?#&]/,""))?(t.split("&").forEach((function(t){var e=t.replace(/\+/g," ").split("="),i=e.shift(),a=e.length>0?e.join("="):void 0;a=void 0===a?null:o(a),n(o(i),a,r)})),Object.keys(r).sort().reduce((function(t,e){var n=r[e];return Boolean(n)&&"object"===typeof n&&!Array.isArray(n)?t[e]=function t(e){return Array.isArray(e)?e.sort():"object"===typeof e?t(Object.keys(e)).sort((function(t,e){return Number(t)-Number(e)})).map((function(t){return e[t]})):e}(n):t[e]=n,t}),Object.create(null))):r}e.extract=s,e.parse=u,e.stringify=function(t,e){!1===(e=i({encode:!0,strict:!0,arrayFormat:"none"},e)).sort&&(e.sort=function(){});var n=function(t){switch(t.arrayFormat){case"index":return function(e,n,r){return null===n?[a(e,t),"[",r,"]"].join(""):[a(e,t),"[",a(r,t),"]=",a(n,t)].join("")};case"bracket":return function(e,n){return null===n?a(e,t):[a(e,t),"[]=",a(n,t)].join("")};default:return function(e,n){return null===n?a(e,t):[a(e,t),"=",a(n,t)].join("")}}}(e);return t?Object.keys(t).sort(e.sort).map((function(r){var i=t[r];if(void 0===i)return"";if(null===i)return a(r,e);if(Array.isArray(i)){var o=[];return i.slice().forEach((function(t){void 0!==t&&o.push(n(r,t,o.length))})),o.join("&")}return a(r,e)+"="+a(i,e)})).filter((function(t){return t.length>0})).join("&"):""},e.parseUrl=function(t,e){return{url:t.split("?")[0]||"",query:u(s(t),e)}}},,,function(t,e,n){e.__esModule=!0,e.Helmet=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=h(n(0)),a=h(n(1)),s=h(n(68)),u=h(n(70)),c=n(71),l=n(34);function h(t){return t&&t.__esModule?t:{default:t}}function p(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var f=function(t){var e,n;return n=e=function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,e.apply(this,arguments))}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),n.prototype.shouldComponentUpdate=function(t){return!(0,u.default)(this.props,t)},n.prototype.mapNestedChildrenToProps=function(t,e){if(!e)return null;switch(t.type){case l.TAG_NAMES.SCRIPT:case l.TAG_NAMES.NOSCRIPT:return{innerHTML:e};case l.TAG_NAMES.STYLE:return{cssText:e}}throw new Error("<"+t.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},n.prototype.flattenArrayTypeChildren=function(t){var e,n=t.child,i=t.arrayTypeChildren,o=t.newChildProps,a=t.nestedChildren;return r({},i,((e={})[n.type]=[].concat(i[n.type]||[],[r({},o,this.mapNestedChildrenToProps(n,a))]),e))},n.prototype.mapObjectTypeChildren=function(t){var e,n,i=t.child,o=t.newProps,a=t.newChildProps,s=t.nestedChildren;switch(i.type){case l.TAG_NAMES.TITLE:return r({},o,((e={})[i.type]=s,e.titleAttributes=r({},a),e));case l.TAG_NAMES.BODY:return r({},o,{bodyAttributes:r({},a)});case l.TAG_NAMES.HTML:return r({},o,{htmlAttributes:r({},a)})}return r({},o,((n={})[i.type]=r({},a),n))},n.prototype.mapArrayTypeChildrenToProps=function(t,e){var n=r({},e);return Object.keys(t).forEach((function(e){var i;n=r({},n,((i={})[e]=t[e],i))})),n},n.prototype.warnOnInvalidChildren=function(t,e){return!0},n.prototype.mapChildrenToProps=function(t,e){var n=this,r={};return o.default.Children.forEach(t,(function(t){if(t&&t.props){var i=t.props,o=i.children,a=p(i,["children"]),s=(0,c.convertReactPropstoHtmlAttributes)(a);switch(n.warnOnInvalidChildren(t,o),t.type){case l.TAG_NAMES.LINK:case l.TAG_NAMES.META:case l.TAG_NAMES.NOSCRIPT:case l.TAG_NAMES.SCRIPT:case l.TAG_NAMES.STYLE:r=n.flattenArrayTypeChildren({child:t,arrayTypeChildren:r,newChildProps:s,nestedChildren:o});break;default:e=n.mapObjectTypeChildren({child:t,newProps:e,newChildProps:s,nestedChildren:o})}}})),e=this.mapArrayTypeChildrenToProps(r,e)},n.prototype.render=function(){var e=this.props,n=e.children,i=p(e,["children"]),a=r({},i);return n&&(a=this.mapChildrenToProps(n,a)),o.default.createElement(t,a)},i(n,null,[{key:"canUseDOM",set:function(e){t.canUseDOM=e}}]),n}(o.default.Component),e.propTypes={base:a.default.object,bodyAttributes:a.default.object,children:a.default.oneOfType([a.default.arrayOf(a.default.node),a.default.node]),defaultTitle:a.default.string,defer:a.default.bool,encodeSpecialCharacters:a.default.bool,htmlAttributes:a.default.object,link:a.default.arrayOf(a.default.object),meta:a.default.arrayOf(a.default.object),noscript:a.default.arrayOf(a.default.object),onChangeClientState:a.default.func,script:a.default.arrayOf(a.default.object),style:a.default.arrayOf(a.default.object),title:a.default.string,titleAttributes:a.default.object,titleTemplate:a.default.string},e.defaultProps={defer:!0,encodeSpecialCharacters:!0},e.peek=t.peek,e.rewind=function(){var e=t.rewind();return e||(e=(0,c.mapStateOnServer)({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),e},n}((0,s.default)(c.reducePropsToState,c.handleClientStateChange,c.mapStateOnServer)((function(){return null})));f.renderStatic=f.rewind,e.Helmet=f,e.default=f},,function(t,e,n){"use strict";var r=n(26),i="function"===typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,u=i?Symbol.for("react.strict_mode"):60108,c=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,h=i?Symbol.for("react.context"):60110,p=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113;i&&Symbol.for("react.suspense_list");var d=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116;i&&Symbol.for("react.fundamental"),i&&Symbol.for("react.responder"),i&&Symbol.for("react.scope");var y="function"===typeof Symbol&&Symbol.iterator;function g(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_={};function b(t,e,n){this.props=t,this.context=e,this.refs=_,this.updater=n||v}function w(){}function x(t,e,n){this.props=t,this.context=e,this.refs=_,this.updater=n||v}b.prototype.isReactComponent={},b.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error(g(85));this.updater.enqueueSetState(this,t,e,"setState")},b.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},w.prototype=b.prototype;var E=x.prototype=new w;E.constructor=x,r(E,b.prototype),E.isPureReactComponent=!0;var T={current:null},S={current:null},C=Object.prototype.hasOwnProperty,I={key:!0,ref:!0,__self:!0,__source:!0};function k(t,e,n){var r,i={},a=null,s=null;if(null!=e)for(r in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)C.call(e,r)&&!I.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:o,type:t,key:a,ref:s,props:i,_owner:S.current}}function A(t){return"object"===typeof t&&null!==t&&t.$$typeof===o}var O=/\/+/g,P=[];function D(t,e,n,r){if(P.length){var i=P.pop();return i.result=t,i.keyPrefix=e,i.func=n,i.context=r,i.count=0,i}return{result:t,keyPrefix:e,func:n,context:r,count:0}}function M(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>P.length&&P.push(t)}function R(t,e,n){return null==t?0:function t(e,n,r,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case o:case a:u=!0}}if(u)return r(i,e,""===n?"."+N(e,0):n),1;if(u=0,n=""===n?".":n+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=n+N(s=e[c],c);u+=t(s,l,r,i)}else if(null===e||"object"!==typeof e?l=null:l="function"===typeof(l=y&&e[y]||e["@@iterator"])?l:null,"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=t(s=s.value,l=n+N(s,c++),r,i);else if("object"===s)throw r=""+e,Error(g(31,"[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r,""));return u}(t,"",e,n)}function N(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function L(t,e){t.func.call(t.context,e,t.count++)}function F(t,e,n){var r=t.result,i=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?j(t,r,n,(function(t){return t})):null!=t&&(A(t)&&(t=function(t,e){return{$$typeof:o,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,i+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(O,"$&/")+"/")+n)),r.push(t))}function j(t,e,n,r,i){var o="";null!=n&&(o=(""+n).replace(O,"$&/")+"/"),R(t,F,e=D(e,o,r,i)),M(e)}function z(){var t=T.current;if(null===t)throw Error(g(321));return t}var B={Children:{map:function(t,e,n){if(null==t)return t;var r=[];return j(t,r,null,e,n),r},forEach:function(t,e,n){if(null==t)return t;R(t,L,e=D(null,null,e,n)),M(e)},count:function(t){return R(t,(function(){return null}),null)},toArray:function(t){var e=[];return j(t,e,null,(function(t){return t})),e},only:function(t){if(!A(t))throw Error(g(143));return t}},createRef:function(){return{current:null}},Component:b,PureComponent:x,createContext:function(t,e){return void 0===e&&(e=null),(t={$$typeof:h,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:l,_context:t},t.Consumer=t},forwardRef:function(t){return{$$typeof:p,render:t}},lazy:function(t){return{$$typeof:m,_ctor:t,_status:-1,_result:null}},memo:function(t,e){return{$$typeof:d,type:t,compare:void 0===e?null:e}},useCallback:function(t,e){return z().useCallback(t,e)},useContext:function(t,e){return z().useContext(t,e)},useEffect:function(t,e){return z().useEffect(t,e)},useImperativeHandle:function(t,e,n){return z().useImperativeHandle(t,e,n)},useDebugValue:function(){},useLayoutEffect:function(t,e){return z().useLayoutEffect(t,e)},useMemo:function(t,e){return z().useMemo(t,e)},useReducer:function(t,e,n){return z().useReducer(t,e,n)},useRef:function(t){return z().useRef(t)},useState:function(t){return z().useState(t)},Fragment:s,Profiler:c,StrictMode:u,Suspense:f,createElement:k,cloneElement:function(t,e,n){if(null===t||void 0===t)throw Error(g(267,t));var i=r({},t.props),a=t.key,s=t.ref,u=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,u=S.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(l in e)C.call(e,l)&&!I.hasOwnProperty(l)&&(i[l]=void 0===e[l]&&void 0!==c?c[l]:e[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){c=Array(l);for(var h=0;h<l;h++)c[h]=arguments[h+2];i.children=c}return{$$typeof:o,type:t.type,key:a,ref:s,props:i,_owner:u}},createFactory:function(t){var e=k.bind(null,t);return e.type=t,e},isValidElement:A,version:"16.12.0",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:T,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:S,IsSomeRendererActing:{current:!1},assign:r}},U={default:B},V=U&&B||U;t.exports=V.default||V},function(t,e,n){"use strict";var r=n(0),i=n(26),o=n(48);function a(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(a(227));var s=null,u={};function c(){if(s)for(var t in u){var e=u[t],n=s.indexOf(t);if(!(-1<n))throw Error(a(96,t));if(!h[n]){if(!e.extractEvents)throw Error(a(97,t));for(var r in h[n]=e,n=e.eventTypes){var i=void 0,o=n[r],c=e,f=r;if(p.hasOwnProperty(f))throw Error(a(99,f));p[f]=o;var d=o.phasedRegistrationNames;if(d){for(i in d)d.hasOwnProperty(i)&&l(d[i],c,f);i=!0}else o.registrationName?(l(o.registrationName,c,f),i=!0):i=!1;if(!i)throw Error(a(98,r,t))}}}}function l(t,e,n){if(f[t])throw Error(a(100,t));f[t]=e,d[t]=e.eventTypes[n].dependencies}var h=[],p={},f={},d={};function m(t,e,n,r,i,o,a,s,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(l){this.onError(l)}}var y=!1,g=null,v=!1,_=null,b={onError:function(t){y=!0,g=t}};function w(t,e,n,r,i,o,a,s,u){y=!1,g=null,m.apply(b,arguments)}var x=null,E=null,T=null;function S(t,e,n){var r=t.type||"unknown-event";t.currentTarget=T(n),function(t,e,n,r,i,o,s,u,c){if(w.apply(this,arguments),y){if(!y)throw Error(a(198));var l=g;y=!1,g=null,v||(v=!0,_=l)}}(r,e,void 0,t),t.currentTarget=null}function C(t,e){if(null==e)throw Error(a(30));return null==t?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function I(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)}var k=null;function A(t){if(t){var e=t._dispatchListeners,n=t._dispatchInstances;if(Array.isArray(e))for(var r=0;r<e.length&&!t.isPropagationStopped();r++)S(t,e[r],n[r]);else e&&S(t,e,n);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function O(t){if(null!==t&&(k=C(k,t)),t=k,k=null,t){if(I(t,A),k)throw Error(a(95));if(v)throw t=_,v=!1,_=null,t}}var P={injectEventPluginOrder:function(t){if(s)throw Error(a(101));s=Array.prototype.slice.call(t),c()},injectEventPluginsByName:function(t){var e,n=!1;for(e in t)if(t.hasOwnProperty(e)){var r=t[e];if(!u.hasOwnProperty(e)||u[e]!==r){if(u[e])throw Error(a(102,e));u[e]=r,n=!0}}n&&c()}};function D(t,e){var n=t.stateNode;if(!n)return null;var r=x(n);if(!r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(a(231,e,typeof n));return n}var M=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;M.hasOwnProperty("ReactCurrentDispatcher")||(M.ReactCurrentDispatcher={current:null}),M.hasOwnProperty("ReactCurrentBatchConfig")||(M.ReactCurrentBatchConfig={suspense:null});var R=/^(.*)[\\\/]/,N="function"===typeof Symbol&&Symbol.for,L=N?Symbol.for("react.element"):60103,F=N?Symbol.for("react.portal"):60106,j=N?Symbol.for("react.fragment"):60107,z=N?Symbol.for("react.strict_mode"):60108,B=N?Symbol.for("react.profiler"):60114,U=N?Symbol.for("react.provider"):60109,V=N?Symbol.for("react.context"):60110,q=N?Symbol.for("react.concurrent_mode"):60111,W=N?Symbol.for("react.forward_ref"):60112,G=N?Symbol.for("react.suspense"):60113,H=N?Symbol.for("react.suspense_list"):60120,K=N?Symbol.for("react.memo"):60115,Q=N?Symbol.for("react.lazy"):60116;N&&Symbol.for("react.fundamental"),N&&Symbol.for("react.responder"),N&&Symbol.for("react.scope");var X="function"===typeof Symbol&&Symbol.iterator;function Y(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=X&&t[X]||t["@@iterator"])?t:null}function Z(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case j:return"Fragment";case F:return"Portal";case B:return"Profiler";case z:return"StrictMode";case G:return"Suspense";case H:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case V:return"Context.Consumer";case U:return"Context.Provider";case W:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case K:return Z(t.type);case Q:if(t=1===t._status?t._result:null)return Z(t)}return null}function J(t){var e="";do{t:switch(t.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break t;default:var r=t._debugOwner,i=t._debugSource,o=Z(t.type);n=null,r&&(n=Z(r.type)),r=o,o="",i?o=" (at "+i.fileName.replace(R,"")+":"+i.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+o}e+=n,t=t.return}while(t);return e}var $=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),tt=null,et=null,nt=null;function rt(t){if(t=E(t)){if("function"!==typeof tt)throw Error(a(280));var e=x(t.stateNode);tt(t.stateNode,t.type,e)}}function it(t){et?nt?nt.push(t):nt=[t]:et=t}function ot(){if(et){var t=et,e=nt;if(nt=et=null,rt(t),e)for(t=0;t<e.length;t++)rt(e[t])}}function at(t,e){return t(e)}function st(t,e,n,r){return t(e,n,r)}function ut(){}var ct=at,lt=!1,ht=!1;function pt(){null===et&&null===nt||(ut(),ot())}new Map;var ft=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dt=Object.prototype.hasOwnProperty,mt={},yt={};function gt(t,e,n,r,i,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o}var vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){vt[t]=new gt(t,0,!1,t,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];vt[e]=new gt(e,1,!1,t[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){vt[t]=new gt(t,2,!1,t.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){vt[t]=new gt(t,2,!1,t,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){vt[t]=new gt(t,3,!1,t.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(t){vt[t]=new gt(t,3,!0,t,null,!1)})),["capture","download"].forEach((function(t){vt[t]=new gt(t,4,!1,t,null,!1)})),["cols","rows","size","span"].forEach((function(t){vt[t]=new gt(t,6,!1,t,null,!1)})),["rowSpan","start"].forEach((function(t){vt[t]=new gt(t,5,!1,t.toLowerCase(),null,!1)}));var _t=/[\-:]([a-z])/g;function bt(t){return t[1].toUpperCase()}function wt(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function xt(t,e,n,r){var i=vt.hasOwnProperty(e)?vt[e]:null;(null!==i?0===i.type:!r&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!dt.call(yt,t)||!dt.call(mt,t)&&(ft.test(t)?yt[t]=!0:(mt[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}function Et(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function Tt(t){t._valueTracker||(t._valueTracker=function(t){var e=Et(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function St(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Et(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function Ct(t,e){var n=e.checked;return i({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function It(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=wt(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function kt(t,e){null!=(e=e.checked)&&xt(t,"checked",e,!1)}function At(t,e){kt(t,e);var n=wt(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?Pt(t,e.type,n):e.hasOwnProperty("defaultValue")&&Pt(t,e.type,wt(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Ot(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!t.defaultChecked,t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function Pt(t,e,n){"number"===e&&t.ownerDocument.activeElement===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function Dt(t,e){return t=i({children:void 0},e),(e=function(t){var e="";return r.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function Mt(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+wt(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function Rt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(a(91));return i({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Nt(t,e){var n=e.value;if(null==n){if(n=e.defaultValue,null!=(e=e.children)){if(null!=n)throw Error(a(92));if(Array.isArray(e)){if(!(1>=e.length))throw Error(a(93));e=e[0]}n=e}null==n&&(n="")}t._wrapperState={initialValue:wt(n)}}function Lt(t,e){var n=wt(e.value),r=wt(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function Ft(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(_t,bt);vt[e]=new gt(e,1,!1,t,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(_t,bt);vt[e]=new gt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(_t,bt);vt[e]=new gt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(t){vt[t]=new gt(t,1,!1,t.toLowerCase(),null,!1)})),vt.xlinkHref=new gt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(t){vt[t]=new gt(t,1,!1,t.toLowerCase(),null,!0)}));var jt={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function zt(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?zt(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var Ut,Vt=function(t){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction((function(){return t(e,n)}))}:t}((function(t,e){if(t.namespaceURI!==jt.svg||"innerHTML"in t)t.innerHTML=e;else{for((Ut=Ut||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ut.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}}));function qt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}function Wt(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Gt={animationend:Wt("Animation","AnimationEnd"),animationiteration:Wt("Animation","AnimationIteration"),animationstart:Wt("Animation","AnimationStart"),transitionend:Wt("Transition","TransitionEnd")},Ht={},Kt={};function Qt(t){if(Ht[t])return Ht[t];if(!Gt[t])return t;var e,n=Gt[t];for(e in n)if(n.hasOwnProperty(e)&&e in Kt)return Ht[t]=n[e];return t}$&&(Kt=document.createElement("div").style,"AnimationEvent"in window||(delete Gt.animationend.animation,delete Gt.animationiteration.animation,delete Gt.animationstart.animation),"TransitionEvent"in window||delete Gt.transitionend.transition);var Xt=Qt("animationend"),Yt=Qt("animationiteration"),Zt=Qt("animationstart"),Jt=Qt("transitionend"),$t="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" ");function te(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(1026&(e=t).effectTag)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function ee(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function ne(t){if(te(t)!==t)throw Error(a(188))}function re(t){if(!(t=function(t){var e=t.alternate;if(!e){if(null===(e=te(t)))throw Error(a(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return ne(i),t;if(o===r)return ne(i),e;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?t:e}(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}var ie,oe,ae,se=!1,ue=[],ce=null,le=null,he=null,pe=new Map,fe=new Map,de=[],me="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),ye="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function ge(t,e,n,r){return{blockedOn:t,topLevelType:e,eventSystemFlags:32|n,nativeEvent:r}}function ve(t,e){switch(t){case"focus":case"blur":ce=null;break;case"dragenter":case"dragleave":le=null;break;case"mouseover":case"mouseout":he=null;break;case"pointerover":case"pointerout":pe.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fe.delete(e.pointerId)}}function _e(t,e,n,r,i){return null===t||t.nativeEvent!==i?(t=ge(e,n,r,i),null!==e&&(null!==(e=fr(e))&&oe(e)),t):(t.eventSystemFlags|=r,t)}function be(t){var e=pr(t.target);if(null!==e){var n=te(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=ee(n)))return t.blockedOn=e,void o.unstable_runWithPriority(t.priority,(function(){ae(n)}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function we(t){if(null!==t.blockedOn)return!1;var e=Pn(t.topLevelType,t.eventSystemFlags,t.nativeEvent);if(null!==e){var n=fr(e);return null!==n&&oe(n),t.blockedOn=e,!1}return!0}function xe(t,e,n){we(t)&&n.delete(e)}function Ee(){for(se=!1;0<ue.length;){var t=ue[0];if(null!==t.blockedOn){null!==(t=fr(t.blockedOn))&&ie(t);break}var e=Pn(t.topLevelType,t.eventSystemFlags,t.nativeEvent);null!==e?t.blockedOn=e:ue.shift()}null!==ce&&we(ce)&&(ce=null),null!==le&&we(le)&&(le=null),null!==he&&we(he)&&(he=null),pe.forEach(xe),fe.forEach(xe)}function Te(t,e){t.blockedOn===e&&(t.blockedOn=null,se||(se=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Ee)))}function Se(t){function e(e){return Te(e,t)}if(0<ue.length){Te(ue[0],t);for(var n=1;n<ue.length;n++){var r=ue[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==ce&&Te(ce,t),null!==le&&Te(le,t),null!==he&&Te(he,t),pe.forEach(e),fe.forEach(e),n=0;n<de.length;n++)(r=de[n]).blockedOn===t&&(r.blockedOn=null);for(;0<de.length&&null===(n=de[0]).blockedOn;)be(n),null===n.blockedOn&&de.shift()}function Ce(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}function Ie(t){do{t=t.return}while(t&&5!==t.tag);return t||null}function ke(t,e,n){(e=D(t,n.dispatchConfig.phasedRegistrationNames[e]))&&(n._dispatchListeners=C(n._dispatchListeners,e),n._dispatchInstances=C(n._dispatchInstances,t))}function Ae(t){if(t&&t.dispatchConfig.phasedRegistrationNames){for(var e=t._targetInst,n=[];e;)n.push(e),e=Ie(e);for(e=n.length;0<e--;)ke(n[e],"captured",t);for(e=0;e<n.length;e++)ke(n[e],"bubbled",t)}}function Oe(t,e,n){t&&n&&n.dispatchConfig.registrationName&&(e=D(t,n.dispatchConfig.registrationName))&&(n._dispatchListeners=C(n._dispatchListeners,e),n._dispatchInstances=C(n._dispatchInstances,t))}function Pe(t){t&&t.dispatchConfig.registrationName&&Oe(t._targetInst,null,t)}function De(t){I(t,Ae)}function Me(){return!0}function Re(){return!1}function Ne(t,e,n,r){for(var i in this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=n,t=this.constructor.Interface)t.hasOwnProperty(i)&&((e=t[i])?this[i]=e(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Me:Re,this.isPropagationStopped=Re,this}function Le(t,e,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,t,e,n,r),i}return new this(t,e,n,r)}function Fe(t){if(!(t instanceof this))throw Error(a(279));t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function je(t){t.eventPool=[],t.getPooled=Le,t.release=Fe}i(Ne.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=Me)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=Me)},persist:function(){this.isPersistent=Me},isPersistent:Re,destructor:function(){var t,e=this.constructor.Interface;for(t in e)this[t]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Re,this._dispatchInstances=this._dispatchListeners=null}}),Ne.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Ne.extend=function(t){function e(){}function n(){return r.apply(this,arguments)}var r=this;e.prototype=r.prototype;var o=new e;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,t),n.extend=r.extend,je(n),n},je(Ne);var ze=Ne.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Be=Ne.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ue=Ne.extend({view:null,detail:null}),Ve=Ue.extend({relatedTarget:null});function qe(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}var We={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ge={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},He={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ke(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=He[t])&&!!e[t]}function Qe(){return Ke}for(var Xe=Ue.extend({key:function(t){if(t.key){var e=We[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=qe(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?Ge[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Qe,charCode:function(t){return"keypress"===t.type?qe(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?qe(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Ye=0,Ze=0,Je=!1,$e=!1,tn=Ue.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Qe,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},movementX:function(t){if("movementX"in t)return t.movementX;var e=Ye;return Ye=t.screenX,Je?"mousemove"===t.type?t.screenX-e:0:(Je=!0,0)},movementY:function(t){if("movementY"in t)return t.movementY;var e=Ze;return Ze=t.screenY,$e?"mousemove"===t.type?t.screenY-e:0:($e=!0,0)}}),en=tn.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),nn=tn.extend({dataTransfer:null}),rn=Ue.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Qe}),on=Ne.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),an=tn.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),sn=[["blur","blur",0],["cancel","cancel",0],["click","click",0],["close","close",0],["contextmenu","contextMenu",0],["copy","copy",0],["cut","cut",0],["auxclick","auxClick",0],["dblclick","doubleClick",0],["dragend","dragEnd",0],["dragstart","dragStart",0],["drop","drop",0],["focus","focus",0],["input","input",0],["invalid","invalid",0],["keydown","keyDown",0],["keypress","keyPress",0],["keyup","keyUp",0],["mousedown","mouseDown",0],["mouseup","mouseUp",0],["paste","paste",0],["pause","pause",0],["play","play",0],["pointercancel","pointerCancel",0],["pointerdown","pointerDown",0],["pointerup","pointerUp",0],["ratechange","rateChange",0],["reset","reset",0],["seeked","seeked",0],["submit","submit",0],["touchcancel","touchCancel",0],["touchend","touchEnd",0],["touchstart","touchStart",0],["volumechange","volumeChange",0],["drag","drag",1],["dragenter","dragEnter",1],["dragexit","dragExit",1],["dragleave","dragLeave",1],["dragover","dragOver",1],["mousemove","mouseMove",1],["mouseout","mouseOut",1],["mouseover","mouseOver",1],["pointermove","pointerMove",1],["pointerout","pointerOut",1],["pointerover","pointerOver",1],["scroll","scroll",1],["toggle","toggle",1],["touchmove","touchMove",1],["wheel","wheel",1],["abort","abort",2],[Xt,"animationEnd",2],[Yt,"animationIteration",2],[Zt,"animationStart",2],["canplay","canPlay",2],["canplaythrough","canPlayThrough",2],["durationchange","durationChange",2],["emptied","emptied",2],["encrypted","encrypted",2],["ended","ended",2],["error","error",2],["gotpointercapture","gotPointerCapture",2],["load","load",2],["loadeddata","loadedData",2],["loadedmetadata","loadedMetadata",2],["loadstart","loadStart",2],["lostpointercapture","lostPointerCapture",2],["playing","playing",2],["progress","progress",2],["seeking","seeking",2],["stalled","stalled",2],["suspend","suspend",2],["timeupdate","timeUpdate",2],[Jt,"transitionEnd",2],["waiting","waiting",2]],un={},cn={},ln=0;ln<sn.length;ln++){var hn=sn[ln],pn=hn[0],fn=hn[1],dn=hn[2],mn="on"+(fn[0].toUpperCase()+fn.slice(1)),yn={phasedRegistrationNames:{bubbled:mn,captured:mn+"Capture"},dependencies:[pn],eventPriority:dn};un[fn]=yn,cn[pn]=yn}var gn={eventTypes:un,getEventPriority:function(t){return void 0!==(t=cn[t])?t.eventPriority:2},extractEvents:function(t,e,n,r){var i=cn[t];if(!i)return null;switch(t){case"keypress":if(0===qe(n))return null;case"keydown":case"keyup":t=Xe;break;case"blur":case"focus":t=Ve;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":t=tn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":t=nn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":t=rn;break;case Xt:case Yt:case Zt:t=ze;break;case Jt:t=on;break;case"scroll":t=Ue;break;case"wheel":t=an;break;case"copy":case"cut":case"paste":t=Be;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":t=en;break;default:t=Ne}return De(e=t.getPooled(i,e,n,r)),e}},vn=o.unstable_UserBlockingPriority,_n=o.unstable_runWithPriority,bn=gn.getEventPriority,wn=10,xn=[];function En(t){var e=t.targetInst,n=e;do{if(!n){t.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(e=n.tag)&&6!==e||t.ancestors.push(n),n=pr(r)}while(n);for(n=0;n<t.ancestors.length;n++){e=t.ancestors[n];var i=Ce(t.nativeEvent);r=t.topLevelType;for(var o=t.nativeEvent,a=t.eventSystemFlags,s=null,u=0;u<h.length;u++){var c=h[u];c&&(c=c.extractEvents(r,e,o,i,a))&&(s=C(s,c))}O(s)}}var Tn=!0;function Sn(t,e){Cn(e,t,!1)}function Cn(t,e,n){switch(bn(e)){case 0:var r=In.bind(null,e,1);break;case 1:r=kn.bind(null,e,1);break;default:r=On.bind(null,e,1)}n?t.addEventListener(e,r,!0):t.addEventListener(e,r,!1)}function In(t,e,n){lt||ut();var r=On,i=lt;lt=!0;try{st(r,t,e,n)}finally{(lt=i)||pt()}}function kn(t,e,n){_n(vn,On.bind(null,t,e,n))}function An(t,e,n,r){if(xn.length){var i=xn.pop();i.topLevelType=t,i.eventSystemFlags=e,i.nativeEvent=n,i.targetInst=r,t=i}else t={topLevelType:t,eventSystemFlags:e,nativeEvent:n,targetInst:r,ancestors:[]};try{if(e=En,n=t,ht)e(n,void 0);else{ht=!0;try{ct(e,n,void 0)}finally{ht=!1,pt()}}}finally{t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,xn.length<wn&&xn.push(t)}}function On(t,e,n){if(Tn)if(0<ue.length&&-1<me.indexOf(t))t=ge(null,t,e,n),ue.push(t);else{var r=Pn(t,e,n);null===r?ve(t,n):-1<me.indexOf(t)?(t=ge(r,t,e,n),ue.push(t)):function(t,e,n,r){switch(e){case"focus":return ce=_e(ce,t,e,n,r),!0;case"dragenter":return le=_e(le,t,e,n,r),!0;case"mouseover":return he=_e(he,t,e,n,r),!0;case"pointerover":var i=r.pointerId;return pe.set(i,_e(pe.get(i)||null,t,e,n,r)),!0;case"gotpointercapture":return i=r.pointerId,fe.set(i,_e(fe.get(i)||null,t,e,n,r)),!0}return!1}(r,t,e,n)||(ve(t,n),An(t,e,n,null))}}function Pn(t,e,n){var r=Ce(n);if(null!==(r=pr(r))){var i=te(r);if(null===i)r=null;else{var o=i.tag;if(13===o){if(null!==(r=ee(i)))return r;r=null}else if(3===o){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return An(t,e,n,r),null}function Dn(t){if(!$)return!1;var e=(t="on"+t)in document;return e||((e=document.createElement("div")).setAttribute(t,"return;"),e="function"===typeof e[t]),e}var Mn=new("function"===typeof WeakMap?WeakMap:Map);function Rn(t){var e=Mn.get(t);return void 0===e&&(e=new Set,Mn.set(t,e)),e}function Nn(t,e,n){if(!n.has(t)){switch(t){case"scroll":Cn(e,"scroll",!0);break;case"focus":case"blur":Cn(e,"focus",!0),Cn(e,"blur",!0),n.add("blur"),n.add("focus");break;case"cancel":case"close":Dn(t)&&Cn(e,t,!0);break;case"invalid":case"submit":case"reset":break;default:-1===$t.indexOf(t)&&Sn(t,e)}n.add(t)}}var Ln={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fn=["Webkit","ms","Moz","O"];function jn(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||Ln.hasOwnProperty(t)&&Ln[t]?(""+e).trim():e+"px"}function zn(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=jn(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys(Ln).forEach((function(t){Fn.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ln[e]=Ln[t]}))}));var Bn=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Un(t,e){if(e){if(Bn[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(a(137,t,""));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(a(60));if(!("object"===typeof e.dangerouslySetInnerHTML&&"__html"in e.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(a(62,""))}}function Vn(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function qn(t,e){var n=Rn(t=9===t.nodeType||11===t.nodeType?t:t.ownerDocument);e=d[e];for(var r=0;r<e.length;r++)Nn(e[r],t,n)}function Wn(){}function Gn(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Hn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Kn(t,e){var n,r=Hn(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=Hn(r)}}function Qn(){for(var t=window,e=Gn();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(r){n=!1}if(!n)break;e=Gn((t=e.contentWindow).document)}return e}function Xn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var Yn="$",Zn="/$",Jn="$?",$n="$!",tr=null,er=null;function nr(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function rr(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,or="function"===typeof clearTimeout?clearTimeout:void 0;function ar(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function sr(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if(n===Yn||n===$n||n===Jn){if(0===e)return t;e--}else n===Zn&&e++}t=t.previousSibling}return null}var ur=Math.random().toString(36).slice(2),cr="__reactInternalInstance$"+ur,lr="__reactEventHandlers$"+ur,hr="__reactContainere$"+ur;function pr(t){var e=t[cr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[hr]||n[cr]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=sr(t);null!==t;){if(n=t[cr])return n;t=sr(t)}return e}n=(t=n).parentNode}return null}function fr(t){return!(t=t[cr]||t[hr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function dr(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(a(33))}function mr(t){return t[lr]||null}var yr=null,gr=null,vr=null;function _r(){if(vr)return vr;var t,e,n=gr,r=n.length,i="value"in yr?yr.value:yr.textContent,o=i.length;for(t=0;t<r&&n[t]===i[t];t++);var a=r-t;for(e=1;e<=a&&n[r-e]===i[o-e];e++);return vr=i.slice(t,1<e?1-e:void 0)}var br=Ne.extend({data:null}),wr=Ne.extend({data:null}),xr=[9,13,27,32],Er=$&&"CompositionEvent"in window,Tr=null;$&&"documentMode"in document&&(Tr=document.documentMode);var Sr=$&&"TextEvent"in window&&!Tr,Cr=$&&(!Er||Tr&&8<Tr&&11>=Tr),Ir=String.fromCharCode(32),kr={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},Ar=!1;function Or(t,e){switch(t){case"keyup":return-1!==xr.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function Pr(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Dr=!1;var Mr={eventTypes:kr,extractEvents:function(t,e,n,r){var i;if(Er)t:{switch(t){case"compositionstart":var o=kr.compositionStart;break t;case"compositionend":o=kr.compositionEnd;break t;case"compositionupdate":o=kr.compositionUpdate;break t}o=void 0}else Dr?Or(t,n)&&(o=kr.compositionEnd):"keydown"===t&&229===n.keyCode&&(o=kr.compositionStart);return o?(Cr&&"ko"!==n.locale&&(Dr||o!==kr.compositionStart?o===kr.compositionEnd&&Dr&&(i=_r()):(gr="value"in(yr=r)?yr.value:yr.textContent,Dr=!0)),o=br.getPooled(o,e,n,r),i?o.data=i:null!==(i=Pr(n))&&(o.data=i),De(o),i=o):i=null,(t=Sr?function(t,e){switch(t){case"compositionend":return Pr(e);case"keypress":return 32!==e.which?null:(Ar=!0,Ir);case"textInput":return(t=e.data)===Ir&&Ar?null:t;default:return null}}(t,n):function(t,e){if(Dr)return"compositionend"===t||!Er&&Or(t,e)?(t=_r(),vr=gr=yr=null,Dr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Cr&&"ko"!==e.locale?null:e.data;default:return null}}(t,n))?((e=wr.getPooled(kr.beforeInput,e,n,r)).data=t,De(e)):e=null,null===i?e:null===e?i:[i,e]}},Rr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Rr[t.type]:"textarea"===e}var Lr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function Fr(t,e,n){return(t=Ne.getPooled(Lr.change,t,e,n)).type="change",it(n),De(t),t}var jr=null,zr=null;function Br(t){O(t)}function Ur(t){if(St(dr(t)))return t}function Vr(t,e){if("change"===t)return e}var qr=!1;function Wr(){jr&&(jr.detachEvent("onpropertychange",Gr),zr=jr=null)}function Gr(t){if("value"===t.propertyName&&Ur(zr))if(t=Fr(zr,t,Ce(t)),lt)O(t);else{lt=!0;try{at(Br,t)}finally{lt=!1,pt()}}}function Hr(t,e,n){"focus"===t?(Wr(),zr=n,(jr=e).attachEvent("onpropertychange",Gr)):"blur"===t&&Wr()}function Kr(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Ur(zr)}function Qr(t,e){if("click"===t)return Ur(e)}function Xr(t,e){if("input"===t||"change"===t)return Ur(e)}$&&(qr=Dn("input")&&(!document.documentMode||9<document.documentMode));var Yr,Zr={eventTypes:Lr,_isInputEventSupported:qr,extractEvents:function(t,e,n,r){var i=e?dr(e):window,o=i.nodeName&&i.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===i.type)var a=Vr;else if(Nr(i))if(qr)a=Xr;else{a=Kr;var s=Hr}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(a=Qr);if(a&&(a=a(t,e)))return Fr(a,n,r);s&&s(t,i,e),"blur"===t&&(t=i._wrapperState)&&t.controlled&&"number"===i.type&&Pt(i,"number",i.value)}},Jr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},$r={eventTypes:Jr,extractEvents:function(t,e,n,r,i){var o="mouseover"===t||"pointerover"===t,a="mouseout"===t||"pointerout"===t;if(o&&0===(32&i)&&(n.relatedTarget||n.fromElement)||!a&&!o)return null;if(i=r.window===r?r:(i=r.ownerDocument)?i.defaultView||i.parentWindow:window,a?(a=e,null!==(e=(e=n.relatedTarget||n.toElement)?pr(e):null)&&(e!==(o=te(e))||5!==e.tag&&6!==e.tag)&&(e=null)):a=null,a===e)return null;if("mouseout"===t||"mouseover"===t)var s=tn,u=Jr.mouseLeave,c=Jr.mouseEnter,l="mouse";else"pointerout"!==t&&"pointerover"!==t||(s=en,u=Jr.pointerLeave,c=Jr.pointerEnter,l="pointer");if(t=null==a?i:dr(a),i=null==e?i:dr(e),(u=s.getPooled(u,a,n,r)).type=l+"leave",u.target=t,u.relatedTarget=i,(r=s.getPooled(c,e,n,r)).type=l+"enter",r.target=i,r.relatedTarget=t,l=e,(s=a)&&l)t:{for(t=l,a=0,e=c=s;e;e=Ie(e))a++;for(e=0,i=t;i;i=Ie(i))e++;for(;0<a-e;)c=Ie(c),a--;for(;0<e-a;)t=Ie(t),e--;for(;a--;){if(c===t||c===t.alternate)break t;c=Ie(c),t=Ie(t)}c=null}else c=null;for(t=c,c=[];s&&s!==t&&(null===(a=s.alternate)||a!==t);)c.push(s),s=Ie(s);for(s=[];l&&l!==t&&(null===(a=l.alternate)||a!==t);)s.push(l),l=Ie(l);for(l=0;l<c.length;l++)Oe(c[l],"bubbled",u);for(l=s.length;0<l--;)Oe(s[l],"captured",r);return n===Yr?(Yr=null,[u]):(Yr=n,[u,r])}};var ti="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},ei=Object.prototype.hasOwnProperty;function ni(t,e){if(ti(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!ei.call(e,n[r])||!ti(t[n[r]],e[n[r]]))return!1;return!0}var ri=$&&"documentMode"in document&&11>=document.documentMode,ii={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},oi=null,ai=null,si=null,ui=!1;function ci(t,e){var n=e.window===e?e.document:9===e.nodeType?e:e.ownerDocument;return ui||null==oi||oi!==Gn(n)?null:("selectionStart"in(n=oi)&&Xn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},si&&ni(si,n)?null:(si=n,(t=Ne.getPooled(ii.select,ai,t,e)).type="select",t.target=oi,De(t),t))}var li={eventTypes:ii,extractEvents:function(t,e,n,r){var i,o=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;if(!(i=!o)){t:{o=Rn(o),i=d.onSelect;for(var a=0;a<i.length;a++)if(!o.has(i[a])){o=!1;break t}o=!0}i=!o}if(i)return null;switch(o=e?dr(e):window,t){case"focus":(Nr(o)||"true"===o.contentEditable)&&(oi=o,ai=e,si=null);break;case"blur":si=ai=oi=null;break;case"mousedown":ui=!0;break;case"contextmenu":case"mouseup":case"dragend":return ui=!1,ci(n,r);case"selectionchange":if(ri)break;case"keydown":case"keyup":return ci(n,r)}return null}};P.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),x=mr,E=fr,T=dr,P.injectEventPluginsByName({SimpleEventPlugin:gn,EnterLeaveEventPlugin:$r,ChangeEventPlugin:Zr,SelectEventPlugin:li,BeforeInputEventPlugin:Mr}),new Set;var hi=[],pi=-1;function fi(t){0>pi||(t.current=hi[pi],hi[pi]=null,pi--)}function di(t,e){pi++,hi[pi]=t.current,t.current=e}var mi={},yi={current:mi},gi={current:!1},vi=mi;function _i(t,e){var n=t.type.contextTypes;if(!n)return mi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function bi(t){return null!==(t=t.childContextTypes)&&void 0!==t}function wi(t){fi(gi),fi(yi)}function xi(t){fi(gi),fi(yi)}function Ei(t,e,n){if(yi.current!==mi)throw Error(a(168));di(yi,e),di(gi,n)}function Ti(t,e,n){var r=t.stateNode;if(t=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(a(108,Z(e)||"Unknown",o));return i({},n,{},r)}function Si(t){var e=t.stateNode;return e=e&&e.__reactInternalMemoizedMergedChildContext||mi,vi=yi.current,di(yi,e),di(gi,gi.current),!0}function Ci(t,e,n){var r=t.stateNode;if(!r)throw Error(a(169));n?(e=Ti(t,e,vi),r.__reactInternalMemoizedMergedChildContext=e,fi(gi),fi(yi),di(yi,e)):fi(gi),di(gi,n)}var Ii=o.unstable_runWithPriority,ki=o.unstable_scheduleCallback,Ai=o.unstable_cancelCallback,Oi=o.unstable_shouldYield,Pi=o.unstable_requestPaint,Di=o.unstable_now,Mi=o.unstable_getCurrentPriorityLevel,Ri=o.unstable_ImmediatePriority,Ni=o.unstable_UserBlockingPriority,Li=o.unstable_NormalPriority,Fi=o.unstable_LowPriority,ji=o.unstable_IdlePriority,zi={},Bi=void 0!==Pi?Pi:function(){},Ui=null,Vi=null,qi=!1,Wi=Di(),Gi=1e4>Wi?Di:function(){return Di()-Wi};function Hi(){switch(Mi()){case Ri:return 99;case Ni:return 98;case Li:return 97;case Fi:return 96;case ji:return 95;default:throw Error(a(332))}}function Ki(t){switch(t){case 99:return Ri;case 98:return Ni;case 97:return Li;case 96:return Fi;case 95:return ji;default:throw Error(a(332))}}function Qi(t,e){return t=Ki(t),Ii(t,e)}function Xi(t,e,n){return t=Ki(t),ki(t,e,n)}function Yi(t){return null===Ui?(Ui=[t],Vi=ki(Ri,Ji)):Ui.push(t),zi}function Zi(){if(null!==Vi){var t=Vi;Vi=null,Ai(t)}Ji()}function Ji(){if(!qi&&null!==Ui){qi=!0;var t=0;try{var e=Ui;Qi(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),Ui=null}catch(n){throw null!==Ui&&(Ui=Ui.slice(t+1)),ki(Ri,Zi),n}finally{qi=!1}}}var $i=3;function to(t,e,n){return 1073741821-(1+((1073741821-t+e/10)/(n/=10)|0))*n}function eo(t,e){if(t&&t.defaultProps)for(var n in e=i({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}var no={current:null},ro=null,io=null,oo=null;function ao(){oo=io=ro=null}function so(t,e){var n=t.type._context;di(no,n._currentValue),n._currentValue=e}function uo(t){var e=no.current;fi(no),t.type._context._currentValue=e}function co(t,e){for(;null!==t;){var n=t.alternate;if(t.childExpirationTime<e)t.childExpirationTime=e,null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e);else{if(!(null!==n&&n.childExpirationTime<e))break;n.childExpirationTime=e}t=t.return}}function lo(t,e){ro=t,oo=io=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(t.expirationTime>=e&&(Ga=!0),t.firstContext=null)}function ho(t,e){if(oo!==t&&!1!==e&&0!==e)if("number"===typeof e&&1073741823!==e||(oo=t,e=1073741823),e={context:t,observedBits:e,next:null},null===io){if(null===ro)throw Error(a(308));io=e,ro.dependencies={expirationTime:0,firstContext:e,responders:null}}else io=io.next=e;return t._currentValue}var po=!1;function fo(t){return{baseState:t,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function mo(t){return{baseState:t.baseState,firstUpdate:t.firstUpdate,lastUpdate:t.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function yo(t,e){return{expirationTime:t,suspenseConfig:e,tag:0,payload:null,callback:null,next:null,nextEffect:null}}function go(t,e){null===t.lastUpdate?t.firstUpdate=t.lastUpdate=e:(t.lastUpdate.next=e,t.lastUpdate=e)}function vo(t,e){var n=t.alternate;if(null===n){var r=t.updateQueue,i=null;null===r&&(r=t.updateQueue=fo(t.memoizedState))}else r=t.updateQueue,i=n.updateQueue,null===r?null===i?(r=t.updateQueue=fo(t.memoizedState),i=n.updateQueue=fo(n.memoizedState)):r=t.updateQueue=mo(i):null===i&&(i=n.updateQueue=mo(r));null===i||r===i?go(r,e):null===r.lastUpdate||null===i.lastUpdate?(go(r,e),go(i,e)):(go(r,e),i.lastUpdate=e)}function _o(t,e){var n=t.updateQueue;null===(n=null===n?t.updateQueue=fo(t.memoizedState):bo(t,n)).lastCapturedUpdate?n.firstCapturedUpdate=n.lastCapturedUpdate=e:(n.lastCapturedUpdate.next=e,n.lastCapturedUpdate=e)}function bo(t,e){var n=t.alternate;return null!==n&&e===n.updateQueue&&(e=t.updateQueue=mo(e)),e}function wo(t,e,n,r,o,a){switch(n.tag){case 1:return"function"===typeof(t=n.payload)?t.call(a,r,o):t;case 3:t.effectTag=-4097&t.effectTag|64;case 0:if(null===(o="function"===typeof(t=n.payload)?t.call(a,r,o):t)||void 0===o)break;return i({},r,o);case 2:po=!0}return r}function xo(t,e,n,r,i){po=!1;for(var o=(e=bo(t,e)).baseState,a=null,s=0,u=e.firstUpdate,c=o;null!==u;){var l=u.expirationTime;l<i?(null===a&&(a=u,o=c),s<l&&(s=l)):(Iu(l,u.suspenseConfig),c=wo(t,0,u,c,n,r),null!==u.callback&&(t.effectTag|=32,u.nextEffect=null,null===e.lastEffect?e.firstEffect=e.lastEffect=u:(e.lastEffect.nextEffect=u,e.lastEffect=u))),u=u.next}for(l=null,u=e.firstCapturedUpdate;null!==u;){var h=u.expirationTime;h<i?(null===l&&(l=u,null===a&&(o=c)),s<h&&(s=h)):(c=wo(t,0,u,c,n,r),null!==u.callback&&(t.effectTag|=32,u.nextEffect=null,null===e.lastCapturedEffect?e.firstCapturedEffect=e.lastCapturedEffect=u:(e.lastCapturedEffect.nextEffect=u,e.lastCapturedEffect=u))),u=u.next}null===a&&(e.lastUpdate=null),null===l?e.lastCapturedUpdate=null:t.effectTag|=32,null===a&&null===l&&(o=c),e.baseState=o,e.firstUpdate=a,e.firstCapturedUpdate=l,ku(s),t.expirationTime=s,t.memoizedState=c}function Eo(t,e,n){null!==e.firstCapturedUpdate&&(null!==e.lastUpdate&&(e.lastUpdate.next=e.firstCapturedUpdate,e.lastUpdate=e.lastCapturedUpdate),e.firstCapturedUpdate=e.lastCapturedUpdate=null),To(e.firstEffect,n),e.firstEffect=e.lastEffect=null,To(e.firstCapturedEffect,n),e.firstCapturedEffect=e.lastCapturedEffect=null}function To(t,e){for(;null!==t;){var n=t.callback;if(null!==n){t.callback=null;var r=e;if("function"!==typeof n)throw Error(a(191,n));n.call(r)}t=t.nextEffect}}var So=M.ReactCurrentBatchConfig,Co=(new r.Component).refs;function Io(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:i({},e,n),t.memoizedState=n,null!==(r=t.updateQueue)&&0===t.expirationTime&&(r.baseState=n)}var ko={isMounted:function(t){return!!(t=t._reactInternalFiber)&&te(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternalFiber;var r=du(),i=So.suspense;(i=yo(r=mu(r,t,i),i)).payload=e,void 0!==n&&null!==n&&(i.callback=n),vo(t,i),yu(t,r)},enqueueReplaceState:function(t,e,n){t=t._reactInternalFiber;var r=du(),i=So.suspense;(i=yo(r=mu(r,t,i),i)).tag=1,i.payload=e,void 0!==n&&null!==n&&(i.callback=n),vo(t,i),yu(t,r)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var n=du(),r=So.suspense;(r=yo(n=mu(n,t,r),r)).tag=2,void 0!==e&&null!==e&&(r.callback=e),vo(t,r),yu(t,n)}};function Ao(t,e,n,r,i,o,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!ni(n,r)||!ni(i,o))}function Oo(t,e,n){var r=!1,i=mi,o=e.contextType;return"object"===typeof o&&null!==o?o=ho(o):(i=bi(e)?vi:yi.current,o=(r=null!==(r=e.contextTypes)&&void 0!==r)?_i(t,i):mi),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=ko,t.stateNode=e,e._reactInternalFiber=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Po(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ko.enqueueReplaceState(e,e.state,null)}function Do(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=Co;var o=e.contextType;"object"===typeof o&&null!==o?i.context=ho(o):(o=bi(e)?vi:yi.current,i.context=_i(t,o)),null!==(o=t.updateQueue)&&(xo(t,o,n,i,r),i.state=t.memoizedState),"function"===typeof(o=e.getDerivedStateFromProps)&&(Io(t,e,o,n),i.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(e=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&ko.enqueueReplaceState(i,i.state,null),null!==(o=t.updateQueue)&&(xo(t,o,n,i,r),i.state=t.memoizedState)),"function"===typeof i.componentDidMount&&(t.effectTag|=4)}var Mo=Array.isArray;function Ro(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,t));var i=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===i?e.ref:((e=function(t){var e=r.refs;e===Co&&(e=r.refs={}),null===t?delete e[i]:e[i]=t})._stringRef=i,e)}if("string"!==typeof t)throw Error(a(284));if(!n._owner)throw Error(a(290,t))}return t}function No(t,e){if("textarea"!==t.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,""))}function Lo(t){function e(e,n){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e,n){return(t=Qu(t,e)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.effectTag=2,n):r:(e.effectTag=2,n):n}function s(e){return t&&null===e.alternate&&(e.effectTag=2),e}function u(t,e,n,r){return null===e||6!==e.tag?((e=Zu(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function c(t,e,n,r){return null!==e&&e.elementType===n.type?((r=i(e,n.props)).ref=Ro(t,e,n),r.return=t,r):((r=Xu(n.type,n.key,n.props,null,t.mode,r)).ref=Ro(t,e,n),r.return=t,r)}function l(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Ju(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function h(t,e,n,r,o){return null===e||7!==e.tag?((e=Yu(n,t.mode,r,o)).return=t,e):((e=i(e,n)).return=t,e)}function p(t,e,n){if("string"===typeof e||"number"===typeof e)return(e=Zu(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case L:return(n=Xu(e.type,e.key,e.props,null,t.mode,n)).ref=Ro(t,null,e),n.return=t,n;case F:return(e=Ju(e,t.mode,n)).return=t,e}if(Mo(e)||Y(e))return(e=Yu(e,t.mode,n,null)).return=t,e;No(t,e)}return null}function f(t,e,n,r){var i=null!==e?e.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:u(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case L:return n.key===i?n.type===j?h(t,e,n.props.children,r,i):c(t,e,n,r):null;case F:return n.key===i?l(t,e,n,r):null}if(Mo(n)||Y(n))return null!==i?null:h(t,e,n,r,null);No(t,n)}return null}function d(t,e,n,r,i){if("string"===typeof r||"number"===typeof r)return u(e,t=t.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case L:return t=t.get(null===r.key?n:r.key)||null,r.type===j?h(e,t,r.props.children,i,r.key):c(e,t,r,i);case F:return l(e,t=t.get(null===r.key?n:r.key)||null,r,i)}if(Mo(r)||Y(r))return h(e,t=t.get(n)||null,r,i,null);No(e,r)}return null}function m(i,a,s,u){for(var c=null,l=null,h=a,m=a=0,y=null;null!==h&&m<s.length;m++){h.index>m?(y=h,h=null):y=h.sibling;var g=f(i,h,s[m],u);if(null===g){null===h&&(h=y);break}t&&h&&null===g.alternate&&e(i,h),a=o(g,a,m),null===l?c=g:l.sibling=g,l=g,h=y}if(m===s.length)return n(i,h),c;if(null===h){for(;m<s.length;m++)null!==(h=p(i,s[m],u))&&(a=o(h,a,m),null===l?c=h:l.sibling=h,l=h);return c}for(h=r(i,h);m<s.length;m++)null!==(y=d(h,i,m,s[m],u))&&(t&&null!==y.alternate&&h.delete(null===y.key?m:y.key),a=o(y,a,m),null===l?c=y:l.sibling=y,l=y);return t&&h.forEach((function(t){return e(i,t)})),c}function y(i,s,u,c){var l=Y(u);if("function"!==typeof l)throw Error(a(150));if(null==(u=l.call(u)))throw Error(a(151));for(var h=l=null,m=s,y=s=0,g=null,v=u.next();null!==m&&!v.done;y++,v=u.next()){m.index>y?(g=m,m=null):g=m.sibling;var _=f(i,m,v.value,c);if(null===_){null===m&&(m=g);break}t&&m&&null===_.alternate&&e(i,m),s=o(_,s,y),null===h?l=_:h.sibling=_,h=_,m=g}if(v.done)return n(i,m),l;if(null===m){for(;!v.done;y++,v=u.next())null!==(v=p(i,v.value,c))&&(s=o(v,s,y),null===h?l=v:h.sibling=v,h=v);return l}for(m=r(i,m);!v.done;y++,v=u.next())null!==(v=d(m,i,y,v.value,c))&&(t&&null!==v.alternate&&m.delete(null===v.key?y:v.key),s=o(v,s,y),null===h?l=v:h.sibling=v,h=v);return t&&m.forEach((function(t){return e(i,t)})),l}return function(t,r,o,u){var c="object"===typeof o&&null!==o&&o.type===j&&null===o.key;c&&(o=o.props.children);var l="object"===typeof o&&null!==o;if(l)switch(o.$$typeof){case L:t:{for(l=o.key,c=r;null!==c;){if(c.key===l){if(7===c.tag?o.type===j:c.elementType===o.type){n(t,c.sibling),(r=i(c,o.type===j?o.props.children:o.props)).ref=Ro(t,c,o),r.return=t,t=r;break t}n(t,c);break}e(t,c),c=c.sibling}o.type===j?((r=Yu(o.props.children,t.mode,u,o.key)).return=t,t=r):((u=Xu(o.type,o.key,o.props,null,t.mode,u)).ref=Ro(t,r,o),u.return=t,t=u)}return s(t);case F:t:{for(c=o.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(t,r.sibling),(r=i(r,o.children||[])).return=t,t=r;break t}n(t,r);break}e(t,r),r=r.sibling}(r=Ju(o,t.mode,u)).return=t,t=r}return s(t)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==r&&6===r.tag?(n(t,r.sibling),(r=i(r,o)).return=t,t=r):(n(t,r),(r=Zu(o,t.mode,u)).return=t,t=r),s(t);if(Mo(o))return m(t,r,o,u);if(Y(o))return y(t,r,o,u);if(l&&No(t,o),"undefined"===typeof o&&!c)switch(t.tag){case 1:case 0:throw t=t.type,Error(a(152,t.displayName||t.name||"Component"))}return n(t,r)}}var Fo=Lo(!0),jo=Lo(!1),zo={},Bo={current:zo},Uo={current:zo},Vo={current:zo};function qo(t){if(t===zo)throw Error(a(174));return t}function Wo(t,e){di(Vo,e),di(Uo,t),di(Bo,zo);var n=e.nodeType;switch(n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Bt(null,"");break;default:e=Bt(e=(n=8===n?e.parentNode:e).namespaceURI||null,n=n.tagName)}fi(Bo),di(Bo,e)}function Go(t){fi(Bo),fi(Uo),fi(Vo)}function Ho(t){qo(Vo.current);var e=qo(Bo.current),n=Bt(e,t.type);e!==n&&(di(Uo,t),di(Bo,n))}function Ko(t){Uo.current===t&&(fi(Bo),fi(Uo))}var Qo={current:0};function Xo(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||n.data===Jn||n.data===$n))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(64&e.effectTag))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function Yo(t,e){return{responder:t,props:e}}var Zo=M.ReactCurrentDispatcher,Jo=M.ReactCurrentBatchConfig,$o=0,ta=null,ea=null,na=null,ra=null,ia=null,oa=null,aa=0,sa=null,ua=0,ca=!1,la=null,ha=0;function pa(){throw Error(a(321))}function fa(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ti(t[n],e[n]))return!1;return!0}function da(t,e,n,r,i,o){if($o=o,ta=e,na=null!==t?t.memoizedState:null,Zo.current=null===na?Ma:Ra,e=n(r,i),ca){do{ca=!1,ha+=1,na=null!==t?t.memoizedState:null,oa=ra,sa=ia=ea=null,Zo.current=Ra,e=n(r,i)}while(ca);la=null,ha=0}if(Zo.current=Da,(t=ta).memoizedState=ra,t.expirationTime=aa,t.updateQueue=sa,t.effectTag|=ua,t=null!==ea&&null!==ea.next,$o=0,oa=ia=ra=na=ea=ta=null,aa=0,sa=null,ua=0,t)throw Error(a(300));return e}function ma(){Zo.current=Da,$o=0,oa=ia=ra=na=ea=ta=null,aa=0,sa=null,ua=0,ca=!1,la=null,ha=0}function ya(){var t={memoizedState:null,baseState:null,queue:null,baseUpdate:null,next:null};return null===ia?ra=ia=t:ia=ia.next=t,ia}function ga(){if(null!==oa)oa=(ia=oa).next,na=null!==(ea=na)?ea.next:null;else{if(null===na)throw Error(a(310));var t={memoizedState:(ea=na).memoizedState,baseState:ea.baseState,queue:ea.queue,baseUpdate:ea.baseUpdate,next:null};ia=null===ia?ra=t:ia.next=t,na=ea.next}return ia}function va(t,e){return"function"===typeof e?e(t):e}function _a(t){var e=ga(),n=e.queue;if(null===n)throw Error(a(311));if(n.lastRenderedReducer=t,0<ha){var r=n.dispatch;if(null!==la){var i=la.get(n);if(void 0!==i){la.delete(n);var o=e.memoizedState;do{o=t(o,i.action),i=i.next}while(null!==i);return ti(o,e.memoizedState)||(Ga=!0),e.memoizedState=o,e.baseUpdate===n.last&&(e.baseState=o),n.lastRenderedState=o,[o,r]}}return[e.memoizedState,r]}r=n.last;var s=e.baseUpdate;if(o=e.baseState,null!==s?(null!==r&&(r.next=null),r=s.next):r=null!==r?r.next:null,null!==r){var u=i=null,c=r,l=!1;do{var h=c.expirationTime;h<$o?(l||(l=!0,u=s,i=o),h>aa&&ku(aa=h)):(Iu(h,c.suspenseConfig),o=c.eagerReducer===t?c.eagerState:t(o,c.action)),s=c,c=c.next}while(null!==c&&c!==r);l||(u=s,i=o),ti(o,e.memoizedState)||(Ga=!0),e.memoizedState=o,e.baseUpdate=u,e.baseState=i,n.lastRenderedState=o}return[e.memoizedState,n.dispatch]}function ba(t){var e=ya();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={last:null,dispatch:null,lastRenderedReducer:va,lastRenderedState:t}).dispatch=Pa.bind(null,ta,t),[e.memoizedState,t]}function wa(t){return _a(va)}function xa(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===sa?(sa={lastEffect:null}).lastEffect=t.next=t:null===(e=sa.lastEffect)?sa.lastEffect=t.next=t:(n=e.next,e.next=t,t.next=n,sa.lastEffect=t),t}function Ea(t,e,n,r){var i=ya();ua|=t,i.memoizedState=xa(e,n,void 0,void 0===r?null:r)}function Ta(t,e,n,r){var i=ga();r=void 0===r?null:r;var o=void 0;if(null!==ea){var a=ea.memoizedState;if(o=a.destroy,null!==r&&fa(r,a.deps))return void xa(0,n,o,r)}ua|=t,i.memoizedState=xa(e,n,o,r)}function Sa(t,e){return Ea(516,192,t,e)}function Ca(t,e){return Ta(516,192,t,e)}function Ia(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function ka(){}function Aa(t,e){return ya().memoizedState=[t,void 0===e?null:e],t}function Oa(t,e){var n=ga();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&fa(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Pa(t,e,n){if(!(25>ha))throw Error(a(301));var r=t.alternate;if(t===ta||null!==r&&r===ta)if(ca=!0,t={expirationTime:$o,suspenseConfig:null,action:n,eagerReducer:null,eagerState:null,next:null},null===la&&(la=new Map),void 0===(n=la.get(e)))la.set(e,t);else{for(e=n;null!==e.next;)e=e.next;e.next=t}else{var i=du(),o=So.suspense;o={expirationTime:i=mu(i,t,o),suspenseConfig:o,action:n,eagerReducer:null,eagerState:null,next:null};var s=e.last;if(null===s)o.next=o;else{var u=s.next;null!==u&&(o.next=u),s.next=o}if(e.last=o,0===t.expirationTime&&(null===r||0===r.expirationTime)&&null!==(r=e.lastRenderedReducer))try{var c=e.lastRenderedState,l=r(c,n);if(o.eagerReducer=r,o.eagerState=l,ti(l,c))return}catch(h){}yu(t,i)}}var Da={readContext:ho,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useResponder:pa,useDeferredValue:pa,useTransition:pa},Ma={readContext:ho,useCallback:Aa,useContext:ho,useEffect:Sa,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Ea(4,36,Ia.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ea(4,36,t,e)},useMemo:function(t,e){var n=ya();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ya();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t=(t=r.queue={last:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=Pa.bind(null,ta,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},ya().memoizedState=t},useState:ba,useDebugValue:ka,useResponder:Yo,useDeferredValue:function(t,e){var n=ba(t),r=n[0],i=n[1];return Sa((function(){o.unstable_next((function(){var n=Jo.suspense;Jo.suspense=void 0===e?null:e;try{i(t)}finally{Jo.suspense=n}}))}),[t,e]),r},useTransition:function(t){var e=ba(!1),n=e[0],r=e[1];return[Aa((function(e){r(!0),o.unstable_next((function(){var n=Jo.suspense;Jo.suspense=void 0===t?null:t;try{r(!1),e()}finally{Jo.suspense=n}}))}),[t,n]),n]}},Ra={readContext:ho,useCallback:Oa,useContext:ho,useEffect:Ca,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Ta(4,36,Ia.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ta(4,36,t,e)},useMemo:function(t,e){var n=ga();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&fa(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)},useReducer:_a,useRef:function(){return ga().memoizedState},useState:wa,useDebugValue:ka,useResponder:Yo,useDeferredValue:function(t,e){var n=wa(),r=n[0],i=n[1];return Ca((function(){o.unstable_next((function(){var n=Jo.suspense;Jo.suspense=void 0===e?null:e;try{i(t)}finally{Jo.suspense=n}}))}),[t,e]),r},useTransition:function(t){var e=wa(),n=e[0],r=e[1];return[Oa((function(e){r(!0),o.unstable_next((function(){var n=Jo.suspense;Jo.suspense=void 0===t?null:t;try{r(!1),e()}finally{Jo.suspense=n}}))}),[t,n]),n]}},Na=null,La=null,Fa=!1;function ja(t,e){var n=Hu(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function za(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);case 13:default:return!1}}function Ba(t){if(Fa){var e=La;if(e){var n=e;if(!za(t,e)){if(!(e=ar(n.nextSibling))||!za(t,e))return t.effectTag=-1025&t.effectTag|2,Fa=!1,void(Na=t);ja(Na,n)}Na=t,La=ar(e.firstChild)}else t.effectTag=-1025&t.effectTag|2,Fa=!1,Na=t}}function Ua(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;Na=t}function Va(t){if(t!==Na)return!1;if(!Fa)return Ua(t),Fa=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!rr(e,t.memoizedProps))for(e=La;e;)ja(t,e),e=ar(e.nextSibling);if(Ua(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(a(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if(n===Zn){if(0===e){La=ar(t.nextSibling);break t}e--}else n!==Yn&&n!==$n&&n!==Jn||e++}t=t.nextSibling}La=null}}else La=Na?ar(t.stateNode.nextSibling):null;return!0}function qa(){La=Na=null,Fa=!1}var Wa=M.ReactCurrentOwner,Ga=!1;function Ha(t,e,n,r){e.child=null===t?jo(e,null,n,r):Fo(e,t.child,n,r)}function Ka(t,e,n,r,i){n=n.render;var o=e.ref;return lo(e,i),r=da(t,e,n,r,o,i),null===t||Ga?(e.effectTag|=1,Ha(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=i&&(t.expirationTime=0),ls(t,e,i))}function Qa(t,e,n,r,i,o){if(null===t){var a=n.type;return"function"!==typeof a||Ku(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Xu(n.type,null,r,null,e.mode,o)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=a,Xa(t,e,a,r,i,o))}return a=t.child,i<o&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:ni)(i,r)&&t.ref===e.ref)?ls(t,e,o):(e.effectTag|=1,(t=Qu(a,r)).ref=e.ref,t.return=e,e.child=t)}function Xa(t,e,n,r,i,o){return null!==t&&ni(t.memoizedProps,r)&&t.ref===e.ref&&(Ga=!1,i<o)?ls(t,e,o):Za(t,e,n,r,o)}function Ya(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.effectTag|=128)}function Za(t,e,n,r,i){var o=bi(n)?vi:yi.current;return o=_i(e,o),lo(e,i),n=da(t,e,n,r,o,i),null===t||Ga?(e.effectTag|=1,Ha(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=i&&(t.expirationTime=0),ls(t,e,i))}function Ja(t,e,n,r,i){if(bi(n)){var o=!0;Si(e)}else o=!1;if(lo(e,i),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),Oo(e,n,r),Do(e,n,r,i),r=!0;else if(null===t){var a=e.stateNode,s=e.memoizedProps;a.props=s;var u=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=ho(c):c=_i(e,c=bi(n)?vi:yi.current);var l=n.getDerivedStateFromProps,h="function"===typeof l||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||u!==c)&&Po(e,a,r,c),po=!1;var p=e.memoizedState;u=a.state=p;var f=e.updateQueue;null!==f&&(xo(e,f,r,a,i),u=e.memoizedState),s!==r||p!==u||gi.current||po?("function"===typeof l&&(Io(e,n,l,r),u=e.memoizedState),(s=po||Ao(e,n,s,r,p,u,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.effectTag|=4)):("function"===typeof a.componentDidMount&&(e.effectTag|=4),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=c,r=s):("function"===typeof a.componentDidMount&&(e.effectTag|=4),r=!1)}else a=e.stateNode,s=e.memoizedProps,a.props=e.type===e.elementType?s:eo(e.type,s),u=a.context,"object"===typeof(c=n.contextType)&&null!==c?c=ho(c):c=_i(e,c=bi(n)?vi:yi.current),(h="function"===typeof(l=n.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||u!==c)&&Po(e,a,r,c),po=!1,u=e.memoizedState,p=a.state=u,null!==(f=e.updateQueue)&&(xo(e,f,r,a,i),p=e.memoizedState),s!==r||u!==p||gi.current||po?("function"===typeof l&&(Io(e,n,l,r),p=e.memoizedState),(l=po||Ao(e,n,s,r,u,p,c))?(h||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,c),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,c)),"function"===typeof a.componentDidUpdate&&(e.effectTag|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.effectTag|=256)):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=256),e.memoizedProps=r,e.memoizedState=p),a.props=r,a.state=p,a.context=c,r=l):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=256),r=!1);return $a(t,e,n,r,o,i)}function $a(t,e,n,r,i,o){Ya(t,e);var a=0!==(64&e.effectTag);if(!r&&!a)return i&&Ci(e,n,!1),ls(t,e,o);r=e.stateNode,Wa.current=e;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.effectTag|=1,null!==t&&a?(e.child=Fo(e,t.child,null,o),e.child=Fo(e,null,s,o)):Ha(t,e,s,o),e.memoizedState=r.state,i&&Ci(e,n,!0),e.child}function ts(t){var e=t.stateNode;e.pendingContext?Ei(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Ei(0,e.context,!1),Wo(t,e.containerInfo)}var es,ns,rs,is,os={dehydrated:null,retryTime:0};function as(t,e,n){var r,i=e.mode,o=e.pendingProps,a=Qo.current,s=!1;if((r=0!==(64&e.effectTag))||(r=0!==(2&a)&&(null===t||null!==t.memoizedState)),r?(s=!0,e.effectTag&=-65):null!==t&&null===t.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(a|=1),di(Qo,1&a),null===t){if(void 0!==o.fallback&&Ba(e),s){if(s=o.fallback,(o=Yu(null,i,0,null)).return=e,0===(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,o.child=t;null!==t;)t.return=o,t=t.sibling;return(n=Yu(s,i,n,null)).return=e,o.sibling=n,e.memoizedState=os,e.child=o,n}return i=o.children,e.memoizedState=null,e.child=jo(e,null,i,n)}if(null!==t.memoizedState){if(i=(t=t.child).sibling,s){if(o=o.fallback,(n=Qu(t,t.pendingProps)).return=e,0===(2&e.mode)&&(s=null!==e.memoizedState?e.child.child:e.child)!==t.child)for(n.child=s;null!==s;)s.return=n,s=s.sibling;return(i=Qu(i,o,i.expirationTime)).return=e,n.sibling=i,n.childExpirationTime=0,e.memoizedState=os,e.child=n,i}return n=Fo(e,t.child,o.children,n),e.memoizedState=null,e.child=n}if(t=t.child,s){if(s=o.fallback,(o=Yu(null,i,0,null)).return=e,o.child=t,null!==t&&(t.return=o),0===(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,o.child=t;null!==t;)t.return=o,t=t.sibling;return(n=Yu(s,i,n,null)).return=e,o.sibling=n,n.effectTag|=2,o.childExpirationTime=0,e.memoizedState=os,e.child=o,n}return e.memoizedState=null,e.child=Fo(e,t,o.children,n)}function ss(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e),co(t.return,e)}function us(t,e,n,r,i,o){var a=t.memoizedState;null===a?t.memoizedState={isBackwards:e,rendering:null,last:r,tail:n,tailExpiration:0,tailMode:i,lastEffect:o}:(a.isBackwards=e,a.rendering=null,a.last=r,a.tail=n,a.tailExpiration=0,a.tailMode=i,a.lastEffect=o)}function cs(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Ha(t,e,r.children,n),0!==(2&(r=Qo.current)))r=1&r|2,e.effectTag|=64;else{if(null!==t&&0!==(64&t.effectTag))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&ss(t,n);else if(19===t.tag)ss(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(di(Qo,r),0===(2&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;null!==n;)null!==(t=n.alternate)&&null===Xo(t)&&(i=n),n=n.sibling;null===(n=i)?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),us(e,!1,i,n,o,e.lastEffect);break;case"backwards":for(n=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===Xo(t)){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}us(e,!0,n,null,o,e.lastEffect);break;case"together":us(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function ls(t,e,n){null!==t&&(e.dependencies=t.dependencies);var r=e.expirationTime;if(0!==r&&ku(r),e.childExpirationTime<n)return null;if(null!==t&&e.child!==t.child)throw Error(a(153));if(null!==e.child){for(n=Qu(t=e.child,t.pendingProps,t.expirationTime),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Qu(t,t.pendingProps,t.expirationTime)).return=e;n.sibling=null}return e.child}function hs(t){t.effectTag|=4}function ps(t,e){switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function fs(t){switch(t.tag){case 1:bi(t.type)&&wi();var e=t.effectTag;return 4096&e?(t.effectTag=-4097&e|64,t):null;case 3:if(Go(),xi(),0!==(64&(e=t.effectTag)))throw Error(a(285));return t.effectTag=-4097&e|64,t;case 5:return Ko(t),null;case 13:return fi(Qo),4096&(e=t.effectTag)?(t.effectTag=-4097&e|64,t):null;case 19:return fi(Qo),null;case 4:return Go(),null;case 10:return uo(t),null;default:return null}}function ds(t,e){return{value:t,source:e,stack:J(e)}}es=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},ns=function(){},rs=function(t,e,n,r,o){var a=t.memoizedProps;if(a!==r){var s,u,c=e.stateNode;switch(qo(Bo.current),t=null,n){case"input":a=Ct(c,a),r=Ct(c,r),t=[];break;case"option":a=Dt(c,a),r=Dt(c,r),t=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),t=[];break;case"textarea":a=Rt(c,a),r=Rt(c,r),t=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(c.onclick=Wn)}for(s in Un(n,r),n=null,a)if(!r.hasOwnProperty(s)&&a.hasOwnProperty(s)&&null!=a[s])if("style"===s)for(u in c=a[s])c.hasOwnProperty(u)&&(n||(n={}),n[u]="");else"dangerouslySetInnerHTML"!==s&&"children"!==s&&"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(f.hasOwnProperty(s)?t||(t=[]):(t=t||[]).push(s,null));for(s in r){var l=r[s];if(c=null!=a?a[s]:void 0,r.hasOwnProperty(s)&&l!==c&&(null!=l||null!=c))if("style"===s)if(c){for(u in c)!c.hasOwnProperty(u)||l&&l.hasOwnProperty(u)||(n||(n={}),n[u]="");for(u in l)l.hasOwnProperty(u)&&c[u]!==l[u]&&(n||(n={}),n[u]=l[u])}else n||(t||(t=[]),t.push(s,n)),n=l;else"dangerouslySetInnerHTML"===s?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(t=t||[]).push(s,""+l)):"children"===s?c===l||"string"!==typeof l&&"number"!==typeof l||(t=t||[]).push(s,""+l):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&(f.hasOwnProperty(s)?(null!=l&&qn(o,s),t||c===l||(t=[])):(t=t||[]).push(s,l))}n&&(t=t||[]).push("style",n),o=t,(e.updateQueue=o)&&hs(e)}},is=function(t,e,n,r){n!==r&&hs(e)};var ms="function"===typeof WeakSet?WeakSet:Set;function ys(t,e){var n=e.source,r=e.stack;null===r&&null!==n&&(r=J(n)),null!==n&&Z(n.type),e=e.value,null!==t&&1===t.tag&&Z(t.type);try{console.error(e)}catch(i){setTimeout((function(){throw i}))}}function gs(t){var e=t.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(n){Bu(t,n)}else e.current=null}function vs(t,e){switch(e.tag){case 0:case 11:case 15:_s(2,0,e);break;case 1:if(256&e.effectTag&&null!==t){var n=t.memoizedProps,r=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:eo(e.type,n),r),t.__reactInternalSnapshotBeforeUpdate=e}break;case 3:case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}function _s(t,e,n){if(null!==(n=null!==(n=n.updateQueue)?n.lastEffect:null)){var r=n=n.next;do{if(0!==(r.tag&t)){var i=r.destroy;r.destroy=void 0,void 0!==i&&i()}0!==(r.tag&e)&&(i=r.create,r.destroy=i()),r=r.next}while(r!==n)}}function bs(t,e,n){switch("function"===typeof Wu&&Wu(e),e.tag){case 0:case 11:case 14:case 15:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var r=t.next;Qi(97<n?97:n,(function(){var t=r;do{var n=t.destroy;if(void 0!==n){var i=e;try{n()}catch(o){Bu(i,o)}}t=t.next}while(t!==r)}))}break;case 1:gs(e),"function"===typeof(n=e.stateNode).componentWillUnmount&&function(t,e){try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(n){Bu(t,n)}}(e,n);break;case 5:gs(e);break;case 4:Ts(t,e,n)}}function ws(t){var e=t.alternate;t.return=null,t.child=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.alternate=null,t.firstEffect=null,t.lastEffect=null,t.pendingProps=null,t.memoizedProps=null,null!==e&&ws(e)}function xs(t){return 5===t.tag||3===t.tag||4===t.tag}function Es(t){t:{for(var e=t.return;null!==e;){if(xs(e)){var n=e;break t}e=e.return}throw Error(a(160))}switch(e=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:e=e.containerInfo,r=!0;break;default:throw Error(a(161))}16&n.effectTag&&(qt(e,""),n.effectTag&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||xs(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break t}}for(var i=t;;){var o=5===i.tag||6===i.tag;if(o){var s=o?i.stateNode:i.stateNode.instance;if(n)if(r){var u=s;s=n,8===(o=e).nodeType?o.parentNode.insertBefore(u,s):o.insertBefore(u,s)}else e.insertBefore(s,n);else r?(8===(u=e).nodeType?(o=u.parentNode).insertBefore(s,u):(o=u).appendChild(s),null!==(u=u._reactRootContainer)&&void 0!==u||null!==o.onclick||(o.onclick=Wn)):e.appendChild(s)}else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function Ts(t,e,n){for(var r,i,o=e,s=!1;;){if(!s){s=o.return;t:for(;;){if(null===s)throw Error(a(160));switch(r=s.stateNode,s.tag){case 5:i=!1;break t;case 3:case 4:r=r.containerInfo,i=!0;break t}s=s.return}s=!0}if(5===o.tag||6===o.tag){t:for(var u=t,c=o,l=n,h=c;;)if(bs(u,h,l),null!==h.child&&4!==h.tag)h.child.return=h,h=h.child;else{if(h===c)break;for(;null===h.sibling;){if(null===h.return||h.return===c)break t;h=h.return}h.sibling.return=h.return,h=h.sibling}i?(u=r,c=o.stateNode,8===u.nodeType?u.parentNode.removeChild(c):u.removeChild(c)):r.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,i=!0,o.child.return=o,o=o.child;continue}}else if(bs(t,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===e)break;for(;null===o.sibling;){if(null===o.return||o.return===e)return;4===(o=o.return).tag&&(s=!1)}o.sibling.return=o.return,o=o.sibling}}function Ss(t,e){switch(e.tag){case 0:case 11:case 14:case 15:_s(4,8,e);break;case 1:break;case 5:var n=e.stateNode;if(null!=n){var r=e.memoizedProps,i=null!==t?t.memoizedProps:r;t=e.type;var o=e.updateQueue;if(e.updateQueue=null,null!==o){for(n[lr]=r,"input"===t&&"radio"===r.type&&null!=r.name&&kt(n,r),Vn(t,i),e=Vn(t,r),i=0;i<o.length;i+=2){var s=o[i],u=o[i+1];"style"===s?zn(n,u):"dangerouslySetInnerHTML"===s?Vt(n,u):"children"===s?qt(n,u):xt(n,s,u,e)}switch(t){case"input":At(n,r);break;case"textarea":Lt(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(t=r.value)?Mt(n,!!r.multiple,t,!1):e!==!!r.multiple&&(null!=r.defaultValue?Mt(n,!!r.multiple,r.defaultValue,!0):Mt(n,!!r.multiple,r.multiple?[]:"",!1))}}}break;case 6:if(null===e.stateNode)throw Error(a(162));e.stateNode.nodeValue=e.memoizedProps;break;case 3:(e=e.stateNode).hydrate&&(e.hydrate=!1,Se(e.containerInfo));break;case 12:break;case 13:if(n=e,null===e.memoizedState?r=!1:(r=!0,n=e.child,eu=Gi()),null!==n)t:for(t=n;;){if(5===t.tag)o=t.stateNode,r?"function"===typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=t.stateNode,i=void 0!==(i=t.memoizedProps.style)&&null!==i&&i.hasOwnProperty("display")?i.display:null,o.style.display=jn("display",i));else if(6===t.tag)t.stateNode.nodeValue=r?"":t.memoizedProps;else{if(13===t.tag&&null!==t.memoizedState&&null===t.memoizedState.dehydrated){(o=t.child.sibling).return=t,t=o;continue}if(null!==t.child){t.child.return=t,t=t.child;continue}}if(t===n)break t;for(;null===t.sibling;){if(null===t.return||t.return===n)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}Cs(e);break;case 19:Cs(e);break;case 17:case 20:case 21:break;default:throw Error(a(163))}}function Cs(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new ms),e.forEach((function(e){var r=Vu.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}var Is="function"===typeof WeakMap?WeakMap:Map;function ks(t,e,n){(n=yo(n,null)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){iu||(iu=!0,ou=r),ys(t,e)},n}function As(t,e,n){(n=yo(n,null)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var i=e.value;n.payload=function(){return ys(t,e),r(i)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===au?au=new Set([this]):au.add(this),ys(t,e));var n=e.stack;this.componentDidCatch(e.value,{componentStack:null!==n?n:""})}),n}var Os,Ps=Math.ceil,Ds=M.ReactCurrentDispatcher,Ms=M.ReactCurrentOwner,Rs=0,Ns=8,Ls=16,Fs=32,js=0,zs=1,Bs=2,Us=3,Vs=4,qs=5,Ws=Rs,Gs=null,Hs=null,Ks=0,Qs=js,Xs=null,Ys=1073741823,Zs=1073741823,Js=null,$s=0,tu=!1,eu=0,nu=500,ru=null,iu=!1,ou=null,au=null,su=!1,uu=null,cu=90,lu=null,hu=0,pu=null,fu=0;function du(){return(Ws&(Ls|Fs))!==Rs?1073741821-(Gi()/10|0):0!==fu?fu:fu=1073741821-(Gi()/10|0)}function mu(t,e,n){if(0===(2&(e=e.mode)))return 1073741823;var r=Hi();if(0===(4&e))return 99===r?1073741823:1073741822;if((Ws&Ls)!==Rs)return Ks;if(null!==n)t=to(t,0|n.timeoutMs||5e3,250);else switch(r){case 99:t=1073741823;break;case 98:t=to(t,150,100);break;case 97:case 96:t=to(t,5e3,250);break;case 95:t=2;break;default:throw Error(a(326))}return null!==Gs&&t===Ks&&--t,t}function yu(t,e){if(50<hu)throw hu=0,pu=null,Error(a(185));if(null!==(t=gu(t,e))){var n=Hi();1073741823===e?(Ws&Ns)!==Rs&&(Ws&(Ls|Fs))===Rs?wu(t):(_u(t),Ws===Rs&&Zi()):_u(t),(4&Ws)===Rs||98!==n&&99!==n||(null===lu?lu=new Map([[t,e]]):(void 0===(n=lu.get(t))||n>e)&&lu.set(t,e))}}function gu(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e);var r=t.return,i=null;if(null===r&&3===t.tag)i=t.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<e&&(r.childExpirationTime=e),null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null!==i&&(Gs===i&&(ku(e),Qs===Vs&&ec(i,Ks)),nc(i,e)),i}function vu(t){var e=t.lastExpiredTime;return 0!==e?e:tc(t,e=t.firstPendingTime)?(e=t.lastPingedTime)>(t=t.nextKnownPendingLevel)?e:t:e}function _u(t){if(0!==t.lastExpiredTime)t.callbackExpirationTime=1073741823,t.callbackPriority=99,t.callbackNode=Yi(wu.bind(null,t));else{var e=vu(t),n=t.callbackNode;if(0===e)null!==n&&(t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90);else{var r=du();if(1073741823===e?r=99:1===e||2===e?r=95:r=0>=(r=10*(1073741821-e)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var i=t.callbackPriority;if(t.callbackExpirationTime===e&&i>=r)return;n!==zi&&Ai(n)}t.callbackExpirationTime=e,t.callbackPriority=r,e=1073741823===e?Yi(wu.bind(null,t)):Xi(r,bu.bind(null,t),{timeout:10*(1073741821-e)-Gi()}),t.callbackNode=e}}}function bu(t,e){if(fu=0,e)return rc(t,e=du()),_u(t),null;var n=vu(t);if(0!==n){if(e=t.callbackNode,(Ws&(Ls|Fs))!==Rs)throw Error(a(327));if(Fu(),t===Gs&&n===Ks||Tu(t,n),null!==Hs){var r=Ws;Ws|=Ls;for(var i=Cu();;)try{Ou();break}catch(u){Su(t,u)}if(ao(),Ws=r,Ds.current=i,Qs===zs)throw e=Xs,Tu(t,n),ec(t,n),_u(t),e;if(null===Hs)switch(i=t.finishedWork=t.current.alternate,t.finishedExpirationTime=n,r=Qs,Gs=null,r){case js:case zs:throw Error(a(345));case Bs:rc(t,2<n?2:n);break;case Us:if(ec(t,n),n===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=Mu(i)),1073741823===Ys&&10<(i=eu+nu-Gi())){if(tu){var o=t.lastPingedTime;if(0===o||o>=n){t.lastPingedTime=n,Tu(t,n);break}}if(0!==(o=vu(t))&&o!==n)break;if(0!==r&&r!==n){t.lastPingedTime=r;break}t.timeoutHandle=ir(Ru.bind(null,t),i);break}Ru(t);break;case Vs:if(ec(t,n),n===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=Mu(i)),tu&&(0===(i=t.lastPingedTime)||i>=n)){t.lastPingedTime=n,Tu(t,n);break}if(0!==(i=vu(t))&&i!==n)break;if(0!==r&&r!==n){t.lastPingedTime=r;break}if(1073741823!==Zs?r=10*(1073741821-Zs)-Gi():1073741823===Ys?r=0:(r=10*(1073741821-Ys)-5e3,0>(r=(i=Gi())-r)&&(r=0),(n=10*(1073741821-n)-i)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ps(r/1960))-r)&&(r=n)),10<r){t.timeoutHandle=ir(Ru.bind(null,t),r);break}Ru(t);break;case qs:if(1073741823!==Ys&&null!==Js){o=Ys;var s=Js;if(0>=(r=0|s.busyMinDurationMs)?r=0:(i=0|s.busyDelayMs,r=(o=Gi()-(10*(1073741821-o)-(0|s.timeoutMs||5e3)))<=i?0:i+r-o),10<r){ec(t,n),t.timeoutHandle=ir(Ru.bind(null,t),r);break}}Ru(t);break;default:throw Error(a(329))}if(_u(t),t.callbackNode===e)return bu.bind(null,t)}}return null}function wu(t){var e=t.lastExpiredTime;if(e=0!==e?e:1073741823,t.finishedExpirationTime===e)Ru(t);else{if((Ws&(Ls|Fs))!==Rs)throw Error(a(327));if(Fu(),t===Gs&&e===Ks||Tu(t,e),null!==Hs){var n=Ws;Ws|=Ls;for(var r=Cu();;)try{Au();break}catch(i){Su(t,i)}if(ao(),Ws=n,Ds.current=r,Qs===zs)throw n=Xs,Tu(t,e),ec(t,e),_u(t),n;if(null!==Hs)throw Error(a(261));t.finishedWork=t.current.alternate,t.finishedExpirationTime=e,Gs=null,Ru(t),_u(t)}}return null}function xu(t,e){var n=Ws;Ws|=1;try{return t(e)}finally{(Ws=n)===Rs&&Zi()}}function Eu(t,e){var n=Ws;Ws&=-2,Ws|=Ns;try{return t(e)}finally{(Ws=n)===Rs&&Zi()}}function Tu(t,e){t.finishedWork=null,t.finishedExpirationTime=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,or(n)),null!==Hs)for(n=Hs.return;null!==n;){var r=n;switch(r.tag){case 1:var i=r.type.childContextTypes;null!==i&&void 0!==i&&wi();break;case 3:Go(),xi();break;case 5:Ko(r);break;case 4:Go();break;case 13:case 19:fi(Qo);break;case 10:uo(r)}n=n.return}Gs=t,Hs=Qu(t.current,null),Ks=e,Qs=js,Xs=null,Zs=Ys=1073741823,Js=null,$s=0,tu=!1}function Su(t,e){for(;;){try{if(ao(),ma(),null===Hs||null===Hs.return)return Qs=zs,Xs=e,null;t:{var n=t,r=Hs.return,i=Hs,o=e;if(e=Ks,i.effectTag|=2048,i.firstEffect=i.lastEffect=null,null!==o&&"object"===typeof o&&"function"===typeof o.then){var a=o,s=0!==(1&Qo.current),u=r;do{var c;if(c=13===u.tag){var l=u.memoizedState;if(null!==l)c=null!==l.dehydrated;else{var h=u.memoizedProps;c=void 0!==h.fallback&&(!0!==h.unstable_avoidThisFallback||!s)}}if(c){var p=u.updateQueue;if(null===p){var f=new Set;f.add(a),u.updateQueue=f}else p.add(a);if(0===(2&u.mode)){if(u.effectTag|=64,i.effectTag&=-2981,1===i.tag)if(null===i.alternate)i.tag=17;else{var d=yo(1073741823,null);d.tag=2,vo(i,d)}i.expirationTime=1073741823;break t}o=void 0,i=e;var m=n.pingCache;if(null===m?(m=n.pingCache=new Is,o=new Set,m.set(a,o)):void 0===(o=m.get(a))&&(o=new Set,m.set(a,o)),!o.has(i)){o.add(i);var y=Uu.bind(null,n,a,i);a.then(y,y)}u.effectTag|=4096,u.expirationTime=e;break t}u=u.return}while(null!==u);o=Error((Z(i.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+J(i))}Qs!==qs&&(Qs=Bs),o=ds(o,i),u=r;do{switch(u.tag){case 3:a=o,u.effectTag|=4096,u.expirationTime=e,_o(u,ks(u,a,e));break t;case 1:a=o;var g=u.type,v=u.stateNode;if(0===(64&u.effectTag)&&("function"===typeof g.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===au||!au.has(v)))){u.effectTag|=4096,u.expirationTime=e,_o(u,As(u,a,e));break t}}u=u.return}while(null!==u)}Hs=Du(Hs)}catch(_){e=_;continue}break}}function Cu(){var t=Ds.current;return Ds.current=Da,null===t?Da:t}function Iu(t,e){t<Ys&&2<t&&(Ys=t),null!==e&&t<Zs&&2<t&&(Zs=t,Js=e)}function ku(t){t>$s&&($s=t)}function Au(){for(;null!==Hs;)Hs=Pu(Hs)}function Ou(){for(;null!==Hs&&!Oi();)Hs=Pu(Hs)}function Pu(t){var e=Os(t.alternate,t,Ks);return t.memoizedProps=t.pendingProps,null===e&&(e=Du(t)),Ms.current=null,e}function Du(t){Hs=t;do{var e=Hs.alternate;if(t=Hs.return,0===(2048&Hs.effectTag)){t:{var n=e,r=Ks,o=(e=Hs).pendingProps;switch(e.tag){case 2:case 16:break;case 15:case 0:break;case 1:bi(e.type)&&wi();break;case 3:Go(),xi(),(o=e.stateNode).pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(null===n||null===n.child)&&Va(e)&&hs(e),ns(e);break;case 5:Ko(e),r=qo(Vo.current);var s=e.type;if(null!==n&&null!=e.stateNode)rs(n,e,s,o,r),n.ref!==e.ref&&(e.effectTag|=128);else if(o){var u=qo(Bo.current);if(Va(e)){var c=(o=e).stateNode;n=o.type;var l=o.memoizedProps,h=r;switch(c[cr]=o,c[lr]=l,s=void 0,r=c,n){case"iframe":case"object":case"embed":Sn("load",r);break;case"video":case"audio":for(c=0;c<$t.length;c++)Sn($t[c],r);break;case"source":Sn("error",r);break;case"img":case"image":case"link":Sn("error",r),Sn("load",r);break;case"form":Sn("reset",r),Sn("submit",r);break;case"details":Sn("toggle",r);break;case"input":It(r,l),Sn("invalid",r),qn(h,"onChange");break;case"select":r._wrapperState={wasMultiple:!!l.multiple},Sn("invalid",r),qn(h,"onChange");break;case"textarea":Nt(r,l),Sn("invalid",r),qn(h,"onChange")}for(s in Un(n,l),c=null,l)l.hasOwnProperty(s)&&(u=l[s],"children"===s?"string"===typeof u?r.textContent!==u&&(c=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(c=["children",""+u]):f.hasOwnProperty(s)&&null!=u&&qn(h,s));switch(n){case"input":Tt(r),Ot(r,l,!0);break;case"textarea":Tt(r),Ft(r);break;case"select":case"option":break;default:"function"===typeof l.onClick&&(r.onclick=Wn)}s=c,o.updateQueue=s,(o=null!==s)&&hs(e)}else{n=e,h=s,l=o,c=9===r.nodeType?r:r.ownerDocument,u===jt.html&&(u=zt(h)),u===jt.html?"script"===h?((l=c.createElement("div")).innerHTML="<script><\/script>",c=l.removeChild(l.firstChild)):"string"===typeof l.is?c=c.createElement(h,{is:l.is}):(c=c.createElement(h),"select"===h&&(h=c,l.multiple?h.multiple=!0:l.size&&(h.size=l.size))):c=c.createElementNS(u,h),(l=c)[cr]=n,l[lr]=o,es(l,e,!1,!1),e.stateNode=l;var p=r,d=Vn(h=s,n=o);switch(h){case"iframe":case"object":case"embed":Sn("load",l),r=n;break;case"video":case"audio":for(r=0;r<$t.length;r++)Sn($t[r],l);r=n;break;case"source":Sn("error",l),r=n;break;case"img":case"image":case"link":Sn("error",l),Sn("load",l),r=n;break;case"form":Sn("reset",l),Sn("submit",l),r=n;break;case"details":Sn("toggle",l),r=n;break;case"input":It(l,n),r=Ct(l,n),Sn("invalid",l),qn(p,"onChange");break;case"option":r=Dt(l,n);break;case"select":l._wrapperState={wasMultiple:!!n.multiple},r=i({},n,{value:void 0}),Sn("invalid",l),qn(p,"onChange");break;case"textarea":Nt(l,n),r=Rt(l,n),Sn("invalid",l),qn(p,"onChange");break;default:r=n}Un(h,r),c=void 0,u=h;var m=l,y=r;for(c in y)if(y.hasOwnProperty(c)){var g=y[c];"style"===c?zn(m,g):"dangerouslySetInnerHTML"===c?null!=(g=g?g.__html:void 0)&&Vt(m,g):"children"===c?"string"===typeof g?("textarea"!==u||""!==g)&&qt(m,g):"number"===typeof g&&qt(m,""+g):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(f.hasOwnProperty(c)?null!=g&&qn(p,c):null!=g&&xt(m,c,g,d))}switch(h){case"input":Tt(l),Ot(l,n,!1);break;case"textarea":Tt(l),Ft(l);break;case"option":null!=n.value&&l.setAttribute("value",""+wt(n.value));break;case"select":(r=l).multiple=!!n.multiple,null!=(l=n.value)?Mt(r,!!n.multiple,l,!1):null!=n.defaultValue&&Mt(r,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof r.onClick&&(l.onclick=Wn)}(o=nr(s,o))&&hs(e)}null!==e.ref&&(e.effectTag|=128)}else if(null===e.stateNode)throw Error(a(166));break;case 6:if(n&&null!=e.stateNode)is(n,e,n.memoizedProps,o);else{if("string"!==typeof o&&null===e.stateNode)throw Error(a(166));r=qo(Vo.current),qo(Bo.current),Va(e)?(s=(o=e).stateNode,r=o.memoizedProps,s[cr]=o,(o=s.nodeValue!==r)&&hs(e)):(s=e,(o=(9===r.nodeType?r:r.ownerDocument).createTextNode(o))[cr]=s,e.stateNode=o)}break;case 11:break;case 13:if(fi(Qo),o=e.memoizedState,0!==(64&e.effectTag)){e.expirationTime=r;break t}o=null!==o,s=!1,null===n?void 0!==e.memoizedProps.fallback&&Va(e):(s=null!==(r=n.memoizedState),o||null===r||null!==(r=n.child.sibling)&&(null!==(l=e.firstEffect)?(e.firstEffect=r,r.nextEffect=l):(e.firstEffect=e.lastEffect=r,r.nextEffect=null),r.effectTag=8)),o&&!s&&0!==(2&e.mode)&&(null===n&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!==(1&Qo.current)?Qs===js&&(Qs=Us):(Qs!==js&&Qs!==Us||(Qs=Vs),0!==$s&&null!==Gs&&(ec(Gs,Ks),nc(Gs,$s)))),(o||s)&&(e.effectTag|=4);break;case 7:case 8:case 12:break;case 4:Go(),ns(e);break;case 10:uo(e);break;case 9:case 14:break;case 17:bi(e.type)&&wi();break;case 19:if(fi(Qo),null===(o=e.memoizedState))break;if(s=0!==(64&e.effectTag),null===(l=o.rendering)){if(s)ps(o,!1);else if(Qs!==js||null!==n&&0!==(64&n.effectTag))for(n=e.child;null!==n;){if(null!==(l=Xo(n))){for(e.effectTag|=64,ps(o,!1),null!==(s=l.updateQueue)&&(e.updateQueue=s,e.effectTag|=4),null===o.lastEffect&&(e.firstEffect=null),e.lastEffect=o.lastEffect,o=r,s=e.child;null!==s;)n=o,(r=s).effectTag&=2,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null,null===(l=r.alternate)?(r.childExpirationTime=0,r.expirationTime=n,r.child=null,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null):(r.childExpirationTime=l.childExpirationTime,r.expirationTime=l.expirationTime,r.child=l.child,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,n=l.dependencies,r.dependencies=null===n?null:{expirationTime:n.expirationTime,firstContext:n.firstContext,responders:n.responders}),s=s.sibling;di(Qo,1&Qo.current|2),e=e.child;break t}n=n.sibling}}else{if(!s)if(null!==(n=Xo(l))){if(e.effectTag|=64,s=!0,null!==(r=n.updateQueue)&&(e.updateQueue=r,e.effectTag|=4),ps(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate){null!==(e=e.lastEffect=o.lastEffect)&&(e.nextEffect=null);break}}else Gi()>o.tailExpiration&&1<r&&(e.effectTag|=64,s=!0,ps(o,!1),e.expirationTime=e.childExpirationTime=r-1);o.isBackwards?(l.sibling=e.child,e.child=l):(null!==(r=o.last)?r.sibling=l:e.child=l,o.last=l)}if(null!==o.tail){0===o.tailExpiration&&(o.tailExpiration=Gi()+500),r=o.tail,o.rendering=r,o.tail=r.sibling,o.lastEffect=e.lastEffect,r.sibling=null,o=Qo.current,di(Qo,o=s?1&o|2:1&o),e=r;break t}break;case 20:case 21:break;default:throw Error(a(156,e.tag))}e=null}if(o=Hs,1===Ks||1!==o.childExpirationTime){for(s=0,r=o.child;null!==r;)(n=r.expirationTime)>s&&(s=n),(l=r.childExpirationTime)>s&&(s=l),r=r.sibling;o.childExpirationTime=s}if(null!==e)return e;null!==t&&0===(2048&t.effectTag)&&(null===t.firstEffect&&(t.firstEffect=Hs.firstEffect),null!==Hs.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=Hs.firstEffect),t.lastEffect=Hs.lastEffect),1<Hs.effectTag&&(null!==t.lastEffect?t.lastEffect.nextEffect=Hs:t.firstEffect=Hs,t.lastEffect=Hs))}else{if(null!==(e=fs(Hs)))return e.effectTag&=2047,e;null!==t&&(t.firstEffect=t.lastEffect=null,t.effectTag|=2048)}if(null!==(e=Hs.sibling))return e;Hs=t}while(null!==Hs);return Qs===js&&(Qs=qs),null}function Mu(t){var e=t.expirationTime;return e>(t=t.childExpirationTime)?e:t}function Ru(t){var e=Hi();return Qi(99,Nu.bind(null,t,e)),null}function Nu(t,e){do{Fu()}while(null!==uu);if((Ws&(Ls|Fs))!==Rs)throw Error(a(327));var n=t.finishedWork,r=t.finishedExpirationTime;if(null===n)return null;if(t.finishedWork=null,t.finishedExpirationTime=0,n===t.current)throw Error(a(177));t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90,t.nextKnownPendingLevel=0;var i=Mu(n);if(t.firstPendingTime=i,r<=t.lastSuspendedTime?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:r<=t.firstSuspendedTime&&(t.firstSuspendedTime=r-1),r<=t.lastPingedTime&&(t.lastPingedTime=0),r<=t.lastExpiredTime&&(t.lastExpiredTime=0),t===Gs&&(Hs=Gs=null,Ks=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){var o=Ws;Ws|=Fs,Ms.current=null,tr=Tn;var s=Qn();if(Xn(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else t:{var c=(u=(u=s.ownerDocument)&&u.defaultView||window).getSelection&&u.getSelection();if(c&&0!==c.rangeCount){u=c.anchorNode;var l=c.anchorOffset,h=c.focusNode;c=c.focusOffset;try{u.nodeType,h.nodeType}catch(N){u=null;break t}var p=0,f=-1,d=-1,m=0,y=0,g=s,v=null;e:for(;;){for(var _;g!==u||0!==l&&3!==g.nodeType||(f=p+l),g!==h||0!==c&&3!==g.nodeType||(d=p+c),3===g.nodeType&&(p+=g.nodeValue.length),null!==(_=g.firstChild);)v=g,g=_;for(;;){if(g===s)break e;if(v===u&&++m===l&&(f=p),v===h&&++y===c&&(d=p),null!==(_=g.nextSibling))break;v=(g=v).parentNode}g=_}u=-1===f||-1===d?null:{start:f,end:d}}else u=null}u=u||{start:0,end:0}}else u=null;er={focusedElem:s,selectionRange:u},Tn=!1,ru=i;do{try{Lu()}catch(N){if(null===ru)throw Error(a(330));Bu(ru,N),ru=ru.nextEffect}}while(null!==ru);ru=i;do{try{for(s=t,u=e;null!==ru;){var b=ru.effectTag;if(16&b&&qt(ru.stateNode,""),128&b){var w=ru.alternate;if(null!==w){var x=w.ref;null!==x&&("function"===typeof x?x(null):x.current=null)}}switch(1038&b){case 2:Es(ru),ru.effectTag&=-3;break;case 6:Es(ru),ru.effectTag&=-3,Ss(ru.alternate,ru);break;case 1024:ru.effectTag&=-1025;break;case 1028:ru.effectTag&=-1025,Ss(ru.alternate,ru);break;case 4:Ss(ru.alternate,ru);break;case 8:Ts(s,l=ru,u),ws(l)}ru=ru.nextEffect}}catch(N){if(null===ru)throw Error(a(330));Bu(ru,N),ru=ru.nextEffect}}while(null!==ru);if(x=er,w=Qn(),b=x.focusedElem,u=x.selectionRange,w!==b&&b&&b.ownerDocument&&function t(e,n){return!(!e||!n)&&(e===n||(!e||3!==e.nodeType)&&(n&&3===n.nodeType?t(e,n.parentNode):"contains"in e?e.contains(n):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(n))))}(b.ownerDocument.documentElement,b)){null!==u&&Xn(b)&&(w=u.start,void 0===(x=u.end)&&(x=w),"selectionStart"in b?(b.selectionStart=w,b.selectionEnd=Math.min(x,b.value.length)):(x=(w=b.ownerDocument||document)&&w.defaultView||window).getSelection&&(x=x.getSelection(),l=b.textContent.length,s=Math.min(u.start,l),u=void 0===u.end?s:Math.min(u.end,l),!x.extend&&s>u&&(l=u,u=s,s=l),l=Kn(b,s),h=Kn(b,u),l&&h&&(1!==x.rangeCount||x.anchorNode!==l.node||x.anchorOffset!==l.offset||x.focusNode!==h.node||x.focusOffset!==h.offset)&&((w=w.createRange()).setStart(l.node,l.offset),x.removeAllRanges(),s>u?(x.addRange(w),x.extend(h.node,h.offset)):(w.setEnd(h.node,h.offset),x.addRange(w))))),w=[];for(x=b;x=x.parentNode;)1===x.nodeType&&w.push({element:x,left:x.scrollLeft,top:x.scrollTop});for("function"===typeof b.focus&&b.focus(),b=0;b<w.length;b++)(x=w[b]).element.scrollLeft=x.left,x.element.scrollTop=x.top}er=null,Tn=!!tr,tr=null,t.current=n,ru=i;do{try{for(b=r;null!==ru;){var E=ru.effectTag;if(36&E){var T=ru.alternate;switch(x=b,(w=ru).tag){case 0:case 11:case 15:_s(16,32,w);break;case 1:var S=w.stateNode;if(4&w.effectTag)if(null===T)S.componentDidMount();else{var C=w.elementType===w.type?T.memoizedProps:eo(w.type,T.memoizedProps);S.componentDidUpdate(C,T.memoizedState,S.__reactInternalSnapshotBeforeUpdate)}var I=w.updateQueue;null!==I&&Eo(0,I,S);break;case 3:var k=w.updateQueue;if(null!==k){if(s=null,null!==w.child)switch(w.child.tag){case 5:s=w.child.stateNode;break;case 1:s=w.child.stateNode}Eo(0,k,s)}break;case 5:var A=w.stateNode;null===T&&4&w.effectTag&&nr(w.type,w.memoizedProps)&&A.focus();break;case 6:case 4:case 12:break;case 13:if(null===w.memoizedState){var O=w.alternate;if(null!==O){var P=O.memoizedState;if(null!==P){var D=P.dehydrated;null!==D&&Se(D)}}}break;case 19:case 17:case 20:case 21:break;default:throw Error(a(163))}}if(128&E){w=void 0;var M=ru.ref;if(null!==M){var R=ru.stateNode;switch(ru.tag){case 5:w=R;break;default:w=R}"function"===typeof M?M(w):M.current=w}}ru=ru.nextEffect}}catch(N){if(null===ru)throw Error(a(330));Bu(ru,N),ru=ru.nextEffect}}while(null!==ru);ru=null,Bi(),Ws=o}else t.current=n;if(su)su=!1,uu=t,cu=e;else for(ru=i;null!==ru;)e=ru.nextEffect,ru.nextEffect=null,ru=e;if(0===(e=t.firstPendingTime)&&(au=null),1073741823===e?t===pu?hu++:(hu=0,pu=t):hu=0,"function"===typeof qu&&qu(n.stateNode,r),_u(t),iu)throw iu=!1,t=ou,ou=null,t;return(Ws&Ns)!==Rs?null:(Zi(),null)}function Lu(){for(;null!==ru;){var t=ru.effectTag;0!==(256&t)&&vs(ru.alternate,ru),0===(512&t)||su||(su=!0,Xi(97,(function(){return Fu(),null}))),ru=ru.nextEffect}}function Fu(){if(90!==cu){var t=97<cu?97:cu;return cu=90,Qi(t,ju)}}function ju(){if(null===uu)return!1;var t=uu;if(uu=null,(Ws&(Ls|Fs))!==Rs)throw Error(a(331));var e=Ws;for(Ws|=Fs,t=t.current.firstEffect;null!==t;){try{var n=t;if(0!==(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:_s(128,0,n),_s(0,64,n)}}catch(r){if(null===t)throw Error(a(330));Bu(t,r)}n=t.nextEffect,t.nextEffect=null,t=n}return Ws=e,Zi(),!0}function zu(t,e,n){vo(t,e=ks(t,e=ds(n,e),1073741823)),null!==(t=gu(t,1073741823))&&_u(t)}function Bu(t,e){if(3===t.tag)zu(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){zu(n,t,e);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===au||!au.has(r))){vo(n,t=As(n,t=ds(e,t),1073741823)),null!==(n=gu(n,1073741823))&&_u(n);break}}n=n.return}}function Uu(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),Gs===t&&Ks===n?Qs===Vs||Qs===Us&&1073741823===Ys&&Gi()-eu<nu?Tu(t,Ks):tu=!0:tc(t,n)&&(0!==(e=t.lastPingedTime)&&e<n||(t.lastPingedTime=n,t.finishedExpirationTime===n&&(t.finishedExpirationTime=0,t.finishedWork=null),_u(t)))}function Vu(t,e){var n=t.stateNode;null!==n&&n.delete(e),0===(e=0)&&(e=mu(e=du(),t,null)),null!==(t=gu(t,e))&&_u(t)}Os=function(t,e,n){var r=e.expirationTime;if(null!==t){var i=e.pendingProps;if(t.memoizedProps!==i||gi.current)Ga=!0;else{if(r<n){switch(Ga=!1,e.tag){case 3:ts(e),qa();break;case 5:if(Ho(e),4&e.mode&&1!==n&&i.hidden)return e.expirationTime=e.childExpirationTime=1,null;break;case 1:bi(e.type)&&Si(e);break;case 4:Wo(e,e.stateNode.containerInfo);break;case 10:so(e,e.memoizedProps.value);break;case 13:if(null!==e.memoizedState)return 0!==(r=e.child.childExpirationTime)&&r>=n?as(t,e,n):(di(Qo,1&Qo.current),null!==(e=ls(t,e,n))?e.sibling:null);di(Qo,1&Qo.current);break;case 19:if(r=e.childExpirationTime>=n,0!==(64&t.effectTag)){if(r)return cs(t,e,n);e.effectTag|=64}if(null!==(i=e.memoizedState)&&(i.rendering=null,i.tail=null),di(Qo,Qo.current),!r)return null}return ls(t,e,n)}Ga=!1}}else Ga=!1;switch(e.expirationTime=0,e.tag){case 2:if(r=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,i=_i(e,yi.current),lo(e,n),i=da(null,e,r,t,i,n),e.effectTag|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(e.tag=1,ma(),bi(r)){var o=!0;Si(e)}else o=!1;e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null;var s=r.getDerivedStateFromProps;"function"===typeof s&&Io(e,r,s,t),i.updater=ko,e.stateNode=i,i._reactInternalFiber=e,Do(e,r,t,n),e=$a(null,e,r,!0,o,n)}else e.tag=0,Ha(null,e,i,n),e=e.child;return e;case 16:if(i=e.elementType,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,function(t){if(-1===t._status){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}}(i),1!==i._status)throw i._result;switch(i=i._result,e.type=i,o=e.tag=function(t){if("function"===typeof t)return Ku(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===W)return 11;if(t===K)return 14}return 2}(i),t=eo(i,t),o){case 0:e=Za(null,e,i,t,n);break;case 1:e=Ja(null,e,i,t,n);break;case 11:e=Ka(null,e,i,t,n);break;case 14:e=Qa(null,e,i,eo(i.type,t),r,n);break;default:throw Error(a(306,i,""))}return e;case 0:return r=e.type,i=e.pendingProps,Za(t,e,r,i=e.elementType===r?i:eo(r,i),n);case 1:return r=e.type,i=e.pendingProps,Ja(t,e,r,i=e.elementType===r?i:eo(r,i),n);case 3:if(ts(e),null===(r=e.updateQueue))throw Error(a(282));if(i=null!==(i=e.memoizedState)?i.element:null,xo(e,r,e.pendingProps,null,n),(r=e.memoizedState.element)===i)qa(),e=ls(t,e,n);else{if((i=e.stateNode.hydrate)&&(La=ar(e.stateNode.containerInfo.firstChild),Na=e,i=Fa=!0),i)for(n=jo(e,null,r,n),e.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Ha(t,e,r,n),qa();e=e.child}return e;case 5:return Ho(e),null===t&&Ba(e),r=e.type,i=e.pendingProps,o=null!==t?t.memoizedProps:null,s=i.children,rr(r,i)?s=null:null!==o&&rr(r,o)&&(e.effectTag|=16),Ya(t,e),4&e.mode&&1!==n&&i.hidden?(e.expirationTime=e.childExpirationTime=1,e=null):(Ha(t,e,s,n),e=e.child),e;case 6:return null===t&&Ba(e),null;case 13:return as(t,e,n);case 4:return Wo(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=Fo(e,null,r,n):Ha(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,Ka(t,e,r,i=e.elementType===r?i:eo(r,i),n);case 7:return Ha(t,e,e.pendingProps,n),e.child;case 8:case 12:return Ha(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,so(e,o=i.value),null!==s){var u=s.value;if(0===(o=ti(u,o)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(u,o):1073741823))){if(s.children===i.children&&!gi.current){e=ls(t,e,n);break t}}else for(null!==(u=e.child)&&(u.return=e);null!==u;){var c=u.dependencies;if(null!==c){s=u.child;for(var l=c.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&o)){1===u.tag&&((l=yo(n,null)).tag=2,vo(u,l)),u.expirationTime<n&&(u.expirationTime=n),null!==(l=u.alternate)&&l.expirationTime<n&&(l.expirationTime=n),co(u.return,n),c.expirationTime<n&&(c.expirationTime=n);break}l=l.next}}else s=10===u.tag&&u.type===e.type?null:u.child;if(null!==s)s.return=u;else for(s=u;null!==s;){if(s===e){s=null;break}if(null!==(u=s.sibling)){u.return=s.return,s=u;break}s=s.return}u=s}}Ha(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=(o=e.pendingProps).children,lo(e,n),r=r(i=ho(i,o.unstable_observedBits)),e.effectTag|=1,Ha(t,e,r,n),e.child;case 14:return o=eo(i=e.type,e.pendingProps),Qa(t,e,i,o=eo(i.type,o),r,n);case 15:return Xa(t,e,e.type,e.pendingProps,r,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:eo(r,i),null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),e.tag=1,bi(r)?(t=!0,Si(e)):t=!1,lo(e,n),Oo(e,r,i),Do(e,r,i,n),$a(null,e,r,!0,t,n);case 19:return cs(t,e,n)}throw Error(a(156,e.tag))};var qu=null,Wu=null;function Gu(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Hu(t,e,n,r){return new Gu(t,e,n,r)}function Ku(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Qu(t,e){var n=t.alternate;return null===n?((n=Hu(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=t.childExpirationTime,n.expirationTime=t.expirationTime,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{expirationTime:e.expirationTime,firstContext:e.firstContext,responders:e.responders},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Xu(t,e,n,r,i,o){var s=2;if(r=t,"function"===typeof t)Ku(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case j:return Yu(n.children,i,o,e);case q:s=8,i|=7;break;case z:s=8,i|=1;break;case B:return(t=Hu(12,n,e,8|i)).elementType=B,t.type=B,t.expirationTime=o,t;case G:return(t=Hu(13,n,e,i)).type=G,t.elementType=G,t.expirationTime=o,t;case H:return(t=Hu(19,n,e,i)).elementType=H,t.expirationTime=o,t;default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case U:s=10;break t;case V:s=9;break t;case W:s=11;break t;case K:s=14;break t;case Q:s=16,r=null;break t}throw Error(a(130,null==t?t:typeof t,""))}return(e=Hu(s,n,e,i)).elementType=t,e.type=r,e.expirationTime=o,e}function Yu(t,e,n,r){return(t=Hu(7,t,r,e)).expirationTime=n,t}function Zu(t,e,n){return(t=Hu(6,t,null,e)).expirationTime=n,t}function Ju(t,e,n){return(e=Hu(4,null!==t.children?t.children:[],t.key,e)).expirationTime=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function $u(t,e,n){this.tag=e,this.current=null,this.containerInfo=t,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function tc(t,e){var n=t.firstSuspendedTime;return t=t.lastSuspendedTime,0!==n&&n>=e&&t<=e}function ec(t,e){var n=t.firstSuspendedTime,r=t.lastSuspendedTime;n<e&&(t.firstSuspendedTime=e),(r>e||0===n)&&(t.lastSuspendedTime=e),e<=t.lastPingedTime&&(t.lastPingedTime=0),e<=t.lastExpiredTime&&(t.lastExpiredTime=0)}function nc(t,e){e>t.firstPendingTime&&(t.firstPendingTime=e);var n=t.firstSuspendedTime;0!==n&&(e>=n?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:e>=t.lastSuspendedTime&&(t.lastSuspendedTime=e+1),e>t.nextKnownPendingLevel&&(t.nextKnownPendingLevel=e))}function rc(t,e){var n=t.lastExpiredTime;(0===n||n>e)&&(t.lastExpiredTime=e)}function ic(t,e,n,r){var i=e.current,o=du(),s=So.suspense;o=mu(o,i,s);t:if(n){e:{if(te(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(a(170));var u=n;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(bi(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(null!==u);throw Error(a(171))}if(1===n.tag){var c=n.type;if(bi(c)){n=Ti(n,c,u);break t}}n=u}else n=mi;return null===e.context?e.context=n:e.pendingContext=n,(e=yo(o,s)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),vo(i,e),yu(i,o),o}function oc(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:default:return t.child.stateNode}}function ac(t,e){null!==(t=t.memoizedState)&&null!==t.dehydrated&&t.retryTime<e&&(t.retryTime=e)}function sc(t,e){ac(t,e),(t=t.alternate)&&ac(t,e)}function uc(t,e,n){var r=new $u(t,e,n=null!=n&&!0===n.hydrate),i=Hu(3,null,null,2===e?7:1===e?3:0);r.current=i,i.stateNode=r,t[hr]=r.current,n&&0!==e&&function(t){var e=Rn(t);me.forEach((function(n){Nn(n,t,e)})),ye.forEach((function(n){Nn(n,t,e)}))}(9===t.nodeType?t:t.ownerDocument),this._internalRoot=r}function cc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function lc(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o._internalRoot;if("function"===typeof i){var s=i;i=function(){var t=oc(a);s.call(t)}}ic(e,a,t,i)}else{if(o=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new uc(t,0,e?{hydrate:!0}:void 0)}(n,r),a=o._internalRoot,"function"===typeof i){var u=i;i=function(){var t=oc(a);u.call(t)}}Eu((function(){ic(e,a,t,i)}))}return oc(a)}function hc(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!cc(e))throw Error(a(200));return function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:F,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}(t,e,null,n)}uc.prototype.render=function(t,e){ic(t,this._internalRoot,null,void 0===e?null:e)},uc.prototype.unmount=function(t){var e=this._internalRoot,n=void 0===t?null:t,r=e.containerInfo;ic(null,e,null,(function(){r[hr]=null,null!==n&&n()}))},ie=function(t){if(13===t.tag){var e=to(du(),150,100);yu(t,e),sc(t,e)}},oe=function(t){if(13===t.tag){du();var e=$i++;yu(t,e),sc(t,e)}},ae=function(t){if(13===t.tag){var e=du();yu(t,e=mu(e,t,null)),sc(t,e)}},tt=function(t,e,n){switch(e){case"input":if(At(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=mr(r);if(!i)throw Error(a(90));St(r),At(r,i)}}}break;case"textarea":Lt(t,n);break;case"select":null!=(e=n.value)&&Mt(t,!!n.multiple,e,!1)}},at=xu,st=function(t,e,n,r){var i=Ws;Ws|=4;try{return Qi(98,t.bind(null,e,n,r))}finally{(Ws=i)===Rs&&Zi()}},ut=function(){(Ws&(1|Ls|Fs))===Rs&&(function(){if(null!==lu){var t=lu;lu=null,t.forEach((function(t,e){rc(e,t),_u(e)})),Zi()}}(),Fu())},ct=function(t,e){var n=Ws;Ws|=2;try{return t(e)}finally{(Ws=n)===Rs&&Zi()}};var pc={createPortal:hc,findDOMNode:function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternalFiber;if(void 0===e){if("function"===typeof t.render)throw Error(a(188));throw Error(a(268,Object.keys(t)))}return t=null===(t=re(e))?null:t.stateNode},hydrate:function(t,e,n){if(!cc(e))throw Error(a(200));return lc(null,t,e,!0,n)},render:function(t,e,n){if(!cc(e))throw Error(a(200));return lc(null,t,e,!1,n)},unstable_renderSubtreeIntoContainer:function(t,e,n,r){if(!cc(n))throw Error(a(200));if(null==t||void 0===t._reactInternalFiber)throw Error(a(38));return lc(t,e,n,!1,r)},unmountComponentAtNode:function(t){if(!cc(t))throw Error(a(40));return!!t._reactRootContainer&&(Eu((function(){lc(null,null,t,!1,(function(){t._reactRootContainer=null,t[hr]=null}))})),!0)},unstable_createPortal:function(){return hc.apply(void 0,arguments)},unstable_batchedUpdates:xu,flushSync:function(t,e){if((Ws&(Ls|Fs))!==Rs)throw Error(a(187));var n=Ws;Ws|=1;try{return Qi(99,t.bind(null,e))}finally{Ws=n,Zi()}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{Events:[fr,dr,mr,P.injectEventPluginsByName,p,De,function(t){I(t,Pe)},it,ot,On,O,Fu,{current:!1}]}};!function(t){var e=t.findFiberByHostInstance;(function(t){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var n=e.inject(t);qu=function(t){try{e.onCommitFiberRoot(n,t,void 0,64===(64&t.current.effectTag))}catch(r){}},Wu=function(t){try{e.onCommitFiberUnmount(n,t)}catch(r){}}}catch(r){}})(i({},t,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=re(t))?null:t.stateNode},findFiberByHostInstance:function(t){return e?e(t):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:pr,bundleType:0,version:"16.12.0",rendererPackageName:"react-dom"});var fc={default:pc},dc=fc&&pc||fc;t.exports=dc.default||dc},function(t,e,n){"use strict";t.exports=n(49)},function(t,e,n){"use strict";var r,i,o,a,s;if(Object.defineProperty(e,"__esModule",{value:!0}),"undefined"===typeof window||"function"!==typeof MessageChannel){var u=null,c=null,l=function t(){if(null!==u)try{var n=e.unstable_now();u(!0,n),u=null}catch(r){throw setTimeout(t,0),r}},h=Date.now();e.unstable_now=function(){return Date.now()-h},r=function(t){null!==u?setTimeout(r,0,t):(u=t,setTimeout(l,0))},i=function(t,e){c=setTimeout(t,e)},o=function(){clearTimeout(c)},a=function(){return!1},s=e.unstable_forceFrameRate=function(){}}else{var p=window.performance,f=window.Date,d=window.setTimeout,m=window.clearTimeout;if("undefined"!==typeof console){var y=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof y&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"===typeof p&&"function"===typeof p.now)e.unstable_now=function(){return p.now()};else{var g=f.now();e.unstable_now=function(){return f.now()-g}}var v=!1,_=null,b=-1,w=5,x=0;a=function(){return e.unstable_now()>=x},s=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):w=0<t?Math.floor(1e3/t):5};var E=new MessageChannel,T=E.port2;E.port1.onmessage=function(){if(null!==_){var t=e.unstable_now();x=t+w;try{_(!0,t)?T.postMessage(null):(v=!1,_=null)}catch(n){throw T.postMessage(null),n}}else v=!1},r=function(t){_=t,v||(v=!0,T.postMessage(null))},i=function(t,n){b=d((function(){t(e.unstable_now())}),n)},o=function(){m(b),b=-1}}function S(t,e){var n=t.length;t.push(e);t:for(;;){var r=Math.floor((n-1)/2),i=t[r];if(!(void 0!==i&&0<k(i,e)))break t;t[r]=e,t[n]=i,n=r}}function C(t){return void 0===(t=t[0])?null:t}function I(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,i=t.length;r<i;){var o=2*(r+1)-1,a=t[o],s=o+1,u=t[s];if(void 0!==a&&0>k(a,n))void 0!==u&&0>k(u,a)?(t[r]=u,t[s]=n,r=s):(t[r]=a,t[o]=n,r=o);else{if(!(void 0!==u&&0>k(u,n)))break t;t[r]=u,t[s]=n,r=s}}}return e}return null}function k(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var A=[],O=[],P=1,D=null,M=3,R=!1,N=!1,L=!1;function F(t){for(var e=C(O);null!==e;){if(null===e.callback)I(O);else{if(!(e.startTime<=t))break;I(O),e.sortIndex=e.expirationTime,S(A,e)}e=C(O)}}function j(t){if(L=!1,F(t),!N)if(null!==C(A))N=!0,r(z);else{var e=C(O);null!==e&&i(j,e.startTime-t)}}function z(t,n){N=!1,L&&(L=!1,o()),R=!0;var r=M;try{for(F(n),D=C(A);null!==D&&(!(D.expirationTime>n)||t&&!a());){var s=D.callback;if(null!==s){D.callback=null,M=D.priorityLevel;var u=s(D.expirationTime<=n);n=e.unstable_now(),"function"===typeof u?D.callback=u:D===C(A)&&I(A),F(n)}else I(A);D=C(A)}if(null!==D)var c=!0;else{var l=C(O);null!==l&&i(j,l.startTime-n),c=!1}return c}finally{D=null,M=r,R=!1}}function B(t){switch(t){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var U=s;e.unstable_ImmediatePriority=1,e.unstable_UserBlockingPriority=2,e.unstable_NormalPriority=3,e.unstable_IdlePriority=5,e.unstable_LowPriority=4,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=M;M=t;try{return e()}finally{M=n}},e.unstable_next=function(t){switch(M){case 1:case 2:case 3:var e=3;break;default:e=M}var n=M;M=e;try{return t()}finally{M=n}},e.unstable_scheduleCallback=function(t,n,a){var s=e.unstable_now();if("object"===typeof a&&null!==a){var u=a.delay;u="number"===typeof u&&0<u?s+u:s,a="number"===typeof a.timeout?a.timeout:B(t)}else a=B(t),u=s;return t={id:P++,callback:n,priorityLevel:t,startTime:u,expirationTime:a=u+a,sortIndex:-1},u>s?(t.sortIndex=u,S(O,t),null===C(A)&&t===C(O)&&(L?o():L=!0,i(j,u-s))):(t.sortIndex=a,S(A,t),N||R||(N=!0,r(z))),t},e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_wrapCallback=function(t){var e=M;return function(){var n=M;M=e;try{return t.apply(this,arguments)}finally{M=n}}},e.unstable_getCurrentPriorityLevel=function(){return M},e.unstable_shouldYield=function(){var t=e.unstable_now();F(t);var n=C(A);return n!==D&&null!==D&&null!==n&&null!==n.callback&&n.startTime<=t&&n.expirationTime<D.expirationTime||a()},e.unstable_requestPaint=U,e.unstable_continueExecution=function(){N||R||(N=!0,r(z))},e.unstable_pauseExecution=function(){},e.unstable_getFirstCallbackNode=function(){return C(A)},e.unstable_Profiling=null},,function(t,e,n){var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,o=Object.create(i.prototype),a=new I(r||[]);return o._invoke=function(t,e,n){var r=l;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw o;return A()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var u=c(t,e,n);if("normal"===u.type){if(r=n.done?f:h,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=f,n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(r){return{type:"throw",arg:r}}}t.wrap=u;var l="suspendedStart",h="suspendedYield",p="executing",f="completed",d={};function m(){}function y(){}function g(){}var v={};v[o]=function(){return this};var _=Object.getPrototypeOf,b=_&&_(_(k([])));b&&b!==n&&r.call(b,o)&&(v=b);var w=g.prototype=m.prototype=Object.create(v);function x(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function E(t){var e;this._invoke=function(n,i){function o(){return new Promise((function(e,o){!function e(n,i,o,a){var s=c(t[n],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"===typeof l&&r.call(l,"__await")?Promise.resolve(l.__await).then((function(t){e("next",t,o,a)}),(function(t){e("throw",t,o,a)})):Promise.resolve(l).then((function(t){u.value=t,o(u)}),(function(t){return e("throw",t,o,a)}))}a(s.arg)}(n,i,e,o)}))}return e=e?e.then(o,o):o()}}function T(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method))return d;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=c(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function k(t){if(t){var n=t[o];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:A}}function A(){return{value:e,done:!0}}return y.prototype=w.constructor=g,g.constructor=y,g[s]=y.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},x(E.prototype),E.prototype[a]=function(){return this},t.AsyncIterator=E,t.async=function(e,n,r,i){var o=new E(u(e,n,r,i));return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(w),w[s]="Generator",w[o]=function(){return this},w.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=k,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:k(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}(t.exports);try{regeneratorRuntime=r}catch(i){Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){"use strict";n.r(e),function(t){var e=n(7),r=n.n(e);(function(){var e,n="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i="undefined"!=typeof window&&window===this?this:"undefined"!=typeof t&&null!=t?t:this;function o(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function a(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:o(t)}}!function(t,e){if(e){var r=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}(e=e(o=r[t=t[t.length-1]]))!=o&&null!=e&&n(r,t,{configurable:!0,writable:!0,value:e})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var o=i.setTimeout;n.prototype.c=function(t){o(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.f(r)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.o(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.u(t):this.h(t)}},e.prototype.u=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.v(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.o=function(t){var e=this.f();t.La(e.resolve,e.reject)},e.prototype.v=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(n){o(n)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.La(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.La=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=a(t),o=i.next();!o.done;o=i.next())r(o.value).La(e,n)}))},e.all=function(t){var n=a(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).La(o(a.length-1),e),i=n.next()}while(!i.done)}))},e}));var s=s||{},u=this||self;function c(t){return"string"==typeof t}function l(t){return"boolean"==typeof t}var h=/^[\w+/_-]+[=]{0,2}$/,p=null;function f(){}function d(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function m(t){return null===t}function y(t){return"array"==d(t)}function g(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"function"==d(t)}function _(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var b="closure_uid_"+(1e9*Math.random()>>>0),w=0;function x(t,e,n){return t.call.apply(t.bind,arguments)}function E(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function T(t,e,n){return(T=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?x:E).apply(null,arguments)}function S(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var C=Date.now||function(){return+new Date};function I(t,e){function n(){}n.prototype=e.prototype,t.qb=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.gd=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function k(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function A(t){if(Error.captureStackTrace)Error.captureStackTrace(this,A);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function O(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");A.call(this,n+t[r])}function P(t,e){throw new O("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function D(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function M(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function R(){this.b=this.a=null}I(A,Error),A.prototype.name="CustomError",I(O,A),O.prototype.name="AssertionError",D.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var N=new D((function(){return new F}),(function(t){t.reset()}));function L(){var t=Wt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function F(){this.next=this.b=this.a=null}function j(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||u).Element&&r.Location){var i=r;break t}}catch(a){}i=null}if(i&&"undefined"!=typeof i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(_(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(a){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;P("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}R.prototype.add=function(t,e){var n=N.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},F.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},F.prototype.reset=function(){this.next=this.b=this.a=null};var z=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(c(t))return c(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=c(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};var U=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i=c(t)?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},V=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=c(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function q(t,e){return 0<=z(t,e)}function W(t,e){var n;return(n=0<=(e=z(t,e)))&&Array.prototype.splice.call(t,e,1),n}function G(t,e){!function(t,e){for(var n=c(t)?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0}))}function H(t){return Array.prototype.concat.apply([],arguments)}function K(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function X(t){for(var e in t)return!1;return!0}function Y(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Z.length;o++)n=Z[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function $(t,e){this.a=t===nt&&e||"",this.b=et}function tt(t){return t instanceof $&&t.constructor===$&&t.b===et?t.a:(P("expected object of type Const, got '"+t+"'"),"type_error:Const")}$.prototype.qa=!0,$.prototype.pa=function(){return this.a},$.prototype.toString=function(){return"Const{"+this.a+"}"};var et={},nt={},rt=new $(nt,"");function it(){this.a="",this.b=ct}function ot(t){return t instanceof it&&t.constructor===it&&t.b===ct?t.a:(P("expected object of type TrustedResourceUrl, got '"+t+"' of type "+d(t)),"type_error:TrustedResourceUrl")}function at(t,e){var n=tt(t);if(!ut.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return lt(t=n.replace(st,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof $?tt(t):encodeURIComponent(String(t))})))}it.prototype.qa=!0,it.prototype.pa=function(){return this.a.toString()},it.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var st=/%{(\w+)}/g,ut=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,ct={};function lt(t){var e=new it;return e.a=t,e}var ht=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},pt=/&/g,ft=/</g,dt=/>/g,mt=/"/g,yt=/'/g,gt=/\x00/g,vt=/[\x00&<>"']/;function _t(t,e){return-1!=t.indexOf(e)}function bt(t,e){return t<e?-1:t>e?1:0}function wt(){this.a="",this.b=Ct}function xt(t){return t instanceof wt&&t.constructor===wt&&t.b===Ct?t.a:(P("expected object of type SafeUrl, got '"+t+"' of type "+d(t)),"type_error:SafeUrl")}wt.prototype.qa=!0,wt.prototype.pa=function(){return this.a.toString()},wt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Et=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Tt(t){return t instanceof wt?t:(t="object"==typeof t&&t.qa?t.pa():String(t),Et.test(t)||(t="about:invalid#zClosurez"),It(t))}var St,Ct={};function It(t){var e=new wt;return e.a=t,e}It("about:blank");t:{var kt=u.navigator;if(kt){var At=kt.userAgent;if(At){St=At;break t}}St=""}function Ot(t){return _t(St,t)}function Pt(){this.a="",this.b=Mt}function Dt(t){return t instanceof Pt&&t.constructor===Pt&&t.b===Mt?t.a:(P("expected object of type SafeHtml, got '"+t+"' of type "+d(t)),"type_error:SafeHtml")}Pt.prototype.qa=!0,Pt.prototype.pa=function(){return this.a.toString()},Pt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Mt={};function Rt(t){var e=new Pt;return e.a=t,e}Rt("<!DOCTYPE html>");var Nt,Lt,Ft=Rt("");function jt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function zt(t){return vt.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(pt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(ft,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(dt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(mt,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(yt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(gt,"&#0;"))),t}function Bt(t){u.setTimeout((function(){throw t}),0)}function Ut(){var t=u.MessageChannel;if("undefined"===typeof t&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!Ot("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",function(t){var e=lt(tt(rt));j(t,"HTMLIFrameElement"),t.src=ot(e).toString()}(t),document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(Dt(Ft)),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=T((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),"undefined"!==typeof t&&!Ot("Trident")&&!Ot("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).yb;n.yb=null,t()}},function(t){r.next={yb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){u.setTimeout(t,0)}}function Vt(t,e){Lt||function(){if(u.Promise&&u.Promise.resolve){var t=u.Promise.resolve(void 0);Lt=function(){t.then(Gt)}}else Lt=function(){var t=Gt;!v(u.setImmediate)||u.Window&&u.Window.prototype&&!Ot("Edge")&&u.Window.prototype.setImmediate==u.setImmediate?(Nt||(Nt=Ut()),Nt(t)):u.setImmediate(t)}}(),qt||(Lt(),qt=!0),Wt.add(t,e)}Rt("<br>");var qt=!1,Wt=new R;function Gt(){for(var t;t=L();){try{t.a.call(t.b)}catch(e){Bt(e)}M(N,t)}qt=!1}function Ht(t,e){if(this.a=Kt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,(function(t){oe(n,Qt,t)}),(function(t){if(!(t instanceof pe))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}oe(n,Xt,t)}))}catch(r){oe(this,Xt,r)}}var Kt=0,Qt=2,Xt=3;function Yt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Yt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Zt=new D((function(){return new Yt}),(function(t){t.reset()}));function Jt(t,e,n){var r=Zt.get();return r.g=t,r.b=e,r.f=n,r}function $t(t){if(t instanceof Ht)return t;var e=new Ht(f);return oe(e,Qt,t),e}function te(t){return new Ht((function(e,n){n(t)}))}function ee(t,e,n){ae(t,e,n,null)||Vt(S(e,t))}function ne(t){return new Ht((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Gb:!0,value:o}:{Gb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)ee(t[o],S(i,o,!0),S(i,o,!1));else e(r)}))}function re(t,e){t.b||t.a!=Qt&&t.a!=Xt||se(t),t.f?t.f.next=e:t.b=e,t.f=e}function ie(t,e,n,r){var i=Jt(null,null,null);return i.a=new Ht((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(a){o(a)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof pe?o(e):t(i)}catch(a){o(a)}}:o})),i.a.c=t,re(t,i),i.a}function oe(t,e,n){t.a==Kt&&(t===n&&(e=Xt,n=new TypeError("Promise cannot resolve to itself")),t.a=1,ae(n,t.Oc,t.Pc,t)||(t.i=n,t.a=e,t.c=null,se(t),e!=Xt||n instanceof pe||function(t,e){t.g=!0,Vt((function(){t.g&&he.call(null,e)}))}(t,n)))}function ae(t,e,n,r){if(t instanceof Ht)return re(t,Jt(e||f,n||null,r)),!0;if(k(t))return t.then(e,n,r),!0;if(_(t))try{var i=t.then;if(v(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,(function(t){a||(a=!0,n.call(i,t))}),o)}catch(s){o(s)}}(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function se(t){t.h||(t.h=!0,Vt(t.Zb,t))}function ue(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function ce(t,e,n,r){if(n==Xt&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,le(e,n,r);else try{e.c?e.g.call(e.f):le(e,n,r)}catch(i){he.call(null,i)}M(Zt,e)}function le(t,e,n){e==Qt?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Ht.prototype.then=function(t,e,n){return ie(this,v(t)?t:null,v(e)?e:null,n)},Ht.prototype.$goog_Thenable=!0,(e=Ht.prototype).ka=function(t,e){return(t=Jt(t,t,e)).c=!0,re(this,t),this},e.s=function(t,e){return ie(this,null,t,e)},e.cancel=function(t){this.a==Kt&&Vt((function(){!function t(e,n){if(e.a==Kt)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==e&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==Kt&&1==i?t(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):ue(r),ce(r,o,Xt,n)))}e.c=null}else oe(e,Xt,n)}(this,new pe(t))}),this)},e.Oc=function(t){this.a=Kt,oe(this,Qt,t)},e.Pc=function(t){this.a=Kt,oe(this,Xt,t)},e.Zb=function(){for(var t;t=ue(this);)ce(this,t,this.a,this.i);this.h=!1};var he=Bt;function pe(t){A.call(this,t)}function fe(){0!=de&&(me[this[b]||(this[b]=++w)]=this),this.va=this.va,this.la=this.la}I(pe,A),pe.prototype.name="cancel";var de=0,me={};function ye(t){if(!t.va&&(t.va=!0,t.za(),0!=de)){var e=t[b]||(t[b]=++w);if(0!=de&&t.la&&0<t.la.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete me[e]}}function ge(t){return ge[" "](t),t}fe.prototype.va=!1,fe.prototype.za=function(){if(this.la)for(;this.la.length;)this.la.shift()()},ge[" "]=f;var ve,_e=Ot("Opera"),be=Ot("Trident")||Ot("MSIE"),we=Ot("Edge"),xe=we||be,Ee=Ot("Gecko")&&!(_t(St.toLowerCase(),"webkit")&&!Ot("Edge"))&&!(Ot("Trident")||Ot("MSIE"))&&!Ot("Edge"),Te=_t(St.toLowerCase(),"webkit")&&!Ot("Edge");function Se(){var t=u.document;return t?t.documentMode:void 0}t:{var Ce="",Ie=function(){var t=St;return Ee?/rv:([^\);]+)(\)|;)/.exec(t):we?/Edge\/([\d\.]+)/.exec(t):be?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Te?/WebKit\/(\S+)/.exec(t):_e?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Ie&&(Ce=Ie?Ie[1]:""),be){var ke=Se();if(null!=ke&&ke>parseFloat(Ce)){ve=String(ke);break t}}ve=Ce}var Ae,Oe={};function Pe(t){return function(t,e){var n=Oe;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=ht(String(ve)).split("."),r=ht(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=bt(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||bt(0==a[2].length,0==s[2].length)||bt(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}Ae=u.document&&be?Se():void 0;var De=Object.freeze||function(t){return t},Me=!be||9<=Number(Ae),Re=be&&!Pe("9"),Ne=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",f,e),u.removeEventListener("test",f,e)}catch(n){}return t}();function Le(t,e){this.type=t,this.b=this.target=e,this.Mb=!0}function Fe(t,e){if(Le.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Ee){t:{try{ge(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=c(t.pointerType)?t.pointerType:je[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Le.prototype.preventDefault=function(){this.Mb=!1},I(Fe,Le);var je=De({2:"touch",3:"pen",4:"mouse"});Fe.prototype.preventDefault=function(){Fe.qb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Re)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},Fe.prototype.f=function(){return this.a};var ze="closure_listenable_"+(1e6*Math.random()|0),Be=0;function Ue(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Pa=i,this.key=++Be,this.ta=this.Ka=!1}function Ve(t){t.ta=!0,t.listener=null,t.proxy=null,t.src=null,t.Pa=null}function qe(t){this.src=t,this.a={},this.b=0}function We(t,e){var n=e.type;n in t.a&&W(t.a[n],e)&&(Ve(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function Ge(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ta&&o.listener==e&&o.capture==!!n&&o.Pa==r)return i}return-1}qe.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=Ge(t,e,r,i);return-1<a?(e=t[a],n||(e.Ka=!1)):((e=new Ue(e,this.src,o,!!r,i)).Ka=n,t.push(e)),e};var He="closure_lm_"+(1e6*Math.random()|0),Ke={};function Qe(t,e,n,r,i){if(r&&r.once)Ye(t,e,n,r,i);else if(y(e))for(var o=0;o<e.length;o++)Qe(t,e[o],n,r,i);else n=an(n),t&&t[ze]?un(t,e,n,_(r)?!!r.capture:!!r,i):Xe(t,e,n,!1,r,i)}function Xe(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=_(i)?!!i.capture:!!i,s=rn(t);if(s||(t[He]=s=new qe(t)),!(n=s.add(e,n,r,a,o)).proxy){if(r=function(){var t=nn,e=Me?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Ne||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent($e(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}0}}function Ye(t,e,n,r,i){if(y(e))for(var o=0;o<e.length;o++)Ye(t,e[o],n,r,i);else n=an(n),t&&t[ze]?cn(t,e,n,_(r)?!!r.capture:!!r,i):Xe(t,e,n,!0,r,i)}function Ze(t,e,n,r,i){if(y(e))for(var o=0;o<e.length;o++)Ze(t,e[o],n,r,i);else r=_(r)?!!r.capture:!!r,n=an(n),t&&t[ze]?(t=t.u,(e=String(e).toString())in t.a&&(-1<(n=Ge(o=t.a[e],n,r,i))&&(Ve(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=rn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Ge(e,n,r,i)),(n=-1<t?e[t]:null)&&Je(n))}function Je(t){if("number"!=typeof t&&t&&!t.ta){var e=t.src;if(e&&e[ze])We(e.u,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent($e(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=rn(e))?(We(n,t),0==n.b&&(n.src=null,e[He]=null)):Ve(t)}}}function $e(t){return t in Ke?Ke[t]:Ke[t]="on"+t}function tn(t,e,n,r){var i=!0;if((t=rn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.ta&&(o=en(o,r),i=i&&!1!==o)}return i}function en(t,e){var n=t.listener,r=t.Pa||t.src;return t.Ka&&Je(t),n.call(r,e)}function nn(t,e){if(t.ta)return!0;if(!Me){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Fe(r=e,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(a){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=tn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=tn(r[i],t,!1,e),n=n&&o}return n}return en(t,new Fe(e,this))}function rn(t){return(t=t[He])instanceof qe?t:null}var on="__closure_events_fn_"+(1e9*Math.random()>>>0);function an(t){return v(t)?t:(t[on]||(t[on]=function(e){return t.handleEvent(e)}),t[on])}function sn(){fe.call(this),this.u=new qe(this),this.Sb=this,this.Xa=null}function un(t,e,n,r,i){t.u.add(String(e),n,!1,r,i)}function cn(t,e,n,r,i){t.u.add(String(e),n,!0,r,i)}function ln(t,e,n,r){if(!(e=t.u.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ta&&a.capture==n){var s=a.listener,u=a.Pa||a.src;a.Ka&&We(t.u,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Mb}function hn(t,e,n){if(v(t))n&&(t=T(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=T(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function pn(t){var e=null;return new Ht((function(n,r){-1==(e=hn((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).s((function(t){throw u.clearTimeout(e),t}))}function fn(t){if(t.U&&"function"==typeof t.U)return t.U();if(c(t))return t.split("");if(g(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function dn(t){if(t.X&&"function"==typeof t.X)return t.X();if(!t.U||"function"!=typeof t.U){if(g(t)||c(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function mn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof mn)for(n=t.X(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function yn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];gn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)gn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function gn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}I(sn,fe),sn.prototype[ze]=!0,sn.prototype.addEventListener=function(t,e,n,r){Qe(this,t,e,n,r)},sn.prototype.removeEventListener=function(t,e,n,r){Ze(this,t,e,n,r)},sn.prototype.dispatchEvent=function(t){var e,n=this.Xa;if(n)for(e=[];n;n=n.Xa)e.push(n);n=this.Sb;var r=t.type||t;if(c(t))t=new Le(t,n);else if(t instanceof Le)t.target=t.target||n;else{var i=t;J(t=new Le(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=ln(a,r,!0,t)&&i}if(i=ln(a=t.b=n,r,!0,t)&&i,i=ln(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=ln(a=t.b=e[o],r,!1,t)&&i;return i},sn.prototype.za=function(){if(sn.qb.za.call(this),this.u){var t,e=this.u;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Ve(n[r]);delete e.a[t],e.b--}}this.Xa=null},(e=mn.prototype).U=function(){yn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},e.X=function(){return yn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(t,e){return gn(this.b,t)?this.b[t]:e},e.set=function(t,e){gn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},e.forEach=function(t,e){for(var n=this.X(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var vn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function _n(t,e){var n;this.b=this.i=this.f="",this.l=null,this.g=this.c="",this.h=!1,t instanceof _n?(this.h=void 0!==e?e:t.h,bn(this,t.f),this.i=t.i,this.b=t.b,wn(this,t.l),this.c=t.c,xn(this,Un(t.a)),this.g=t.g):t&&(n=String(t).match(vn))?(this.h=!!e,bn(this,n[1]||"",!0),this.i=In(n[2]||""),this.b=In(n[3]||"",!0),wn(this,n[4]),this.c=In(n[5]||"",!0),xn(this,n[6]||"",!0),this.g=In(n[7]||"")):(this.h=!!e,this.a=new Nn(null,this.h))}function bn(t,e,n){t.f=n?In(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function wn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.l=e}else t.l=null}function xn(t,e,n){e instanceof Nn?(t.a=e,function(t,e){e&&!t.f&&(Ln(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(jn(this,e),Bn(this,n,t))}),t)),t.f=e}(t.a,t.h)):(n||(e=kn(e,Mn)),t.a=new Nn(e,t.h))}function En(t,e,n){t.a.set(e,n)}function Tn(t,e){return t.a.get(e)}function Sn(t){return t instanceof _n?new _n(t):new _n(t,void 0)}function Cn(t,e){var n=new _n(null,void 0);return bn(n,"https"),t&&(n.b=t),e&&(n.c=e),n}function In(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function kn(t,e,n){return c(t)?(t=encodeURI(t).replace(e,An),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function An(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}_n.prototype.toString=function(){var t=[],e=this.f;e&&t.push(kn(e,On,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.i)&&t.push(kn(e,On,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.l)&&t.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(kn(n,"/"==n.charAt(0)?Dn:Pn,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.g)&&t.push("#",kn(n,Rn)),t.join("")},_n.prototype.resolve=function(t){var e=new _n(this),n=!!t.f;n?bn(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.l;var r=t.c;if(n)wn(e,t.l);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.b&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(_t(i,"./")||_t(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.a.toString(),n?xn(e,Un(t.a)):n=!!t.g,n&&(e.g=t.g),e};var On=/[#\/\?@]/g,Pn=/[#\?:]/g,Dn=/[#\?]/g,Mn=/[#\?@]/g,Rn=/#/g;function Nn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Ln(t){t.a||(t.a=new mn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Fn(t){var e=dn(t);if("undefined"==typeof e)throw Error("Keys are undefined");var n=new Nn(null,void 0);t=fn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];y(o)?Bn(n,i,o):n.add(i,o)}return n}function jn(t,e){Ln(t),e=Vn(t,e),gn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,gn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&yn(t)))}function zn(t,e){return Ln(t),e=Vn(t,e),gn(t.a.b,e)}function Bn(t,e,n){jn(t,e),0<n.length&&(t.c=null,t.a.set(Vn(t,e),K(n)),t.b+=n.length)}function Un(t){var e=new Nn;return e.c=t.c,t.a&&(e.a=new mn(t.a),e.b=t.b),e}function Vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(e=Nn.prototype).add=function(t,e){Ln(this),this.c=null,t=Vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(t,e){Ln(this),this.a.forEach((function(n,r){B(n,(function(n){t.call(e,n,r,this)}),this)}),this)},e.X=function(){Ln(this);for(var t=this.a.U(),e=this.a.X(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},e.U=function(t){Ln(this);var e=[];if(c(t))zn(this,t)&&(e=H(e,this.a.get(Vn(this,t))));else{t=this.a.U();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},e.set=function(t,e){return Ln(this),this.c=null,zn(this,t=Vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},e.get=function(t,e){return t&&0<(t=this.U(t)).length?String(t[0]):e},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.X(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.U(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var qn=!be||9<=Number(Ae);function Wn(t){var e=document;return c(t)?e.getElementById(t):t}function Gn(t,e){Q(e,(function(e,n){e&&"object"==typeof e&&e.qa&&(e=e.pa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:Hn.hasOwnProperty(n)?t.setAttribute(Hn[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var Hn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Kn(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!qn&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',zt(a.name),'"'),a.type){o.push(' type="',zt(a.type),'"');var s={};J(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=i.createElement(o),a&&(c(a)?o.className=a:y(a)?o.className=a.join(" "):Gn(o,a)),2<r.length&&function(t,e,n){function r(n){n&&e.appendChild(c(n)?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!g(o)||_(o)&&0<o.nodeType?r(o):B(Qn(o)?K(o):o,r)}}(i,o,r),o}function Qn(t){if(t&&"number"==typeof t.length){if(_(t))return"function"==typeof t.item||"string"==typeof t.item;if(v(t))return"function"==typeof t.item}return!1}function Xn(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(y(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),t(e,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&("function"!=typeof(a=n[i])&&(r.push(o),$n(i,r),r.push(":"),t(e,a,r),o=","));return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":$n(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Yn,t,e),e.join("")}function Yn(){}var Zn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Jn=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function $n(t,e){e.push('"',t.replace(Jn,(function(t){var e=Zn[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Zn[t]=e),e})),'"')}function tr(){var t=_r();return be&&!!Ae&&11==Ae||/Edge\/\d+/.test(t)}function er(){return u.window&&u.window.location.href||self&&self.location&&self.location.href||""}function nr(t,e){e=e||u.window;var n="about:blank";t&&(n=xt(Tt(t)).toString()),e.location.href=n}function rr(t){return!!((t=(t||_r()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function ir(t){t=t||u.window;try{t.close()}catch(e){}}function or(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=_r().toLowerCase(),r&&(e.target=r,_t(n,"crios/")&&(e.target="_blank")),yr(_r())==dr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof wt?n:Tt("undefined"!=typeof n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((Ot("iPhone")&&!Ot("iPod")&&!Ot("iPad")||Ot("iPad")||Ot("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(j(a=r.document.createElement("A"),"HTMLAnchorElement"),e instanceof wt||e instanceof wt||(e="object"==typeof e&&e.qa?e.pa():String(e),Et.test(e)||(e="about:invalid#zClosurez"),e=It(e)),a.href=xt(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=r.open("",n,a),t=xt(e).toString(),a&&(xe&&_t(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t=Rt('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+zt(t)+'">'),a.document.write(Dt(t)),a.document.close())):(a=r.open(xt(e).toString(),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var ar=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sr=/^[^@]+@[^@]+$/;function ur(){var t=null;return new Ht((function(e){"complete"==u.document.readyState?e():(t=function(){e()},Ye(window,"load",t))})).s((function(e){throw Ze(window,"load",t),e}))}function cr(t){return t=t||_r(),!("file:"!==Tr()&&"ionic:"!==Tr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function lr(){var t=u.window;try{return!(!t||t==t.top)}catch(e){return!1}}function hr(){return"undefined"!==typeof u.WorkerGlobalScope&&"function"===typeof u.importScripts}function pr(){return r.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.a.INTERNAL.hasOwnProperty("node")?"Node":hr()?"Worker":"Browser"}function fr(){var t=pr();return"ReactNative"===t||"Node"===t}var dr="Firefox",mr="Chrome";function yr(t){var e=t.toLowerCase();return _t(e,"opera/")||_t(e,"opr/")||_t(e,"opios/")?"Opera":_t(e,"iemobile")?"IEMobile":_t(e,"msie")||_t(e,"trident/")?"IE":_t(e,"edge/")?"Edge":_t(e,"firefox/")?dr:_t(e,"silk/")?"Silk":_t(e,"blackberry")?"Blackberry":_t(e,"webos")?"Webos":!_t(e,"safari/")||_t(e,"chrome/")||_t(e,"crios/")||_t(e,"android")?!_t(e,"chrome/")&&!_t(e,"crios/")||_t(e,"edge/")?_t(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":mr:"Safari"}var gr={Wc:"FirebaseCore-web",Yc:"FirebaseUI-web"};function vr(t,e){e=e||[];var n,r=[],i={};for(n in gr)i[gr[n]]=!0;for(n=0;n<e.length;n++)"undefined"!==typeof i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=pr())?r=yr(i=_r()):"Worker"===r&&(r=yr(i=_r())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function _r(){return u.navigator&&u.navigator.userAgent||""}function br(t,e){t=t.split("."),e=e||u;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function wr(){try{var t=u.localStorage,e=Ar();if(t)return t.setItem(e,"1"),t.removeItem(e),!tr()||!!u.indexedDB}catch(n){return hr()&&!!u.indexedDB}return!1}function xr(){return(Er()||"chrome-extension:"===Tr()||cr())&&!fr()&&wr()&&!hr()}function Er(){return"http:"===Tr()||"https:"===Tr()}function Tr(){return u.location&&u.location.protocol||null}function Sr(t){return!rr(t=t||_r())&&yr(t)!=dr}function Cr(t){return"undefined"===typeof t?null:Xn(t)}function Ir(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function kr(t){if(null!==t)return JSON.parse(t)}function Ar(t){return t||Math.floor(1e9*Math.random()).toString()}function Or(t){return"Safari"!=yr(t=t||_r())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Pr(){var t=u.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Dr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=_r(),e=pr(),this.b=rr(t)||"ReactNative"===e}function Mr(){var t=u.document;return!t||"undefined"===typeof t.visibilityState||"visible"==t.visibilityState}function Rr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function Nr(){return!(!br("fireauth.oauthhelper",u)&&!br("fireauth.iframe",u))}Dr.prototype.get=function(){var t=u.navigator;return!t||"boolean"!==typeof t.onLine||!Er()&&"chrome-extension:"!==Tr()&&"undefined"===typeof t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Lr,Fr={};function jr(t){Fr[t]||(Fr[t]=!0,"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(t))}try{var zr={};Object.defineProperty(zr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(zr,"abcd",{configurable:!0,enumerable:!0,value:2}),Lr=2==zr.abcd}catch(Ho){Lr=!1}function Br(t,e,n){Lr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Ur(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Br(t,n,e[n])}function Vr(t){var e={};return Ur(e,t),e}function qr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Br(e,n,qr(t[n]));return e}function Wr(t){var e={},n=t[Hr],r=t[Kr];if(!(t=t[Qr])||t!=Gr&&!n)throw Error("Invalid provider user info!");e[Yr]=r||null,e[Xr]=n||null,Br(this,Jr,t),Br(this,Zr,qr(e))}var Gr="EMAIL_SIGNIN",Hr="email",Kr="newEmail",Qr="requestType",Xr="email",Yr="fromEmail",Zr="data",Jr="operation";function $r(t,e){this.code=ei+t,this.message=e||ni[t]||""}function ti(t){var e=t&&t.code;return e?new $r(e.substring(ei.length),t.message):null}I($r,Error),$r.prototype.A=function(){return{code:this.code,message:this.message}},$r.prototype.toJSON=function(){return this.A()};var ei="auth/",ni={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function ri(t){var e=Tn(t=Sn(t),ii)||null,n=Tn(t,oi)||null,r=Tn(t,ui)||null;if(r=r&&li[r]||null,!e||!n||!r)throw new $r("argument-error",ii+", "+oi+"and "+ui+" are required in a valid action code URL.");Ur(this,{apiKey:e,operation:r,code:n,continueUrl:Tn(t,ai)||null,languageCode:Tn(t,si)||null,tenantId:Tn(t,ci)||null})}var ii="apiKey",oi="oobCode",ai="continueUrl",si="languageCode",ui="mode",ci="tenantId",li={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",signIn:Gr,verifyEmail:"VERIFY_EMAIL"};function hi(t){try{return new ri(t)}catch(e){return null}}function pi(t){var e=t[gi];if("undefined"===typeof e)throw new $r("missing-continue-uri");if("string"!==typeof e||"string"===typeof e&&!e.length)throw new $r("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[fi];if(n&&"object"===typeof n){e=n[bi];var r=n[vi];if(n=n[_i],"string"===typeof e&&e.length){if(this.a=e,"undefined"!==typeof r&&"boolean"!==typeof r)throw new $r("argument-error",vi+" property must be a boolean when specified.");if(this.g=!!r,"undefined"!==typeof n&&("string"!==typeof n||"string"===typeof n&&!n.length))throw new $r("argument-error",_i+" property must be a non empty string when specified.");this.b=n||null}else{if("undefined"!==typeof e)throw new $r("argument-error",bi+" property must be a non empty string when specified.");if("undefined"!==typeof r||"undefined"!==typeof n)throw new $r("missing-android-pkg-name")}}else if("undefined"!==typeof n)throw new $r("argument-error",fi+" property must be a non null object when specified.");if(this.f=null,(e=t[yi])&&"object"===typeof e){if("string"===typeof(e=e[wi])&&e.length)this.f=e;else if("undefined"!==typeof e)throw new $r("argument-error",wi+" property must be a non empty string when specified.")}else if("undefined"!==typeof e)throw new $r("argument-error",yi+" property must be a non null object when specified.");if("undefined"!==typeof(e=t[mi])&&"boolean"!==typeof e)throw new $r("argument-error",mi+" property must be a boolean when specified.");if(this.c=!!e,"undefined"!==typeof(t=t[di])&&("string"!==typeof t||"string"===typeof t&&!t.length))throw new $r("argument-error",di+" property must be a non empty string when specified.");this.i=t||null}var fi="android",di="dynamicLinkDomain",mi="handleCodeInApp",yi="iOS",gi="url",vi="installApp",_i="minimumVersion",bi="packageName",wi="bundleId";function xi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Ei=null,Ti=null;function Si(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Ti[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Ei){Ei={},Ti={};for(var t=0;65>t;t++)Ei[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),Ti[Ei[t]]=t,62<=t&&(Ti["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e+=String.fromCharCode(t)})),e}function Ci(t){this.f=t.sub,C(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.c=t.firebase&&t.firebase.tenant||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function Ii(t){return(t=ki(t))&&t.sub&&t.iss&&t.aud&&t.exp?new Ci(t):null}function ki(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(Si(t))}catch(r){}return null}Ci.prototype.R=function(){return this.c},Ci.prototype.g=function(){return this.b};var Ai,Oi={bd:{cb:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},dd:{cb:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ed:{cb:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function Pi(t){for(var e in Oi)if(Oi[e].id===t)return{firebaseEndpoint:(t=Oi[e]).cb,secureTokenEndpoint:t.ib};return null}Ai=Pi("__EID__")?"__EID__":void 0;var Di="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Mi=["client_id","response_type","scope","redirect_uri","state"],Ri={Xc:{Ea:"locale",sa:700,ra:600,Fa:"facebook.com",Qa:Mi},Zc:{Ea:null,sa:500,ra:750,Fa:"github.com",Qa:Mi},$c:{Ea:"hl",sa:515,ra:680,Fa:"google.com",Qa:Mi},fd:{Ea:"lang",sa:485,ra:705,Fa:"twitter.com",Qa:Di},Vc:{Ea:"locale",sa:600,ra:600,Fa:"apple.com",Qa:[]}};function Ni(t){for(var e in Ri)if(Ri[e].Fa==t)return Ri[e];return null}function Li(t){var e={};e["facebook.com"]=Ui,e["google.com"]=qi,e["github.com"]=Vi,e["twitter.com"]=Wi;var n=t&&t[ji];try{if(n)return e[n]?new e[n](t):new Bi(t);if("undefined"!==typeof t[Fi])return new zi(t)}catch(r){}return null}var Fi="idToken",ji="providerId";function zi(t){var e=t[ji];if(!e&&t[Fi]){var n=Ii(t[Fi]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,"undefined"!==typeof t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Br(this,"providerId",e),Br(this,"isNewUser",n)}function Bi(t){zi.call(this,t),Br(this,"profile",qr((t=kr(t.rawUserInfo||"{}"))||{}))}function Ui(t){if(Bi.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Vi(t){if(Bi.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Br(this,"username",this.profile&&this.profile.login||null)}function qi(t){if(Bi.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Wi(t){if(Bi.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Br(this,"username",t.screenName||null)}function Gi(t){var e=Sn(t),n=Tn(e,"link"),r=Tn(Sn(n),"link");return e=Tn(e,"deep_link_id"),Tn(Sn(e),"link")||e||r||n||t}function Hi(){}function Ki(t,e){return t.then((function(t){if(t[La]){var n=Ii(t[La]);if(!n||e!=n.f)throw new $r("user-mismatch");return t}throw new $r("user-mismatch")})).s((function(t){throw t&&t.code&&t.code==ei+"user-not-found"?new $r("user-mismatch"):t}))}function Qi(t,e){if(!e)throw new $r("internal-error","failed to construct a credential");this.a=e,Br(this,"providerId",t),Br(this,"signInMethod",t)}function Xi(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function Yi(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new Qi(t.providerId,t.pendingToken)}catch(e){}return null}function Zi(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Br(this,"idToken",e.idToken),e.accessToken&&Br(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Br(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new $r("internal-error","failed to construct a credential");Br(this,"accessToken",e.oauthToken),Br(this,"secret",e.oauthTokenSecret)}Br(this,"providerId",t),Br(this,"signInMethod",n)}function Ji(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Fn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function $i(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new Zi(t.providerId,e,t.signInMethod)}catch(n){}}return null}function to(t,e){this.Fc=e||[],Ur(this,{providerId:t,isOAuthProvider:!0}),this.zb={},this.eb=(Ni(t)||{}).Ea||null,this.bb=null}function eo(t){if("string"!==typeof t||0!=t.indexOf("saml."))throw new $r("argument-error",'SAML provider IDs must be prefixed with "saml."');to.call(this,t,[])}function no(t){to.call(this,t,Mi),this.a=[]}function ro(){no.call(this,"facebook.com")}function io(t){if(!t)throw new $r("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return _(t)&&(e=t.accessToken),(new ro).credential({accessToken:e})}function oo(){no.call(this,"github.com")}function ao(t){if(!t)throw new $r("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return _(t)&&(e=t.accessToken),(new oo).credential({accessToken:e})}function so(){no.call(this,"google.com"),this.ya("profile")}function uo(t,e){var n=t;return _(t)&&(n=t.idToken,e=t.accessToken),(new so).credential({idToken:n,accessToken:e})}function co(){to.call(this,"twitter.com",Di)}function lo(t,e){var n=t;if(_(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new $r("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Zi("twitter.com",n,"twitter.com")}function ho(t,e,n){this.a=t,this.c=e,Br(this,"providerId","password"),Br(this,"signInMethod",n===fo.EMAIL_LINK_SIGN_IN_METHOD?fo.EMAIL_LINK_SIGN_IN_METHOD:fo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function po(t){return t&&t.email&&t.password?new ho(t.email,t.password,t.signInMethod):null}function fo(){Ur(this,{providerId:"password",isOAuthProvider:!1})}function mo(t,e){if(!(e=yo(e)))throw new $r("argument-error","Invalid email link!");return new ho(t,e.code,fo.EMAIL_LINK_SIGN_IN_METHOD)}function yo(t){return(t=hi(t=Gi(t)))&&t.operation===Gr?t:null}function go(t){if(!(t.Va&&t.Ua||t.Ha&&t.ba))throw new $r("internal-error");this.a=t,Br(this,"providerId","phone"),Br(this,"signInMethod","phone")}function vo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return B(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new go(e)}return null}function _o(t){return t.a.Ha&&t.a.ba?{temporaryProof:t.a.Ha,phoneNumber:t.a.ba}:{sessionInfo:t.a.Va,code:t.a.Ua}}function bo(t){try{this.a=t||r.a.auth()}catch(e){throw new $r("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Ur(this,{providerId:"phone",isOAuthProvider:!1})}function wo(t,e){if(!t)throw new $r("missing-verification-id");if(!e)throw new $r("missing-verification-code");return new go({Va:t,Ua:e})}function xo(t){if(t.temporaryProof&&t.phoneNumber)return new go({Ha:t.temporaryProof,ba:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return uo(o,n);case"facebook.com":return io(n);case"github.com":return ao(n);case"twitter.com":return lo(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new Qi(e,a):new Zi(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new no(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function Eo(t){if(!t.isOAuthProvider)throw new $r("invalid-oauth-provider")}function To(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new $r("invalid-auth-event");if(this.g&&this.a)throw new $r("invalid-auth-event");if(this.g&&!this.f)throw new $r("invalid-auth-event")}function So(t){return(t=t||{}).type?new To(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&ti(t.error),t.postBody,t.tenantId):null}function Co(){this.b=null,this.a=[]}I(Bi,zi),I(Ui,Bi),I(Vi,Bi),I(qi,Bi),I(Wi,Bi),Qi.prototype.na=function(t){return ts(t,Xi(this))},Qi.prototype.b=function(t,e){var n=Xi(this);return n.idToken=e,es(t,n)},Qi.prototype.f=function(t,e){return Ki(ns(t,Xi(this)),e)},Qi.prototype.A=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},Zi.prototype.na=function(t){return ts(t,Ji(this))},Zi.prototype.b=function(t,e){var n=Ji(this);return n.idToken=e,es(t,n)},Zi.prototype.f=function(t,e){return Ki(ns(t,Ji(this)),e)},Zi.prototype.A=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},to.prototype.Ga=function(t){return this.zb=Y(t),this},I(eo,to),I(no,to),no.prototype.ya=function(t){return q(this.a,t)||this.a.push(t),this},no.prototype.Hb=function(){return K(this.a)},no.prototype.credential=function(t,e){var n;if(!(n=_(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new $r("argument-error","credential failed: must provide the ID token and/or the access token.");return new Zi(this.providerId,n,this.providerId)},I(ro,no),Br(ro,"PROVIDER_ID","facebook.com"),Br(ro,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),I(oo,no),Br(oo,"PROVIDER_ID","github.com"),Br(oo,"GITHUB_SIGN_IN_METHOD","github.com"),I(so,no),Br(so,"PROVIDER_ID","google.com"),Br(so,"GOOGLE_SIGN_IN_METHOD","google.com"),I(co,to),Br(co,"PROVIDER_ID","twitter.com"),Br(co,"TWITTER_SIGN_IN_METHOD","twitter.com"),ho.prototype.na=function(t){return this.signInMethod==fo.EMAIL_LINK_SIGN_IN_METHOD?Ps(t,ls,{email:this.a,oobCode:this.c}):Ps(t,Is,{email:this.a,password:this.c})},ho.prototype.b=function(t,e){return this.signInMethod==fo.EMAIL_LINK_SIGN_IN_METHOD?Ps(t,hs,{idToken:e,email:this.a,oobCode:this.c}):Ps(t,ws,{idToken:e,email:this.a,password:this.c})},ho.prototype.f=function(t,e){return Ki(this.na(t),e)},ho.prototype.A=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Ur(fo,{PROVIDER_ID:"password"}),Ur(fo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Ur(fo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),go.prototype.na=function(t){return t.Wa(_o(this))},go.prototype.b=function(t,e){var n=_o(this);return n.idToken=e,Ps(t,As,n)},go.prototype.f=function(t,e){var n=_o(this);return n.operation="REAUTH",Ki(t=Ps(t,Os,n),e)},go.prototype.A=function(){var t={providerId:"phone"};return this.a.Va&&(t.verificationId=this.a.Va),this.a.Ua&&(t.verificationCode=this.a.Ua),this.a.Ha&&(t.temporaryProof=this.a.Ha),this.a.ba&&(t.phoneNumber=this.a.ba),t},bo.prototype.Wa=function(t,e){var n=this.a.b;return $t(e.verify()).then((function(r){if(!c(r))throw new $r("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return function(t,e){return Ps(t,_s,e)}(n,{phoneNumber:t,recaptchaToken:r}).then((function(t){return"function"===typeof e.reset&&e.reset(),t}),(function(t){throw"function"===typeof e.reset&&e.reset(),t}));default:throw new $r("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Ur(bo,{PROVIDER_ID:"phone"}),Ur(bo,{PHONE_SIGN_IN_METHOD:"phone"}),To.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},To.prototype.R=function(){return this.h},To.prototype.A=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.A()}};var Io,ko=null;function Ao(t){var e="unauthorized-domain",n=void 0,r=Sn(t);t=r.b,"chrome-extension"==(r=r.f)?n=jt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=jt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",$r.call(this,e,n)}function Oo(t,e,n){$r.call(this,t,n),(t=e||{}).Ab&&Br(this,"email",t.Ab),t.ba&&Br(this,"phoneNumber",t.ba),t.credential&&Br(this,"credential",t.credential),t.Qb&&Br(this,"tenantId",t.Qb)}function Po(t){if(t.code){var e=t.code||"";0==e.indexOf(ei)&&(e=e.substring(ei.length));var n={credential:xo(t),Qb:t.tenantId};if(t.email)n.Ab=t.email;else if(t.phoneNumber)n.ba=t.phoneNumber;else if(!n.credential)return new $r(e,t.message||void 0);return new Oo(e,n,t.message)}return null}function Do(){}function Mo(t){return t.c||(t.c=t.b())}function Ro(){}function No(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Lo(){}function Fo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=T(this.fc,this),this.a.onerror=T(this.Ib,this),this.a.onprogress=T(this.gc,this),this.a.ontimeout=T(this.kc,this)}function jo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function zo(t,e,n){this.reset(t,e,n,void 0,void 0)}I(Ao,$r),I(Oo,$r),Oo.prototype.A=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.A();return e&&J(t,e),t},Oo.prototype.toJSON=function(){return this.A()},Do.prototype.c=null,I(Ro,Do),Ro.prototype.a=function(){var t=No(this);return t?new ActiveXObject(t):new XMLHttpRequest},Ro.prototype.b=function(){var t={};return No(this)&&(t[0]=!0,t[1]=!0),t},Io=new Ro,I(Lo,Do),Lo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Fo;throw Error("Unsupported browser")},Lo.prototype.b=function(){return{}},(e=Fo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},e.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},e.fc=function(){this.status=200,this.response=this.responseText=this.a.responseText,jo(this,4)},e.Ib=function(){this.status=500,this.response=this.responseText="",jo(this,4)},e.kc=function(){this.Ib()},e.gc=function(){this.status=200,jo(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},zo.prototype.a=null;function Bo(t){this.f=t,this.b=this.c=this.a=null}function Uo(t,e){this.name=t,this.value=e}zo.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||C(),delete this.a},Uo.prototype.toString=function(){return this.name};var Vo=new Uo("SEVERE",1e3),qo=new Uo("WARNING",900),Wo=new Uo("CONFIG",700),Go=new Uo("FINE",500);Bo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(P("Root logger has no level set."),null)}(this).value)for(v(e)&&(e=e()),t=new zo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Ho,Ko={},Qo=null;function Xo(t){var e;if(Qo||(Qo=new Bo(""),Ko[""]=Qo,Qo.c=Wo),!(e=Ko[t])){e=new Bo(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=Xo(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,Ko[t]=e}return e}function Yo(t,e){t&&t.log(Go,e,void 0)}function Zo(t){this.f=t}function Jo(t){sn.call(this),this.o=t,this.readyState=$o,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=Xo("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}I(Zo,Do),Zo.prototype.a=function(){return new Jo(this.f)},Zo.prototype.b=(Ho={},function(){return Ho}),I(Jo,sn);var $o=0;function ta(t){t.c.read().then(t.ec.bind(t)).catch(t.Oa.bind(t))}function ea(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,na(t)}function na(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function ra(t){sn.call(this),this.headers=new mn,this.B=t||null,this.c=!1,this.w=this.a=null,this.h=this.O=this.l="",this.f=this.J=this.i=this.I=!1,this.g=0,this.o=null,this.m=ia,this.v=this.P=!1}(e=Jo.prototype).open=function(t,e){if(this.readyState!=$o)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,na(this)},e.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.o.fetch(new Request(this.g,e)).then(this.jc.bind(this),this.Oa.bind(this))},e.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ea(this,!1)),this.readyState=$o},e.jc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,na(this)),this.a&&(this.readyState=3,na(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.hc.bind(this),this.Oa.bind(this)):"undefined"!==typeof u.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,ta(this)):t.text().then(this.ic.bind(this),this.Oa.bind(this)))))},e.ec=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?ea(this,!0):na(this),3==this.readyState&&ta(this)}},e.ic=function(t){this.a&&(this.response=this.responseText=t,ea(this,!0))},e.hc=function(t){this.a&&(this.response=t,ea(this,!0))},e.Oa=function(t){var e=this.h;e&&e.log(qo,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&ea(this,!0)},e.setRequestHeader=function(t,e){this.i.append(t,e)},e.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(qo,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(qo,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},I(ra,sn);var ia="";ra.prototype.b=Xo("goog.net.XhrIo");var oa=/^https?$/i,aa=["POST","PUT"];function sa(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.O=n,t.I=!1,t.c=!0,t.a=t.B?t.B.a():Io.a(),t.w=t.B?Mo(t.B):Mo(Io),t.a.onreadystatechange=T(t.Lb,t);try{Yo(t.b,ya(t,"Opening Xhr")),t.J=!0,t.a.open(n,String(e),!0),t.J=!1}catch(a){return Yo(t.b,ya(t,"Error opening Xhr: "+a.message)),void ca(t,a)}e=r||"";var o=new mn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(g(t)||c(t))B(t,e,void 0);else for(var n=dn(t),r=fn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=ua,n=t.length,r=c(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:c(t)?t.charAt(e):t[e]}(o.X()),r=u.FormData&&e instanceof u.FormData,!q(aa,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.P&&(t.a.withCredentials=t.P);try{fa(t),0<t.g&&(t.v=function(t){return be&&Pe(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),Yo(t.b,ya(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=T(t.Ia,t)):t.o=hn(t.Ia,t.g,t)),Yo(t.b,ya(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(a){Yo(t.b,ya(t,"Send error: "+a.message)),ca(t,a)}}function ua(t){return"content-type"==t.toLowerCase()}function ca(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,la(t),pa(t)}function la(t){t.I||(t.I=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function ha(t){if(t.c&&"undefined"!=typeof s)if(t.w[1]&&4==da(t)&&2==ma(t))Yo(t.b,ya(t,"Local request error detected and ignored"));else if(t.i&&4==da(t))hn(t.Lb,0,t);else if(t.dispatchEvent("readystatechange"),4==da(t)){Yo(t.b,ya(t,"Request complete")),t.c=!1;try{var e,n=ma(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(vn)[1]||null;if(!o&&u.self&&u.self.location){var a=u.self.location.protocol;o=a.substr(0,a.length-1)}i=!oa.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<da(t)?t.a.statusText:""}catch(l){Yo(t.b,"Can not get status: "+l.message),c=""}t.h=c+" ["+ma(t)+"]",la(t)}}finally{pa(t)}}}function pa(t,e){if(t.a){fa(t);var n=t.a,r=t.w[0]?f:null;t.a=null,t.w=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(t=t.b)&&t.log(Vo,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function fa(t){t.a&&t.v&&(t.a.ontimeout=null),t.o&&(u.clearTimeout(t.o),t.o=null)}function da(t){return t.a?t.a.readyState:0}function ma(t){try{return 2<da(t)?t.a.status:-1}catch(e){return-1}}function ya(t,e){return e+" ["+t.O+" "+t.l+" "+ma(t)+"]"}function ga(t){var e=ka;this.g=[],this.v=e,this.o=t||null,this.f=this.a=!1,this.c=void 0,this.u=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function va(t,e,n){t.a=!0,t.c=n,t.f=!e,xa(t)}function _a(t){if(t.a){if(!t.u)throw new Ea(t);t.u=!1}}function ba(t,e,n,r){t.g.push([e,n,r]),t.a&&xa(t)}function wa(t){return V(t.g,(function(t){return v(t[1])}))}function xa(t){if(t.h&&t.a&&wa(t)){var e=t.h,n=Ca[e];n&&(u.clearTimeout(n.a),delete Ca[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.o,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(k(e)||"function"===typeof u.Promise&&e instanceof u.Promise)&&(r=!0,t.i=!0)}catch(c){e=c,t.f=!0,wa(t)||(n=!0)}}t.c=e,r&&(s=T(t.m,t,!0),r=T(t.m,t,!1),e instanceof ga?(ba(e,s,r),e.w=!0):e.then(s,r)),n&&(e=new Sa(e),Ca[e.a]=e,t.h=e.a)}function Ea(){A.call(this)}function Ta(){A.call(this)}function Sa(t){this.a=u.setTimeout(T(this.c,this),0),this.b=t}(e=ra.prototype).Ia=function(){"undefined"!=typeof s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Yo(this.b,ya(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(Yo(this.b,ya(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),pa(this))},e.za=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),pa(this,!0)),ra.qb.za.call(this)},e.Lb=function(){this.va||(this.J||this.i||this.f?ha(this):this.yc())},e.yc=function(){ha(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ia:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(Vo,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return Yo(this.b,"Can not get response: "+e.message),null}},ga.prototype.cancel=function(t){if(this.a)this.c instanceof ga&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.v?this.v.call(this.o,this):this.u=!0,this.a||(t=new Ta(this),_a(this),va(this,!1,t))}},ga.prototype.m=function(t,e){this.i=!1,va(this,t,e)},ga.prototype.then=function(t,e,n){var r,i,o=new Ht((function(t,e){r=t,i=e}));return ba(this,r,(function(t){t instanceof Ta?o.cancel():i(t)})),o.then(t,e,n)},ga.prototype.$goog_Thenable=!0,I(Ea,A),Ea.prototype.message="Deferred has already fired",Ea.prototype.name="AlreadyCalledError",I(Ta,A),Ta.prototype.message="Deferred was canceled",Ta.prototype.name="CanceledError",Sa.prototype.c=function(){throw delete Ca[this.a],this.b};var Ca={};function Ia(t){var e={},n=e.document||document,r=ot(t).toString(),i=document.createElement("SCRIPT"),o={Nb:i,Ia:void 0},a=new ga(o),s=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(s=window.setTimeout((function(){Aa(i,!0);var t=new Da(Pa,"Timeout reached for loading script "+r);_a(a),va(a,!1,t)}),c),o.Ia=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Aa(i,e.hd||!1,s),_a(a),va(a,!0,null))},i.onerror=function(){Aa(i,!0,s);var t=new Da(Oa,"Error while loading script "+r);_a(a),va(a,!1,t)},J(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),Gn(i,o),function(t,e){j(t,"HTMLScriptElement"),t.src=ot(e),null===p&&(p=(e=(e=u.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&h.test(e)?e:""),(e=p)&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function ka(){if(this&&this.Nb){var t=this.Nb;t&&"SCRIPT"==t.tagName&&Aa(t,!0,this.Ia)}}function Aa(t,e,n){null!=n&&u.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Oa=0,Pa=1;function Da(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),A.call(this,n),this.code=t}function Ma(t){this.f=t}function Ra(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.u=t.secureTokenTimeout||Fa,this.g=Y(t.secureTokenHeaders||ja),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.firebaseTimeout||za,this.a=Y(t.firebaseHeaders||Ba),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==pr(),!(n=u.XMLHttpRequest||n&&r.a.INTERNAL.node&&r.a.INTERNAL.node.XMLHttpRequest)&&!hr())throw new $r("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,hr()?this.f=new Zo(self):fr()?this.f=new Ma(n):this.f=new Lo,this.b=null}I(Da,A),I(Ma,Do),Ma.prototype.a=function(){return new this.f},Ma.prototype.b=function(){return{}};var Na,La="idToken",Fa=new Dr(3e4,6e4),ja={"Content-Type":"application/x-www-form-urlencoded"},za=new Dr(3e4,6e4),Ba={"Content-Type":"application/json"};function Ua(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Va(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function qa(t,e,n,r,i,o,a){(function(){var t=_r();return!((t=yr(t)!=mr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t)&&(!be||!Ae||9<Ae)})()||hr()?t=T(t.o,t):(Na||(Na=new Ht((function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{u[Ga]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){ba(t,null,e,void 0)}(Ia(at(Wa,{onload:Ga})),(function(){e(Error("CORS_UNSUPPORTED"))}))}}(t,e)}))),t=T(t.m,t)),t(e,n,r,i,o,a)}Ra.prototype.R=function(){return this.b},Ra.prototype.o=function(t,e,n,r,i,o){if(hr()&&("undefined"===typeof u.fetch||"undefined"===typeof u.Headers||"undefined"===typeof u.Request))throw new $r("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new ra(this.f);if(o){a.g=Math.max(0,o);var s=setTimeout((function(){a.dispatchEvent("timeout")}),o)}un(a,"complete",(function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return Yo(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(n){t=null}e&&e(t)})),cn(a,"ready",(function(){s&&clearTimeout(s),ye(this)})),cn(a,"timeout",(function(){s&&clearTimeout(s),ye(this),e&&e(null)})),sa(a,t,n,r,i)};var Wa=new $(nt,"https://apis.google.com/js/client.js?onload=%{onload}"),Ga="__fcb"+Math.floor(1e6*Math.random()).toString();function Ha(t){if(!c(t=t.email)||!sr.test(t))throw new $r("invalid-email")}function Ka(t){"email"in t&&Ha(t)}function Qa(t){if(!t[La])throw new $r("internal-error")}function Xa(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new $r("internal-error")}else{if(!t.sessionInfo)throw new $r("missing-verification-id");if(!t.code)throw new $r("missing-verification-code")}}Ra.prototype.m=function(t,e,n,r,i){var o=this;Na.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).s((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Ra.prototype.ob=function(){return Ps(this,xs,{})},Ra.prototype.rb=function(t,e){return Ps(this,bs,{idToken:t,email:e})},Ra.prototype.sb=function(t,e){return Ps(this,ws,{idToken:t,password:e})};var Ya={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Za(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new $r("internal-error")}function Ja(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(zn(t=new Nn(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function $a(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Po(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Po(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Po(t)):t.errorMessage&&(e=Ds(t.errorMessage)),e)throw e;if(!t[La])throw new $r("internal-error")}function ts(t,e){return e.returnIdpCredential=!0,Ps(t,Es,e)}function es(t,e){return e.returnIdpCredential=!0,Ps(t,Ss,e)}function ns(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Ps(t,Ts,e)}function rs(t){if(!t.oobCode)throw new $r("invalid-action-code")}(e=Ra.prototype).tb=function(t,e){var n={idToken:t},r=[];return Q(Ya,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),Ps(this,bs,n)},e.kb=function(t,e){return J(t={requestType:"PASSWORD_RESET",email:t},e),Ps(this,ms,t)},e.lb=function(t,e){return J(t={requestType:"EMAIL_SIGNIN",email:t},e),Ps(this,fs,t)},e.jb=function(t,e){return J(t={requestType:"VERIFY_EMAIL",idToken:t},e),Ps(this,ds,t)},e.Wa=function(t){return Ps(this,ks,t)},e.ab=function(t,e){return Ps(this,vs,{oobCode:t,newPassword:e})},e.Ma=function(t){return Ps(this,os,{oobCode:t})},e.Ya=function(t){return Ps(this,is,{oobCode:t})};var is={endpoint:"setAccountInfo",D:rs,fa:"email",F:!0},os={endpoint:"resetPassword",D:rs,K:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new $r("internal-error")},F:!0},as={endpoint:"signupNewUser",D:function(t){if(Ha(t),!t.password)throw new $r("weak-password")},K:Qa,T:!0,F:!0},ss={endpoint:"createAuthUri",F:!0},us={endpoint:"deleteAccount",V:["idToken"]},cs={endpoint:"setAccountInfo",V:["idToken","deleteProvider"],D:function(t){if(!y(t.deleteProvider))throw new $r("internal-error")}},ls={endpoint:"emailLinkSignin",V:["email","oobCode"],D:Ha,K:Qa,T:!0,F:!0},hs={endpoint:"emailLinkSignin",V:["idToken","email","oobCode"],D:Ha,K:Qa,T:!0},ps={endpoint:"getAccountInfo"},fs={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new $r("internal-error");Ha(t)},fa:"email",F:!0},ds={endpoint:"getOobConfirmationCode",V:["idToken","requestType"],D:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new $r("internal-error")},fa:"email",F:!0},ms={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("PASSWORD_RESET"!=t.requestType)throw new $r("internal-error");Ha(t)},fa:"email",F:!0},ys={wb:!0,endpoint:"getProjectConfig",Kb:"GET"},gs={wb:!0,endpoint:"getRecaptchaParam",Kb:"GET",K:function(t){if(!t.recaptchaSiteKey)throw new $r("internal-error")}},vs={endpoint:"resetPassword",D:rs,fa:"email",F:!0},_s={endpoint:"sendVerificationCode",V:["phoneNumber","recaptchaToken"],fa:"sessionInfo",F:!0},bs={endpoint:"setAccountInfo",V:["idToken"],D:Ka,T:!0},ws={endpoint:"setAccountInfo",V:["idToken"],D:function(t){if(Ka(t),!t.password)throw new $r("weak-password")},K:Qa,T:!0},xs={endpoint:"signupNewUser",K:Qa,T:!0,F:!0},Es={endpoint:"verifyAssertion",D:Za,Ra:Ja,K:$a,T:!0,F:!0},Ts={endpoint:"verifyAssertion",D:Za,Ra:Ja,K:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new $r("user-not-found");if(t.errorMessage)throw Ds(t.errorMessage);if(!t[La])throw new $r("internal-error")},T:!0,F:!0},Ss={endpoint:"verifyAssertion",D:function(t){if(Za(t),!t.idToken)throw new $r("internal-error")},Ra:Ja,K:$a,T:!0},Cs={endpoint:"verifyCustomToken",D:function(t){if(!t.token)throw new $r("invalid-custom-token")},K:Qa,T:!0,F:!0},Is={endpoint:"verifyPassword",D:function(t){if(Ha(t),!t.password)throw new $r("wrong-password")},K:Qa,T:!0,F:!0},ks={endpoint:"verifyPhoneNumber",D:Xa,K:Qa,F:!0},As={endpoint:"verifyPhoneNumber",D:function(t){if(!t.idToken)throw new $r("internal-error");Xa(t)},K:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Po(t);Qa(t)}},Os={Yb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",D:Xa,K:Qa,F:!0};function Ps(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(void 0===r||null===r||""===r)return!1}return!0}(n,e.V))return te(new $r("internal-error"));var r,i=e.Kb||"POST";return $t(n).then(e.D).then((function(){return e.T&&(n.returnSecureToken=!0),e.F&&t.b&&"undefined"===typeof n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o){var a=Sn(t.h+e);En(a,"key",t.c),o&&En(a,"cb",C().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&En(a,u,r[u]);return new Ht((function(e,o){qa(t,a.toString(),(function(t){t?t.error?o(Ms(t,i||{})):e(t):o(new $r("network-request-failed"))}),n,s?void 0:Xn(Ir(r)),t.a,t.i.get())}))}(t,e.endpoint,i,n,e.Yb,e.wb||!1)})).then((function(t){return r=t,e.Ra?e.Ra(n,r):r})).then(e.K).then((function(){if(!e.fa)return r;if(!(e.fa in r))throw new $r("internal-error");return r[e.fa]}))}function Ds(t){return Ms({error:{errors:[{message:t}],code:400,message:t}})}function Ms(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new $r(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",J(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new $r(r[i],e);return!e&&t&&(e=Cr(t)),new $r("internal-error",e)}function Rs(t){this.b=t,this.a=null,this.gb=function(t){return(js||(js=new Ht((function(t,e){function n(){Pr(),br("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Pr(),e(Error("Network Error"))},timeout:Ls.get()})}if(br("gapi.iframes.Iframe"))t();else if(br("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();u[r]=function(){br("gapi.load")?n():e(Error("Network Error"))},$t(Ia(r=at(Ns,{onload:r}))).s((function(){e(Error("Network Error"))}))}})).s((function(t){throw js=null,t})))).then((function(){return new Ht((function(e,n){br("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:br("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),Fs.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var Ns=new $(nt,"https://apis.google.com/js/api.js?onload=%{onload}"),Ls=new Dr(3e4,6e4),Fs=new Dr(5e3,15e3),js=null;function zs(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Cn(this.i,"/__/auth/iframe"),En(this.a,"apiKey",this.g),En(this.a,"appName",this.h),this.b=null,this.c=[]}function Bs(t,e,n,r,i){this.o=t,this.m=e,this.c=n,this.u=r,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function Us(t){try{return r.a.app(t).auth().Ca()}catch(e){return[]}}function Vs(t,e,n,r,i){this.u=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.m=this.o=this.v=null,this.g=[],this.l=this.a=null}function qs(t){var e=er();return function(t){return Ps(t,ys,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Sn(e),r=n.f;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Sn(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:ar.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Ao(er())}))}function Ws(t){return t.l?t.l:(t.l=ur().then((function(){if(!t.o){var e=t.c,n=t.h,r=Us(t.b),i=new zs(t.u,t.f,t.b);i.f=e,i.b=n,i.c=K(r||[]),t.o=i.toString()}t.i=new Rs(t.o),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.gb.then((function(){t.a.register("authEvent",e,br("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.i,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=So(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return(n={}).status=r?"ACK":"ERROR",$t(n)}return n.status="ERROR",$t(n)}))}(t)})),t.l)}function Gs(t){return t.m||(t.v=t.c?vr(t.c,Us(t.b)):null,t.m=new Ra(t.f,Pi(t.h),t.v)),t.m}function Hs(t,e,n,r,i,o,a,s,u,c,l){return(t=new Bs(t,e,n,r,i)).l=o,t.g=a,t.i=s,t.b=Y(u||null),t.f=c,t.nb(l).toString()}function Ks(t){if(this.a=t||r.a.INTERNAL.reactNative&&r.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new $r("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Qs(t){this.b=t,this.a={},this.f=T(this.c,this)}zs.prototype.toString=function(){return this.f?En(this.a,"v",this.f):jn(this.a.a,"v"),this.b?En(this.a,"eid",this.b):jn(this.a.a,"eid"),this.c.length?En(this.a,"fw",this.c.join(",")):jn(this.a.a,"fw"),this.a.toString()},Bs.prototype.nb=function(t){return this.h=t,this},Bs.prototype.toString=function(){var t=Cn(this.o,"/__/auth/handler");if(En(t,"apiKey",this.m),En(t,"appName",this.c),En(t,"authType",this.u),this.a.isOAuthProvider){var e=this.a;try{var n=r.a.app(this.c).auth().ha()}catch(u){n=null}for(var i in e.bb=n,En(t,"providerId",this.a.providerId),n=Ir((e=this.a).zb))n[i]=n[i].toString();i=e.Fc,n=Y(n);for(var o=0;o<i.length;o++){var a=i[o];a in n&&delete n[a]}e.eb&&e.bb&&!n[e.eb]&&(n[e.eb]=e.bb),X(n)||En(t,"customParameters",Cr(n))}if("function"===typeof this.a.Hb&&((e=this.a.Hb()).length&&En(t,"scopes",e.join(","))),this.l?En(t,"redirectUrl",this.l):jn(t.a,"redirectUrl"),this.g?En(t,"eventId",this.g):jn(t.a,"eventId"),this.i?En(t,"v",this.i):jn(t.a,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!Tn(t,s)&&En(t,s,this.b[s]);return this.h?En(t,"tid",this.h):jn(t.a,"tid"),this.f?En(t,"eid",this.f):jn(t.a,"eid"),(s=Us(this.c)).length&&En(t,"fw",s.join(",")),t.toString()},(e=Vs.prototype).Fb=function(t,e,n){var r=new $r("popup-closed-by-user"),i=new $r("web-storage-unsupported"),o=this,a=!1;return this.ia().then((function(){(function(t){var e={type:"webStorageSupport"};return Ws(t).then((function(){return function(t,e){return t.gb.then((function(){return new Ht((function(n){t.a.send(e.type,e,n,br("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.i,e)})).then((function(t){if(t&&t.length&&"undefined"!==typeof t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&ir(t),e(i),a=!0)}))})).s((function(){})).then((function(){if(!a)return function(t){return new Ht((function(e){return function n(){pn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return pn(n).then((function(){e(r)}))}))},e.Ob=function(){var t=_r();return!Sr(t)&&!Or(t)},e.Jb=function(){return!1},e.Db=function(t,e,n,r,i,o,a,s){if(!t)return te(new $r("popup-blocked"));if(a&&!Sr())return this.ia().s((function(e){ir(t),i(e)})),r(),$t();this.a||(this.a=qs(Gs(this)));var u=this;return this.a.then((function(){var e=u.ia().s((function(e){throw ir(t),i(e),e}));return r(),e})).then((function(){(Eo(n),a)||nr(Hs(u.u,u.f,u.b,e,n,null,o,u.c,void 0,u.h,s),t)})).s((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},e.Eb=function(t,e,n,r){this.a||(this.a=qs(Gs(this)));var i=this;return this.a.then((function(){Eo(e),nr(Hs(i.u,i.f,i.b,t,e,er(),n,i.c,void 0,i.h,r))})).s((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},e.ia=function(){var t=this;return Ws(this).then((function(){return t.i.gb})).s((function(){throw t.a=null,new $r("network-request-failed")}))},e.Rb=function(){return!0},e.Aa=function(t){this.g.push(t)},e.Na=function(t){G(this.g,(function(e){return e==t}))},(e=Ks.prototype).get=function(t){return $t(this.a.getItem(t)).then((function(t){return t&&kr(t)}))},e.set=function(t,e){return $t(this.a.setItem(t,Cr(e)))},e.S=function(t){return $t(this.a.removeItem(t))},e.$=function(){},e.ea=function(){};var Xs,Ys=[];function Zs(t,e,n){X(t.a)&&t.b.addEventListener("message",t.f),"undefined"===typeof t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Js(t){this.a=t}function $s(t){this.c=t,this.b=!1,this.a=[]}function tu(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return te(Error("connection_unavailable"));var l=r?800:50,h="undefined"!==typeof MessageChannel?new MessageChannel:null;return new Ht((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),l),c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),"undefined"!==typeof t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return eu(t,c),e})).s((function(e){throw eu(t,c),e}))}function eu(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),G(t.a,(function(t){return t==e}))}}function nu(){if(!ou())throw new $r("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.u=u.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var t=this;hr()&&self?(this.l=function(){var t=hr()?self:null;if(B(Ys,(function(n){n.b==t&&(e=n)})),!e){var e=new Qs(t);Ys.push(e)}return e}(),Zs(this.l,"keyChanged",(function(e,n){return lu(t).then((function(e){return 0<e.length&&B(t.a,(function(t){t(e)})),{keyProcessed:q(e,n.key)}}))})),Zs(this.l,"ping",(function(){return $t(["keyChanged"])}))):function(){var t=u.navigator;return t&&t.serviceWorker?$t().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).s((function(){return null})):$t(null)}().then((function(e){(t.h=e)&&(t.g=new $s(new Js(e)),tu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&q(e[0].value,"keyChanged")&&(t.o=!0)})).s((function(){})))}))}function ru(t){return new Ht((function(e,n){var r=t.u.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new Ht((function(e,n){var r=t.u.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return ru(t)})).then((function(t){e(t)})).s((function(t){n(t)}))}}))}function iu(t){return t.m||(t.m=ru(t)),t.m}function ou(){try{return!!u.indexedDB}catch(Ho){return!1}}function au(t){return t.objectStore("firebaseLocalStorage")}function su(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function uu(t){return new Ht((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function cu(t,e){return t.g&&t.h&&function(){var t=u.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?tu(t.g,"keyChanged",{key:e},t.o).then((function(){})).s((function(){})):$t()}function lu(t){return iu(t).then((function(t){var e=au(su(t,!1));return e.getAll?uu(e.getAll()):new Ht((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r}))}function hu(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function pu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=$t().then((function(){if(ou()){var t=Ar(),r="__sak"+t;return Xs||(Xs=new nu),(n=Xs).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.S(r)})).then((function(){return n})).s((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.$((function(t){B(e.a,(function(e){e(t)}))})),t}))}function fu(){this.a={},this.type="inMemory"}function du(){if(!function(){var t="Node"==pr();if(!(t=mu()||t&&r.a.INTERNAL.node&&r.a.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==pr())throw new $r("internal-error","The LocalStorage compatibility library was not found.");throw new $r("web-storage-unsupported")}this.a=mu()||r.a.INTERNAL.node.localStorage,this.type="localStorage"}function mu(){try{var t=u.localStorage,e=Ar();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function yu(){this.type="nullStorage"}function gu(){if(!function(){var t="Node"==pr();if(!(t=vu()||t&&r.a.INTERNAL.node&&r.a.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==pr())throw new $r("internal-error","The SessionStorage compatibility library was not found.");throw new $r("web-storage-unsupported")}this.a=vu()||r.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function vu(){try{var t=u.sessionStorage,e=Ar();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function _u(){var t={};t.Browser=xu,t.Node=Eu,t.ReactNative=Tu,t.Worker=Su,this.a=t[pr()]}Qs.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];B(r,(function(e){i.push($t().then((function(){return e(t.origin,t.data.data)})))})),ne(i).then((function(r){var i=[];B(r,(function(t){i.push({fulfilled:t.Gb,value:t.value,reason:t.reason?t.reason.message:void 0})})),B(i,(function(t){for(var e in t)"undefined"===typeof t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},Js.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},$s.prototype.close=function(){for(;0<this.a.length;)eu(this,this.a[0]);this.b=!0},(e=nu.prototype).set=function(t,e){var n,r=!1,i=this;return iu(this).then((function(e){return uu((e=au(su(n=e,!0))).get(t))})).then((function(o){var a=au(su(n,!0));return o?(o.value=e,uu(a.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,uu(a.add(o)))})).then((function(){return i.c[t]=e,cu(i,t)})).ka((function(){r&&i.b--}))},e.get=function(t){return iu(this).then((function(e){return uu(au(su(e,!1)).get(t))})).then((function(t){return t&&t.value}))},e.S=function(t){var e=!1,n=this;return iu(this).then((function(r){return e=!0,n.b++,uu(au(su(r,!0)).delete(t))})).then((function(){return delete n.c[t],cu(n,t)})).ka((function(){e&&n.b--}))},e.$=function(t){0==this.a.length&&function(t){hu(t),function e(){t.f=setTimeout((function(){t.i=lu(t).then((function(e){0<e.length&&B(t.a,(function(t){t(e)}))})).then((function(){e()})).s((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},e.ea=function(t){G(this.a,(function(e){return e==t})),0==this.a.length&&hu(this)},(e=pu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},e.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},e.S=function(t){return this.b.then((function(e){return e.S(t)}))},e.$=function(t){this.a.push(t)},e.ea=function(t){G(this.a,(function(e){return e==t}))},(e=fu.prototype).get=function(t){return $t(this.a[t])},e.set=function(t,e){return this.a[t]=e,$t()},e.S=function(t){return delete this.a[t],$t()},e.$=function(){},e.ea=function(){},(e=du.prototype).get=function(t){var e=this;return $t().then((function(){return kr(e.a.getItem(t))}))},e.set=function(t,e){var n=this;return $t().then((function(){var r=Cr(e);null===r?n.S(t):n.a.setItem(t,r)}))},e.S=function(t){var e=this;return $t().then((function(){e.a.removeItem(t)}))},e.$=function(t){u.window&&Qe(u.window,"storage",t)},e.ea=function(t){u.window&&Ze(u.window,"storage",t)},(e=yu.prototype).get=function(){return $t(null)},e.set=function(){return $t()},e.S=function(){return $t()},e.$=function(){},e.ea=function(){},(e=gu.prototype).get=function(t){var e=this;return $t().then((function(){return kr(e.a.getItem(t))}))},e.set=function(t,e){var n=this;return $t().then((function(){var r=Cr(e);null===r?n.S(t):n.a.setItem(t,r)}))},e.S=function(t){var e=this;return $t().then((function(){e.a.removeItem(t)}))},e.$=function(){},e.ea=function(){};var bu,wu,xu={C:du,Ta:gu},Eu={C:du,Ta:gu},Tu={C:Ks,Ta:yu},Su={C:du,Ta:yu},Cu={ad:"local",NONE:"none",cd:"session"};function Iu(){var t=!(Or(_r())||!lr()),e=Sr(),n=wr();this.m=t,this.h=e,this.l=n,this.a={},bu||(bu=new _u),t=bu;try{this.g=!tr()&&Nr()||!u.indexedDB?new t.a.C:new pu(hr()?new fu:new t.a.C)}catch(r){this.g=new fu,this.h=!0}try{this.i=new t.a.Ta}catch(r){this.i=new fu}this.u=new fu,this.f=T(this.Pb,this),this.b={}}function ku(){return wu||(wu=new Iu),wu}function Au(t,e){switch(e){case"session":return t.i;case"none":return t.u;default:return t.g}}function Ou(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Pu(t,e,n){return n=Ou(e,n),"local"==e.C&&(t.b[n]=null),Au(t,e.C).S(n)}function Du(t){t.c&&(clearInterval(t.c),t.c=null)}function Mu(t){this.a=t,this.b=ku()}(e=Iu.prototype).get=function(t,e){return Au(this,t.C).get(Ou(t,e))},e.set=function(t,e,n){var r=Ou(t,n),i=this,o=Au(this,t.C);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.C&&(i.b[r]=e)}))},e.addListener=function(t,e,n){t=Ou(t,e),this.l&&(this.b[t]=u.localStorage.getItem(t)),X(this.a)&&(Au(this,"local").$(this.f),this.h||(tr()||!Nr())&&u.indexedDB||!this.l||function(t){Du(t),t.c=setInterval((function(){for(var e in t.a){var n=u.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Fe({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Pb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},e.removeListener=function(t,e,n){t=Ou(t,e),this.a[t]&&(G(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),X(this.a)&&(Au(this,"local").ea(this.f),Du(this))},e.Pb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];"undefined"===typeof r&&(r=null);var i=u.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.$a(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if("undefined"!==typeof t.a.a?Au(this,"local").ea(this.f):Du(this),this.m)if(n=u.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?u.localStorage.setItem(e,r):u.localStorage.removeItem(e);else if(this.b[e]===r&&"undefined"===typeof t.a.a)return;var o=this;n=function(){"undefined"===typeof t.a.a&&o.b[e]===u.localStorage.getItem(e)||(o.b[e]=u.localStorage.getItem(e),o.$a(e))},be&&Ae&&10==Ae&&u.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else B(t,T(this.$a,this))},e.$a=function(t){this.a[t]&&B(this.a[t],(function(t){t()}))};var Ru,Nu={name:"authEvent",C:"local"};function Lu(){this.a=ku()}function Fu(t,e){this.b=ju,this.f=u.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=u.Int32Array?new Int32Array(64):Array(64),void 0!==Ru||(Ru=u.Int32Array?new Int32Array(Gu):Gu),this.reset()}I(Fu,(function(){this.b=-1}));for(var ju=64,zu=ju-1,Bu=[],Uu=0;Uu<zu;Uu++)Bu[Uu]=0;var Vu=H(128,Bu);function qu(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var p=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|Ru[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+p|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function Wu(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if(c(e))for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(qu(t),i=0);else{if(!g(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(qu(t),i=0)}}t.c=i,t.g+=n}Fu.prototype.reset=function(){this.g=this.c=0,this.a=u.Int32Array?new Int32Array(this.h):K(this.h)};var Gu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Hu(){Fu.call(this,8,Ku)}I(Hu,Fu);var Ku=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Qu(t,e,n,r,i){this.u=t,this.i=e,this.l=n,this.m=r||null,this.o=i||null,this.h=e+":"+n,this.v=new Lu,this.g=new Mu(this.h),this.f=null,this.b=[],this.a=this.c=null}function Xu(t){return new $r("invalid-cordova-configuration",t)}function Yu(t){var e=new Hu;Wu(e,t),t=[];var n=8*e.g;56>e.c?Wu(e,Vu,56-e.c):Wu(e,Vu,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(qu(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return U(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}function Zu(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function Ju(t){return t.f||(t.f=t.ia().then((function(){return new Ht((function(e){t.Aa((function n(r){return e(r),t.Na(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),$u(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=Gi(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"===typeof(o=kr(Tn(o=Sn(i),"firebaseError")||null))?ti(o):null)?new To(r.c,r.b,null,null,o,null,r.R()):new To(r.c,r.b,i,r.f,null,null,r.R())),i=o||n}Zu(t,i)}))}var n=new To("unknown",null,null,null,new $r("no-auth-event")),r=!1,i=pn(500).then((function(){return $u(t).then((function(){r||Zu(t,n)}))})),o=u.handleOpenURL;u.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(br("BuildInfo.packageName",u).toLowerCase()+"://")&&e({url:t}),"function"===typeof o)try{o(t)}catch(n){console.error(n)}},ko||(ko=new Co),function(t){var e=ko;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"===typeof(t=br("universalLinks.subscribe",u))&&t(null,e.b))}(e)}(t)}))}))),t.f}function $u(t){var e=null;return function(t){return t.b.get(Nu,t.a).then((function(t){return So(t)}))}(t.g).then((function(n){return e=n,Pu((n=t.g).b,Nu,n.a)})).then((function(){return e}))}function tc(t){this.a=t,this.b=ku()}(e=Qu.prototype).ia=function(){return this.Da?this.Da:this.Da=(cr(void 0)?ur().then((function(){return new Ht((function(t,e){var n=u.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):te(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!==typeof br("universalLinks.subscribe",u))throw Xu("cordova-universal-links-plugin-fix is not installed");if("undefined"===typeof br("BuildInfo.packageName",u))throw Xu("cordova-plugin-buildinfo is not installed");if("function"!==typeof br("cordova.plugins.browsertab.openUrl",u))throw Xu("cordova-plugin-browsertab is not installed");if("function"!==typeof br("cordova.InAppBrowser.open",u))throw Xu("cordova-plugin-inappbrowser is not installed")}),(function(){throw new $r("cordova-not-ready")}))},e.Fb=function(t,e){return e(new $r("operation-not-supported-in-this-environment")),$t()},e.Db=function(){return te(new $r("operation-not-supported-in-this-environment"))},e.Rb=function(){return!1},e.Ob=function(){return!0},e.Jb=function(){return!0},e.Eb=function(t,e,n,r){if(this.c)return te(new $r("redirect-operation-pending"));var i=this,o=u.document,a=null,s=null,c=null,l=null;return this.c=$t().then((function(){return Eo(e),Ju(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new To(e,r,null,o,new $r("no-auth-event"),null,i),s=br("BuildInfo.packageName",u);if("string"!==typeof s)throw new $r("invalid-cordova-configuration");var c=br("BuildInfo.displayName",u),l={};if(_r().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=s;else{if(!_r().toLowerCase().match(/android/))return te(new $r("operation-not-supported-in-this-environment"));l.apn=s}c&&(l.appDisplayName=c),o=Yu(o),l.sessionId=o;var h=Hs(t.u,t.i,t.l,e,n,null,r,t.m,l,t.o,i);return t.ia().then((function(){var e=t.h;return t.v.a.set(Nu,a.A(),e)})).then((function(){var e=br("cordova.plugins.browsertab.isAvailable",u);if("function"!==typeof e)throw new $r("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!==typeof(n=br("cordova.plugins.browsertab.openUrl",u)))throw new $r("invalid-cordova-configuration");n(h)}else{if("function"!==typeof(n=br("cordova.InAppBrowser.open",u)))throw new $r("invalid-cordova-configuration");e=_r(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new Ht((function(t,e){s=function(){var e=br("cordova.plugins.browsertab.close",u);return t(),"function"===typeof e&&e(),i.a&&"function"===typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Aa(s),c=function(){a||(a=pn(2e3).then((function(){e(new $r("redirect-cancelled-by-user"))})))},l=function(){Mr()&&c()},o.addEventListener("resume",c,!1),_r().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)})).s((function(t){return $u(i).then((function(){throw t}))}))})).ka((function(){c&&o.removeEventListener("resume",c,!1),l&&o.removeEventListener("visibilitychange",l,!1),a&&a.cancel(),s&&i.Na(s),i.c=null}))},e.Aa=function(t){this.b.push(t),Ju(this).s((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new To("unknown",null,null,null,new $r("no-auth-event")),t(e))}))},e.Na=function(t){G(this.b,(function(e){return e==t}))};var ec={name:"pendingRedirect",C:"session"};function nc(t){return Pu(t.b,ec,t.a)}function rc(t,e,n){this.i={},this.v=0,this.B=t,this.u=e,this.m=n,this.h=[],this.f=!1,this.l=T(this.o,this),this.b=new gc,this.w=new xc,this.g=new tc(this.u+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.w,this.c.linkViaPopup=this.w,this.c.reauthViaPopup=this.w,this.a=ic(this.B,this.u,this.m,Ai)}function ic(t,e,n,i){var o=r.a.SDK_VERSION||null;return cr()?new Qu(t,e,n,o,i):new Vs(t,e,n,o,i)}function oc(t){t.f||(t.f=!0,t.a.Aa(t.l));var e=t.a;return t.a.ia().s((function(n){throw t.a==e&&t.reset(),n}))}function ac(t){t.a.Ob()&&oc(t).s((function(e){var n=new To("unknown",null,null,null,new $r("operation-not-supported-in-this-environment"));pc(e)&&t.o(n)})),t.a.Jb()||vc(t.b)}function sc(t,e){q(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(ec,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?nc(t.g).then((function(){oc(t).s((function(e){var n=new To("unknown",null,null,null,new $r("operation-not-supported-in-this-environment"));pc(e)&&t.o(n)}))})):ac(t)})).s((function(){ac(t)}))}function uc(t,e){G(t.h,(function(t){return t==e}))}rc.prototype.reset=function(){this.f=!1,this.a.Na(this.l),this.a=ic(this.B,this.u,this.m),this.i={}},rc.prototype.o=function(t){if(!t)throw new $r("invalid-auth-event");if(6e5<=C()-this.v&&(this.i={},this.v=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.xb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.v=C())),e=!0;break}}return vc(this.b),e};var cc=new Dr(2e3,1e4),lc=new Dr(3e4,6e4);function hc(t,e,n,r,i,o,a){return t.a.Db(e,n,r,(function(){t.f||(t.f=!0,t.a.Aa(t.l))}),(function(){t.reset()}),i,o,a)}function pc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function fc(t,e,n,r,i){var o;return function(t){return t.b.set(ec,"pending",t.a)}(t.g).then((function(){return t.a.Eb(e,n,r,i).s((function(e){if(pc(e))throw new $r("operation-not-supported-in-this-environment");return o=e,nc(t.g).then((function(){throw o}))})).then((function(){return t.a.Rb()?new Ht((function(){})):nc(t.g).then((function(){return t.oa()})).then((function(){})).s((function(){}))}))}))}function dc(t,e,n,r,i){return t.a.Fb(r,(function(t){e.ja(n,null,t,i)}),cc.get())}rc.prototype.oa=function(){return this.b.oa()};var mc={};function yc(t,e,n){var r=e+":"+n;return mc[r]||(mc[r]=new rc(t,e,n)),mc[r]}function gc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function vc(t){t.g||(t.g=!0,wc(t,!1,null,null))}function _c(t){t.g&&!t.i&&wc(t,!1,null,null)}function bc(t,e){if(t.b=function(){return $t(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function wc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return te(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):bc(t,n):bc(t,{user:null}),t.f=[],t.c=[]}function xc(){}function Ec(){this.vb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.vb},set:function(t){this.vb=t},enumerable:!1})}function Tc(t,e){this.a=e,Br(this,"verificationId",t)}function Sc(t,e,n,r){return new bo(t).Wa(e,n).then((function(t){return new Tc(t,r)}))}function Cc(t){var e=ki(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new $r("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Ur(this,{token:t,expirationTime:Rr(1e3*e.exp),authTime:Rr(1e3*e.auth_time),issuedAtTime:Rr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function Ic(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function kc(t){this.f=t,this.b=this.a=null,this.c=0}function Ac(t,e){var n=e[La],r=e.refreshToken;e=Oc(e.expiresIn),t.b=n,t.c=e,t.a=r}function Oc(t){return C()+1e3*parseInt(t,10)}function Pc(t,e){return function(t,e){return new Ht((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?qa(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(Ms(t)):t.access_token&&t.refresh_token?n(t):r(new $r("internal-error")):r(new $r("network-request-failed"))}),"POST",Fn(e).toString(),t.g,t.u.get()):r(new $r("internal-error"))}))}(t.f,e).then((function(e){return t.b=e.access_token,t.c=Oc(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}})).s((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}function Dc(t,e){this.a=t||null,this.b=e||null,Ur(this,{lastSignInTime:Rr(e||null),creationTime:Rr(t||null)})}function Mc(t,e,n,r,i,o){Ur(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function Rc(t,e){for(var n in Le.call(this,t),e)this[n]=e[n]}function Nc(t,e,n){this.I=[],this.l=t.apiKey,this.m=t.appName,this.o=t.authDomain||null,t=r.a.SDK_VERSION?vr(r.a.SDK_VERSION):null,this.a=new Ra(this.l,Pi(Ai),t),this.b=new kc(this.a),Vc(this,e[La]),Ac(this.b,e),Br(this,"refreshToken",this.b.a),Gc(this,n||{}),sn.call(this),this.J=!1,this.o&&xr()&&(this.i=yc(this.o,this.l,this.m)),this.O=[],this.h=null,this.w=function(t){return new Ic((function(){return t.G(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.b.c-C()-3e5;return 0<e?e:0}))}(this),this.W=T(this.Ja,this);var i=this;this.ga=null,this.xa=function(t){i.ua(t.g)},this.Z=null,this.P=[],this.wa=function(t){Fc(i,t.c)},this.Y=null}function Lc(t,e){t.Z&&Ze(t.Z,"languageCodeChanged",t.xa),(t.Z=e)&&Qe(e,"languageCodeChanged",t.xa)}function Fc(t,e){t.P=e,Va(t.a,r.a.SDK_VERSION?vr(r.a.SDK_VERSION,t.P):null)}function jc(t,e){t.Y&&Ze(t.Y,"frameworkChanged",t.wa),(t.Y=e)&&Qe(e,"frameworkChanged",t.wa)}function zc(t){try{return r.a.app(t.m).auth()}catch(e){throw new $r("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function Bc(t){t.B||t.w.b||(t.w.start(),Ze(t,"tokenChanged",t.W),Qe(t,"tokenChanged",t.W))}function Uc(t){Ze(t,"tokenChanged",t.W),t.w.stop()}function Vc(t,e){t.ma=e,Br(t,"_lat",e)}function qc(t){for(var e=[],n=0;n<t.O.length;n++)e.push(t.O[n](t));return ne(e).then((function(){return t}))}function Wc(t){t.i&&!t.J&&(t.J=!0,sc(t.i,t))}function Gc(t,e){Ur(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new Dc(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Hc(){}function Kc(t){return $t().then((function(){if(t.B)throw new $r("app-deleted")}))}function Qc(t){return U(t.providerData,(function(t){return t.providerId}))}function Xc(t,e){e&&(Yc(t,e.providerId),t.providerData.push(e))}function Yc(t,e){G(t.providerData,(function(t){return t.providerId==e}))}function Zc(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Br(t,e,n)}function Jc(t,e){t!=e&&(Ur(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Br(t,"metadata",function(t){return new Dc(t.a,t.b)}(e.metadata)):Br(t,"metadata",new Dc),B(e.providerData,(function(e){Xc(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.b,e.b),Br(t,"refreshToken",t.b.a))}function $c(t){return t.G().then((function(e){var n=t.isAnonymous;return function(t,e){return Ps(t.a,ps,{idToken:e}).then(T(t.zc,t))}(t,e).then((function(){return n||Zc(t,"isAnonymous",!1),e}))}))}function tl(t,e){e[La]&&t.ma!=e[La]&&(Ac(t.b,e),t.dispatchEvent(new Rc("tokenChanged")),Vc(t,e[La]),Zc(t,"refreshToken",t.b.a))}function el(t,e){return $c(t).then((function(){if(q(Qc(t),e))return qc(t).then((function(){throw new $r("provider-already-linked")}))}))}function nl(t,e,n){return Vr({user:t,credential:xo(e),additionalUserInfo:e=Li(e),operationType:n})}function rl(t,e){return tl(t,e),t.reload().then((function(){return t}))}function il(t,e,n,i,o){if(!xr())return te(new $r("operation-not-supported-in-this-environment"));if(t.h&&!o)return te(t.h);var a=Ni(n.providerId),s=Ar(t.uid+":::"),u=null;(!Sr()||lr())&&t.o&&n.isOAuthProvider&&(u=Hs(t.o,t.l,t.m,e,n,null,s,r.a.SDK_VERSION||null,null,null,t.tenantId));var c=or(u,a&&a.sa,a&&a.ra);return i=i().then((function(){if(al(t),!o)return t.G().then((function(){}))})).then((function(){return hc(t.i,c,e,n,s,!!u,t.tenantId)})).then((function(){return new Ht((function(n,r){t.ja(e,null,new $r("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=s,t.c=dc(t.i,t,e,c,s)}))})).then((function(t){return c&&ir(c),t?Vr(t):null})).s((function(t){throw c&&ir(c),t})),sl(t,i,o)}function ol(t,e,n,r,i){if(!xr())return te(new $r("operation-not-supported-in-this-environment"));if(t.h&&!i)return te(t.h);var o=null,a=Ar(t.uid+":::");return r=r().then((function(){if(al(t),!i)return t.G().then((function(){}))})).then((function(){return t.ca=a,qc(t)})).then((function(e){return t.da&&(e=(e=t.da).b.set(ll,t.A(),e.a)),e})).then((function(){return fc(t.i,e,n,a,t.tenantId)})).s((function(e){if(o=e,t.da)return hl(t.da);throw o})).then((function(){if(o)throw o})),sl(t,r,i)}function al(t){if(!t.i||!t.J){if(t.i&&!t.J)throw new $r("internal-error");throw new $r("auth-domain-config-required")}}function sl(t,e,n){var r=function(t,e,n){return t.h&&!n?(e.cancel(),te(t.h)):e.s((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new Rc("userInvalidated")),t.h=e),e}))}(t,e,n);return t.I.push(r),r.ka((function(){W(t.I,r)})),r}function ul(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[La]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-C())/1e3;var r=new Nc(e,n,t);return t.providerData&&B(t.providerData,(function(t){t&&Xc(r,Vr(t))})),t.redirectEventId&&(r.ca=t.redirectEventId),r}function cl(t){this.a=t,this.b=ku()}gc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},gc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(wc(this,!0,null,t.a),$t()):e.Ba(n,r)?function(t,e,n){n=n.Ba(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.R(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){wc(t,s,e,null)})).s((function(e){wc(t,s,null,e)}))}(this,t,e):te(new $r("invalid-auth-event")):(wc(this,!1,null,null),$t())}else te(new $r("invalid-auth-event"))},gc.prototype.oa=function(){var t=this;return new Ht((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new $r("timeout");t.a&&t.a.cancel(),t.a=pn(lc.get()).then((function(){t.b||(t.g=!0,wc(t,!0,null,e))}))}(t))}))},xc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ja(t.c,null,t.a,t.b),$t()):e.Ba(n,r)?function(t,e){var n=t.b,r=t.c;e.Ba(r,n)(t.g,t.f,t.R(),t.i).then((function(t){e.ja(r,t,null,n)})).s((function(t){e.ja(r,null,t,n)}))}(t,e):te(new $r("invalid-auth-event"))}else te(new $r("invalid-auth-event"))},Tc.prototype.confirm=function(t){return t=wo(this.verificationId,t),this.a(t)},Ic.prototype.start=function(){this.a=this.c,function t(e,n){e.stop(),e.b=pn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then((function(){return function(){var t=u.document,e=null;return Mr()||!t?$t():new Ht((function(n){e=function(){Mr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).s((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return e.h()})).then((function(){t(e,!0)})).s((function(n){e.i(n)&&t(e,!1)}))}(this,!0)},Ic.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},kc.prototype.A=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},kc.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?te(new $r("user-token-expired")):t||!this.b||C()>this.c-3e4?this.a?Pc(this,{grant_type:"refresh_token",refresh_token:this.a}):$t(null):$t({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},Dc.prototype.A=function(){return{lastLoginAt:this.b,createdAt:this.a}},I(Rc,Le),I(Nc,sn),Nc.prototype.ua=function(t){this.ga=t,Ua(this.a,t)},Nc.prototype.ha=function(){return this.ga},Nc.prototype.Ca=function(){return K(this.P)},Nc.prototype.Ja=function(){this.w.b&&(this.w.stop(),this.w.start())},Br(Nc.prototype,"providerId","firebase"),(e=Nc.prototype).reload=function(){var t=this;return sl(this,Kc(this).then((function(){return $c(t).then((function(){return qc(t)})).then(Hc)})))},e.dc=function(t){return this.G(t).then((function(t){return new Cc(t)}))},e.G=function(t){var e=this;return sl(this,Kc(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new $r("internal-error");return t.accessToken!=e.ma&&(Vc(e,t.accessToken),e.dispatchEvent(new Rc("tokenChanged"))),Zc(e,"refreshToken",t.refreshToken),t.accessToken})))},e.zc=function(t){if(!(t=t.users)||!t.length)throw new $r("internal-error");Gc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?U(t,(function(t){return new Mc(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Xc(this,e[n]);Zc(this,"isAnonymous",!(this.email&&t.passwordHash)&&!(this.providerData&&this.providerData.length))},e.Ac=function(t){return jr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.hb(t)},e.hb=function(t){var e=this,n=null;return sl(this,t.f(this.a,this.uid).then((function(t){return tl(e,t),n=nl(e,t,"reauthenticate"),e.h=null,e.reload()})).then((function(){return n})),!0)},e.rc=function(t){return jr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.fb(t)},e.fb=function(t){var e=this,n=null;return sl(this,el(this,t.providerId).then((function(){return e.G()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=nl(e,t,"link"),rl(e,t)})).then((function(){return n})))},e.sc=function(t,e){var n=this;return sl(this,el(this,"phone").then((function(){return Sc(zc(n),t,e,T(n.fb,n))})))},e.Bc=function(t,e){var n=this;return sl(this,$t().then((function(){return Sc(zc(n),t,e,T(n.hb,n))})),!0)},e.rb=function(t){var e=this;return sl(this,this.G().then((function(n){return e.a.rb(n,t)})).then((function(t){return tl(e,t),e.reload()})))},e.Sc=function(t){var e=this;return sl(this,this.G().then((function(n){return t.b(e.a,n)})).then((function(t){return tl(e,t),e.reload()})))},e.sb=function(t){var e=this;return sl(this,this.G().then((function(n){return e.a.sb(n,t)})).then((function(t){return tl(e,t),e.reload()})))},e.tb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Kc(this);var e=this;return sl(this,this.G().then((function(n){return e.a.tb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return tl(e,t),Zc(e,"displayName",t.displayName||null),Zc(e,"photoURL",t.photoUrl||null),B(e.providerData,(function(t){"password"===t.providerId&&(Br(t,"displayName",e.displayName),Br(t,"photoURL",e.photoURL))})),qc(e)})).then(Hc))},e.Qc=function(t){var e=this;return sl(this,$c(this).then((function(n){return q(Qc(e),t)?function(t,e,n){return Ps(t,cs,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return B(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),B(Qc(e),(function(t){n[t]||Yc(e,t)})),n[bo.PROVIDER_ID]||Br(e,"phoneNumber",null),qc(e)})):qc(e).then((function(){throw new $r("no-such-provider")}))})))},e.delete=function(){var t=this;return sl(this,this.G().then((function(e){return Ps(t.a,us,{idToken:e})})).then((function(){t.dispatchEvent(new Rc("userDeleted"))}))).then((function(){for(var e=0;e<t.I.length;e++)t.I[e].cancel("app-deleted");Lc(t,null),jc(t,null),t.I=[],t.B=!0,Uc(t),Br(t,"refreshToken",null),t.i&&uc(t.i,t)}))},e.xb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ca||null)==e||"reauthViaRedirect"==t&&(this.ca||null)==e)},e.ja=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},e.Ba=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?T(this.Bb,this):"reauthViaPopup"==t&&e==(this.g||null)?T(this.Cb,this):"linkViaRedirect"==t&&(this.ca||null)==e?T(this.Bb,this):"reauthViaRedirect"==t&&(this.ca||null)==e?T(this.Cb,this):null},e.tc=function(t){var e=this;return il(this,"linkViaPopup",t,(function(){return el(e,t.providerId).then((function(){return qc(e)}))}),!1)},e.Cc=function(t){return il(this,"reauthViaPopup",t,(function(){return $t()}),!0)},e.uc=function(t){var e=this;return ol(this,"linkViaRedirect",t,(function(){return el(e,t.providerId)}),!1)},e.Dc=function(t){return ol(this,"reauthViaRedirect",t,(function(){return $t()}),!0)},e.Bb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return sl(this,this.G().then((function(n){return es(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=nl(i,t,"link"),rl(i,t)})).then((function(){return o})))},e.Cb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return sl(this,$t().then((function(){return Ki(ns(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=nl(i,t,"reauthenticate"),tl(i,t),i.h=null,i.reload()})).then((function(){return o})),!0)},e.jb=function(t){var e=this,n=null;return sl(this,this.G().then((function(e){return n=e,"undefined"===typeof t||X(t)?{}:xi(new pi(t))})).then((function(t){return e.a.jb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},e.toJSON=function(){return this.A()},e.A=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.A(),redirectEventId:this.ca||null};return this.metadata&&J(t,this.metadata.A()),B(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),t};var ll={name:"redirectUser",C:"session"};function hl(t){return Pu(t.b,ll,t.a)}function pl(t){this.a=t,this.b=ku(),this.c=null,this.f=function(t){var e=ml("local"),n=ml("session"),r=ml("none");return function(t,e,n){var r=Ou(e,n),i=Au(t,e.C);return t.get(e,n).then((function(o){var a=null;try{a=kr(u.localStorage.getItem(r))}catch(s){}if(a&&!o)return u.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&u.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(dl,t.a).then((function(t){return t?ml(t):e}))}))}))})).then((function(e){return t.c=e,fl(t,e.C)})).s((function(){t.c||(t.c=e)}))}(this),this.b.addListener(ml("local"),this.a,T(this.g,this))}function fl(t,e){var n,r=[];for(n in Cu)Cu[n]!==e&&r.push(Pu(t.b,ml(Cu[n]),t.a));return r.push(Pu(t.b,dl,t.a)),function(t){return new Ht((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)ee(t[s],S(o,s),a);else e(i)}))}(r)}pl.prototype.g=function(){var t=this,e=ml("local");_l(this,(function(){return $t().then((function(){return t.c&&"local"!=t.c.C?t.b.get(e,t.a):null})).then((function(n){if(n)return fl(t,"local").then((function(){t.c=e}))}))}))};var dl={name:"persistence",C:"session"};function ml(t){return{name:"authUser",C:t}}function yl(t,e){return _l(t,(function(){return t.b.set(t.c,e.A(),t.a)}))}function gl(t){return _l(t,(function(){return Pu(t.b,t.c,t.a)}))}function vl(t,e){return _l(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),ul(t||{})}))}))}function _l(t,e){return t.f=t.f.then(e,e),t.f}function bl(t){if(this.l=!1,Br(this,"settings",new Ec),Br(this,"app",t),!kl(this).options||!kl(this).options.apiKey)throw new $r("invalid-api-key");t=r.a.SDK_VERSION?vr(r.a.SDK_VERSION):null,this.b=new Ra(kl(this).options&&kl(this).options.apiKey,Pi(Ai),t),this.O=[],this.m=[],this.J=[],this.Ub=r.a.INTERNAL.createSubscribe(T(this.oc,this)),this.W=void 0,this.Vb=r.a.INTERNAL.createSubscribe(T(this.pc,this)),Cl(this,null),this.h=new pl(kl(this).options.apiKey+":"+kl(this).name),this.w=new cl(kl(this).options.apiKey+":"+kl(this).name),this.Y=Dl(this,function(t){var e=kl(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(ll,t.a).then((function(t){return t&&e&&(t.authDomain=e),ul(t||{})}))}(t.w,kl(t).options.authDomain).then((function(e){return(t.B=e)&&(e.da=t.w),hl(t.w)}));return Dl(t,e)}(t).then((function(){return vl(t.h,e)})).then((function(e){return e?(e.da=t.w,t.B&&(t.B.ca||null)==(e.ca||null)?e:e.reload().then((function(){return yl(t.h,e).then((function(){return e}))})).s((function(n){return"auth/network-request-failed"==n.code?e:gl(t.h)}))):null})).then((function(e){Cl(t,e||null)}));return Dl(t,n)}(this)),this.i=Dl(this,function(t){return t.Y.then((function(){return Tl(t)})).s((function(){})).then((function(){if(!t.l)return t.ma()})).s((function(){})).then((function(){if(!t.l){t.ga=!0;var e=t.h;e.b.addListener(ml("local"),e.a,t.ma)}}))}(this)),this.ga=!1,this.ma=T(this.Nc,this),this.ub=T(this.aa,this),this.wa=T(this.bc,this),this.xa=T(this.mc,this),this.Ja=T(this.nc,this),this.a=null,function(t){var e=kl(t).options.authDomain,n=kl(t).options.apiKey;e&&xr()&&(t.Tb=t.Y.then((function(){if(!t.l){if(t.a=yc(e,n,kl(t).name),sc(t.a,t),Al(t)&&Wc(Al(t)),t.B){Wc(t.B);var r=t.B;r.ua(t.ha()),Lc(r,t),Fc(r=t.B,t.I),jc(r,t),t.B=null}return t.a}})))}(this),this.INTERNAL={},this.INTERNAL.delete=T(this.delete,this),this.INTERNAL.logFramework=T(this.vc,this),this.o=0,sn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ha()},set:function(t){this.ua(t)},enumerable:!1}),t.Z=null,Object.defineProperty(t,"ti",{get:function(){return this.R()},set:function(t){this.nb(t)},enumerable:!1}),t.P=null}(this),this.I=[]}function wl(t){Le.call(this,"languageCodeChanged"),this.g=t}function xl(t){Le.call(this,"frameworkChanged"),this.c=t}function El(t){return t.Tb||te(new $r("auth-domain-config-required"))}function Tl(t){if(!xr())return te(new $r("operation-not-supported-in-this-environment"));var e=El(t).then((function(){return t.a.oa()})).then((function(t){return t?Vr(t):null}));return Dl(t,e)}function Sl(t,e){var n={};return n.apiKey=kl(t).options.apiKey,n.authDomain=kl(t).options.authDomain,n.appName=kl(t).name,t.Y.then((function(){return function(t,e,n,r){var i=new Nc(t,e);return n&&(i.da=n),r&&Fc(i,r),i.reload().then((function(){return i}))}(n,e,t.w,t.Ca())})).then((function(e){return Al(t)&&e.uid==Al(t).uid?(Jc(Al(t),e),t.aa(e)):(Cl(t,e),Wc(e),t.aa(e))})).then((function(){Pl(t)}))}function Cl(t,e){Al(t)&&(function(t,e){G(t.O,(function(t){return t==e}))}(Al(t),t.ub),Ze(Al(t),"tokenChanged",t.wa),Ze(Al(t),"userDeleted",t.xa),Ze(Al(t),"userInvalidated",t.Ja),Uc(Al(t))),e&&(e.O.push(t.ub),Qe(e,"tokenChanged",t.wa),Qe(e,"userDeleted",t.xa),Qe(e,"userInvalidated",t.Ja),0<t.o&&Bc(e)),Br(t,"currentUser",e),e&&(e.ua(t.ha()),Lc(e,t),Fc(e,t.I),jc(e,t))}function Il(t,e){var n=null,r=null;return Dl(t,e.then((function(e){return n=xo(e),r=Li(e),Sl(t,e)})).then((function(){return Vr({user:Al(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function kl(t){return t.app}function Al(t){return t.currentUser}function Ol(t){return Al(t)&&Al(t)._lat||null}function Pl(t){if(t.ga){for(var e=0;e<t.m.length;e++)t.m[e]&&t.m[e](Ol(t));if(t.W!==t.getUid()&&t.J.length)for(t.W=t.getUid(),e=0;e<t.J.length;e++)t.J[e]&&t.J[e](Ol(t))}}function Dl(t,e){return t.O.push(e),e.ka((function(){W(t.O,e)})),e}function Ml(){}function Rl(){this.a={},this.b=1e12}pl.prototype.mb=function(t){var e=null,n=this;return function(t){var e=new $r("invalid-persistence-type"),n=new $r("unsupported-persistence-type");t:{for(r in Cu)if(Cu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!==typeof t)throw e;switch(pr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!wr()&&"none"!==t)throw n}}(t),_l(this,(function(){return t!=n.c.C?n.b.get(n.c,n.a).then((function(r){return e=r,fl(n,t)})).then((function(){if(n.c=ml(t),e)return n.b.set(n.c,e,n.a)})):$t()}))},I(bl,sn),I(wl,Le),I(xl,Le),(e=bl.prototype).mb=function(t){return Dl(this,t=this.h.mb(t))},e.ua=function(t){this.Z===t||this.l||(this.Z=t,Ua(this.b,this.Z),this.dispatchEvent(new wl(this.ha())))},e.ha=function(){return this.Z},e.Tc=function(){var t=u.navigator;this.ua(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},e.vc=function(t){this.I.push(t),Va(this.b,r.a.SDK_VERSION?vr(r.a.SDK_VERSION,this.I):null),this.dispatchEvent(new xl(this.I))},e.Ca=function(){return K(this.I)},e.nb=function(t){this.P===t||this.l||(this.P=t,this.b.b=this.P)},e.R=function(){return this.P},e.toJSON=function(){return{apiKey:kl(this).options.apiKey,authDomain:kl(this).options.authDomain,appName:kl(this).name,currentUser:Al(this)&&Al(this).A()}},e.xb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},e.ja=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},e.Ba=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?T(this.ac,this):null},e.ac=function(t,e,n,r){var i=this;t={requestUri:t,postBody:r,sessionId:e,tenantId:n},this.c&&(this.c.cancel(),this.c=null);var o=null,a=null,s=ts(i.b,t).then((function(t){return o=xo(t),a=Li(t),t}));return Dl(this,t=i.Y.then((function(){return s})).then((function(t){return Sl(i,t)})).then((function(){return Vr({user:Al(i),credential:o,additionalUserInfo:a,operationType:"signIn"})})))},e.Lc=function(t){if(!xr())return te(new $r("operation-not-supported-in-this-environment"));var e=this,n=Ni(t.providerId),i=Ar(),o=null;(!Sr()||lr())&&kl(this).options.authDomain&&t.isOAuthProvider&&(o=Hs(kl(this).options.authDomain,kl(this).options.apiKey,kl(this).name,"signInViaPopup",t,null,i,r.a.SDK_VERSION||null,null,null,this.R()));var a=or(o,n&&n.sa,n&&n.ra);return Dl(this,n=El(this).then((function(n){return hc(n,a,"signInViaPopup",t,i,!!o,e.R())})).then((function(){return new Ht((function(t,n){e.ja("signInViaPopup",null,new $r("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=i,e.c=dc(e.a,e,"signInViaPopup",a,i)}))})).then((function(t){return a&&ir(a),t?Vr(t):null})).s((function(t){throw a&&ir(a),t})))},e.Mc=function(t){if(!xr())return te(new $r("operation-not-supported-in-this-environment"));var e=this;return Dl(this,El(this).then((function(){return function(t){return _l(t,(function(){return t.b.set(dl,t.c.C,t.a)}))}(e.h)})).then((function(){return fc(e.a,"signInViaRedirect",t,void 0,e.R())})))},e.oa=function(){var t=this;return Tl(this).then((function(e){return t.a&&_c(t.a.b),e})).s((function(e){throw t.a&&_c(t.a.b),e}))},e.Rc=function(t){if(!t)return te(new $r("null-user"));if(this.P!=t.tenantId)return te(new $r("tenant-id-mismatch"));var e=this,n={};n.apiKey=kl(this).options.apiKey,n.authDomain=kl(this).options.authDomain,n.appName=kl(this).name;var r=function(t,e,n,r){e=e||{apiKey:t.l,authDomain:t.o,appName:t.m};var i=t.b,o={};return o[La]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-C())/1e3,e=new Nc(e,o),n&&(e.da=n),r&&Fc(e,r),Jc(e,t),e}(t,n,e.w,e.Ca());return Dl(this,this.i.then((function(){if(kl(e).options.apiKey!=t.l)return r.reload()})).then((function(){return Al(e)&&t.uid==Al(e).uid?(Jc(Al(e),t),e.aa(t)):(Cl(e,r),Wc(r),e.aa(r))})).then((function(){Pl(e)})))},e.pb=function(){var t=this;return Dl(this,this.i.then((function(){return t.a&&_c(t.a.b),Al(t)?(Cl(t,null),gl(t.h).then((function(){Pl(t)}))):$t()})))},e.Nc=function(){var t=this;return vl(this.h,kl(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=Al(t)&&e){n=Al(t).uid;var r=e.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return Jc(Al(t),e),Al(t).G();(Al(t)||e)&&(Cl(t,e),e&&(Wc(e),e.da=t.w),t.a&&sc(t.a,t),Pl(t))}}))},e.aa=function(t){return yl(this.h,t)},e.bc=function(){Pl(this),this.aa(Al(this))},e.mc=function(){this.pb()},e.nc=function(){this.pb()},e.oc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(Al(e))}))},e.pc=function(t){var e=this;!function(t,e){t.J.push(e),Dl(t,t.i.then((function(){!t.l&&q(t.J,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(Ol(t)))})))}(this,(function(){t.next(Al(e))}))},e.xc=function(t,e,n){var r=this;return this.ga&&Promise.resolve().then((function(){v(t)?t(Al(r)):v(t.next)&&t.next(Al(r))})),this.Ub(t,e,n)},e.wc=function(t,e,n){var r=this;return this.ga&&Promise.resolve().then((function(){r.W=r.getUid(),v(t)?t(Al(r)):v(t.next)&&t.next(Al(r))})),this.Vb(t,e,n)},e.cc=function(t){var e=this;return Dl(this,this.i.then((function(){return Al(e)?Al(e).G(t).then((function(t){return{accessToken:t}})):null})))},e.Hc=function(t){var e=this;return this.i.then((function(){return Il(e,Ps(e.b,Cs,{token:t}))})).then((function(t){var n=t.user;return Zc(n,"isAnonymous",!1),e.aa(n),t}))},e.Ic=function(t,e){var n=this;return this.i.then((function(){return Il(n,Ps(n.b,Is,{email:t,password:e}))}))},e.Xb=function(t,e){var n=this;return this.i.then((function(){return Il(n,Ps(n.b,as,{email:t,password:e}))}))},e.Sa=function(t){var e=this;return this.i.then((function(){return Il(e,t.na(e.b))}))},e.Gc=function(t){return jr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Sa(t)},e.ob=function(){var t=this;return this.i.then((function(){var e=Al(t);if(e&&e.isAnonymous){var n=Vr({providerId:null,isNewUser:!1});return Vr({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return Il(t,t.b.ob()).then((function(e){var n=e.user;return Zc(n,"isAnonymous",!0),t.aa(n),e}))}))},e.getUid=function(){return Al(this)&&Al(this).uid||null},e.Wb=function(t){this.addAuthTokenListener(t),this.o++,0<this.o&&Al(this)&&Bc(Al(this))},e.Ec=function(t){var e=this;B(this.m,(function(n){n==t&&e.o--})),0>this.o&&(this.o=0),0==this.o&&Al(this)&&Uc(Al(this)),this.removeAuthTokenListener(t)},e.addAuthTokenListener=function(t){var e=this;this.m.push(t),Dl(this,this.i.then((function(){e.l||q(e.m,t)&&t(Ol(e))})))},e.removeAuthTokenListener=function(t){G(this.m,(function(e){return e==t}))},e.delete=function(){this.l=!0;for(var t=0;t<this.O.length;t++)this.O[t].cancel("app-deleted");return this.O=[],this.h&&(t=this.h).b.removeListener(ml("local"),t.a,this.ma),this.a&&(uc(this.a,this),_c(this.a.b)),Promise.resolve()},e.$b=function(t){return Dl(this,function(t,e){return Ps(t,ss,{identifier:e,continueUri:Er()?er():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.b,t))},e.qc=function(t){return!!yo(t)},e.lb=function(t,e){var n=this;return Dl(this,$t().then((function(){var t=new pi(e);if(!t.c)throw new $r("argument-error",mi+" must be true when sending sign in link to email");return xi(t)})).then((function(e){return n.b.lb(t,e)})).then((function(){})))},e.Uc=function(t){return this.Ma(t).then((function(t){return t.data.email}))},e.ab=function(t,e){return Dl(this,this.b.ab(t,e).then((function(){})))},e.Ma=function(t){return Dl(this,this.b.Ma(t).then((function(t){return new Wr(t)})))},e.Ya=function(t){return Dl(this,this.b.Ya(t).then((function(){})))},e.kb=function(t,e){var n=this;return Dl(this,$t().then((function(){return"undefined"===typeof e||X(e)?{}:xi(new pi(e))})).then((function(e){return n.b.kb(t,e)})).then((function(){})))},e.Kc=function(t,e){return Dl(this,Sc(this,t,e,T(this.Sa,this)))},e.Jc=function(t,e){var n=this;return Dl(this,$t().then((function(){var r=e||er(),i=mo(t,r);if(!(r=yo(r)))throw new $r("argument-error","Invalid email link!");if(r.tenantId!==n.R())throw new $r("tenant-id-mismatch");return n.Sa(i)})))},Ml.prototype.render=function(){},Ml.prototype.reset=function(){},Ml.prototype.getResponse=function(){},Ml.prototype.execute=function(){};var Nl=null;function Ll(t,e){return(e=Fl(e))&&t.a[e]||null}function Fl(t){return(t="undefined"===typeof t?1e12:t)?t.toString():null}function jl(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=Wn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():Qe(this.f,"click",this.i)}function zl(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Bl(){}Rl.prototype.render=function(t,e){return this.a[this.b.toString()]=new jl(t,e),this.b++},Rl.prototype.reset=function(t){var e=Ll(this,t);t=Fl(t),e&&t&&(e.delete(),delete this.a[t])},Rl.prototype.getResponse=function(t){return(t=Ll(this,t))?t.getResponse():null},Rl.prototype.execute=function(t){(t=Ll(this,t))&&t.execute()},jl.prototype.getResponse=function(){return zl(this),this.b},jl.prototype.execute=function(){zl(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()}),6e4)}),500))},jl.prototype.delete=function(){zl(this),this.g=!0,clearTimeout(this.a),this.a=null,Ze(this.f,"click",this.i)},Bl.prototype.g=function(){return Nl||(Nl=new Rl),$t(Nl)},Bl.prototype.c=function(){};var Ul=null;function Vl(){this.b=u.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var ql=new $(nt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Wl=new Dr(3e4,6e4);Vl.prototype.g=function(t){var e=this;return new Ht((function(n,r){var i=setTimeout((function(){r(new $r("network-request-failed"))}),Wl.get());!u.grecaptcha||t!==e.f&&!e.b?(u[e.a]=function(){if(u.grecaptcha){e.f=t;var o=u.grecaptcha.render;u.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(u.grecaptcha)}else clearTimeout(i),r(new $r("internal-error"));delete u[e.a]},$t(Ia(at(ql,{onload:e.a,hl:t||""}))).s((function(){clearTimeout(i),r(new $r("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(u.grecaptcha))}))},Vl.prototype.c=function(){this.b--};var Gl=null;function Hl(t,e,n,r,i,o,a){if(Br(this,"type","recaptcha"),this.c=this.f=null,this.B=!1,this.u=e,this.g=null,a?(Ul||(Ul=new Bl),a=Ul):(Gl||(Gl=new Vl),a=Gl),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Xl])throw new $r("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Yl],!u.document)throw new $r("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Wn(e)||!this.i&&Wn(e).hasChildNodes())throw new $r("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new Ra(t,o||null,i||null),this.v=r||function(){return null};var s=this;this.l=[];var c=this.a[Kl];this.a[Kl]=function(t){if(Zl(s,t),"function"===typeof c)c(t);else if("string"===typeof c){var e=br(c,u);"function"===typeof e&&e(t)}};var l=this.a[Ql];this.a[Ql]=function(){if(Zl(s,null),"function"===typeof l)l();else if("string"===typeof l){var t=br(l,u);"function"===typeof t&&t()}}}var Kl="callback",Ql="expired-callback",Xl="sitekey",Yl="size";function Zl(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function Jl(t,e){return t.h.push(e),e.ka((function(){W(t.h,e)})),e}function $l(t){if(t.B)throw new $r("internal-error","RecaptchaVerifier instance has been destroyed.")}function th(t,e,n){var i=!1;try{this.b=n||r.a.app()}catch(s){throw new $r("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new $r("invalid-api-key");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ca()}catch(s){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}a=r.a.SDK_VERSION?vr(r.a.SDK_VERSION,a):null,Hl.call(this,n,t,e,(function(){try{var t=o.b.auth().ha()}catch(e){t=null}return t}),a,Pi(Ai),i)}function eh(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new $r("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].N(n[i])&&!o){if(e=e[i],0>i||i>=nh.length)throw new $r("internal-error","Argument validator received an unsupported number of arguments.");n=nh[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.M+".";break t}r=null}}if(r)throw new $r("argument-error",t+" failed: "+r)}(e=Hl.prototype).Da=function(){var t=this;return this.f?this.f:this.f=Jl(this,$t().then((function(){if(Er()&&!hr())return ur();throw new $r("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.v())})).then((function(e){return t.g=e,Ps(t.o,gs,{})})).then((function(e){t.a[Xl]=e.recaptchaSiteKey})).s((function(e){throw t.f=null,e})))},e.render=function(){$l(this);var t=this;return Jl(this,this.Da().then((function(){if(null===t.c){var e=t.u;if(!t.i){var n=Wn(e);e=Kn("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},e.verify=function(){$l(this);var t=this;return Jl(this,this.render().then((function(e){return new Ht((function(n){var r=t.g.getResponse(e);if(r)n(r);else{t.l.push((function e(r){r&&(function(t,e){G(t.l,(function(t){return t==e}))}(t,e),n(r))})),t.i&&t.g.execute(t.c)}}))})))},e.reset=function(){$l(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){$l(this),this.B=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=Wn(this.u);for(var e;e=t.firstChild;)t.removeChild(e)}},I(th,Hl);var nh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function rh(t,e){return{name:t||"",M:"a valid string",optional:!!e,N:c}}function ih(t,e){return{name:t||"",M:"a boolean",optional:!!e,N:l}}function oh(t,e){return{name:t||"",M:"a valid object",optional:!!e,N:_}}function ah(t,e){return{name:t||"",M:"a function",optional:!!e,N:v}}function sh(t,e){return{name:t||"",M:"null",optional:!!e,N:m}}function uh(t){return{name:t?t+"Credential":"credential",M:t?"a valid "+t+" credential":"a valid credential",optional:!1,N:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.na||!n)}}}function ch(){return{name:"applicationVerifier",M:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,N:function(t){return!!(t&&c(t.type)&&v(t.verify))}}}function lh(t,e,n,r){return{name:n||"",M:t.M+" or "+e.M,optional:!!r,N:function(n){return t.N(n)||e.N(n)}}}function hh(t,e){for(var n in e){var r=e[n].name;t[r]=dh(r,t[n],e[n].j)}}function ph(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:S((function(t){return this[t]}),n),set:S((function(t,e,n,r){eh(t,[n],[r],!0),this[e]=r}),r,n,e[n].Za),enumerable:!0})}}function fh(t,e,n,r){t[e]=dh(e,n,r)}function dh(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return eh(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}hh(bl.prototype,{Ya:{name:"applyActionCode",j:[rh("code")]},Ma:{name:"checkActionCode",j:[rh("code")]},ab:{name:"confirmPasswordReset",j:[rh("code"),rh("newPassword")]},Xb:{name:"createUserWithEmailAndPassword",j:[rh("email"),rh("password")]},$b:{name:"fetchSignInMethodsForEmail",j:[rh("email")]},oa:{name:"getRedirectResult",j:[]},qc:{name:"isSignInWithEmailLink",j:[rh("emailLink")]},wc:{name:"onAuthStateChanged",j:[lh(oh(),ah(),"nextOrObserver"),ah("opt_error",!0),ah("opt_completed",!0)]},xc:{name:"onIdTokenChanged",j:[lh(oh(),ah(),"nextOrObserver"),ah("opt_error",!0),ah("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[rh("email"),lh(oh("opt_actionCodeSettings",!0),sh(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[rh("email"),oh("actionCodeSettings")]},mb:{name:"setPersistence",j:[rh("persistence")]},Gc:{name:"signInAndRetrieveDataWithCredential",j:[uh()]},ob:{name:"signInAnonymously",j:[]},Sa:{name:"signInWithCredential",j:[uh()]},Hc:{name:"signInWithCustomToken",j:[rh("token")]},Ic:{name:"signInWithEmailAndPassword",j:[rh("email"),rh("password")]},Jc:{name:"signInWithEmailLink",j:[rh("email"),rh("emailLink",!0)]},Kc:{name:"signInWithPhoneNumber",j:[rh("phoneNumber"),ch()]},Lc:{name:"signInWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Mc:{name:"signInWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Rc:{name:"updateCurrentUser",j:[lh({name:"user",M:"an instance of Firebase User",optional:!1,N:function(t){return!!(t&&t instanceof Nc)}},sh(),"user")]},pb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[rh(null,!0)]},Tc:{name:"useDeviceLanguage",j:[]},Uc:{name:"verifyPasswordResetCode",j:[rh("code")]}}),ph(bl.prototype,{lc:{name:"languageCode",Za:lh(rh(),sh(),"languageCode")},ti:{name:"tenantId",Za:lh(rh(),sh(),"tenantId")}}),bl.Persistence=Cu,bl.Persistence.LOCAL="local",bl.Persistence.SESSION="session",bl.Persistence.NONE="none",hh(Nc.prototype,{delete:{name:"delete",j:[]},dc:{name:"getIdTokenResult",j:[ih("opt_forceRefresh",!0)]},G:{name:"getIdToken",j:[ih("opt_forceRefresh",!0)]},rc:{name:"linkAndRetrieveDataWithCredential",j:[uh()]},fb:{name:"linkWithCredential",j:[uh()]},sc:{name:"linkWithPhoneNumber",j:[rh("phoneNumber"),ch()]},tc:{name:"linkWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},uc:{name:"linkWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ac:{name:"reauthenticateAndRetrieveDataWithCredential",j:[uh()]},hb:{name:"reauthenticateWithCredential",j:[uh()]},Bc:{name:"reauthenticateWithPhoneNumber",j:[rh("phoneNumber"),ch()]},Cc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Dc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[lh(oh("opt_actionCodeSettings",!0),sh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[rh(null,!0)]},Qc:{name:"unlink",j:[rh("provider")]},rb:{name:"updateEmail",j:[rh("email")]},sb:{name:"updatePassword",j:[rh("password")]},Sc:{name:"updatePhoneNumber",j:[uh("phone")]},tb:{name:"updateProfile",j:[oh("profile")]}}),hh(Rl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),hh(Ml.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),hh(Ht.prototype,{ka:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),ph(Ec.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",Za:ih("appVerificationDisabledForTesting")}}),hh(Tc.prototype,{confirm:{name:"confirm",j:[rh("verificationCode")]}}),fh(Hi,"fromJSON",(function(t){t=c(t)?JSON.parse(t):t;for(var e,n=[$i,po,vo,Yi],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[lh(rh(),oh(),"json")]),fh(fo,"credential",(function(t,e){return new ho(t,e)}),[rh("email"),rh("password")]),hh(ho.prototype,{A:{name:"toJSON",j:[rh(null,!0)]}}),hh(ro.prototype,{ya:{name:"addScope",j:[rh("scope")]},Ga:{name:"setCustomParameters",j:[oh("customOAuthParameters")]}}),fh(ro,"credential",io,[lh(rh(),oh(),"token")]),fh(fo,"credentialWithLink",mo,[rh("email"),rh("emailLink")]),hh(oo.prototype,{ya:{name:"addScope",j:[rh("scope")]},Ga:{name:"setCustomParameters",j:[oh("customOAuthParameters")]}}),fh(oo,"credential",ao,[lh(rh(),oh(),"token")]),hh(so.prototype,{ya:{name:"addScope",j:[rh("scope")]},Ga:{name:"setCustomParameters",j:[oh("customOAuthParameters")]}}),fh(so,"credential",uo,[lh(rh(),lh(oh(),sh()),"idToken"),lh(rh(),sh(),"accessToken",!0)]),hh(co.prototype,{Ga:{name:"setCustomParameters",j:[oh("customOAuthParameters")]}}),fh(co,"credential",lo,[lh(rh(),oh(),"token"),rh("secret",!0)]),hh(no.prototype,{ya:{name:"addScope",j:[rh("scope")]},credential:{name:"credential",j:[lh(rh(),lh(oh(),sh()),"optionsOrIdToken"),lh(rh(),sh(),"accessToken",!0)]},Ga:{name:"setCustomParameters",j:[oh("customOAuthParameters")]}}),hh(Zi.prototype,{A:{name:"toJSON",j:[rh(null,!0)]}}),hh(Qi.prototype,{A:{name:"toJSON",j:[rh(null,!0)]}}),fh(bo,"credential",wo,[rh("verificationId"),rh("verificationCode")]),hh(bo.prototype,{Wa:{name:"verifyPhoneNumber",j:[rh("phoneNumber"),ch()]}}),hh(go.prototype,{A:{name:"toJSON",j:[rh(null,!0)]}}),hh($r.prototype,{toJSON:{name:"toJSON",j:[rh(null,!0)]}}),hh(Oo.prototype,{toJSON:{name:"toJSON",j:[rh(null,!0)]}}),hh(Ao.prototype,{toJSON:{name:"toJSON",j:[rh(null,!0)]}}),hh(th.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),fh(ri,"parseLink",hi,[rh("link")]),function(){if("undefined"===typeof r.a||!r.a.INTERNAL||!r.a.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Gr,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:bl,AuthCredential:Hi,Error:$r};fh(t,"EmailAuthProvider",fo,[]),fh(t,"FacebookAuthProvider",ro,[]),fh(t,"GithubAuthProvider",oo,[]),fh(t,"GoogleAuthProvider",so,[]),fh(t,"TwitterAuthProvider",co,[]),fh(t,"OAuthProvider",no,[rh("providerId")]),fh(t,"SAMLAuthProvider",eo,[rh("providerId")]),fh(t,"PhoneAuthProvider",bo,[{name:"auth",M:"an instance of Firebase Auth",optional:!0,N:function(t){return!!(t&&t instanceof bl)}}]),fh(t,"RecaptchaVerifier",th,[lh(rh(),{name:"",M:"an HTML element",optional:!1,N:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),oh("recaptchaParameters",!0),{name:"app",M:"an instance of Firebase App",optional:!0,N:function(t){return!!(t&&t instanceof r.a.app.App)}}]),fh(t,"ActionCodeURL",ri,[]),r.a.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new bl(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),r.a.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:T((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:T(t.cc,t),addAuthTokenListener:T(t.Wb,t),removeAuthTokenListener:T(t.Ec,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.a.registerVersion("@firebase/auth","0.13.3"),r.a.INTERNAL.extendNamespace({User:Nc})}()}).apply("undefined"!==typeof t?t:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})}.call(this,n(20))},function(t,e,n){"use strict";(function(r){Object.defineProperty(e,"__esModule",{value:!0});var i,o=(i=n(7))&&"object"===typeof i&&"default"in i?i.default:i,a=n(2),s=n(13),u=n(23),c=n(12),l=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),s.stringify(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:s.jsonEval(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),h=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return s.contains(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),p=function(t){try{if("undefined"!==typeof window&&"undefined"!==typeof window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new l(e)}}catch(n){}return new h},f=p("localStorage"),d=p("sessionStorage"),m=new u.Logger("@firebase/database"),y=function(){var t=1;return function(){return t++}}(),g=function(t){var e=s.stringToByteArray(t),n=new s.Sha1;n.update(e);var r=n.digest();return s.base64.encodeByteArray(r)},v=function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r="",i=0;i<e.length;i++)Array.isArray(e[i])||e[i]&&"object"===typeof e[i]&&"number"===typeof e[i].length?r+=t.apply(null,e[i]):"object"===typeof e[i]?r+=s.stringify(e[i]):r+=e[i],r+=" ";return r},_=null,b=!0,w=function(t,e){s.assert(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(m.logLevel=u.LogLevel.VERBOSE,_=m.log.bind(m),e&&d.set("logging_enabled",!0)):"function"===typeof t?_=t:(_=null,d.remove("logging_enabled"))},x=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===b&&(b=!1,null===_&&!0===d.get("logging_enabled")&&w(!0)),_){var n=v.apply(null,t);_(n)}},E=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];x.apply(void 0,a.__spread([t],e))}},T=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+v.apply(void 0,a.__spread(t));m.error(n)},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+v.apply(void 0,a.__spread(t));throw m.error(n),new Error(n)},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+v.apply(void 0,a.__spread(t));m.warn(n)},I=function(t){return"number"===typeof t&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)},k="[MIN_NAME]",A="[MAX_NAME]",O=function(t,e){if(t===e)return 0;if(t===k||e===A)return-1;if(e===k||t===A)return 1;var n=j(t),r=j(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},P=function(t,e){return t===e?0:t<e?-1:1},D=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+s.stringify(e))},M=function t(e){if("object"!==typeof e||null===e)return s.stringify(e);var n=[];for(var r in e)n.push(r);n.sort();for(var i="{",o=0;o<n.length;o++)0!==o&&(i+=","),i+=s.stringify(n[o]),i+=":",i+=t(e[n[o]]);return i+="}"},R=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function N(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var L=function(t){s.assert(!I(t),"Invalid JSON number");var e,n,r,i,o,a,u;for(0===t?(n=0,r=0,e=1/t===-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074)))),a=[],o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse(),u=a.join("");var c="";for(o=0;o<64;o+=8){var l=parseInt(u.substr(o,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},F=new RegExp("^-?(0*)\\d{1,10}$"),j=function(t){if(F.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},z=function(t){try{t()}catch(e){setTimeout((function(){var t=e.stack||"";throw C("Exception was thrown by user callback.",t),e}),Math.floor(0))}},B=function(){return("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},U=function(t,e){var n=setTimeout(t,e);return"object"===typeof n&&n.unref&&n.unref(),n},V=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!0,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=O(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),q=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=s.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=s.stringLength(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=s.stringLength(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),W="long_polling",G=function(){function t(t,e,n,r,i,o){void 0===i&&(i=""),void 0===o&&(o=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.includeNamespaceInQueryParams=o,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=f.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&f.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(s.assert("string"===typeof t,"typeof type must == string"),s.assert("object"===typeof e,"typeof params must == object"),"websocket"===t)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==W)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return N(e,(function(t,e){r.push(t+"="+e)})),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}();var H,K,Q=function(t){var e=X(t),n=e.namespace;"firebase"===e.domain&&S(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||"localhost"===e.domain||S("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&C("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var r="ws"===e.scheme||"wss"===e.scheme;return{repoInfo:new G(e.host,e.secure,n,r,"",n!=e.subdomain),path:new V(e.pathString)}},X=function(t){var e="",n="",r="",i="",o="",s=!0,u="https",c=443;if("string"===typeof t){var l=t.indexOf("//");l>=0&&(u=t.substring(0,l-1),t=t.substring(l+2));var h=t.indexOf("/");-1===h&&(h=t.length);var p=t.indexOf("?");-1===p&&(p=t.length),e=t.substring(0,Math.min(h,p)),h<p&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}e+="/"+i}return e}(t.substring(h,p)));var f=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=a.__values(t.split("&")),o=i.next();!o.done;o=i.next()){var s=o.value;if(0!==s.length){var u=s.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):C("Invalid query segment '"+s+"' in query '"+t+"'")}}}catch(c){e={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,p)));(l=e.indexOf(":"))>=0?(s="https"===u||"wss"===u,c=parseInt(e.substring(l+1),10)):l=t.length;var d=e.split(".");3===d.length?(n=d[1],o=r=d[0].toLowerCase()):2===d.length?n=d[0]:"localhost"===d[0].slice(0,l).toLowerCase()&&(n="localhost"),"ns"in f&&(o=f.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:s,scheme:u,pathString:i,namespace:o}},Y=/[\[\].#$\/\u0000-\u001F\u007F]/,Z=/[\[\].#$\u0000-\u001F\u007F]/,J=function(t){return"string"===typeof t&&0!==t.length&&!Y.test(t)},$=function(t){return"string"===typeof t&&0!==t.length&&!Z.test(t)},tt=function(t){return null===t||"string"===typeof t||"number"===typeof t&&!I(t)||t&&"object"===typeof t&&s.contains(t,".sv")},et=function(t,e,n,r,i){i&&void 0===n||nt(s.errorPrefix(t,e,i),n,r)},nt=function t(e,n,r){var i=r instanceof V?new q(r,e):r;if(void 0===n)throw new Error(e+"contains undefined "+i.toErrorString());if("function"===typeof n)throw new Error(e+"contains a function "+i.toErrorString()+" with contents = "+n.toString());if(I(n))throw new Error(e+"contains "+n.toString()+" "+i.toErrorString());if("string"===typeof n&&n.length>10485760/3&&s.stringLength(n)>10485760)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+i.toErrorString()+" ('"+n.substring(0,50)+"...')");if(n&&"object"===typeof n){var o=!1,a=!1;if(N(n,(function(n,r){if(".value"===n)o=!0;else if(".priority"!==n&&".sv"!==n&&(a=!0,!J(n)))throw new Error(e+" contains an invalid key ("+n+") "+i.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');i.push(n),t(e,r,i),i.pop()})),o&&a)throw new Error(e+' contains ".value" child '+i.toErrorString()+" in addition to actual children.")}},rt=function(t,e,n,r,i){if(!i||void 0!==n){var o=s.errorPrefix(t,e,i);if(!n||"object"!==typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];N(n,(function(t,e){var n=new V(t);if(nt(o,e,r.child(n)),".priority"===n.getBack()&&!tt(e))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=(r=e[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!J(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(V.comparePaths);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&a.contains(r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(o,a)}},it=function(t,e,n,r){if(!r||void 0!==n){if(I(n))throw new Error(s.errorPrefix(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!tt(n))throw new Error(s.errorPrefix(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ot=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(s.errorPrefix(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},at=function(t,e,n,r){if((!r||void 0!==n)&&!J(n))throw new Error(s.errorPrefix(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},st=function(t,e,n,r){if((!r||void 0!==n)&&!$(n))throw new Error(s.errorPrefix(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ut=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),st(t,e,n,r)},ct=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},lt=function(t,e,n){var r=n.path.toString();if("string"!==typeof n.repoInfo.host||0===n.repoInfo.host.length||!J(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),$(t)}(r))throw new Error(s.errorPrefix(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},ht=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error(s.errorPrefix(t,e,r)+"must be a boolean.")},pt=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){s.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),s.validateCallback("OnDisconnect.cancel",1,t,!0);var e=new s.Deferred;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){s.validateArgCount("OnDisconnect.remove",0,1,arguments.length),ct("OnDisconnect.remove",this.path_),s.validateCallback("OnDisconnect.remove",1,t,!0);var e=new s.Deferred;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){s.validateArgCount("OnDisconnect.set",1,2,arguments.length),ct("OnDisconnect.set",this.path_),et("OnDisconnect.set",1,t,this.path_,!1),s.validateCallback("OnDisconnect.set",2,e,!0);var n=new s.Deferred;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){s.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),ct("OnDisconnect.setWithPriority",this.path_),et("OnDisconnect.setWithPriority",1,t,this.path_,!1),it("OnDisconnect.setWithPriority",2,e,!1),s.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var r=new s.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(s.validateArgCount("OnDisconnect.update",1,2,arguments.length),ct("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,C("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}rt("OnDisconnect.update",1,t,this.path_,!1),s.validateCallback("OnDisconnect.update",2,e,!0);var i=new s.Deferred;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),ft=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return s.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),dt=function(){var t="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",e=0,n=[];return function(r){var i,o=r===e;e=r;var a=new Array(8);for(i=7;i>=0;i--)a[i]=t.charAt(r%64),r=Math.floor(r/64);s.assert(0===r,"Cannot push at time == 0");var u=a.join("");if(o){for(i=11;i>=0&&63===n[i];i--)n[i]=0;n[i]++}else for(i=0;i<12;i++)n[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)u+=t.charAt(n[i]);return s.assert(20===u.length,"nextPushId: Length should be 20."),u}}(),mt=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),yt=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new mt(k,t),r=new mt(k,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return mt.MIN},t}(),gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return H},set:function(t){H=t},enumerable:!0,configurable:!0}),e.prototype.compare=function(t,e){return O(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw s.assertionError("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return mt.MIN},e.prototype.maxPost=function(){return new mt(A,H)},e.prototype.makePost=function(t,e){return s.assert("string"===typeof t,"KeyIndex indexValue must always be a string."),new mt(t,H)},e.prototype.toString=function(){return".key"},e}(yt),vt=new gt;var _t,bt,wt,xt=function(t){return"number"===typeof t?"number:"+L(t):"string:"+t},Et=function(t){if(t.isLeafNode()){var e=t.val();s.assert("string"===typeof e||"number"===typeof e||"object"===typeof e&&s.contains(e,".sv"),"Priority must be a string or number.")}else s.assert(t===K||t.isEmpty(),"priority of unexpected type.");s.assert(t===K||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Tt=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,s.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Et(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return _t},set:function(t){_t=t},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(s.assert(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+xt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?L(this.value_):this.value_,this.lazyHash_=g(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(s.assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),o=t.VALUE_TYPE_ORDER.indexOf(r);return s.assert(i>=0,"Unknown leaf type: "+n),s.assert(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();var St,Ct,It=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?O(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return mt.MIN},e.prototype.maxPost=function(){return new mt(A,new Tt("[PRIORITY-POST]",wt))},e.prototype.makePost=function(t,e){var n=bt(t);return new mt(e,new Tt("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(yt)),kt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),At=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Pt.EMPTY_NODE,this.right=null!=o?o:Pt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r,i;return(i=(r=n(t,(i=this).key))<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Pt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Pt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){var t;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((t=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Ot=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new At(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Pt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,At.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,At.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new kt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new kt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new kt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new kt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Ot,t}(),Dt=Math.log(2),Mt=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Dt,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),Rt=function(t,e,n,r){t.sort(e);var i=function(e){for(var r=null,i=null,o=t.length,a=function(e,r){var i=o-e,a=o;o-=e;var u=function e(r,i){var o,a,s=i-r;if(0==s)return null;if(1==s)return o=t[r],a=n?n(o):o,new At(a,o.node,At.BLACK,null,null);var u=parseInt(s/2,10)+r,c=e(r,u),l=e(u+1,i);return o=t[u],a=n?n(o):o,new At(a,o.node,At.BLACK,c,l)}(i+1,a),c=t[i],l=n?n(c):c;s(new At(l,c.node,r,null,u))},s=function(t){r?(r.left=t,r=t):(i=t,r=t)},u=0;u<e.count;++u){var c=e.nextBitIsOne(),l=Math.pow(2,e.count-(u+1));c?a(l,At.BLACK):(a(l,At.BLACK),a(l,At.RED))}return i}(new Mt(t.length));return new Pt(r||e,i)},Nt={},Lt=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return s.assert(Nt&&It,"ChildrenNode.ts has not been loaded"),St=St||new t({".priority":Nt},{".priority":It})},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var e=s.safeGet(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Pt?e:null},t.prototype.hasIndex=function(t){return s.contains(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){s.assert(e!==vt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],o=!1,u=n.getIterator(mt.Wrap),c=u.getNext();c;)o=o||e.isDefinedOn(c.node),i.push(c),c=u.getNext();r=o?Rt(i,e.getCompare()):Nt;var l=e.toString(),h=a.__assign({},this.indexSet_);h[l]=e;var p=a.__assign({},this.indexes_);return p[l]=r,new t(p,h)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(s.map(this.indexes_,(function(t,i){var o=s.safeGet(r.indexSet_,i);if(s.assert(o,"Missing index implementation for "+i),t===Nt){if(o.isDefinedOn(e.node)){for(var a=[],u=n.getIterator(mt.Wrap),c=u.getNext();c;)c.name!=e.name&&a.push(c),c=u.getNext();return a.push(e),Rt(a,o.getCompare())}return Nt}var l=n.get(e.name),h=t;return l&&(h=h.remove(new mt(e.name,l))),h.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(s.map(this.indexes_,(function(t){if(t===Nt)return t;var r=n.get(e.name);return r?t.remove(new mt(e.name,r)):t})),this.indexSet_)},t}();function Ft(t,e){return O(t.name,e.name)}function jt(t,e){return O(t,e)}var zt=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Et(this.priorityNode_),this.children_.isEmpty()&&s.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return Ct||(Ct=new t(new Pt(jt),null,Lt.Default))},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||Ct},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Ct:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(s.assert(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r,i=new mt(e,n),o=void 0,a=void 0;return n.isEmpty()?(o=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(e,n),a=this.indexMap_.addToIndexes(i,this.children_)),r=o.isEmpty()?Ct:this.priorityNode_,new t(o,r,a)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;s.assert(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(It,(function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+xt(this.getPriority().val())+":"),this.forEachChild(It,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":g(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new mt(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new mt(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new mt(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,mt.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,mt.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Bt?-1:0},t.prototype.withIndex=function(e){if(e===vt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===vt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(It),r=e.getIterator(It),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===vt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),Bt=new(function(t){function e(){return t.call(this,new Pt(jt),zt.EMPTY_NODE,Lt.Default)||this}return a.__extends(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return zt.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(zt));Object.defineProperties(mt,{MIN:{value:new mt(k,zt.EMPTY_NODE)},MAX:{value:new mt(A,Bt)}}),gt.__EMPTY_NODE=zt.EMPTY_NODE,Tt.__childrenNodeConstructor=zt,K=Bt,function(t){wt=t}(Bt);var Ut=!0;function Vt(t,e){if(void 0===e&&(e=null),null===t)return zt.EMPTY_NODE;if("object"===typeof t&&".priority"in t&&(e=t[".priority"]),s.assert(null===e||"string"===typeof e||"number"===typeof e||"object"===typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"===typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!==typeof t||".sv"in t)return new Tt(t,Vt(e));if(t instanceof Array||!Ut){var n=zt.EMPTY_NODE;return N(t,(function(e,r){if(s.contains(t,e)&&"."!==e.substring(0,1)){var i=Vt(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(Vt(e))}var r=[],i=!1;if(N(t,(function(t,e){if("."!==t.substring(0,1)){var n=Vt(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new mt(t,n)))}})),0==r.length)return zt.EMPTY_NODE;var o=Rt(r,Ft,(function(t){return t.name}),jt);if(i){var a=Rt(r,It.getCompare());return new zt(o,Vt(e),new Lt({".priority":a},{".priority":It}))}return new zt(o,Vt(e),Lt.Default)}!function(t){bt=t}(Vt);var qt,Wt,Gt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?O(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return mt.MIN},e.prototype.maxPost=function(){return mt.MAX},e.prototype.makePost=function(t,e){var n=Vt(t);return new mt(e,n)},e.prototype.toString=function(){return".value"},e}(yt)),Ht=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,s.assert(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return a.__extends(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?O(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=Vt(t),r=zt.EMPTY_NODE.updateChild(this.indexPath_,n);return new mt(e,r)},e.prototype.maxPost=function(){var t=zt.EMPTY_NODE.updateChild(this.indexPath_,Bt);return new mt(A,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(yt),Kt=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return s.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return s.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return s.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return s.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){s.validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),st("DataSnapshot.child",1,e,!1);var n=new V(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,It)},t.prototype.hasChild=function(t){s.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),st("DataSnapshot.hasChild",1,t,!1);var e=new V(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return s.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;if(s.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),s.validateCallback("DataSnapshot.forEach",1,e,!1),this.node_.isLeafNode())return!1;var r=this.node_;return!!r.forEachChild(this.index_,(function(r,i){return e(new t(i,n.ref_.child(r),It))}))},t.prototype.hasChildren=function(){return s.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),t.prototype.numChildren=function(){return s.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return s.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),Qt=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+s.stringify(this.snapshot.exportVal())},t}(),Xt=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Yt=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new Qt("value",this,new Kt(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){s.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Xt(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),Zt=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,s.contains(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Xt(this,t,e):null},t.prototype.createEvent=function(t,e){s.assert(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new Qt(t.type,this,new Kt(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){s.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){var n=this;if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var r=Object.keys(e.callbacks_),i=Object.keys(this.callbacks_),o=r.length;if(o===i.length){if(1===o){var a=r[0],s=i[0];return s===a&&(!e.callbacks_[a]||!this.callbacks_[s]||e.callbacks_[a]===this.callbacks_[s])}return i.every((function(t){return e.callbacks_[t]===n.callbacks_[t]}))}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),Jt=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return s.assert(qt,"Reference.ts has not been loaded"),qt},set:function(t){qt=t},enumerable:!0,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===vt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!=k)throw new Error(r);if("string"!==typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!=A)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(t.getIndex()===It){if(null!=e&&!tt(e)||null!=n&&!tt(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(s.assert(t.getIndex()instanceof Ht||t.getIndex()===Gt,"unknown index type."),null!=e&&"object"===typeof e||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return s.validateArgCount("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){s.validateArgCount("Query.on",2,4,arguments.length),ot("Query.on",1,e,!1),s.validateCallback("Query.on",2,n,!1);var o=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[e]=n,this.onChildEvent(a,o.cancel,o.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new Yt(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new Zt(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){s.validateArgCount("Query.off",0,3,arguments.length),ot("Query.off",1,t,!0),s.validateCallback("Query.off",2,e,!0),s.validateContextObject("Query.off",3,n,!0);var r=null,i=null;if("value"===t){var o=e||null;r=new Yt(o,null,n||null)}else t&&(e&&((i={})[t]=e),r=new Zt(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},t.prototype.once=function(e,n,r,i){var o=this;s.validateArgCount("Query.once",1,4,arguments.length),ot("Query.once",1,e,!1),s.validateCallback("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),u=!0,c=new s.Deferred;c.promise.catch((function(){}));var l=function t(r){u&&(u=!1,o.off(e,t),n&&n.bind(a.context)(r),c.resolve(r))};return this.on(e,l,(function(t){o.off(e,l),a.cancel&&a.cancel.bind(a.context)(t),c.reject(t)})),c.promise},t.prototype.limitToFirst=function(e){if(s.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(s.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(s.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');st("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new V(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new Ht(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){s.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(vt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){s.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(It);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){s.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(Gt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),s.validateArgCount("Query.startAt",0,2,arguments.length),et("Query.startAt",1,e,this.path,!0),at("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),s.validateArgCount("Query.endAt",0,2,arguments.length),et("Query.endAt",1,e,this.path,!0),at("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(s.validateArgCount("Query.equalTo",1,2,arguments.length),et("Query.equalTo",1,t,this.path,!1),at("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return s.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return s.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=M(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(s.validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var r=this.repo===e.repo,i=this.path.equals(e.path),o=this.queryIdentifier()===e.queryIdentifier();return r&&i&&o},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,s.validateCallback(t,3,r.cancel,!0),r.context=n,s.validateContextObject(t,4,r.context,!0);else if(e)if("object"===typeof e&&null!==e)r.context=e;else{if("function"!==typeof e)throw new Error(s.errorPrefix(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),$t=function(){function t(){this.value=null,this.children=new Map}return t.prototype.find=function(t){if(null!=this.value)return this.value.getChild(t);if(!t.isEmpty()&&this.children.size>0){var e=t.getFront();return t=t.popFront(),this.children.has(e)?this.children.get(e).find(t):null}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value=n,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(e,n);else{var r=e.getFront();this.children.has(r)||this.children.set(r,new t);var i=this.children.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var e=this.value;this.value=null;var n=this;return e.forEachChild(It,(function(t,e){n.remember(new V(t),e)})),this.forget(t)}if(this.children.size>0){var r=t.getFront();if(t=t.popFront(),this.children.has(r))this.children.get(r).forget(t)&&this.children.delete(r);return 0===this.children.size}return!0},t.prototype.forEachTree=function(t,e){null!==this.value?e(t,this.value):this.forEachChild((function(n,r){var i=new V(t.toString()+"/"+n);r.forEachTree(i,e)}))},t.prototype.forEachChild=function(t){this.children.forEach((function(e,n){t(n,e)}))},t}(),te=function(t,e,n){return t&&"object"===typeof t?(s.assert(".sv"in t,"Unexpected leaf node or priority contents"),"string"===typeof t[".sv"]?ee(t[".sv"],e,n):"object"===typeof t[".sv"]?ne(t[".sv"],e):void s.assert(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},ee=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:s.assert(!1,"Unexpected server value: "+t)}},ne=function(t,e,n){t.hasOwnProperty("increment")||s.assert(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;if("number"!==typeof r&&s.assert(!1,"Unexpected increment value: "+r),!e.isLeafNode())return r;var i=e.getValue();return"number"!==typeof i?r:i+r},re=function t(e,n,r){var i,o=e.getPriority().val(),a=te(o,n.getPriority(),r);if(e.isLeafNode()){var s=e,u=te(s.getValue(),n,r);return u!==s.getValue()||a!==s.getPriority().val()?new Tt(u,Vt(a)):e}var c=e;return i=c,a!==c.getPriority().val()&&(i=i.updatePriority(new Tt(a))),c.forEachChild(It,(function(e,o){var a=t(o,n.getImmediateChild(e),r);a!==o&&(i=i.updateImmediateChild(e,a))})),i};!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Wt||(Wt={}));var ie,oe,ae=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,s.assert(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),se=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Wt.ACK_USER_WRITE,this.source=ae.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return s.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new V(e));return new t(V.Empty,n,this.revert)}return s.assert(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),ue=function(){return ie||(ie=new Pt(P)),ie},ce=function(){function t(t,e){void 0===e&&(e=ue()),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return N(e,(function(t,e){n=n.set(new V(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:V.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null!=i?{path:new V(n).child(i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=(this.children.get(r)||t.Empty).set(e.popFront(),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r=e.getFront(),i=(this.children.get(r)||t.Empty).setTree(e.popFront(),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new t(this.value,o)},t.prototype.fold=function(t){return this.fold_(V.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(t.child(r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,V.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,V.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(V.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(t.child(n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t.Empty=new t(null),t}(),le=function(){function t(t,e){this.source=t,this.path=e,this.type=Wt.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,V.Empty):new t(this.source,this.path.popFront())},t}(),he=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Wt.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,V.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),pe=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Wt.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new V(e));return n.isEmpty()?null:n.value?new he(this.source,V.Empty,n.value):new t(this.source,V.Empty,n)}return s.assert(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),fe=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),de=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new fe(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new fe(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new fe(zt.EMPTY_NODE,!1,!1),new fe(zt.EMPTY_NODE,!1,!1)),t}(),me=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),ye=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,o){s.assert(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()==n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(me.childRemovedChange(e,a)):s.assert(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(me.childAddedChange(e,n)):o.trackChildChange(me.childChangedChange(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(It,(function(t,r){e.hasChild(t)||n.trackChildChange(me.childRemovedChange(t,r))})),e.isLeafNode()||e.forEachChild(It,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(me.childChangedChange(e,r,i))}else n.trackChildChange(me.childAddedChange(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?zt.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),ge=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;s.assert(e==me.CHILD_ADDED||e==me.CHILD_CHANGED||e==me.CHILD_REMOVED,"Only child changes supported for tracking"),s.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(e==me.CHILD_ADDED&&i==me.CHILD_REMOVED)this.changeMap.set(n,me.childChangedChange(n,t.snapshotNode,r.snapshotNode));else if(e==me.CHILD_REMOVED&&i==me.CHILD_ADDED)this.changeMap.delete(n);else if(e==me.CHILD_REMOVED&&i==me.CHILD_CHANGED)this.changeMap.set(n,me.childRemovedChange(n,r.oldSnap));else if(e==me.CHILD_CHANGED&&i==me.CHILD_ADDED)this.changeMap.set(n,me.childAddedChange(n,t.snapshotNode));else{if(e!=me.CHILD_CHANGED||i!=me.CHILD_CHANGED)throw s.assertionError("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,me.childChangedChange(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),ve=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),_e=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new fe(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),be=function(t,e){this.viewCache=t,this.changes=e},we=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){s.assert(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),s.assert(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var o,a,u=new ge;if(n.type===Wt.OVERWRITE){var c=n;c.source.fromUser?o=this.applyUserOverwrite_(e,c.path,c.snap,r,i,u):(s.assert(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.getServerCache().isFiltered()&&!c.path.isEmpty(),o=this.applyServerOverwrite_(e,c.path,c.snap,r,i,a,u))}else if(n.type===Wt.MERGE){var l=n;l.source.fromUser?o=this.applyUserMerge_(e,l.path,l.children,r,i,u):(s.assert(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.getServerCache().isFiltered(),o=this.applyServerMerge_(e,l.path,l.children,r,i,a,u))}else if(n.type===Wt.ACK_USER_WRITE){var h=n;o=h.revert?this.revertUserWrite_(e,h.path,r,i,u):this.ackUserWrite_(e,h.path,h.affectedTree,r,i,u)}else{if(n.type!==Wt.LISTEN_COMPLETE)throw s.assertionError("Unknown operation type: "+n.type);o=this.listenComplete_(e,n.path,r,u)}var p=u.getChanges();return t.maybeAddValueEvent_(e,o,p),new be(o,p)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(me.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var o=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var a=void 0,u=void 0;if(e.isEmpty())if(s.assert(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var c=t.getCompleteServerSnap(),l=c instanceof zt?c:zt.EMPTY_NODE,h=n.calcCompleteEventChildren(l);a=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var p=n.calcCompleteEventCache(t.getCompleteServerSnap());a=this.filter_.updateFullNode(t.getEventCache().getNode(),p,i)}else{var f=e.getFront();if(".priority"==f){s.assert(1==e.getLength(),"Can't have a priority with additional path components");var d=o.getNode();u=t.getServerCache().getNode();var m=n.calcEventCacheAfterServerOverwrite(e,d,u);a=null!=m?this.filter_.updatePriority(d,m):o.getNode()}else{var y=e.popFront(),g=void 0;if(o.isCompleteForChild(f)){u=t.getServerCache().getNode();var v=n.calcEventCacheAfterServerOverwrite(e,o.getNode(),u);g=null!=v?o.getNode().getImmediateChild(f).updateChild(y,v):o.getNode().getImmediateChild(f)}else g=n.calcCompleteChild(f,t.getServerCache());a=null!=g?this.filter_.updateChild(o.getNode(),f,g,y,r,i):o.getNode()}}return t.updateEventSnap(a,o.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,a){var s,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())s=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(e,n);s=c.updateFullNode(u.getNode(),l,null)}else{var h=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var p=e.popFront(),f=u.getNode().getImmediateChild(h).updateChild(p,n);s=".priority"==h?c.updatePriority(u.getNode(),f):c.updateChild(u.getNode(),h,f,p,ve,null)}var d=t.updateServerSnap(s,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),m=new _e(r,d,i);return this.generateEventCacheAfterServerEvent_(d,e,r,m,a)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var a,s,u=t.getEventCache(),c=new _e(r,t,i);if(e.isEmpty())s=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),a=t.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var l=e.getFront();if(".priority"===l)s=this.filter_.updatePriority(t.getEventCache().getNode(),n),a=t.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered());else{var h=e.popFront(),p=u.getNode().getImmediateChild(l),f=void 0;if(h.isEmpty())f=n;else{var d=c.getCompleteChild(l);f=null!=d?".priority"===h.getBack()&&d.getChild(h.parent()).isEmpty()?d:d.updateChild(h,n):zt.EMPTY_NODE}if(p.equals(f))a=t;else{var m=this.filter_.updateChild(u.getNode(),l,f,h,c,o);a=t.updateEventSnap(m,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,a){var s=this,u=e;return r.foreach((function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())&&(u=s.applyUserOverwrite_(u,l,c,i,o,a))})),r.foreach((function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())||(u=s.applyUserOverwrite_(u,l,c,i,o,a))})),u},t.prototype.applyMerge_=function(t,e){return e.foreach((function(e,n){t=t.updateChild(e,n)})),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,a){var s=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:ce.Empty.setTree(e,n);var l=t.getServerCache().getNode();return u.children.inorderTraversal((function(e,n){if(l.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),h=s.applyMerge_(u,n);c=s.applyServerOverwrite_(c,new V(e),h,r,i,o,a)}})),u.children.inorderTraversal((function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!l.hasChild(e)&&!u){var h=t.getServerCache().getNode().getImmediateChild(e),p=s.applyMerge_(h,n);c=s.applyServerOverwrite_(c,new V(e),p,r,i,o,a)}})),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var a=t.getServerCache().isFiltered(),s=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,s.getNode().getChild(e),r,i,a,o);if(e.isEmpty()){var u=ce.Empty;return s.getNode().forEachChild(vt,(function(t,e){u=u.set(new V(t),e)})),this.applyServerMerge_(t,e,u,r,i,a,o)}return t}var c=ce.Empty;return n.foreach((function(t,n){var r=e.child(t);s.isCompleteForPath(r)&&(c=c.set(t,s.getNode().getChild(r)))})),this.applyServerMerge_(t,e,c,r,i,a,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,ve,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var o;if(null!=n.shadowingWrite(e))return t;var a=new _e(n,t,r),u=t.getEventCache().getNode(),c=void 0;if(e.isEmpty()||".priority"===e.getFront()){var l=void 0;if(t.getServerCache().isFullyInitialized())l=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var h=t.getServerCache().getNode();s.assert(h instanceof zt,"serverChildren would be complete if leaf node"),l=n.calcCompleteEventChildren(h)}l=l,c=this.filter_.updateFullNode(u,l,i)}else{var p=e.getFront(),f=n.calcCompleteChild(p,t.getServerCache());null==f&&t.getServerCache().isCompleteForChild(p)&&(f=u.getImmediateChild(p)),(c=null!=f?this.filter_.updateChild(u,p,f,e.popFront(),a,i):t.getEventCache().getNode().hasChild(p)?this.filter_.updateChild(u,p,zt.EMPTY_NODE,e.popFront(),a,i):u).isEmpty()&&t.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(c=this.filter_.updateFullNode(c,o,i))}return o=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(V.Empty),t.updateEventSnap(c,o,this.filter_.filtersNodes())},t}(),xe=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach((function(t){t.type===me.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(me.childMovedChange(t.childName,t.snapshotNode))})),this.generateEventsForType_(i,me.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,me.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,me.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,me.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,me.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,a=n.filter((function(t){return t.type===e}));a.sort(this.compareChanges_.bind(this)),a.forEach((function(e){var n=o.materializeSingleChange_(e,i);r.forEach((function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))}))}))},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_),t)},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw s.assertionError("Should only compare child_ events.");var n=new mt(t.childName,t.snapshotNode),r=new mt(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),Ee=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new ye(n.getIndex()),i=n.getNodeFilter();this.processor_=new we(i);var o=e.getServerCache(),a=e.getEventCache(),s=r.updateFullNode(zt.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(zt.EMPTY_NODE,a.getNode(),null),c=new fe(s,o.isFullyInitialized(),r.filtersNodes()),l=new fe(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new de(l,c),this.eventGenerator_=new xe(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){s.assert(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach((function(t){e=e;var i=t.createCancelEvent(e,r);i&&n.push(i)}))}if(t){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===Wt.MERGE&&null!==t.source.queryId&&(s.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),s.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),s.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];e.getNode().isLeafNode()||e.getNode().forEachChild(It,(function(t,e){n.push(me.childAddedChange(t,e))}));return e.isFullyInitialized()&&n.push(me.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},t}(),Te=function(){function t(){this.views=new Map}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return s.assert(oe,"Reference.ts has not been loaded"),oe},set:function(t){s.assert(!oe,"__referenceConstructor has already been defined"),oe=t},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.views.size},t.prototype.applyOperation=function(t,e,n){var r,i,o=t.source.queryId;if(null!==o){var u=this.views.get(o);return s.assert(null!=u,"SyncTree gave us an op for an invalid query."),u.applyOperation(t,e,n)}var c=[];try{for(var l=a.__values(this.views.values()),h=l.next();!h.done;h=l.next()){u=h.value;c=c.concat(u.applyOperation(t,e,n))}}catch(p){r={error:p}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return c},t.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),a=this.views.get(o);if(!a){var s=n.calcCompleteEventCache(i?r:null),u=!1;s?u=!0:r instanceof zt?(s=n.calcCompleteEventChildren(r),u=!1):(s=zt.EMPTY_NODE,u=!1);var c=new de(new fe(s,u,!1),new fe(r,i,!1));a=new Ee(t,c),this.views.set(o,a)}return a.addEventRegistration(e),a.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var i,o,s=e.queryIdentifier(),u=[],c=[],l=this.hasCompleteView();if("default"===s)try{for(var h=a.__values(this.views.entries()),p=h.next();!p.done;p=h.next()){var f=a.__read(p.value,2),d=f[0],m=f[1];c=c.concat(m.removeEventRegistration(n,r)),m.isEmpty()&&(this.views.delete(d),m.getQuery().getQueryParams().loadsAllData()||u.push(m.getQuery()))}}catch(y){i={error:y}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}else(m=this.views.get(s))&&(c=c.concat(m.removeEventRegistration(n,r)),m.isEmpty()&&(this.views.delete(s),m.getQuery().getQueryParams().loadsAllData()||u.push(m.getQuery())));return l&&!this.hasCompleteView()&&u.push(new t.__referenceConstructor(e.repo,e.path)),{removed:u,events:c}},t.prototype.getQueryViews=function(){var t,e,n=[];try{for(var r=a.__values(this.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;o.getQuery().getQueryParams().loadsAllData()||n.push(o)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t.prototype.getCompleteServerCache=function(t){var e,n,r=null;try{for(var i=a.__values(this.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r||s.getCompleteServerCache(t)}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return this.views.get(e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){var t,e;try{for(var n=a.__values(this.views.values()),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(o){t={error:o}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},t}(),Se=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new ce(n));var r=this.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=V.relativePath(i,e);return o=o.updateChild(a,n),new t(this.writeTree_.set(i,o))}var s=new ce(n);return new t(this.writeTree_.setTree(e,s))},t.prototype.addWrites=function(t,e){var n=this;return N(e,(function(e,r){n=n.addWrite(t.child(e),r)})),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,ce.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(V.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(It,(function(e,n){t.push(new mt(e,n))})):this.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new mt(e,n.value))})),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new ce(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(t){return function t(e,n,r){if(null!=n.value)return r.updateChild(e,n.value);var i=null;return n.children.inorderTraversal((function(n,o){".priority"===n?(s.assert(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=t(e.child(n),o,r)})),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(e.child(".priority"),i)),r}(V.Empty,this.writeTree_,t)},t.Empty=new t(new ce(null)),t}();var Ce=function(){function t(){this.visibleWrites_=Se.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new Ie(t,this)},t.prototype.addOverwrite=function(t,e,n,r){s.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){s.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex((function(e){return e.writeId===t}));s.assert(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,o=!1,a=this.allWrites_.length-1;i&&a>=0;){var u=this.allWrites_[a];u.visible&&(a>=n&&this.recordContainsPath_(u,r.path)?i=!1:r.path.contains(u.path)&&(o=!0)),a--}if(i){if(o)return this.resetTree_(),!0;r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):N(r.children,(function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(r.path.child(t))}));return!0}return!1},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(e);if(!i&&o.isEmpty())return n;if(i||null!=n||o.hasCompleteWrite(V.Empty)){var a=t.layerTree_(this.allWrites_,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))}),e);c=n||zt.EMPTY_NODE;return a.apply(c)}return null}var s=this.visibleWrites_.getCompleteNode(e);if(null!=s)return s;var u=this.visibleWrites_.childCompoundWrite(e);if(u.isEmpty())return n;if(null!=n||u.hasCompleteWrite(V.Empty)){var c=n||zt.EMPTY_NODE;return u.apply(c)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=zt.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(It,(function(t,e){n=n.updateImmediateChild(t,e)})),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(It,(function(t,e){var r=i.childCompoundWrite(new V(t)).apply(e);n=n.updateImmediateChild(t,r)})),i.getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){s.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(e):o.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(e)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e)):null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(t),u=s.getCompleteNode(V.Empty);if(null!=u)a=u;else{if(null==e)return[];a=s.apply(e)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var c=[],l=o.getCompare(),h=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),p=h.getNext();p&&c.length<r;)0!==l(p,n)&&c.push(p),p=h.getNext();return c},t.prototype.recordContainsPath_=function(t,e){if(t.snap)return t.path.contains(e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&t.path.child(n).contains(e))return!0;return!1},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,V.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=Se.Empty,i=0;i<t.length;++i){var o=t[i];if(e(o)){var a=o.path,u=void 0;if(o.snap)n.contains(a)?(u=V.relativePath(n,a),r=r.addWrite(u,o.snap)):a.contains(n)&&(u=V.relativePath(a,n),r=r.addWrite(V.Empty,o.snap.getChild(u)));else{if(!o.children)throw s.assertionError("WriteRecord should have .snap or .children");if(n.contains(a))u=V.relativePath(n,a),r=r.addWrites(u,o.children);else if(a.contains(n))if((u=V.relativePath(a,n)).isEmpty())r=r.addWrites(V.Empty,o.children);else{var c=s.safeGet(o.children,u.getFront());if(c){var l=c.getChild(u.popFront());r=r.addWrite(V.Empty,l)}}}}}return r},t}(),Ie=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),ke=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=ce.Empty,this.pendingWriteTree_=new Ce,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new he(ae.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=ce.fromObject(e);return this.applyOperationToSyncPoints_(new pe(ae.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=ce.Empty;return null!=n.snap?r=r.set(V.Empty,!0):N(n.children,(function(t,e){r=r.set(new V(t),e)})),this.applyOperationToSyncPoints_(new se(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new he(ae.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=ce.fromObject(e);return this.applyOperationToSyncPoints_(new pe(ae.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new le(ae.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=V.relativePath(a,e),c=new he(ae.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=V.relativePath(a,e),c=ce.fromObject(n),l=new pe(ae.forServerTaggedQuery(s),u,c);return this.applyTaggedOperation_(a,l)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,a=i.queryId,s=V.relativePath(o,e),u=new le(ae.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,(function(t,e){var n=V.relativePath(t,r);i=i||e.getCompleteServerCache(n),o=o||e.hasCompleteView()}));var a,u=this.syncPointTree_.get(r);(u?(o=o||u.hasCompleteView(),i=i||u.getCompleteServerCache(V.Empty)):(u=new Te,this.syncPointTree_=this.syncPointTree_.set(r,u)),null!=i)?a=!0:(a=!1,i=zt.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=e.getCompleteServerCache(V.Empty);n&&(i=i.updateImmediateChild(t,n))})));var c=u.viewExistsForQuery(e);if(!c&&!e.getQueryParams().loadsAllData()){var l=t.makeQueryKey_(e);s.assert(!this.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=t.getNextQueryTag_();this.queryToTagMap.set(l,h),this.tagToQueryMap.set(h,l)}var p=this.pendingWriteTree_.childWrites(r),f=u.addEventRegistration(e,n,p,i,a);if(!c&&!o){var d=u.viewForQuery(e);f=f.concat(this.setupListener_(e,d))}return f},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===e.queryIdentifier()||a.viewExistsForQuery(e))){var u=a.removeEventRegistration(e,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;s=u.events;var l=-1!==c.findIndex((function(t){return t.getQueryParams().loadsAllData()})),h=this.syncPointTree_.findOnPath(o,(function(t,e){return e.hasCompleteView()}));if(l&&!h){var p=this.syncPointTree_.subtree(o);if(!p.isEmpty())for(var f=this.collectDistinctViewsForSubTree_(p),d=0;d<f.length;++d){var m=f[d],y=m.getQuery(),g=this.createListenerForView_(m);this.listenProvider_.startListening(t.queryForListening_(y),this.tagForQuery_(y),g.hashFn,g.onComplete)}}if(!h&&c.length>0&&!r)if(l){this.listenProvider_.stopListening(t.queryForListening_(e),null)}else c.forEach((function(e){var n=i.queryToTagMap.get(t.makeQueryKey_(e));i.listenProvider_.stopListening(t.queryForListening_(e),n)}));this.removeTags_(c)}return s},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,(function(e,n){var r=V.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i}));return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold((function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),N(n,(function(t,e){r=r.concat(e)})),r}))},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),o=this.createListenerForView_(n),a=this.listenProvider_.startListening(t.queryForListening_(e),i,o.hashFn,o.onComplete),u=this.syncPointTree_.subtree(r);if(i)s.assert(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map((function(t){return t.getQuery()})))),N(n,(function(t,e){r=r.concat(e)})),r})),l=0;l<c.length;++l){var h=c[l];this.listenProvider_.stopListening(t.queryForListening_(h),this.tagForQuery_(h))}return a},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||zt.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?n="Client doesn't have permission to access the desired data.":"unavailable"==t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r}(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return s.assert(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new V(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap.get(t)},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return this.queryToTagMap.get(n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);s.assert(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(V.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(V.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(V.Empty));var o=[],a=t.path.getFront(),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,l))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(V.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(V.Empty));var a=[];return e.children.inorderTraversal((function(e,o){var s=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(a=a.concat(i.applyOperationDescendantsHelper_(c,o,s,u)))})),o&&(a=a.concat(o.applyOperation(t,r,n))),a},t.nextQueryTag_=1,t}(),Ae=function(){function t(){this.rootNode_=zt.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),Oe=function(){function t(t,e){var n=this;this.app_=t,this.authProvider_=e,this.auth_=null,this.auth_=e.getImmediate({optional:!0}),this.auth_||e.get().then((function(t){return n.auth_=t}))}return t.prototype.getToken=function(t){return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(x("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):Promise.resolve(null)},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):(setTimeout((function(){return t(null)}),0),this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)})))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',C(t)},t}(),Pe=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),s.contains(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return s.deepCopy(this.counters_)},t}(),De=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new Pe),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),Me=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=a.__assign({},t);return this.last_&&N(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),Re=1e4,Ne=3e4,Le=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Me(t);var n=Re+(Ne-Re)*Math.random();U(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;N(e,(function(e,i){i>0&&s.contains(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),U(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),Fe=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new je(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.equals(t)}))},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.contains(t)||t.contains(e)}))},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];if(r)t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),je=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();_&&x("event: "+e.toString()),z(n)}}},t.prototype.getPath=function(){return this.path_},t}(),ze=function(){function t(t){this.allowedEvents_=t,this.listeners_={},s.assert(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=a.__spread(this.listeners_[t]),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){s.assert(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),Be=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(n="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(n="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return a.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return s.assert("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(ze),Ue=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||s.isMobileCordova()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return a.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return s.assert("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(ze),Ve=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&z((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}},t}(),qe="pLPCommand",We="pRTLPCB",Ge=function(){function t(t,e,n,r){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=E(t),this.stats_=De.getCollection(e),this.urlFn=function(t){return e.connectionURL(W,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new Ve(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if(s.isNodeSdk()||"complete"===document.readyState)t();else{var e=!1,n=function n(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new He((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=a.__read(t,5),i=r[0],o=r[1],s=r[2];r[3],r[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"==i)n.id=o,n.password=s;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=a.__read(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!s.isNodeSdk()&&(!!t.forceAllow_||!t.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=s.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=s.base64Encode(e),r=R(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!s.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=s.stringify(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),He=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,s.isNodeSdk())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=y(),window[qe+this.uniqueCallbackIdentifier]=e,window[We+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var o="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))o='<script>document.domain="'+document.domain+'";<\/script>';var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(u){x("frame writing exception"),u.stack&&x(u.stack),x(u)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||x("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;s.isNodeSdk()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){x("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},t}(),Ke="";var Qe=null;"undefined"!==typeof MozWebSocket?Qe=MozWebSocket:"undefined"!==typeof WebSocket&&(Qe=WebSocket);var Xe=function(){function t(e,n,r,i){this.connId=e,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=E(this.connId),this.stats_=De.getCollection(n),this.connURL=t.connectionURL_(n,r,i)}return t.connectionURL_=function(t,e,n){var r={v:"5"};return!s.isNodeSdk()&&"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL("websocket",r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f.set("previous_websocket_failure",!0);try{if(s.isNodeSdk()){var i=s.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",o={headers:{"User-Agent":"Firebase/5/"+Ke+"/"+r.platform+"/"+i}},a=Object({NODE_ENV:"production",PUBLIC_URL:""}),u=0==this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;u&&(o.proxy={origin:u}),this.mySock=new Qe(this.connURL,[],o)}else this.mySock=new Qe(this.connURL)}catch(l){this.log_("Error instantiating WebSocket.");var c=l.message||l.data;return c&&this.log_(c),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Qe&&!t.forceDisallow_},t.previouslyFailed=function(){return f.isInMemoryStorage||!0===f.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){f.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=s.jsonEval(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(s.assert(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=s.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=R(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),Ye=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Ge,Xe]},enumerable:!0,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=Xe&&Xe.isAvailable(),o=i&&!Xe.previouslyFailed();if(e.webSocketOnly&&(i||C("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[Xe];else{var s=this.transports_=[];try{for(var u=a.__values(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var l=c.value;l&&l.isAvailable()&&s.push(l)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),Ze=function(){function t(t,e,n,r,i,o,a){this.id=t,this.repoInfo_=e,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=E("c:"+this.id+":"),this.transportManager_=new Ye(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=U((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!=e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=D("t",t),n=D("d",t);if("c"==e)this.onSecondaryControl_(n);else{if("d"!=e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=D("t",t),n=D("d",t);"c"==e?this.onControl_(n):"d"==e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=D("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?T("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):T("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&C("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),U((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):U((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),Je=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),$e=1e3,tn=3e5,en=function(t){function e(n,r,i,o,a,u){var c=t.call(this)||this;if(c.repoInfo_=n,c.onDataUpdate_=r,c.onConnectStatus_=i,c.onServerInfoUpdate_=o,c.authTokenProvider_=a,c.authOverride_=u,c.id=e.nextPersistentConnectionId_++,c.log_=E("p:"+c.id+":"),c.interruptReasons_={},c.listens=new Map,c.outstandingPuts_=[],c.outstandingPutCount_=0,c.onDisconnectRequestQueue_=[],c.connected_=!1,c.reconnectDelay_=$e,c.maxReconnectDelay_=tn,c.securityDebugCallback_=null,c.lastSessionId=null,c.establishConnectionTimer_=null,c.visible_=!1,c.requestCBHash_={},c.requestNumber_=0,c.realtime_=null,c.authToken_=null,c.forceTokenRefresh_=!1,c.invalidAuthTokenCount_=0,c.firstConnection_=!0,c.lastConnectionAttemptTime_=null,c.lastConnectionEstablishedTime_=null,u&&!s.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return c.scheduleConnect_(0),Be.getInstance().on("visible",c.onVisible_,c),-1===n.host.indexOf("fblocal")&&Ue.getInstance().on("online",c.onOnline_,c),c}return a.__extends(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(s.stringify(i)),s.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),s.assert(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r.queryObject(),a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"===typeof t&&s.contains(t,"w")){var n=s.safeGet(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();C("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||s.isAdmin(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=s.isValidFormat(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"===typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+s.stringify(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):T("Unrecognized action received from server: "+s.stringify(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;s.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=$e,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=$e,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=$e),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,o=this,a=this.lastSessionId,u=!1,c=null,l=function(){c?c.close():(u=!0,r())};this.realtime_={close:l,sendRequest:function(t){s.assert(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(t)}};var h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(h).then((function(e){u?x("getToken() completed but was canceled"):(x("getToken() completed. Creating connection."),o.authToken_=e&&e.accessToken,c=new Ze(i,o.repoInfo_,t,n,r,(function(t){C(t+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")}),a))})).then(null,(function(t){o.log_("Failed to get token: "+t),u||(s.CONSTANTS.NODE_ADMIN&&C(t),l())}))}},e.prototype.interrupt=function(t){x("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){x("Resuming connection for reason: "+t),delete this.interruptReasons_[t],s.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=$e,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return M(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new V(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){x("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth();try{for(var i=a.__values(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var u=(n=void 0,a.__values(s.values())),c=u.next();!c.done;c=u.next()){var l=c.value;this.sendListen_(l)}}catch(f){n={error:f}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(d){t={error:d}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);for(;this.onDisconnectRequestQueue_.length;){var p=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(p.action,p.pathString,p.data,p.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";s.CONSTANTS.NODE_ADMIN?e="admin_node":s.CONSTANTS.NODE_CLIENT&&(e="node"),t["sdk."+e+"."+Ke.replace(/\./g,"-")]=1,s.isMobileCordova()?t["framework.cordova"]=1:s.isReactNative()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=Ue.getInstance().currentlyOnline();return s.isEmpty(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(Je),nn=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=E("p:rest:"),i.listens_={},i}return a.__extends(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(s.assert(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var o=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",l,(function(t,e){var n=e;(404===t&&(n=null,t=null),null===t&&o.onDataUpdate_(a,n,!1,r),s.safeGet(o.listens_,u)===c)&&i(t?401==t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then((function(i){var o=i&&i.accessToken;o&&(e.auth=o);var a=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+s.querystring(e);r.log_("Sending REST request for "+a);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+a+" received. status:",u.status,"response:",u.responseText);var t=null;if(u.status>=200&&u.status<300){try{t=s.jsonEval(u.responseText)}catch(e){C("Failed to parse JSON response for "+a+": "+u.responseText)}n(null,t)}else 401!==u.status&&404!==u.status&&C("Got unsuccessful REST response for "+a+" Status: "+u.status),n(u.status);n=null}},u.open("GET",a,!0),u.send()}))},e}(Je),rn=function(){function t(t,e,n,r){var i=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Fe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new $t,this.persistentConnection_=null;var o=new Oe(n,r);if(this.stats_=De.getCollection(t),e||B())this.server_=new nn(this.repoInfo_,this.onDataUpdate_.bind(this),o),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var a=n.options.databaseAuthVariableOverride;if("undefined"!==typeof a&&null!==a){if("object"!==typeof a)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{s.stringify(a)}catch(u){throw new Error("Invalid authOverride provided: "+u)}}this.persistentConnection_=new en(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),o,a),this.server_=this.persistentConnection_}o.addTokenChangeListener((function(t){i.server_.refreshAuthToken(t)})),this.statsReporter_=De.getOrCreateReporter(t,(function(){return new Le(i.stats_,i.server_)})),this.transactions_init_(),this.infoData_=new Ae,this.infoSyncTree_=new ke({startListening:function(t,e,n,r){var o=[],a=i.infoData_.getNode(t.path);return a.isEmpty()||(o=i.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout((function(){r("ok")}),0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new ke({startListening:function(t,e,n,r){return i.server_.listen(t,n,e,(function(e,n){var o=r(e,n);i.eventQueue_.raiseEventsForChangedPath(t.path,o)})),[]},stopListening:function(t,e){i.server_.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new V(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return(t=(t={timestamp:this.serverTime()})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new V(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var o=[];if(r)if(n){var a=s.map(e,(function(t){return Vt(t)}));o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var u=Vt(e);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,u,r)}else if(n){var c=s.map(e,(function(t){return Vt(t)}));o=this.serverSyncTree_.applyServerMerge(i,c)}else{var l=Vt(e);o=this.serverSyncTree_.applyServerOverwrite(i,l)}var h=i;o.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,o)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;N(t,(function(t,n){e.updateInfo_(t,n)}))},t.prototype.updateInfo_=function(t,e){var n=new V("/.info/"+t),r=Vt(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),a=Vt(e,n),s=this.serverSyncTree_.calcCompleteEventCache(t),u=re(a,s,o),c=this.getNextWriteId_(),l=this.serverSyncTree_.applyUserOverwrite(t,u,c,!0);this.eventQueue_.queueEvents(l),this.server_.put(t.toString(),a.val(!0),(function(e,n){var o="ok"===e;o||C("set at "+t+" failed: "+e);var a=i.serverSyncTree_.ackUserWrite(c,!o);i.eventQueue_.raiseEventsForChangedPath(t,a),i.callOnCompleteCallback(r,e,n)}));var h=this.abortTransactions_(t);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,o=this.generateServerValues(),a={};if(N(e,(function(e,n){i=!1;var s=Vt(n);a[e]=re(s,r.serverSyncTree_.calcCompleteEventCache(t),o)})),i)x("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var s=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(t,a,s);this.eventQueue_.queueEvents(u),this.server_.merge(t.toString(),e,(function(e,i){var o="ok"===e;o||C("update at "+t+" failed: "+e);var a=r.serverSyncTree_.ackUserWrite(s,!o),u=a.length>0?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(u,a),r.callOnCompleteCallback(n,e,i)})),N(e,(function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)})),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=function(t,e,n){var r=new $t;return t.forEachTree(new V(""),(function(t,i){var o=e.calcCompleteEventCache(t);s.assert(null!==o&&"undefined"!==typeof o,"Expected ChildrenNode.EMPTY_NODE for nulls"),r.remember(t,re(i,o,n))})),r}(this.onDisconnect_,this.serverSyncTree_,e),r=[];n.forEachTree(V.Empty,(function(e,n){r=r.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var i=t.abortTransactions_(e);t.rerunTransactions_(i)})),this.onDisconnect_=new $t,this.eventQueue_.raiseEventsForChangedPath(V.Empty,r)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)}))},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=Vt(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),(function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)}))},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=Vt(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),(function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)}))},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(s.isEmpty(e))return x("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,(function(i,o){"ok"===i&&N(e,(function(e,n){var i=Vt(n);r.onDisconnect_.remember(t.child(e),i)})),r.callOnCompleteCallback(n,i,o)}))},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!==typeof console){var e;t?(this.statsListener_||(this.statsListener_=new Me(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce((function(t,e){return Math.max(e.length,t)}),0);N(e,(function(t,e){for(var r=t,i=t.length;i<n+2;i++)r+=" ";console.log(r+e)}))}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),x.apply(void 0,a.__spread([n],t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&z((function(){if("ok"==e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}}))},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new dn(this))},enumerable:!0,configurable:!0}),t}(),on=function(){function t(e){this.indexedFilter_=new ye(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new mt(e,n))||(n=zt.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=zt.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(zt.EMPTY_NODE);var i=this;return e.forEachChild(It,(function(t,e){i.matches(new mt(t,e))||(r=r.updateImmediateChild(t,zt.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),an=function(){function t(t){this.rangedFilter_=new on(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new mt(e,n))||(n=zt.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=zt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=zt.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(zt.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();){a=i.getNext();!h&&c(s,a)<=0&&(h=!0),h&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,zt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(t,e){return a(e,t)}}else o=this.index_.getCompare();var u=t;s.assert(u.numChildren()==this.limit_,"");var c=new mt(e,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var p=u.getImmediateChild(e),f=r.getChildAfterChild(this.index_,l,this.reverse_);null!=f&&(f.name==e||u.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var d=null==f?1:o(f,c);if(h&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(me.childChangedChange(e,n,p)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(me.childRemovedChange(e,p));var m=u.updateImmediateChild(e,zt.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(me.childAddedChange(f.name,f.node)),m.updateImmediateChild(f.name,f.node)):m}return n.isEmpty()?t:h&&o(l,c)>=0?(null!=i&&(i.trackChildChange(me.childRemovedChange(l.name,l.node)),i.trackChildChange(me.childAddedChange(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(l.name,zt.EMPTY_NODE)):t},t}(),sn=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=It}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return s.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return s.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:k},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return s.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return s.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:A},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return s.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==It&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==It},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new ye(this.getIndex()):this.hasLimit()?new an(this):new on(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,r={};return this.isDefault()?r:(this.index_===It?e=n.PRIORITY_INDEX:this.index_===Gt?e=n.VALUE_INDEX:this.index_===vt?e=n.KEY_INDEX:(s.assert(this.index_ instanceof Ht,"Unrecognized index type!"),e=this.index_.toString()),r[n.ORDER_BY]=s.stringify(e),this.startSet_&&(r[n.START_AT]=s.stringify(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+s.stringify(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=s.stringify(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+s.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_),r)},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),un=function(t){function e(e,n){if(!(e instanceof rn))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,sn.DEFAULT,!1)||this}return a.__extends(e,t),e.prototype.getKey=function(){return s.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return s.validateArgCount("Reference.child",1,1,arguments.length),"number"===typeof t?t=String(t):t instanceof V||(null===this.path.getFront()?ut("Reference.child",1,t,!1):st("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){s.validateArgCount("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){s.validateArgCount("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){s.validateArgCount("Reference.set",1,2,arguments.length),ct("Reference.set",this.path),et("Reference.set",1,t,this.path,!1),s.validateCallback("Reference.set",2,e,!0);var n=new s.Deferred;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(s.validateArgCount("Reference.update",1,2,arguments.length),ct("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,C("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}rt("Reference.update",1,t,this.path,!1),s.validateCallback("Reference.update",2,e,!0);var i=new s.Deferred;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(s.validateArgCount("Reference.setWithPriority",2,3,arguments.length),ct("Reference.setWithPriority",this.path),et("Reference.setWithPriority",1,t,this.path,!1),it("Reference.setWithPriority",2,e,!1),s.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new s.Deferred;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return s.validateArgCount("Reference.remove",0,1,arguments.length),ct("Reference.remove",this.path),s.validateCallback("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(s.validateArgCount("Reference.transaction",1,3,arguments.length),ct("Reference.transaction",this.path),s.validateCallback("Reference.transaction",1,t,!1),s.validateCallback("Reference.transaction",2,e,!0),ht("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new s.Deferred;"function"===typeof e&&r.promise.catch((function(){}));var i=function(t,n,i){t?r.reject(t):r.resolve(new ft(n,i)),"function"===typeof e&&e(t,n,i)};return this.repo.startTransaction(this.path,t,i,n),r.promise},e.prototype.setPriority=function(t,e){s.validateArgCount("Reference.setPriority",1,2,arguments.length),ct("Reference.setPriority",this.path),it("Reference.setPriority",1,t,!1),s.validateCallback("Reference.setPriority",2,e,!0);var n=new s.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){s.validateArgCount("Reference.push",0,2,arguments.length),ct("Reference.push",this.path),et("Reference.push",1,t,this.path,!0),s.validateCallback("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=dt(r),o=this.child(i),a=this.child(i);return n=null!=t?o.set(t,e).then((function(){return a})):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"===typeof e&&n.catch((function(){})),o},e.prototype.onDisconnect=function(){return ct("Reference.onDisconnect",this.path),new pt(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),e}(Jt);Jt.__referenceConstructor=un,Te.__referenceConstructor=un;var cn,ln=function(){this.children={},this.childCount=0,this.value=null},hn=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new ln),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n,r=e instanceof V?e:new V(e),i=this;null!==(n=r.getFront());){i=new t(n,i,s.safeGet(i.node_.children,n)||new ln),r=r.popFront()}return i},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){s.assert("undefined"!==typeof t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;N(this.node_.children,(function(r,i){e(new t(r,n,i))}))},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild((function(e){e.forEachDescendant(t,!0,n)})),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild((function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)}))},t.prototype.path=function(){return new V(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=s.contains(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();!function(t){t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT"}(cn||(cn={})),rn.MAX_TRANSACTION_RETRIES_=25,rn.prototype.transactions_init_=function(){this.transactionQueueTree_=new hn},rn.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},o=new un(this,t);o.on("value",i);var a={path:t,update:e,onComplete:n,status:null,order:y(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=this.getLatestState_(t);a.currentInputSnapshot=u;var c=a.update(u.val());if(void 0===c){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var l=new Kt(a.currentInputSnapshot,new un(this,a.path),It);a.onComplete(null,!1,l)}}else{nt("transaction failed: Data returned ",c,a.path),a.status=cn.RUN;var h=this.transactionQueueTree_.subTree(t),p=h.getValue()||[];p.push(a),h.setValue(p);var f=void 0;if("object"===typeof c&&null!==c&&s.contains(c,".priority"))f=s.safeGet(c,".priority"),s.assert(tt(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else f=(this.serverSyncTree_.calcCompleteEventCache(t)||zt.EMPTY_NODE).getPriority().val();f=f;var d=this.generateServerValues(),m=Vt(c,f),g=re(m,u,d);a.currentOutputSnapshotRaw=m,a.currentOutputSnapshotResolved=g,a.currentWriteId=this.getNextWriteId_();var v=this.serverSyncTree_.applyUserOverwrite(t,g,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,v),this.sendReadyTransactions_()}},rn.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||zt.EMPTY_NODE},rn.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);s.assert(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return t.status===cn.RUN}))&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild((function(t){e.sendReadyTransactions_(t)}))},rn.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map((function(t){return t.currentWriteId})),i=this.getLatestState_(t,r),o=i,a=i.hash(),u=0;u<e.length;u++){var c=e[u];s.assert(c.status===cn.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=cn.SENT,c.retryCount++;var l=V.relativePath(t,c.path);o=o.updateChild(l,c.currentOutputSnapshotRaw)}var h=o.val(!0),p=t;this.server_.put(p.toString(),h,(function(r){n.log_("transaction put response",{path:p.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=0;a<e.length;a++){if(e[a].status=cn.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[a].currentWriteId)),e[a].onComplete){var s=e[a].currentOutputSnapshotResolved,u=new un(n,e[a].path),c=new Kt(s,u,It);o.push(e[a].onComplete.bind(null,null,!0,c))}e[a].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i);for(a=0;a<o.length;a++)z(o[a])}else{if("datastale"===r)for(a=0;a<e.length;a++)e[a].status===cn.SENT_NEEDS_ABORT?e[a].status=cn.NEEDS_ABORT:e[a].status=cn.RUN;else{C("transaction at "+p.toString()+" failed: "+r);for(a=0;a<e.length;a++)e[a].status=cn.NEEDS_ABORT,e[a].abortReason=r}n.rerunTransactions_(t)}}),a)},rn.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},rn.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n,r=[],i=[],o=t.filter((function(t){return t.status===cn.RUN})).map((function(t){return t.currentWriteId})),a=0;a<t.length;a++){var u=t[a],c=V.relativePath(e,u.path),l=!1,h=void 0;if(s.assert(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===cn.NEEDS_ABORT)l=!0,h=u.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0));else if(u.status===cn.RUN)if(u.retryCount>=rn.MAX_TRANSACTION_RETRIES_)l=!0,h="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0));else{var p=this.getLatestState_(u.path,o);u.currentInputSnapshot=p;var f=t[a].update(p.val());if(void 0!==f){nt("transaction failed: Data returned ",f,u.path);var d=Vt(f);"object"===typeof f&&null!=f&&s.contains(f,".priority")||(d=d.updatePriority(p.getPriority()));var m=u.currentWriteId,y=this.generateServerValues(),g=re(d,p,y);u.currentOutputSnapshotRaw=d,u.currentOutputSnapshotResolved=g,u.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(m),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(u.path,g,u.currentWriteId,u.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(m,!0))}else l=!0,h="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,i),i=[],l&&(t[a].status=cn.COMPLETED,n=t[a].unwatcher,setTimeout(n,Math.floor(0)),t[a].onComplete))if("nodata"===h){var v=new un(this,t[a].path),_=t[a].currentInputSnapshot,b=new Kt(_,v,It);r.push(t[a].onComplete.bind(null,null,!1,b))}else r.push(t[a].onComplete.bind(null,new Error(h),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(a=0;a<r.length;a++)z(r[a]);this.sendReadyTransactions_()}},rn.prototype.getAncestorTransactionNode_=function(t){for(var e,n=this.transactionQueueTree_;null!==(e=t.getFront())&&null===n.getValue();)n=n.subTree(e),t=t.popFront();return n},rn.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort((function(t,e){return t.order-e.order})),e},rn.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild((function(t){n.aggregateTransactionQueuesForNode_(t,e)}))},rn.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==cn.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild((function(t){e.pruneCompletedTransactionsBelowNode_(t)}))},rn.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor((function(t){e.abortTransactionsOnNode_(t)})),this.abortTransactionsOnNode_(r),r.forEachDescendant((function(t){e.abortTransactionsOnNode_(t)})),n},rn.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,o=0;o<e.length;o++)if(e[o].status===cn.SENT_NEEDS_ABORT);else if(e[o].status===cn.SENT)s.assert(i===o-1,"All SENT items should be at beginning of queue."),i=o,e[o].status=cn.SENT_NEEDS_ABORT,e[o].abortReason="set";else if(s.assert(e[o].status===cn.RUN,"Unexpected transaction status in abort"),e[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[o].currentWriteId,!0)),e[o].onComplete){n.push(e[o].onComplete.bind(null,new Error("set"),!1,null))}-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r);for(o=0;o<n.length;o++)z(n[o])}};var pn,fn=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return pn||(pn=new t),pn},t.prototype.interrupt=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].interrupt()},t.prototype.resume=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].resume()},t.prototype.databaseFromApp=function(t,e,n){var i=n||t.options.databaseURL;void 0===i&&S("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.initializeApp().");var o=Q(i),a=o.repoInfo,s=void 0;return"undefined"!==typeof r&&(s=Object({NODE_ENV:"production",PUBLIC_URL:""}).FIREBASE_DATABASE_EMULATOR_HOST),s&&(i="http://"+s+"?ns="+a.namespace,a=(o=Q(i)).repoInfo),lt("Invalid Firebase Database URL",1,o),o.path.isEmpty()||S("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(a,t,e).database},t.prototype.deleteRepo=function(t){var e=s.safeGet(this.repos_,t.app.name);e&&s.safeGet(e,t.repoInfo_.toURLString())===t||S("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},t.prototype.createRepo=function(t,e,n){var r=s.safeGet(this.repos_,e.name);r||(r={},this.repos_[e.name]=r);var i=s.safeGet(r,t.toURLString());return i&&S("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new rn(t,this.useRestClient_,e,n),r[t.toURLString()]=i,i},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),dn=function(){function t(t){this.repo_=t,t instanceof rn||S("Don't call new Database() directly - please use firebase.database()."),this.root_=new un(t,V.Empty),this.INTERNAL=new mn(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),t.prototype.ref=function(t){return this.checkDeleted_("ref"),s.validateArgCount("database.ref",0,1,arguments.length),t instanceof un?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),s.validateArgCount(e,1,1,arguments.length);var n=Q(t);lt(e,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&S(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repo_&&S("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){s.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){s.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"},_increment:function(t){return{".sv":{increment:t}}}},t}(),mn=function(){function t(t){this.database=t}return t.prototype.delete=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return this.database.checkDeleted_("delete"),fn.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]}))}))},t}(),yn=Object.freeze({__proto__:null,forceLongPolling:function(){Xe.forceDisallow(),Ge.forceAllow()},forceWebSockets:function(){Ge.forceDisallow()},isWebSocketsAvailable:function(){return Xe.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:function(t,e){t.repo.statsIncrementCounter(e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return t.repo.interceptServerData_(e)}}),gn=en;en.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},en.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var vn=Ze,_n=G,bn=Object.freeze({__proto__:null,DataConnection:gn,RealTimeConnection:vn,hijackHash:function(t){var e=en.prototype.put;return en.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){en.prototype.put=e}},ConnectionTarget:_n,queryIdentifier:function(t){return t.queryIdentifier()},forceRestClient:function(t){fn.getInstance().forceRestClient(t)}}),wn="@firebase/database",xn="0.5.17",En=dn.ServerValue;function Tn(e){!function(t){Ke=t}(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new c.Component("database",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return fn.getInstance().databaseFromApp(n,r,e)}),"PUBLIC").setServiceProps({Reference:un,Query:Jt,Database:dn,DataSnapshot:Kt,enableLogging:w,INTERNAL:yn,ServerValue:En,TEST_ACCESS:bn}).setMultipleInstances(!0));e.registerVersion(wn,xn),s.isNodeSdk()&&(t.exports=n)}Tn(o),e.DataSnapshot=Kt,e.Database=dn,e.OnDisconnect=pt,e.Query=Jt,e.Reference=un,e.ServerValue=En,e.enableLogging=w,e.registerDatabase=Tn}).call(this,n(30))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r,i,o=(r=n(7))&&"object"===typeof r&&"default"in r?r.default:r,a=n(2),s=n(23),u=n(13),c=n(12),l=n(55),h=o.SDK_VERSION,p=new s.Logger("@firebase/firestore");function f(){return p.logLevel===s.LogLevel.DEBUG?i.DEBUG:p.logLevel===s.LogLevel.SILENT?i.SILENT:i.ERROR}function d(t){switch(t){case i.DEBUG:p.logLevel=s.LogLevel.DEBUG;break;case i.ERROR:p.logLevel=s.LogLevel.ERROR;break;case i.SILENT:p.logLevel=s.LogLevel.SILENT;break;default:p.error("Firestore ("+h+"): Invalid value passed to `setLogLevel`")}}function m(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(p.logLevel<=s.LogLevel.DEBUG){var i=n.map(g);p.debug.apply(p,a.__spreadArrays(["Firestore ("+h+") ["+t+"]: "+e],i))}}function y(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(p.logLevel<=s.LogLevel.ERROR){var r=e.map(g);p.error.apply(p,a.__spreadArrays(["Firestore ("+h+"): "+t],r))}}function g(t){if("string"===typeof t)return t;var e=b.getPlatform();try{return e.formatJSON(t)}catch(n){return t}}function v(t){var e="FIRESTORE ("+h+") INTERNAL ASSERTION FAILED: "+t;throw y(e),new Error(e)}function _(t,e){t||v(e)}!function(t){t[t.DEBUG=0]="DEBUG",t[t.ERROR=1]="ERROR",t[t.SILENT=2]="SILENT"}(i||(i={}));var b=function(){function t(){}return t.setPlatform=function(e){t.platform&&v("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||v("Platform not set"),t.platform},t}();function w(){return b.getPlatform().emptyByteString}var x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},E=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return a.__extends(e,t),e}(Error);function T(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new E(x.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function C(t,e){return void 0!==t?t:e}function I(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function k(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function A(t){for(var e in _(null!=t&&"object"===typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function O(t,e){if(0!==e.length)throw new E(x.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+X(e.length,"argument")+".")}function P(t,e,n){if(e.length!==n)throw new E(x.INVALID_ARGUMENT,"Function "+t+"() requires "+X(n,"argument")+", but was called with "+X(e.length,"argument")+".")}function D(t,e,n){if(e.length<n)throw new E(x.INVALID_ARGUMENT,"Function "+t+"() requires at least "+X(n,"argument")+", but was called with "+X(e.length,"argument")+".")}function M(t,e,n,r){if(e.length<n||e.length>r)throw new E(x.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+X(e.length,"argument")+".")}function R(t,e,n,r){U(t,e,Q(n)+" argument",r)}function N(t,e,n,r){void 0!==r&&R(t,e,n,r)}function L(t,e,n,r){U(t,e,n+" option",r)}function F(t,e,n,r){void 0!==r&&L(t,e,n,r)}function j(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new E(x.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+q(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new E(x.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+q(r[o]))}(t,e,n,r,i)}function z(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(q(u))}var c=q(r);throw new E(x.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function B(t,e,n,r){if(!e.some((function(t){return t===r})))throw new E(x.INVALID_ARGUMENT,"Invalid value "+q(r)+" provided to function "+t+"() for its "+Q(n)+" argument. Acceptable values: "+e.join(", "))}function U(t,e,n,r){if(!("object"===e?V(r):"non-empty string"===e?"string"===typeof r&&""!==r:typeof r===e)){var i=q(r);throw new E(x.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function V(t){return"object"===typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function q(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"===typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"===typeof t||"boolean"===typeof t)return""+t;if("object"===typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"===typeof t?"a function":v("Unknown wrong type: "+typeof t)}function W(t,e,n){if(void 0===n)throw new E(x.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Q(e)+" argument, but it was undefined.")}function G(t,e,n){k(e,(function(e,r){if(n.indexOf(e)<0)throw new E(x.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function H(t,e,n,r){var i=q(r);return new E(x.INVALID_ARGUMENT,"Function "+t+"() requires its "+Q(n)+" argument to be a "+e+", but it was: "+i)}function K(t,e,n){if(n<=0)throw new E(x.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+Q(e)+" argument to be a positive number, but it was: "+n+".")}function Q(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function X(t,e){return t+" "+e+(1===t?"":"s")}var Y=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return _(20===e.length,"Invalid auto ID: "+e),e},t}();function Z(t,e){return t<e?-1:t>e?1:0}function J(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function $(t){return t+"\0"}function tt(){if("undefined"===typeof Uint8Array)throw new E(x.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function et(){if(!b.getPlatform().base64Available)throw new E(x.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var nt,rt=function(){function t(t){et(),this._binaryString=t}return t.fromBase64String=function(e){P("Blob.fromBase64String",arguments,1),R("Blob.fromBase64String","string",1,e),et();try{var n=b.getPlatform().atob(e);return new t(n)}catch(r){throw new E(x.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+r)}},t.fromUint8Array=function(e){if(P("Blob.fromUint8Array",arguments,1),tt(),!(e instanceof Uint8Array))throw H("Blob.fromUint8Array","Uint8Array",1,e);var n=Array.prototype.map.call(e,(function(t){return String.fromCharCode(t)})).join("");return new t(n)},t.prototype.toBase64=function(){return P("Blob.toBase64",arguments,0),et(),b.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){P("Blob.toUint8Array",arguments,0),tt();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return Z(this._binaryString,t._binaryString)},t}(),it=T(rt,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),ot=function(t,e,n,r,i){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},at="(default)",st=function(){function t(t,e){this.projectId=t,this.database=e||at}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===at},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return Z(this.projectId,t.projectId)||Z(this.database,t.database)},t}(),ut=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}return t.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},t.INVALID=-1,t}(),ct=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&v("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&v("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,_(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return _(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return _(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return _(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new E(x.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter((function(t){return t.length>0})))},e.EMPTY_PATH=new e([]),e}(ct),ht=/^[_a-zA-Z][_a-zA-Z0-9]*$/,pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return ht.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new E(x.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new E(x.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new E(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new E(x.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(ct),ft=function(){function t(e){this.path=e,_(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===lt.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return lt.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2===0},t.fromSegments=function(e){return new t(new lt(e.slice()))},t.fromPathString=function(e){return new t(lt.fromString(e))},t.EMPTY=new t(new lt([])),t}(),dt=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))};!function(t){t.All="all",t.ListenStreamIdle="listen_stream_idle",t.ListenStreamConnectionBackoff="listen_stream_connection_backoff",t.WriteStreamIdle="write_stream_idle",t.WriteStreamConnectionBackoff="write_stream_connection_backoff",t.OnlineStateTimeout="online_state_timeout",t.ClientMetadataRefresh="client_metadata_refresh",t.LruGarbageCollection="lru_garbage_collection",t.RetryTransaction="retry_transaction"}(nt||(nt={}));var mt=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new dt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new E(x.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),yt=function(){function t(){this.tail=Promise.resolve(),this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[]}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!0,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenAfterShutdown=function(t){this.verifyNotFailed(),this.enqueueInternal(t)},t.prototype.enqueueEvenAfterShutdown=function(t){return this.verifyNotFailed(),this.enqueueInternal(t)},t.prototype.enqueueAndInitiateShutdown=function(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.verifyNotFailed(),this._isShuttingDown?[3,2]:(this._isShuttingDown=!0,[4,this.enqueueEvenAfterShutdown(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.enqueue=function(t){return this.verifyNotFailed(),this._isShuttingDown?new Promise((function(t){})):this.enqueueInternal(t)},t.prototype.enqueueInternal=function(t){var e=this,n=this.tail.then((function(){return e.operationInProgress=!0,t().catch((function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw y("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout((function(){throw t}),0),t})).then((function(t){return e.operationInProgress=!1,t}))}));return this.tail=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),_(e>=0,"Attempted to schedule an operation with a negative delay of "+e),this.timerIdsToSkip.indexOf(t)>-1&&(e=0);var i=mt.createAndSchedule(this,t,e,n,(function(t){return r.removeDelayedOperation(t)}));return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&v("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){_(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueueEvenAfterShutdown((function(){return Promise.resolve()}))},t.prototype.containsDelayedOperation=function(t){for(var e=0,n=this.delayedOperations;e<n.length;e++){if(n[e].timerId===t)return!0}return!1},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then((function(){_(t===nt.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==nt.All&&i.timerId===t)break}return e.drain()}))},t.prototype.skipDelaysForTimerId=function(t){this.timerIdsToSkip.push(t)},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);_(e>=0,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),gt="\x01",vt="\x01",_t="\x10",bt="\x11";function wt(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Et(e)),e=xt(t.get(n),e);return Et(e)}function xt(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=gt+_t;break;case gt:n+=gt+bt;break;default:n+=o}}return n}function Et(t){return t+gt+vt}function Tt(t){var e=t.length;if(_(e>=2,"Invalid path "+t),2===e)return _(t.charAt(0)===gt&&t.charAt(1)===vt,"Non-empty path "+t+" had length 2"),lt.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(gt,o);switch((a<0||a>n)&&v('Invalid encoded resource path: "'+t+'"'),t.charAt(a+1)){case vt:var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case _t:i+=t.substring(o,a),i+="\0";break;case bt:i+=t.substring(o,a+1);break;default:v('Invalid encoded resource path: "'+t+'"')}o=a+2}return new lt(r)}var St=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new E(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new E(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new E(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new E(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Z(this.nanoseconds,t.nanoseconds):Z(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),Ct=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new St(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new St(0,0)),t}(),It=function(){function t(t,e){this.comparator=t,this.root=e||At.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,At.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,At.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new kt(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new kt(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new kt(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new kt(this.root,t,this.comparator,!0)},t}(),kt=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){_(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),At=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw v("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw v("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw v("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),Ot=function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw v("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw v("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw v("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw v("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw v("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new At(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();At.EMPTY=new Ot;var Pt=function(){function t(t){this.comparator=t,this.data=new It(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach((function(t){n=n.add(t)})),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();){if(!t(n.getNext().key))return}},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Dt(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Dt(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Dt=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Mt=new It(ft.comparator);function Rt(){return Mt}function Nt(){return Rt()}var Lt=new It(ft.comparator);function Ft(){return Lt}var jt=new It(ft.comparator);function zt(){return jt}var Bt=new Pt(ft.comparator);function Ut(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Bt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Vt=new Pt(Z);function qt(){return Vt}var Wt=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r,_(r.length>0,"Cannot create an empty mutation batch")}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&_(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;_(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&_(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++){(s=r[n]).key.isEqual(t)&&(e=s.applyToLocalView(e,e,this.localWriteTime))}for(var i=e,o=0,a=this.mutations;o<a.length;o++){var s;(s=a[o]).key.isEqual(t)&&(e=s.applyToLocalView(e,i,this.localWriteTime))}return e},t.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Ut())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&J(this.mutations,t.mutations)&&J(this.baseMutations,t.baseMutations)},t}(),Gt=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){_(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=zt(),a=e.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new t(e,n,r,i,o)},t}(),Ht=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&v("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(r){return t.reject(r)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++){r(o[i])}return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),Kt="SimpleDb",Qt=function(){function e(t){this.db=t,12.2===e.getIOSVersion(u.getUA())&&y("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.openOrCreate=function(t,n,r){return _(e.isAvailable(),"IndexedDB not supported in current environment."),m(Kt,"Opening database:",t),new Ht((function(i,o){var a=window.indexedDB.open(t,n);a.onsuccess=function(t){var n=t.target.result;i(new e(n))},a.onblocked=function(){o(new E(x.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new E(x.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},a.onupgradeneeded=function(e){m(Kt,'Database "'+t+'" requires upgrade from version:',e.oldVersion);var n=e.target.result;r.createOrUpgrade(n,a.transaction,e.oldVersion,rn).next((function(){m(Kt,"Database upgrade to version "+rn+" complete")}))}})).toPromise()},e.delete=function(t){return m(Kt,"Removing database:",t),Jt(window.indexedDB.deleteDatabase(t)).toPromise()},e.isAvailable=function(){if("undefined"===typeof window||null==window.indexedDB)return!1;if(e.isMockPersistence())return!0;if(void 0===window.navigator)return!1;var t=u.getUA(),n=e.getIOSVersion(t),r=0<n&&n<10,i=e.getAndroidVersion(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.isMockPersistence=function(){var e;return"undefined"!==typeof t&&"YES"===(null===(e=Object({NODE_ENV:"production",PUBLIC_URL:""}))||void 0===e?void 0:e.USE_MOCK_PERSISTENCE)},e.getStore=function(t,e){return t.store(e)},e.getIOSVersion=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.getAndroidVersion=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.setVersionChangeListener=function(t){this.db.onversionchange=function(e){return t(e)}},e.prototype.runTransaction=function(t,e,n){return a.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,u,c;return a.__generator(this,(function(l){switch(l.label){case 0:r=t.startsWith("readonly"),i=t.endsWith("idempotent"),o=0,s=function(){var t,s,c,l;return a.__generator(this,(function(a){switch(a.label){case 0:++o,t=Yt.open(u.db,r?"readonly":"readwrite",e),a.label=1;case 1:return a.trys.push([1,3,,4]),(s=n(t).catch((function(e){return t.abort(e),Ht.reject(e)})).toPromise()).catch((function(){})),[4,t.completionPromise];case 2:return a.sent(),[2,{value:s}];case 3:return c=a.sent(),l=i&&"FirebaseError"!==c.name&&o<3,m(Kt,"Transaction failed with error: %s. Retrying: %s.",c.message,l),l?[3,4]:[2,{value:Promise.reject(c)}];case 4:return[2]}}))},u=this,l.label=1;case 1:return[5,s()];case 2:return"object"===typeof(c=l.sent())?[2,c.value]:[3,1];case 3:return[2]}}))}))},e.prototype.close=function(){this.db.close()},e}(),Xt=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return Jt(this.dbCursor.delete())},t}(),Yt=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new dt,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){var n=te(t.target.error);e.completionDeferred.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(m(Kt,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return _(!!e,"Object store not part of transaction: "+t),new Zt(e)},t}(),Zt=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(m(Kt,"PUT",this.store.name,t,e),n=this.store.put(e,t)):(m(Kt,"PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Jt(n)},t.prototype.add=function(t){return m(Kt,"ADD",this.store.name,t,t),Jt(this.store.add(t))},t.prototype.get=function(t){var e=this;return Jt(this.store.get(t)).next((function(n){return void 0===n&&(n=null),m(Kt,"GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return m(Kt,"DELETE",this.store.name,t),Jt(this.store.delete(t))},t.prototype.count=function(){return m(Kt,"COUNT",this.store.name),Jt(this.store.count())},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.deleteAll=function(t,e){m(Kt,"DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,(function(t,e,n){return n.delete()}))},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateSerial=function(t){var e=this.cursor({});return new Ht((function(n,r){e.onerror=function(t){var e=te(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.iterateCursor=function(t,e){var n=[];return new Ht((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Xt(i),a=e(i.primaryKey,i.value,o);if(a instanceof Ht){var s=a.catch((function(t){return o.done(),Ht.reject(t)}));n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}})).next((function(){return Ht.waitFor(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"===typeof t?n=t:(_(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Jt(t){return new Ht((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=te(t.target.error);n(e)}}))}var $t=!1;function te(t){var e=Qt.getIOSVersion(u.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new E("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return $t||($t=!0,setTimeout((function(){throw r}),0)),r}}return t}var ee=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return t.forUser=function(e,n,r,i){return _(""!==e.uid,"UserID must not be an empty string."),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return oe(t).iterate({index:cn.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next((function(e){return e.lastStreamToken=ie(n),se(t).put(e)}))},t.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next((function(t){return t.lastStreamToken}))},t.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next((function(n){return n.lastStreamToken=ie(e),se(t).put(n)}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=ae(t),a=oe(t);return a.add({}).next((function(s){_("number"===typeof s,"Auto-generated key is not a number");for(var u=new Wt(s,e,n,r),c=i.serializer.toDbMutationBatch(i.userId,u),l=[],h=new Pt((function(t,e){return Z(t.canonicalString(),e.canonicalString())})),p=0,f=r;p<f.length;p++){var d=f[p],m=ln.key(i.userId,d.key.path,s);h=h.add(d.key.path.popLast()),l.push(a.put(c)),l.push(o.put(m,ln.PLACEHOLDER))}return h.forEach((function(e){l.push(i.indexManager.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.documentKeysByBatchId[s]=u.keys()})),Ht.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return oe(t).get(e).next((function(t){return t?(_(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.fromDbMutationBatch(t)):null}))},t.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?Ht.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return oe(t).iterate({index:cn.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(_(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return oe(t).iterate({index:cn.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return oe(t).loadAll(cn.userMutationsIndex,n).next((function(t){return t.map((function(t){return e.serializer.fromDbMutationBatch(t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=ln.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return ae(t).iterate({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],l=Tt(u);if(s===n.userId&&e.path.isEqual(l))return oe(t).get(c).next((function(t){if(!t)throw v("Dangling document-mutation reference found: "+r+" which points to "+c);_(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+c),o.push(n.serializer.fromDbMutationBatch(t))}));a.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Pt(Z),i=[];return e.forEach((function(e){var o=ln.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=ae(t).iterate({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=Tt(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),Ht.waitFor(i).next((function(){return n.lookupMutationBatches(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;_(!e.isDocumentQuery(),"Document queries shouldn't go down this path"),_(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=e.path,i=r.length+1,o=ln.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Pt(Z);return ae(t).iterate({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],l=Tt(u);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.lookupMutationBatches(t,s)}))},t.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(oe(t).get(e).next((function(t){if(null===t)throw v("Dangling document-mutation reference found, which points to "+e);_(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.fromDbMutationBatch(t))})))})),Ht.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return re(t.simpleDbTransaction,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.removeCachedMutationKeys(e.batchId)})),Ht.forEach(r,(function(e){return n.referenceDelegate.removeMutationReference(t,e)}))}))},t.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Ht.resolve();var r=IDBKeyRange.lowerBound(ln.prefixForUser(e.userId)),i=[];return ae(t).iterate({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Tt(t[1]);i.push(o)}else r.done()})).next((function(){_(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map((function(t){return t.canonicalString()})))}))}))},t.prototype.containsKey=function(t,e){return ne(t,this.userId,e)},t.prototype.getMutationQueueMetadata=function(t){var e=this;return se(t).get(this.userId).next((function(t){return t||new un(e.userId,-1,"")}))},t}();function ne(t,e,n){var r=ln.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return ae(t).iterate({range:o,keysOnly:!0},(function(t,n,r){var o=t[0],s=t[1];t[2];o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function re(t,e,n){var r=t.store(cn.store),i=t.store(ln.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){_(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var p=h[l],f=ln.key(e,p.key.path,n.batchId);o.push(i.delete(f)),c.push(p.key)}return Ht.waitFor(o).next((function(){return c}))}function ie(t){return t instanceof Uint8Array?(_(Qt.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence."),t.toString()):t}function oe(t){return Un.getStore(t,cn.store)}function ae(t){return Un.getStore(t,ln.store)}function se(t){return Un.getStore(t,un.store)}var ue,ce=1;!function(t){t[t.QueryCache=0]="QueryCache",t[t.SyncEngine=1]="SyncEngine"}(ue||(ue={}));var le=function(){function t(t,e){this.generatorId=t,_((t&ce)===t,"Generator ID "+t+" contains more than "+ce+" reserved bits"),this.seek(void 0!==e?e:this.generatorId)}return t.prototype.next=function(){var t=this.nextId;return this.nextId+=1<<ce,t},t.prototype.after=function(t){return this.seek(t+(1<<ce)),this.next()},t.prototype.seek=function(t){_((t&ce)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=t},t.forTargetCache=function(){return new t(ue.QueryCache,2)},t.forSyncEngine=function(){return new t(ue.SyncEngine)},t}(),he=function(){function t(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=le.forTargetCache()}return t.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next((function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next((function(t){return Ct.fromTimestamp(new St(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return de(t.simpleDbTransaction)},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.saveTargetData(t,e).next((function(){return n.retrieveMetadata(t).next((function(r){return r.targetCount+=1,n.updateMetadataFromTargetData(e,r),n.saveMetadata(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.saveTargetData(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return pe(t).delete(e.targetId)})).next((function(){return n.retrieveMetadata(t)})).next((function(e){return _(e.targetCount>0,"Removing from an empty target cache"),e.targetCount-=1,n.saveMetadata(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return pe(t).iterate((function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Ht.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){var n=this;return pe(t).iterate((function(t,r){var i=n.serializer.fromDbTarget(r);e(i)}))},t.prototype.retrieveMetadata=function(t){return fe(t.simpleDbTransaction)},t.prototype.saveMetadata=function(t,e){return(n=t,Un.getStore(n,gn.store)).put(gn.key,e);var n},t.prototype.saveTargetData=function(t,e){return pe(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromTargetData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.retrieveMetadata(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return pe(t).iterate({range:i,index:mn.queryTargetsIndexName},(function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.target)&&(o=a,i.done())})).next((function(){return o}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=me(t);return e.forEach((function(e){var a=wt(e.path);i.push(o.put(new yn(n,a))),i.push(r.referenceDelegate.addReference(t,e))})),Ht.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=me(t);return Ht.forEach(e,(function(e){var o=wt(e.path);return Ht.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=me(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=me(t),i=Ut();return r.iterate({range:n,keysOnly:!0},(function(t,e,n){var r=Tt(t[1]),o=new ft(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=wt(e.path),r=IDBKeyRange.bound([n],[$(n)],!1,!0),i=0;return me(t).iterate({index:yn.documentTargetsIndex,keysOnly:!0,range:r},(function(t,e,n){var r=t[0];t[1];0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.getTargetDataForTarget=function(t,e){var n=this;return pe(t).get(e).next((function(t){return t?n.serializer.fromDbTarget(t):null}))},t}();function pe(t){return Un.getStore(t,mn.store)}function fe(t){return Qt.getStore(t,gn.store).get(gn.key).next((function(t){return _(null!==t,"Missing metadata row."),t}))}function de(t){return fe(t).next((function(t){return t.highestListenSequenceNumber}))}function me(t){return Un.getStore(t,yn.store)}var ye,ge=function(){function t(t){this.fields=t}return t.fromSet=function(e){return new t(e)},t.fromArray=function(e){var n=new Pt(pt.comparator);return e.forEach((function(t){return n=n.add(t)})),new t(n)},t.prototype.covers=function(t){var e=!1;return this.fields.forEach((function(n){n.isPrefixOf(t)&&(e=!0)})),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),ve=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),_e=function(t,e){this.version=t,this.transformResults=e};!function(t){t[t.Set=0]="Set",t[t.Patch=1]="Patch",t[t.Transform=2]="Transform",t[t.Delete=3]="Delete"}(ye||(ye={}));var be,we,xe=function(){function t(t,e){this.updateTime=t,this.exists=e,_(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof Ge&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof Ge:(_(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,(null!==e&&void 0!==e?!(!n||!e.isEqual(n)):e===n)&&this.exists===t.exists;var e,n},t.NONE=new t,t}(),Ee=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&_(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof Ge?t.version:Ct.MIN},t}(),Te=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=ye.Set,i}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),_(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new Ge(this.key,n,{hasCommittedMutations:!0},this.value)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Ee.getPostMutationVersion(t);return new Ge(this.key,r,{hasLocalMutations:!0},this.value)},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(Ee),Se=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=ye.Patch,o}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),_(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return new Ke(this.key,e.version);var n=this.patchDocument(t);return new Ge(this.key,e.version,{hasCommittedMutations:!0},n)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Ee.getPostMutationVersion(t),i=this.patchDocument(t);return new Ge(this.key,r,{hasLocalMutations:!0},i)},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof Ge?t.data():Ve.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t=null!==r?t.set(n,r):t.delete(n)}})),t},e}(Ee),Ce=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=ye.Transform,r.precondition=xe.exists(!0),r}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),_(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return new Ke(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data(),r);return new Ge(this.key,i,{hasCommittedMutations:!0},o)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,t,e),o=this.transformObject(r.data(),i);return new Ge(this.key,r.version,{hasLocalMutations:!0},o)},e.prototype.extractBaseValue=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Ge?t.field(i.field):void 0,a=i.transform.computeBaseValue(o||null);null!=a&&(e=null==e?Ve.EMPTY.set(i.field,a):e.set(i.field,a))}return e},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&J(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){return _(t instanceof Ge,"Unknown MaybeDocument type "+t),_(t.key.isEqual(this.key),"Can only transform a document with the same key"),t},e.prototype.serverTransformResults=function(t,e){var n=[];_(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;t instanceof Ge&&(a=t.field(i.field)),n.push(o.applyToRemoteDocument(a,e[r]))}return n},e.prototype.localTransformResults=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var a=o[i],s=a.transform,u=null;e instanceof Ge&&(u=e.field(a.field)),null===u&&n instanceof Ge&&(u=n.field(a.field)),r.push(s.applyToLocalView(u,t))}return r},e.prototype.transformObject=function(t,e){_(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;t=t.set(r,e[n])}return t},e}(Ee),Ie=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=ye.Delete,r}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),_(null==e.transformResults,"Transform results received by DeleteMutation."),new He(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&_(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new He(this.key,Ct.forDeletedDoc())):t},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(Ee);!function(t){t[t.NullValue=0]="NullValue",t[t.BooleanValue=1]="BooleanValue",t[t.NumberValue=2]="NumberValue",t[t.TimestampValue=3]="TimestampValue",t[t.StringValue=4]="StringValue",t[t.BlobValue=5]="BlobValue",t[t.RefValue=6]="RefValue",t[t.GeoPointValue=7]="GeoPointValue",t[t.ArrayValue=8]="ArrayValue",t[t.ObjectValue=9]="ObjectValue"}(be||(be={})),function(t){t[t.Default=0]="Default",t[t.Estimate=1]="Estimate",t[t.Previous=2]="Previous"}(we||(we={}));var ke=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(we.Estimate,n);case"previous":return new t(we.Previous,n);case"none":case void 0:return new t(we.Default,n);default:return v("fromSnapshotOptions() called with invalid options.")}},t}(),Ae=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){return _(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),Z(this.typeOrder,t.typeOrder)},t}(),Oe=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=be.NullValue,e.internalValue=null,e}return a.__extends(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(Ae),Pe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.BooleanValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?Z(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(Ae),De=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.NumberValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?(n=this.internalValue,r=t.internalValue,n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1):this.defaultCompareTo(t);var n,r},e}(Ae);function Me(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}var Re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Me(this.internalValue,t.internalValue)},e}(De),Ne=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Me(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(De),Le=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.StringValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?Z(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Ae),Fe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.TimestampValue,n}return a.__extends(e,t),e.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof je?-1:this.defaultCompareTo(t)},e}(Ae),je=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=be.TimestampValue,r}return a.__extends(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===we.Estimate?new Fe(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===we.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof Fe?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(Ae),ze=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.BlobValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Ae),Be=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=be.RefValue,r}return a.__extends(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&(this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId))},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:ft.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(Ae),Ue=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.GeoPointValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Ae),Ve=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.ObjectValue,n}return a.__extends(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal((function(n,r){e[n]=r.value(t)})),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=Z(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return Z(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(_(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(_(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return null!==this.field(t)},e.prototype.field=function(t){_(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach((function(t){n=n instanceof e?n.internalValue.get(t):null})),n},e.prototype.fieldMask=function(){var t=new Pt(pt.comparator);return this.internalValue.forEach((function(n,r){var i=new pt([n]);if(r instanceof e){var o=r.fieldMask().fields;o.isEmpty()?t=t.add(i):o.forEach((function(e){t=t.add(i.child(e))}))}else t=t.add(i)})),ge.fromSet(t)},e.prototype.toString=function(){return this.internalValue.toString()},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new It(Z)),e}(Ae),qe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.ArrayValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue.map((function(e){return e.value(t)}))},e.prototype.contains=function(t){for(var e=0,n=this.internalValue;e<n.length;e++){if(n[e].isEqual(t))return!0}return!1},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return Z(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return"["+this.internalValue.map((function(t){return t.toString()})).join(",")+"]"},e}(Ae),We=function(){function t(t,e){this.key=t,this.version=e}return t.compareByKey=function(t,e){return ft.comparator(t.key,e.key)},t}(),Ge=function(t){function e(e,n,r,i,o,a){var s=t.call(this,e,n)||this;return s.objectValue=i,s.proto=o,s.converter=a,_(void 0!==s.objectValue||void 0!==s.proto&&void 0!==s.converter,"If objectValue is not defined, proto and converter need to be set."),s.hasLocalMutations=!!r.hasLocalMutations,s.hasCommittedMutations=!!r.hasCommittedMutations,s}return a.__extends(e,t),e.prototype.field=function(t){if(this.objectValue)return this.objectValue.field(t);this.fieldValueCache||(this.fieldValueCache=new Map);var e=t.canonicalString(),n=this.fieldValueCache.get(e);if(void 0===n){var r=this.getProtoField(t);n=void 0===r?null:this.converter(r),this.fieldValueCache.set(e,n)}return n},e.prototype.data=function(){var t=this;if(!this.objectValue){var e=Ve.EMPTY;k(this.proto.fields||{},(function(n,r){e=e.set(new pt([n]),t.converter(r))})),this.objectValue=e,this.fieldValueCache=void 0}return this.objectValue},e.prototype.value=function(){return this.data().value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations&&this.data().isEqual(t.data())},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.getProtoField=function(t){_(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var e=this.proto.fields?this.proto.fields[t.firstSegment()]:void 0,n=1;n<t.length;++n){if(!e||!e.mapValue||!e.mapValue.fields)return;e=e.mapValue.fields[t.get(n)]}return e},e.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?r.compareTo(i):v("Trying to compare documents on fields that don't exist")},e}(We),He=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return a.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(We),Ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(We),Qe=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){k(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},t.prototype.isEmpty=function(){return A(this.inner)},t}(),Xe=function(){function t(){this.changes=new Qe((function(t){return t.toString()})),this.changesApplied=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return _(void 0!==this._readTime,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this._readTime},set:function(t){_(void 0===this._readTime||this._readTime.isEqual(t),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this._readTime=t},enumerable:!0,configurable:!0}),t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.readTime=e,this.changes.set(t.key,t)},t.prototype.removeEntry=function(t,e){this.assertNotApplied(),e&&(this.readTime=e),this.changes.set(t,null)},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Ht.resolve(n):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){_(!this.changesApplied,"Changes have already been applied.")},t}(),Ye=function(){function t(t,e){this.serializer=t,this.indexManager=e}return t.prototype.addEntry=function(t,e,n){return Je(t).put($e(e),n)},t.prototype.removeEntry=function(t,e){var n=Je(t),r=$e(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.setMetadata(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return Je(t).get($e(e)).next((function(t){return n.maybeDecodeDocument(t)}))},t.prototype.getSizedEntry=function(t,e){var n=this;return Je(t).get($e(e)).next((function(t){var e=n.maybeDecodeDocument(t);return e?{maybeDocument:e,size:tn(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Nt();return this.forEachDbEntry(t,e,(function(t,e){var i=n.maybeDecodeDocument(e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.getSizedEntries=function(t,e){var n=this,r=Nt(),i=new It(ft.comparator);return this.forEachDbEntry(t,e,(function(t,e){var o=n.maybeDecodeDocument(e);o?(r=r.insert(t,o),i=i.insert(t,tn(e))):(r=r.insert(t,null),i=i.insert(t,0))})).next((function(){return{maybeDocuments:r,sizeMap:i}}))},t.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return Ht.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Je(t).iterate({range:r},(function(t,e,r){for(var a=ft.fromSegments(t);o&&ft.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this;_(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var i=Ft(),o=e.path.length+1,a={};if(n.isEqual(Ct.MIN)){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=this.serializer.toDbTimestampKey(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=fn.collectionReadTimeIndex}return Je(t).iterate(a,(function(t,n,a){if(t.length===o){var s=r.serializer.fromDbRemoteDocument(n);e.path.isPrefixOf(s.key.path)?s instanceof Ge&&e.matches(s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.getNewDocumentChanges=function(t,e){var n=this,r=Rt(),i=this.serializer.toDbTimestampKey(e),o=Je(t),a=IDBKeyRange.lowerBound(i,!0);return o.iterate({index:fn.readTimeIndex,range:a},(function(t,e){var o=n.serializer.fromDbRemoteDocument(e);r=r.insert(o.key,o),i=e.readTime})).next((function(){return{changedDocs:r,readTime:n.serializer.fromDbTimestampKey(i)}}))},t.prototype.getLastDocumentChange=function(t){var e,n=this,r=Je(t),i=Ct.MIN;return r.iterate({index:fn.readTimeIndex,reverse:!0},(function(t,r,o){e=n.serializer.fromDbRemoteDocument(r),r.readTime&&(i=n.serializer.fromDbTimestampKey(r.readTime)),o.done()})).next((function(){return{changedDoc:e,readTime:i}}))},t.prototype.newChangeBuffer=function(e){return new t.RemoteDocumentChangeBuffer(this,!!e&&e.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Ze(t).get(dn.key).next((function(t){return _(!!t,"Missing document cache metadata"),t}))},t.prototype.setMetadata=function(t,e){return Ze(t).put(dn.key,e)},t.prototype.maybeDecodeDocument=function(t){if(t){var e=this.serializer.fromDbRemoteDocument(t);return e instanceof He&&e.version.isEqual(Ct.forDeletedDoc())?null:e}return null},t.RemoteDocumentChangeBuffer=function(t){function e(e,n){var r=t.call(this)||this;return r.documentCache=e,r.trackRemovals=n,r.documentSizes=new Qe((function(t){return t.toString()})),r}return a.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Pt((function(t,e){return Z(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.documentSizes.get(o);if(_(void 0!==s,"Cannot modify a document that wasn't read (for "+o+")"),a){_(!e.readTime.isEqual(Ct.MIN),"Cannot add a document with a read time of zero");var u=e.documentCache.serializer.toDbRemoteDocument(a,e.readTime);i=i.add(o.path.popLast());var c=tn(u);r+=c-s,n.push(e.documentCache.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var l=e.documentCache.serializer.toDbRemoteDocument(new He(o,Ct.forDeletedDoc()),e.readTime);n.push(e.documentCache.addEntry(t,o,l))}else n.push(e.documentCache.removeEntry(t,o))})),i.forEach((function(r){n.push(e.documentCache.indexManager.addToCollectionParentIndex(t,r))})),n.push(this.documentCache.updateMetadata(t,r)),Ht.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntry(t,e).next((function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntries(t,e).next((function(t){var e=t.maybeDocuments;return t.sizeMap.forEach((function(t,e){n.documentSizes.set(t,e)})),e}))},e}(Xe),t}();function Ze(t){return Un.getStore(t,dn.store)}function Je(t){return Un.getStore(t,fn.store)}function $e(t){return t.path.toArray()}function tn(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw v("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}var en=function(){function t(){this.collectionParentIndex=new nn}return t.prototype.addToCollectionParentIndex=function(t,e){return this.collectionParentIndex.add(e),Ht.resolve()},t.prototype.getCollectionParents=function(t,e){return Ht.resolve(this.collectionParentIndex.getEntries(e))},t}(),nn=function(){function t(){this.index={}}return t.prototype.add=function(t){_(t.length%2===1,"Expected a collection path.");var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Pt(lt.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Pt(lt.comparator)).toArray()},t}(),rn=9,on=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;_(n<r&&n>=0&&r<=rn,"Unexpected schema upgrade from v"+n+" to v{toVersion}.");var o=new Yt(e);n<1&&r>=1&&(function(t){t.createObjectStore(sn.store)}(t),function(t){t.createObjectStore(un.store,{keyPath:un.keyPath}),t.createObjectStore(cn.store,{keyPath:cn.keyPath,autoIncrement:!0}).createIndex(cn.userMutationsIndex,cn.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ln.store)}(t),_n(t),function(t){t.createObjectStore(fn.store)}(t));var a=Ht.resolve();return n<3&&r>=3&&(0!==n&&(!function(t){t.deleteObjectStore(yn.store),t.deleteObjectStore(mn.store),t.deleteObjectStore(gn.store)}(t),_n(t)),a=a.next((function(){return function(t){var e=t.store(gn.store),n=new gn(0,0,Ct.MIN.toTimestamp(),0);return e.put(gn.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(cn.store).loadAll().next((function(n){t.deleteObjectStore(cn.store),t.createObjectStore(cn.store,{keyPath:cn.keyPath,autoIncrement:!0}).createIndex(cn.userMutationsIndex,cn.userMutationsKeyPath,{unique:!0});var r=e.store(cn.store),i=n.map((function(t){return r.put(t)}));return Ht.waitFor(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(bn.store,{keyPath:bn.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(dn.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(fn.store);e.createIndex(fn.readTimeIndex,fn.readTimeIndexPath,{unique:!1}),e.createIndex(fn.collectionReadTimeIndex,fn.collectionReadTimeIndexPath,{unique:!1})}(e)}))),a},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(fn.store).iterate((function(t,n){e+=tn(n)})).next((function(){var n=new dn(e);return t.store(dn.store).put(dn.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(un.store),r=t.store(cn.store);return n.loadAll().next((function(n){return Ht.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(cn.userMutationsIndex,i).next((function(r){return Ht.forEach(r,(function(r){_(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.fromDbMutationBatch(r);return re(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(yn.store),n=t.store(fn.store);return de(t).next((function(t){var r=[];return n.iterate((function(n,i){var o=new lt(n),a=function(t){return[0,wt(t)]}(o);r.push(e.get(a).next((function(n){return n?Ht.resolve():function(n){return e.put(new yn(0,wt(n),t))}(o)})))})).next((function(){return Ht.waitFor(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(vn.store,{keyPath:vn.keyPath});var n=e.store(vn.store),r=new nn,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:wt(i)})}};return e.store(fn.store).iterate({keysOnly:!0},(function(t,e){var n=new lt(t);return i(n.popLast())})).next((function(){return e.store(ln.store).iterate({keysOnly:!0},(function(t,e){t[0];var n=t[1],r=(t[2],Tt(n));return i(r.popLast())}))}))},t}();var an=function(t,e){this.seconds=t,this.nanoseconds=e},sn=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}();var un=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),cn=function(){function t(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}();var ln=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,wt(e)]},t.key=function(t,e,n){return[t,wt(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}();var hn=function(t,e){this.path=t,this.readTime=e},pn=function(t,e){this.path=t,this.version=e},fn=function(){function t(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o}return t.store="remoteDocuments",t.readTimeIndex="readTimeIndex",t.readTimeIndexPath="readTime",t.collectionReadTimeIndex="collectionReadTimeIndex",t.collectionReadTimeIndexPath=["parentPath","readTime"],t}(),dn=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}();var mn=function(){function t(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),yn=function(){function t(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n,_(0===t===(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),gn=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),vn=function(){function t(t,e){this.collectionId=t,this.parent=e}return t.store="collectionParents",t.keyPath=["collectionId","parent"],t}();function _n(t){t.createObjectStore(yn.store,{keyPath:yn.keyPath}).createIndex(yn.documentTargetsIndex,yn.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(mn.store,{keyPath:mn.keyPath}).createIndex(mn.queryTargetsIndexName,mn.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(gn.store)}var bn=function(){function t(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}return t.store="clientMetadata",t.keyPath="clientId",t}();var wn,xn=[un.store,cn.store,ln.store,fn.store,mn.store,sn.store,gn.store,yn.store],En=a.__spreadArrays(xn,[bn.store]),Tn=a.__spreadArrays(En,[dn.store]),Sn=a.__spreadArrays(Tn,[vn.store]),Cn=function(){function t(){this.collectionParentsCache=new nn}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(_(e.length%2===1,"Expected a collection path."),!this.collectionParentsCache.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.collectionParentsCache.add(e)}));var o={collectionId:r,parent:wt(i)};return In(t).put(o)}return Ht.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[$(e),""],!1,!0);return In(t).loadAll(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Tt(o.parent))}return n}))},t}();function In(t){return Un.getStore(t,vn.store)}!function(t){t[t.Listen=0]="Listen",t[t.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",t[t.LimboResolution=2]="LimboResolution"}(wn||(wn={}));var kn=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=Ct.MIN),void 0===o&&(o=Ct.MIN),void 0===a&&(a=w()),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.lastLimboFreeSnapshotVersion.isEqual(t.lastLimboFreeSnapshotVersion)&&this.resumeToken===t.resumeToken&&this.target.isEqual(t.target)},t}(),An=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=ft.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new He(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){e=ft.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version);return new Ke(e,n)}return v("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t,e){var n=this.toDbTimestampKey(e),r=t.key.path.popLast().toArray();if(t instanceof Ge){var i=t.proto?t.proto:this.remoteSerializer.toDocument(t),o=t.hasCommittedMutations;return new fn(null,null,i,o,n,r)}if(t instanceof He){var a=t.key.path.toArray(),s=this.toDbTimestamp(t.version);o=t.hasCommittedMutations;return new fn(null,new hn(a,s),null,o,n,r)}if(t instanceof Ke){a=t.key.path.toArray();var u=this.toDbTimestamp(t.version);return new fn(new pn(a,u),null,null,!0,n,r)}return v("Unexpected MaybeDocument")},t.prototype.toDbTimestampKey=function(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]},t.prototype.fromDbTimestampKey=function(t){var e=new St(t[0],t[1]);return Ct.fromTimestamp(e)},t.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new an(e.seconds,e.nanoseconds)},t.prototype.fromDbTimestamp=function(t){var e=new St(t.seconds,t.nanoseconds);return Ct.fromTimestamp(e)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.baseMutations.map((function(t){return n.remoteSerializer.toMutation(t)})),i=e.mutations.map((function(t){return n.remoteSerializer.toMutation(t)}));return new cn(t,e.batchId,e.localWriteTime.toMillis(),r,i)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=(t.baseMutations||[]).map((function(t){return e.remoteSerializer.fromMutation(t)})),r=t.mutations.map((function(t){return e.remoteSerializer.fromMutation(t)})),i=St.fromMillis(t.localWriteTimeMs);return new Wt(t.batchId,i,n,r)},t.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach((function(t){e.push(wt(t.path))})),e},t.prototype.fromDbResourcePaths=function(t){for(var e=Ut(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new ft(Tt(i)))}return e},t.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.fromDbTimestamp(t.lastLimboFreeSnapshotVersion):Ct.MIN,i=t.resumeToken;return e=void 0!==t.query.documents?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new kn(e,t.targetId,wn.Listen,t.lastListenSequenceNumber,n,r,i)},t.prototype.toDbTarget=function(t){_(wn.Listen===t.purpose,"Only queries with purpose "+wn.Listen+" may be stored, got "+t.purpose);var e,n,r=this.toDbTimestamp(t.snapshotVersion),i=this.toDbTimestamp(t.lastLimboFreeSnapshotVersion);return e=t.target.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.target):this.remoteSerializer.toQueryTarget(t.target),t.resumeToken instanceof Uint8Array?(_(Qt.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence ."),n=t.resumeToken.toString()):n=t.resumeToken,new mn(t.targetId,t.target.canonicalId(),r,n,t.sequenceNumber,i,e)},t}();function On(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Z(n,i);return 0===a?Z(r,o):a}var Pn=function(){function t(t){this.maxElements=t,this.buffer=new Pt(On),this.previousIndex=0}return t.prototype.nextIndex=function(){return++this.previousIndex},t.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();On(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),Dn={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mn=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t.COLLECTION_DISABLED=-1,t.MINIMUM_CACHE_SIZE_BYTES=1048576,t.DEFAULT_CACHE_SIZE_BYTES=41943040,t.DEFAULT_COLLECTION_PERCENTILE=10,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,t.DEFAULT=new t(t.DEFAULT_CACHE_SIZE_BYTES,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),t.DISABLED=new t(t.COLLECTION_DISABLED,0,0),t}(),Rn=function(){function t(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.hasRun=!1,this.gcTask=null}return t.prototype.start=function(){_(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==Mn.COLLECTION_DISABLED&&this.scheduleGC()},t.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),t.prototype.scheduleGC=function(){var t=this;_(null===this.gcTask,"Cannot schedule GC while a task is pending");var e=this.hasRun?3e5:6e4;m("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(nt.LruGarbageCollection,e,(function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then((function(){return t.scheduleGC()})).catch(Vn)}))},t}(),Nn=function(){function t(t,e){this.delegate=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Ht.resolve(ut.INVALID);var r=new Pn(e);return this.delegate.forEachTarget(t,(function(t){return r.addElement(t.sequenceNumber)})).next((function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,(function(t){return r.addElement(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===Mn.COLLECTION_DISABLED?(m("LruGarbageCollector","Garbage collection skipped; disabled"),Ht.resolve(Dn)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(m("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Dn):n.runGarbageCollection(t,e)}))},t.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},t.prototype.runGarbageCollection=function(t,e){var n,r,o,a,s,u,c,l=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>l.params.maximumSequenceNumbersToCollect?(m("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.maximumSequenceNumbersToCollect+" from "+e),r=l.params.maximumSequenceNumbersToCollect):r=e,a=Date.now(),l.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),l.removeTargets(t,n,e)})).next((function(e){return o=e,u=Date.now(),l.removeOrphanedDocuments(t,n)})).next((function(t){(c=Date.now(),f()<=i.DEBUG)&&m("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-a)+"ms\n\tRemoved "+o+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-h)+"ms");return Ht.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:t})}))},t}(),Ln=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),Fn="IndexedDbPersistence",jn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",zn="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Bn=function(t){function e(e,n){var r=t.call(this)||this;return r.simpleDbTransaction=e,r.currentSequenceNumber=n,r}return a.__extends(e,t),e}(Ln),Un=function(){function t(e,n,r,i,o,a,s,u){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.queue=a,this.sequenceNumberSyncer=u,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},this.referenceDelegate=new Gn(this,o),this.dbName=n+t.MAIN_DATABASE,this.serializer=new An(s),this.document=i.document,this.targetCache=new he(this.referenceDelegate,this.serializer),this.indexManager=new Cn,this.remoteDocumentCache=new Ye(this.serializer,this.indexManager),!i.window||!i.window.localStorage)throw new E(x.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.webStorage=this.window.localStorage}return t.getStore=function(t,e){if(t instanceof Bn)return Qt.getStore(t.simpleDbTransaction,e);throw v("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.createIndexedDbPersistence=function(e){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:if(!t.isAvailable())throw new E(x.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return[4,(n=new t(e.allowTabSynchronization,e.persistenceKey,e.clientId,e.platform,e.lruParams,e.queue,e.serializer,e.sequenceNumberSyncer)).start()];case 1:return r.sent(),[2,n]}}))}))},t.prototype.start=function(){var t=this;return _(!this.started,"IndexedDbPersistence double-started!"),_(null!==this.window,"Expected 'window' to be defined"),Qt.openOrCreate(this.dbName,rn,new on(this.serializer)).then((function(e){return t.simpleDb=e,t.updateClientMetadataAndTryBecomePrimary()})).then((function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.simpleDb.runTransaction("readonly-idempotent",[gn.store],(function(t){return de(t)}))})).then((function(e){t.listenSequence=new ut(e,t.sequenceNumberSyncer)})).then((function(){t._started=!0})).catch((function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)}))},t.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.simpleDb.setVersionChangeListener((function(n){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget((function(){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction("readwrite-idempotent",Sn,(function(e){return Wn(e).put(new bn(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next((function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget((function(){return t.primaryStateListener(!1)})))}))})).next((function(){return t.canActAsPrimary(e)})).next((function(n){return t.isPrimary&&!n?t.releasePrimaryLeaseIfHeld(e).next((function(){return!1})):!!n&&t.acquireOrExtendPrimaryLease(e).next((function(){return!0}))}))})).catch((function(e){if(!t.allowTabSynchronization)throw e;return m(Fn,"Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.queue.enqueueAndForget((function(){return t.primaryStateListener(e)})),t.isPrimary=e}))},t.prototype.verifyPrimaryLease=function(t){var e=this;return qn(t).get(sn.key).next((function(t){return Ht.resolve(e.isLocalClient(t))}))},t.prototype.removeClientMetadata=function(t){return Wn(t).delete(this.clientId)},t.prototype.maybeGarbageCollectMultiClientState=function(){return a.__awaiter(this,void 0,void 0,(function(){var e=this;return a.__generator(this,(function(n){switch(n.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary-idempotent",(function(n){var r=t.getStore(n,bn.store);return r.loadAll().next((function(t){var n=e.filterActiveClients(t,18e5),i=t.filter((function(t){return-1===n.indexOf(t)}));return Ht.forEach(i,(function(t){return r.delete(t.clientId)})).next((function(){return i}))}))}))]);case 1:n.sent().forEach((function(t){e.window.localStorage.removeItem(e.zombiedClientLocalStorageKey(t.clientId))})),n.label=2;case 2:return[2]}}))}))},t.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(nt.ClientMetadataRefresh,4e3,(function(){return t.updateClientMetadataAndTryBecomePrimary().then((function(){return t.maybeGarbageCollectMultiClientState()})).then((function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()}))}))},t.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.canActAsPrimary=function(t){var e=this;return qn(t).get(sn.key).next((function(n){if(null!==n&&e.isWithinAge(n.leaseTimestampMs,5e3)&&!e.isClientZombied(n.ownerId)){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new E(x.FAILED_PRECONDITION,zn);return!1}}return!(!e.networkEnabled||!e.inForeground)||Wn(t).loadAll().next((function(t){return void 0===e.filterActiveClients(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&m(Fn,"Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return a.__awaiter(this,void 0,void 0,(function(){var t=this;return a.__generator(this,(function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite-idempotent",[sn.store,bn.store],(function(e){return t.releasePrimaryLeaseIfHeld(e).next((function(){return t.removeClientMetadata(e)}))}))];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}}))}))},t.prototype.filterActiveClients=function(t,e){var n=this;return t.filter((function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)}))},t.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction("readonly-idempotent",[bn.store],(function(e){return Wn(e).loadAll().next((function(e){return t.filterActiveClients(e,18e5).map((function(t){return t.clientId}))}))}))},t.clearPersistence=function(e){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:return t.isAvailable()?(n=e+t.MAIN_DATABASE,[4,Qt.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getMutationQueue=function(t){return _(this.started,"Cannot initialize MutationQueue before persistence is started."),ee.forUser(t,this.serializer,this.indexManager,this.referenceDelegate)},t.prototype.getTargetCache=function(){return _(this.started,"Cannot initialize TargetCache before persistence is started."),this.targetCache},t.prototype.getRemoteDocumentCache=function(){return _(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},t.prototype.getIndexManager=function(){return _(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},t.prototype.runTransaction=function(t,e,n){var r=this;m(Fn,"Starting transaction:",t);var i,o=e.endsWith("idempotent"),a=e.startsWith("readonly")?o?"readonly-idempotent":"readonly":o?"readwrite-idempotent":"readwrite";return this.simpleDb.runTransaction(a,Sn,(function(o){return i=new Bn(o,r.listenSequence.next()),"readwrite-primary"===e||"readwrite-primary-idempotent"===e?r.verifyPrimaryLease(o).next((function(t){return!!t||r.canActAsPrimary(o)})).next((function(e){if(!e)throw y("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.queue.enqueueAndForget((function(){return r.primaryStateListener(!1)})),new E(x.FAILED_PRECONDITION,jn);return n(i)})).next((function(t){return r.acquireOrExtendPrimaryLease(o).next((function(){return t}))})):r.verifyAllowTabSynchronization(o).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.verifyAllowTabSynchronization=function(t){var e=this;return qn(t).get(sn.key).next((function(t){if(null!==t&&e.isWithinAge(t.leaseTimestampMs,5e3)&&!e.isClientZombied(t.ownerId)&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new E(x.FAILED_PRECONDITION,zn)}))},t.prototype.acquireOrExtendPrimaryLease=function(t){var e=new sn(this.clientId,this.allowTabSynchronization,Date.now());return qn(t).put(sn.key,e)},t.isAvailable=function(){return Qt.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=qn(t);return n.get(sn.key).next((function(t){return e.isLocalClient(t)?(m(Fn,"Releasing primary lease."),n.delete(sn.key)):Ht.resolve()}))},t.prototype.isWithinAge=function(t,e){var n=Date.now();return!(t<n-e)&&(!(t>n)||(y("Detected an update time that is in the future: "+t+" > "+n),!1))},t.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&"function"===typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()}))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},t.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(_(null!==this.document&&"function"===typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;"function"===typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("unload",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(_("function"===typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return m(Fn,"Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(n){return y(Fn,"Failed to get zombied client id.",n),!1}},t.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(t){y("Failed to set zombie client id.",t)}},t.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(t){}},t.prototype.zombiedClientLocalStorageKey=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t.MAIN_DATABASE="main",t}();function Vn(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){if(!function(t){return t.code===x.FAILED_PRECONDITION&&t.message===jn}(t))throw t;return m(Fn,"Unexpectedly lost primary lease"),[2]}))}))}function qn(t){return t.store(sn.store)}function Wn(t){return t.store(bn.store)}var Gn=function(){function t(t,e){this.db=t,this.inMemoryPins=null,this.garbageCollector=new Nn(this,e)}return t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,(function(t,n){return e(n)}))},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return Hn(t,e)},t.prototype.removeReference=function(t,e){return Hn(t,e)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.removeMutationReference=function(t,e){return Hn(t,e)},t.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?Ht.resolve(!0):function(t,e){var n=!1;return se(t).iterateSerial((function(r){return ne(t,r,e).next((function(t){return t&&(n=!0),Ht.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.forEachOrphanedDocument(t,(function(a,s){if(s<=e){var u=n.isPinned(t,a).next((function(e){if(!e)return o++,r.getEntry(t,a).next((function(){return r.removeEntry(a),me(t).delete([0,wt(a.path)])}))}));i.push(u)}})).next((function(){return Ht.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Hn(t,e)},t.prototype.forEachOrphanedDocument=function(t,e){var n,r=me(t),i=ut.INVALID;return r.iterate({index:yn.documentTargetsIndex},(function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==ut.INVALID&&e(new ft(Tt(n)),i),i=s,n=a):i=ut.INVALID})).next((function(){i!==ut.INVALID&&e(new ft(Tt(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Hn(t,e){return me(t).put(function(t,e){return new yn(0,wt(t.path),e)}(e,t.currentSequenceNumber))}var Kn=Number,Qn=Kn.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),Xn=Kn.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Yn=Kn.isInteger||function(t){return"number"===typeof t&&isFinite(t)&&Math.floor(t)===t};function Zn(t){return null===t||void 0===t}function Jn(t){return Yn(t)&&t<=Xn&&t>=Qn}var $n,tr=function(){function t(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}return t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:";for(var e=0,n=this.filters;e<n.length;e++){t+=n[e].canonicalId(),t+=","}t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++){t+=i[r].canonicalId(),t+=","}Zn(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t=this.path.canonicalString();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),Zn(this.limit)||(t+=", limit: "+this.limit),this.orderBy.length>0&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&(!!this.path.isEqual(t.path)&&(!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)))},t.prototype.isDocumentQuery=function(){return ft.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},t}();!function(t){t.First="F",t.Last="L"}($n||($n={}));var er=function(){function t(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=$n.First),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.memoizedOrderBy=null,this.memoizedTarget=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[fr]:this.memoizedOrderBy=[new pr(t),fr];else{_(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:lr.ASCENDING;this.memoizedOrderBy.push(a===lr.ASCENDING?fr:dr)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){_(null==this.getInequalityFilterField()||!(e instanceof ir)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),_(!this.isDocumentQuery(),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){_(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.withLimitToFirst=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,$n.First,this.startAt,this.endAt)},t.prototype.withLimitToLast=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,$n.Last,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,e)},t.prototype.asCollectionQueryAtPath=function(e){return new t(e,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.matchesAllDocuments=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.explicitOrderBy.length||1===this.explicitOrderBy.length&&this.explicitOrderBy[0].field.isKeyField())},t.prototype.canonicalId=function(){return this.toTarget().canonicalId()+"|lt:"+this.limitType},t.prototype.toString=function(){return"Query(target="+this.toTarget().toString()+"; limitType="+this.limitType+")"},t.prototype.isEqual=function(t){return this.toTarget().isEqual(t.toTarget())&&this.limitType===t.limitType},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return _(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesPathAndCollectionGroup(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimitToFirst=function(){return!Zn(this.limit)&&this.limitType===$n.First},t.prototype.hasLimitToLast=function(){return!Zn(this.limit)&&this.limitType===$n.Last},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof ir&&n.isInequality())return n.field}return null},t.prototype.findFilterOperator=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof ir&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.isDocumentQuery=function(){return this.toTarget().isDocumentQuery()},t.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},t.prototype.toTarget=function(){if(!this.memoizedTarget)if(this.limitType===$n.First)this.memoizedTarget=new tr(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i=r.dir===lr.DESCENDING?lr.ASCENDING:lr.DESCENDING;t.push(new pr(r.field,i))}var o=this.endAt?new hr(this.endAt.position,!this.endAt.before):null,a=this.startAt?new hr(this.startAt.position,!this.startAt.before):null;this.memoizedTarget=new tr(this.path,this.collectionGroup,t,this.filters,this.limit,o,a)}return this.memoizedTarget},t.prototype.matchesPathAndCollectionGroup=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(e):ft.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isImmediateParentOf(e)},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&null===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++){if(!n[e].matches(t))return!1}return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t))&&(!this.endAt||!this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){_(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),nr=function(){},rr=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;case"in":return t.IN;case"array-contains-any":return t.ARRAY_CONTAINS_ANY;default:return v("Unknown FieldFilter operator: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t.IN=new t("in"),t.ARRAY_CONTAINS_ANY=new t("array-contains-any"),t}(),ir=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return a.__extends(e,t),e.create=function(t,n,r){if(t.isKeyField())return n===rr.IN?(_(r instanceof qe,"Comparing on key with IN, but filter value not an ArrayValue"),_(r.internalValue.every((function(t){return t instanceof Be})),"Comparing on key with IN, but an array value was not a RefValue"),new ar(t,r)):(_(r instanceof Be,"Comparing on key, but filter value not a RefValue"),_(n!==rr.ARRAY_CONTAINS&&n!==rr.ARRAY_CONTAINS_ANY,"'"+n.toString()+"' queries don't make sense on document keys."),new or(t,n,r));if(r.isEqual(Oe.INSTANCE)){if(n!==rr.EQUAL)throw new E(x.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(r.isEqual(Ne.NAN)){if(n!==rr.EQUAL)throw new E(x.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return n===rr.ARRAY_CONTAINS?new sr(t,r):n===rr.IN?(_(r instanceof qe,"IN filter has invalid value: "+r.toString()),new ur(t,r)):n===rr.ARRAY_CONTAINS_ANY?(_(r instanceof qe,"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new cr(t,r)):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&this.value.typeOrder===e.typeOrder&&this.matchesComparison(e.compareTo(this.value))},e.prototype.matchesComparison=function(t){switch(this.op){case rr.LESS_THAN:return t<0;case rr.LESS_THAN_OR_EQUAL:return t<=0;case rr.EQUAL:return 0===t;case rr.GREATER_THAN:return t>0;case rr.GREATER_THAN_OR_EQUAL:return t>=0;default:return v("Unknown FieldFilter operator: "+this.op)}},e.prototype.isInequality=function(){return[rr.LESS_THAN,rr.LESS_THAN_OR_EQUAL,rr.GREATER_THAN,rr.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&(this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value))},e.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},e}(nr),or=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.matches=function(t){var e=this.value,n=ft.comparator(t.key,e.key);return this.matchesComparison(n)},e}(ir),ar=function(t){function e(e,n){var r=t.call(this,e,rr.IN,n)||this;return r.value=n,r}return a.__extends(e,t),e.prototype.matches=function(t){return this.value.internalValue.some((function(e){return t.key.isEqual(e.key)}))},e}(ir),sr=function(t){function e(e,n){return t.call(this,e,rr.ARRAY_CONTAINS,n)||this}return a.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return e instanceof qe&&e.contains(this.value)},e}(ir),ur=function(t){function e(e,n){var r=t.call(this,e,rr.IN,n)||this;return r.value=n,r}return a.__extends(e,t),e.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return null!==n&&e.contains(n)},e}(ir),cr=function(t){function e(e,n){var r=t.call(this,e,rr.ARRAY_CONTAINS_ANY,n)||this;return r.value=n,r}return a.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return n instanceof qe&&n.internalValue.some((function(t){return e.value.contains(t)}))},e}(ir),lr=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),hr=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++){t+=n[e].toString()}return t},t.prototype.sortsBeforeDocument=function(t,e){_(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())_(o instanceof Be,"Bound has a non-key value where the key path is being used."),n=ft.comparator(o.key,e.key);else{var a=e.field(i.field);_(null!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===lr.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];if(!n.isEqual(r))return!1}return!0},t}(),pr=function(){function t(t,e){this.field=t,void 0===e&&(e=lr.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?Ge.compareByKey(t,e):Ge.compareByField(this.field,t,e);switch(this.dir){case lr.ASCENDING:return n;case lr.DESCENDING:return-1*n;default:return v("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),fr=new pr(pt.keyField(),lr.ASCENDING),dr=new pr(pt.keyField(),lr.DESCENDING),mr=function(){function t(){}return t.prototype.setLocalDocumentsView=function(t){this.localDocumentsView=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var o=this;return _(void 0!==this.localDocumentsView,"setLocalDocumentsView() not called"),e.matchesAllDocuments()?this.executeFullCollectionScan(t,e):n.isEqual(Ct.MIN)?this.executeFullCollectionScan(t,e):this.localDocumentsView.getDocuments(t,r).next((function(a){var s=o.applyQuery(e,a);return(e.hasLimitToFirst()||e.hasLimitToLast())&&o.needsRefill(e.limitType,s,r,n)?o.executeFullCollectionScan(t,e):(f()<=i.DEBUG&&m("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),e.toString()),o.localDocumentsView.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.applyQuery=function(t,e){var n=new Pt((function(e,n){return t.docComparator(e,n)}));return e.forEach((function(e,r){r instanceof Ge&&t.matches(r)&&(n=n.add(r))})),n},t.prototype.needsRefill=function(t,e,n,r){if(n.size!==e.size)return!0;var i=t===$n.First?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.executeFullCollectionScan=function(t,e){return f()<=i.DEBUG&&m("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.localDocumentsView.getDocumentsMatchingQuery(t,e,Ct.MIN)},t}(),yr=function(){function t(t,e,n){this.remoteDocumentCache=t,this.mutationQueue=e,this.indexManager=n}return t.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.getDocumentInternal(t,e,r)}))},t.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++){t=i[r].applyToLocalView(e,t)}return t}))},t.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=Nt();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++){e=o[i].applyToLocalView(t,e)}r=r.insert(t,e)})),r},t.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next((function(e){return n.getLocalViewOfDocuments(t,e)}))},t.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=Rt();return i.forEach((function(t,e){e||(e=new He(t,Ct.forDeletedDoc())),o=o.insert(t,e)})),o}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return e.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(t,e.path):e.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new ft(e)).next((function(t){var e=Ft();return t instanceof Ge&&(e=e.insert(t.key,t)),e}))},t.prototype.getDocumentsMatchingCollectionGroupQuery=function(t,e,n){var r=this;_(e.path.isEmpty(),"Currently we only support collection group queries at the root.");var i=e.collectionGroup,o=Ft();return this.indexManager.getCollectionParents(t,i).next((function(a){return Ht.forEach(a,(function(a){var s=e.asCollectionQueryAtPath(a.child(i));return r.getDocumentsMatchingCollectionQuery(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e,n){var r,i,o=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.addMissingBaseDocuments(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=r.get(c),h=u.applyToLocalView(l,l,o.localWriteTime);r=h instanceof Ge?r.insert(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){e.matches(n)||(r=r.remove(t))})),r}))},t.prototype.addMissingBaseDocuments=function(t,e,n){for(var r=Ut(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof Se&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.remoteDocumentCache.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof Ge&&(c=c.insert(t,e))})),c}))},t}(),gr=function(){function t(){this.refsByKey=new Pt(vr.compareByKey),this.refsByTarget=new Pt(vr.compareByTargetId)}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new vr(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.removeRef(new vr(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.removeReferencesForId=function(t){var e=this,n=ft.EMPTY,r=new vr(n,t),i=new vr(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],(function(t){e.removeRef(t),o.push(t.key)})),o},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach((function(e){return t.removeRef(e)}))},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},t.prototype.referencesForId=function(t){var e=ft.EMPTY,n=new vr(e,t),r=new vr(e,t+1),i=Ut();return this.refsByTarget.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new vr(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),vr=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return ft.comparator(t.key,e.key)||Z(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return Z(t.targetOrBatchId,e.targetOrBatchId)||ft.comparator(t.key,e.key)},t}(),_r=function(){function t(t,e,n){this.persistence=t,this.queryEngine=e,this.localViewReferences=new gr,this.targetDataByTarget=new It(Z),this.targetIdByTarget=new Qe((function(t){return t.canonicalId()})),this.lastDocumentChangeReadTime=Ct.MIN,_(t.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(n),this.remoteDocuments=t.getRemoteDocumentCache(),this.targetCache=t.getTargetCache(),this.localDocuments=new yr(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager()),this.queryEngine.setLocalDocumentsView(this.localDocuments)}return t.prototype.start=function(){return this.synchronizeLastDocumentChangeReadTime()},t.prototype.handleUserChange=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i=this;return a.__generator(this,(function(o){switch(o.label){case 0:return e=this.mutationQueue,n=this.localDocuments,[4,this.persistence.runTransaction("Handle user change","readonly-idempotent",(function(r){var o;return i.mutationQueue.getAllMutationBatches(r).next((function(a){return o=a,e=i.persistence.getMutationQueue(t),n=new yr(i.remoteDocuments,e,i.persistence.getIndexManager()),e.getAllMutationBatches(r)})).next((function(t){for(var e=[],i=[],a=Ut(),s=0,u=o;s<u.length;s++){var c=u[s];e.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var p=h[l];a=a.add(p.key)}}for(var f=0,d=t;f<d.length;f++){c=d[f];i.push(c.batchId);for(var m=0,y=c.mutations;m<y.length;m++){p=y[m];a=a.add(p.key)}}return n.getDocuments(r,a).next((function(t){return{affectedDocuments:t,removedBatchIds:e,addedBatchIds:i}}))}))}))];case 1:return r=o.sent(),this.mutationQueue=e,this.localDocuments=n,this.queryEngine.setLocalDocumentsView(this.localDocuments),[2,r]}}))}))},t.prototype.localWrite=function(t){var e,n=this,r=St.now(),i=t.reduce((function(t,e){return t.add(e.key)}),Ut());return this.persistence.runTransaction("Locally write mutations","readwrite-idempotent",(function(o){return n.localDocuments.getDocuments(o,i).next((function(i){e=i;for(var a=[],s=0,u=t;s<u.length;s++){var c=u[s],l=c.extractBaseValue(e.get(c.key));null!=l&&a.push(new Se(c.key,l,l.fieldMask(),xe.exists(!0)))}return n.mutationQueue.addMutationBatch(o,r,a,t)}))})).then((function(t){var n=t.applyToLocalDocumentSet(e);return{batchId:t.batchId,changes:n}}))},t.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly-idempotent",(function(n){return e.mutationQueue.lookupMutationKeys(n,t).next((function(t){return t?e.localDocuments.getDocuments(n,t):Ht.resolve(null)}))}))},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary-idempotent",(function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer({trackRemovals:!0});return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next((function(){return e.applyWriteToRemoteDocuments(n,t,i)})).next((function(){return i.apply(n)})).next((function(){return e.mutationQueue.performConsistencyCheck(n)})).next((function(){return e.localDocuments.getDocuments(n,r)}))}))},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary-idempotent",(function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next((function(t){return _(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)})).next((function(){return e.mutationQueue.performConsistencyCheck(n)})).next((function(){return e.localDocuments.getDocuments(n,r)}))}))},t.prototype.getHighestUnacknowledgedBatchId=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly-idempotent",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly-idempotent",(function(e){return t.mutationQueue.getLastStreamToken(e)}))},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary-idempotent",(function(n){return e.mutationQueue.setLastStreamToken(n,t)}))},t.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly-idempotent",(function(e){return t.targetCache.getLastRemoteSnapshotVersion(e)}))},t.prototype.applyRemoteEvent=function(e){var n=this,r=e.snapshotVersion,i=this.targetDataByTarget;return this.persistence.runTransaction("Apply remote event","readwrite-primary-idempotent",(function(o){var a=n.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=n.targetDataByTarget;var s=[];I(e.targetChanges,(function(e,a){var u=i.get(e);if(u){s.push(n.targetCache.removeMatchingKeys(o,a.removedDocuments,e).next((function(){return n.targetCache.addMatchingKeys(o,a.addedDocuments,e)})));var c=a.resumeToken;if(c.length>0){var l=u.withResumeToken(c,r).withSequenceNumber(o.currentSequenceNumber);i=i.insert(e,l),t.shouldPersistTargetData(u,l,a)&&s.push(n.targetCache.updateTargetData(o,l))}}}));var u=Rt(),c=Ut();if(e.documentUpdates.forEach((function(t,e){c=c.add(t)})),s.push(a.getEntries(o,c).next((function(t){e.documentUpdates.forEach((function(i,c){var l=t.get(i);c instanceof He&&c.version.isEqual(Ct.MIN)?(a.removeEntry(i,r),u=u.insert(i,c)):null==l||c.version.compareTo(l.version)>0||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(_(!Ct.MIN.isEqual(r),"Cannot add a document when the remote version is zero"),a.addEntry(c,r),u=u.insert(i,c)):m("LocalStore","Ignoring outdated watch update for ",i,". Current version:",l.version," Watch version:",c.version),e.resolvedLimboDocuments.has(i)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(o,i))}))}))),!r.isEqual(Ct.MIN)){var l=n.targetCache.getLastRemoteSnapshotVersion(o).next((function(t){return _(r.compareTo(t)>=0,"Watch stream reverted to previous snapshot?? "+r+" < "+t),n.targetCache.setTargetsMetadata(o,o.currentSequenceNumber,r)}));s.push(l)}return Ht.waitFor(s).next((function(){return a.apply(o)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(o,u)}))})).then((function(t){return n.targetDataByTarget=i,t}))},t.shouldPersistTargetData=function(t,e,n){return _(e.resumeToken.length>0,"Attempted to persist target data with no resume token"),0===t.resumeToken.length||(e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)},t.prototype.notifyLocalViewChanges=function(t){for(var e=this,n=0,r=t;n<r.length;n++){var i=r[n],o=i.targetId;if(this.localViewReferences.addReferences(i.addedKeys,o),this.localViewReferences.removeReferences(i.removedKeys,o),!i.fromCache){var a=this.targetDataByTarget.get(o);_(null!==a,"Can't set limbo-free snapshot version for unknown target: "+o);var s=a.snapshotVersion,u=a.withLastLimboFreeSnapshotVersion(s);this.targetDataByTarget=this.targetDataByTarget.insert(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite-idempotent",(function(n){return Ht.forEach(t,(function(t){return Ht.forEach(t.removedKeys,(function(t){return e.persistence.referenceDelegate.removeReference(n,t)}))}))}))},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly-idempotent",(function(n){return void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)}))},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document","readonly-idempotent",(function(n){return e.localDocuments.getDocument(n,t)}))},t.prototype.allocateTarget=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite-idempotent",(function(n){var r;return e.targetCache.getTargetData(n,t).next((function(i){return i?(r=i,Ht.resolve(r)):e.targetCache.allocateTargetId(n).next((function(i){return r=new kn(t,i,wn.Listen,n.currentSequenceNumber),e.targetCache.addTargetData(n,r).next((function(){return r}))}))}))})).then((function(n){return null===e.targetDataByTarget.get(n.targetId)&&(e.targetDataByTarget=e.targetDataByTarget.insert(n.targetId,n),e.targetIdByTarget.set(t,n.targetId)),n}))},t.prototype.getTargetData=function(t,e){var n=this.targetIdByTarget.get(e);return void 0!==n?Ht.resolve(this.targetDataByTarget.get(n)):this.targetCache.getTargetData(t,e)},t.prototype.releaseTarget=function(t,e){var n=this,r=this.targetDataByTarget.get(t);_(null!==r,"Tried to release nonexistent target: "+t);var i=e?"readwrite-idempotent":"readwrite-primary-idempotent";return this.persistence.runTransaction("Release target",i,(function(i){var o=n.localViewReferences.removeReferencesForId(t);return e?Ht.resolve():Ht.forEach(o,(function(t){return n.persistence.referenceDelegate.removeReference(i,t)})).next((function(){n.persistence.referenceDelegate.removeTarget(i,r)}))})).then((function(){n.targetDataByTarget=n.targetDataByTarget.remove(t),n.targetIdByTarget.delete(r.target)}))},t.prototype.executeQuery=function(t,e){var n=this,r=Ct.MIN,i=Ut();return this.persistence.runTransaction("Execute query","readonly-idempotent",(function(o){return n.getTargetData(o,t.toTarget()).next((function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.targetCache.getMatchingKeysForTargetId(o,t.targetId).next((function(t){i=t}))})).next((function(){return n.queryEngine.getDocumentsMatchingQuery(o,t,e?r:Ct.MIN,e?i:Ut())})).next((function(t){return{documents:t,remoteKeys:i}}))}))},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly-idempotent",(function(n){return e.targetCache.getMatchingKeysForTargetId(n,t)}))},t.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},t.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},t.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),a=Ht.resolve();return o.forEach((function(r){a=a.next((function(){return n.getEntry(t,r)})).next((function(t){var o=t,a=e.docVersions.get(r);_(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,e))?n.addEntry(o,e.commitVersion):_(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))}))})),a.next((function(){return r.mutationQueue.removeMutationBatch(t,i)}))},t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary-idempotent",(function(n){return t.collect(n,e.targetDataByTarget)}))},t.prototype.getTarget=function(t){var e=this,n=this.targetDataByTarget.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly-idempotent",(function(n){return e.targetCache.getTargetDataForTarget(n,t).next((function(t){return t?t.target:null}))}))},t.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly-idempotent",(function(e){return t.remoteDocuments.getNewDocumentChanges(e,t.lastDocumentChangeReadTime)})).then((function(e){var n=e.changedDocs,r=e.readTime;return t.lastDocumentChangeReadTime=r,n}))},t.prototype.synchronizeLastDocumentChangeReadTime=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,e=this;return a.__generator(this,(function(n){return this.remoteDocuments instanceof Ye?(t=this.remoteDocuments,[2,this.persistence.runTransaction("Synchronize last document change read time","readonly-idempotent",(function(e){return t.getLastDocumentChange(e)})).then((function(t){var n=t.readTime;e.lastDocumentChangeReadTime=n}))]):[2]}))}))},t.RESUME_TOKEN_MAX_AGE_MICROS=3e8,t}(),br=function(){function t(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=w(),this.batchesByDocumentKey=new Pt(vr.compareByKey)}return t.prototype.checkEmpty=function(t){return Ht.resolve(0===this.mutationQueue.length)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");_(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return _(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,Ht.resolve()},t.prototype.getLastStreamToken=function(t){return Ht.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,Ht.resolve()},t.prototype.addMutationBatch=function(t,e,n,r){_(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;(this.nextBatchId++,this.mutationQueue.length>0)&&_(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new Wt(i,e,n,r);this.mutationQueue.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new vr(u.key,i)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast())}return Ht.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Ht.resolve(this.findMutationBatch(e))},t.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return _(null!=n,"Failed to find local mutation batch."),Ht.resolve(n.keys())},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.indexOfBatchId(n),i=r<0?0:r;return Ht.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Ht.resolve(0===this.mutationQueue.length?-1:this.nextBatchId-1)},t.prototype.getAllMutationBatches=function(t){return Ht.resolve(this.mutationQueue.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new vr(e,0),i=new vr(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],(function(t){_(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);_(null!==r,"Batches in the index must exist in the main table"),o.push(r)})),Ht.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Pt(Z);return e.forEach((function(t){var e=new vr(t,0),i=new vr(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],(function(e){_(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.targetOrBatchId)}))})),Ht.resolve(this.findMutationBatches(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){_(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;ft.isDocumentKey(i)||(i=i.child(""));var o=new vr(new ft(i),0),a=new Pt(Z);return this.batchesByDocumentKey.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.targetOrBatchId)),!0)}),o),Ht.resolve(this.findMutationBatches(a))},t.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;_(0===this.indexOfExistingBatchId(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return Ht.forEach(e.mutations,(function(i){var o=new vr(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(t,i.key)})).next((function(){n.batchesByDocumentKey=r}))},t.prototype.removeCachedMutationKeys=function(t){},t.prototype.containsKey=function(t,e){var n=new vr(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return Ht.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&_(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),Ht.resolve()},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return _(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return _(n.batchId===t,"If found batch must match"),n},t}();var wr,xr=function(){function t(t,e){this.indexManager=t,this.sizer=e,this.docs=new It(ft.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){_(!n.isEqual(Ct.MIN),"Cannot add a document with a read time of zero");var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.sizer(e);return this.docs=this.docs.insert(r,{maybeDocument:e,size:a,readTime:n}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Ht.resolve(n?n.maybeDocument:null)},t.prototype.getEntries=function(t,e){var n=this,r=Nt();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)})),Ht.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){_(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=Ft(),i=new ft(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.maybeDocument,l=u.readTime;if(!e.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||c instanceof Ge&&e.matches(c)&&(r=r.insert(c.key,c))}return Ht.resolve(r)},t.prototype.forEachDocumentKey=function(t,e){return Ht.forEach(this.docs,(function(t){return e(t)}))},t.prototype.getNewDocumentChanges=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},t.prototype.newChangeBuffer=function(e){return new t.RemoteDocumentChangeBuffer(this)},t.prototype.getSize=function(t){return Ht.resolve(this.size)},t.RemoteDocumentChangeBuffer=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n}return a.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i?n.push(e.documentCache.addEntry(t,i,e.readTime)):e.documentCache.removeEntry(r)})),Ht.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.documentCache.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getEntries(t,e)},e}(Xe),t}(),Er=function(){function t(t){this.persistence=t,this.targets=new Qe((function(t){return t.canonicalId()})),this.lastRemoteSnapshotVersion=Ct.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new gr,this.targetCount=0,this.targetIdGenerator=le.forTargetCache()}return t.prototype.forEachTarget=function(t,e){return this.targets.forEach((function(t,n){return e(n)})),Ht.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Ht.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Ht.resolve(this.highestSequenceNumber)},t.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,Ht.resolve(e)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),Ht.resolve()},t.prototype.saveTargetData=function(t){this.targets.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return _(!this.targets.has(e.target),"Adding a target that already exists"),this.saveTargetData(e),this.targetCount+=1,Ht.resolve()},t.prototype.updateTargetData=function(t,e){return _(this.targets.has(e.target),"Updating a non-existent target"),this.saveTargetData(e),Ht.resolve()},t.prototype.removeTargetData=function(t,e){return _(this.targetCount>0,"Removing a target from an empty cache"),_(this.targets.has(e.target),"Removing a non-existent target from the cache"),this.targets.delete(e.target),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,Ht.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.targets.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.targets.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),Ht.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Ht.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.targets.get(e)||null;return Ht.resolve(n)},t.prototype.getTargetDataForTarget=function(t,e){return v("Not yet implemented.")},t.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.addReference(t,e))})),Ht.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.removeReference(t,e))})),Ht.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),Ht.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return Ht.resolve(n)},t.prototype.containsKey=function(t,e){return Ht.resolve(this.references.containsKey(e))},t}(),Tr=function(){function t(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new ut(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.targetCache=new Er(this);this.indexManager=new en,this.remoteDocumentCache=new xr(this.indexManager,(function(t){return n.referenceDelegate.documentSize(t)}))}return t.createLruPersistence=function(e,n,r){return new t(e,(function(t){return new Ir(t,new An(n),r)}))},t.createEagerPersistence=function(e){return new t(e,(function(t){return new Cr(t)}))},t.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getActiveClients=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return[2,[this.clientId]]}))}))},t.prototype.setPrimaryStateListener=function(t){return t(!0)},t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(t){},t.prototype.getIndexManager=function(){return this.indexManager},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new br(this.indexManager,this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.targetCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;m("MemoryPersistence","Starting transaction:",t);var i=new Sr(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next((function(t){return r.referenceDelegate.onTransactionCommitted(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.mutationQueuesContainKey=function(t,e){return Ht.or(function(t){var e=[];return k(t,(function(t,n){return e.push(n)})),e}(this.mutationQueues).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Sr=function(t){function e(e){var n=t.call(this)||this;return n.currentSequenceNumber=e,n}return a.__extends(e,t),e}(Ln),Cr=function(){function t(t){this.persistence=t,this.inMemoryPins=null,this._orphanedDocuments=null}return Object.defineProperty(t.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw v("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),Ht.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),Ht.resolve()},t.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),Ht.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.orphanedDocuments.add(t)}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},t.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ht.forEach(this.orphanedDocuments,(function(r){return e.isReferenced(t,r).next((function(t){t||n.removeEntry(r)}))})).next((function(){return e._orphanedDocuments=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next((function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)}))},t.prototype.documentSize=function(t){return 0},t.prototype.isReferenced=function(t,e){var n=this;return Ht.or([function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return Ht.resolve(n.inMemoryPins.containsKey(e))}])},t}(),Ir=function(){function t(t,e,n){this.persistence=t,this.serializer=e,this.inMemoryPins=null,this.orphanedSequenceNumbers=new Qe((function(t){return wt(t.path)})),this.garbageCollector=new Nn(this,n)}return t.prototype.onTransactionStarted=function(){},t.prototype.onTransactionCommitted=function(t){return Ht.resolve()},t.prototype.forEachTarget=function(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)},t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t);return this.persistence.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return Ht.forEach(this.orphanedSequenceNumbers,(function(r,i){return n.isPinned(t,r,i).next((function(t){return t?Ht.resolve():e(i)}))}))},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.removeTargets=function(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.forEachDocumentKey(t,(function(i){return n.isPinned(t,i,e).next((function(t){t||(r++,o.removeEntry(i))}))})).next((function(){return o.apply(t)})).next((function(){return r}))},t.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Ht.resolve()},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)},t.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Ht.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Ht.resolve()},t.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Ht.resolve()},t.prototype.documentSize=function(t){var e,n=this.serializer.toDbRemoteDocument(t,t.version);if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw v("Unknown remote document type");e=n.noDocument}return JSON.stringify(e).length},t.prototype.isPinned=function(t,e,n){var r=this;return Ht.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return Ht.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getTargetCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return Ht.resolve(void 0!==t&&t>n)}])},t.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},t}(),kr=1e3,Ar=1.5,Or=6e4,Pr=function(){function t(t,e,n,r,i){void 0===n&&(n=kr),void 0===r&&(r=Ar),void 0===i&&(i=Or),this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&m("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,(function(){return e.lastAttemptTime=Date.now(),t()})),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}();!function(t){t[t.Initial=0]="Initial",t[t.Starting=1]="Starting",t[t.Open=2]="Open",t[t.Error=3]="Error",t[t.Backoff=4]="Backoff"}(wr||(wr={}));var Dr,Mr,Rr=function(){function t(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=wr.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new Pr(t,e)}return t.prototype.isStarted=function(){return this.state===wr.Starting||this.state===wr.Open||this.state===wr.Backoff},t.prototype.isOpen=function(){return this.state===wr.Open},t.prototype.start=function(){this.state!==wr.Error?(_(this.state===wr.Initial,"Already started"),this.auth()):this.performBackoff()},t.prototype.stop=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close(wr.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.inhibitBackoff=function(){_(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=wr.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,(function(){return t.handleIdleCloseTimer()})))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return this.isOpen()?[2,this.close(wr.Initial)]:[2]}))}))},t.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},t.prototype.close=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(n){switch(n.label){case 0:return _(this.isStarted(),"Only started streams should be closed."),_(t===wr.Error||Zn(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==wr.Error?this.backoff.reset():e&&e.code===x.RESOURCE_EXHAUSTED?(y(e.toString()),y("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):e&&e.code===x.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;_(this.state===wr.Initial,"Must be in initial state to auth"),this.state=wr.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then((function(e){t.closeCount===n&&t.startStream(e)}),(function(n){e((function(){var e=new E(x.UNKNOWN,"Fetching auth token failed: "+n.message);return t.handleStreamClose(e)}))}))},t.prototype.startStream=function(t){var e=this;_(this.state===wr.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen((function(){n((function(){return _(e.state===wr.Starting,"Expected stream to be in state Starting, but was "+e.state),e.state=wr.Open,e.listener.onOpen()}))})),this.stream.onClose((function(t){n((function(){return e.handleStreamClose(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.performBackoff=function(){var t=this;_(this.state===wr.Error,"Should only perform backoff when in Error state"),this.state=wr.Backoff,this.backoff.backoffAndRun((function(){return a.__awaiter(t,void 0,void 0,(function(){return a.__generator(this,(function(t){return _(this.state===wr.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=wr.Initial,this.start(),_(this.isStarted(),"PersistentStream should have started"),[2]}))}))}))},t.prototype.handleStreamClose=function(t){return _(this.isStarted(),"Can't handle server close on non-started stream"),m("PersistentStream","close with error: "+t),this.stream=null,this.close(wr.Error,t)},t.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget((function(){return e.closeCount===t?n():(m("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Nr=function(t){function e(e,n,r,i,o){var a=t.call(this,e,nt.ListenStreamConnectionBackoff,nt.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return a.__extends(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(Rr),Lr=function(t){function e(e,n,r,i,o){var a=t.call(this,e,nt.WriteStreamConnectionBackoff,nt.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a.lastStreamToken=w(),a}return a.__extends(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.handshakeComplete_=!1,t.prototype.start.call(this)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(_(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return _(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){_(this.isOpen(),"Writing handshake requires an opened stream"),_(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;_(this.isOpen(),"Writing mutations requires an opened stream"),_(this.handshakeComplete_,"Handshake must be complete before writing mutations"),_(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map((function(t){return e.serializer.toMutation(t)}))};this.sendRequest(n)},e}(Rr),Fr=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(t){return new Lr(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.newPersistentWatchStream=function(t){return new Nr(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map((function(t){return e.serializer.toMutation(t)}))};return this.invokeRPC("Commit",n).then((function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)}))},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map((function(t){return e.serializer.toName(t)}))};return this.invokeStreamingRPC("BatchGetDocuments",n).then((function(n){var r=Rt();n.forEach((function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)}));var i=[];return t.forEach((function(t){var e=r.get(t);_(!!e,"Missing entity in write response for "+t),i.push(e)})),i}))},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeRPC(t,e,r)})).catch((function(t){throw t.code===x.UNAUTHENTICATED&&n.credentials.invalidateToken(),t}))},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeStreamingRPC(t,e,r)})).catch((function(t){throw t.code===x.UNAUTHENTICATED&&n.credentials.invalidateToken(),t}))},t}(),jr=function(){function t(t){this.datastore=t,this.readVersions=zt(),this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new E(x.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.datastore.lookup(t)];case 1:return(e=r.sent()).forEach((function(t){t instanceof He||t instanceof Ge?n.recordVersion(t):v("Document in a transaction was a "+t.constructor.name)})),[2,e]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t))),this.writtenDocs.add(t)},t.prototype.update=function(t,e){try{this.write(e.toMutations(t,this.preconditionForUpdate(t)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(t)},t.prototype.delete=function(t){this.write([new Ie(t,this.precondition(t))]),this.writtenDocs.add(t)},t.prototype.commit=function(){return a.__awaiter(this,void 0,void 0,(function(){var t;return a.__generator(this,(function(e){switch(e.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;if(t=this.readVersions,this.mutations.forEach((function(e){t=t.remove(e.key)})),!t.isEmpty())throw new E(x.INVALID_ARGUMENT,"Every document read in a transaction must also be written.");return[4,this.datastore.commit(this.mutations)];case 1:return e.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t instanceof Ge)e=t.version;else{if(!(t instanceof He))throw v("Document in a transaction was a "+t.constructor.name);e=Ct.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new E(x.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return!this.writtenDocs.has(t)&&e?xe.updateTime(e):xe.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(!this.writtenDocs.has(t)&&e){if(e.isEqual(Ct.forDeletedDoc()))throw new E(x.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return xe.updateTime(e)}return xe.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(t)},t.prototype.ensureCommitNotCalled=function(){_(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},t}();!function(t){t[t.Unknown=0]="Unknown",t[t.Online=1]="Online",t[t.Offline=2]="Offline"}(Dr||(Dr={})),function(t){t[t.RemoteStore=0]="RemoteStore",t[t.SharedClientState=1]="SharedClientState"}(Mr||(Mr={}));var zr,Br=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=Dr.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(Dr.Unknown),_(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(nt.OnlineStateTimeout,1e4,(function(){return t.onlineStateTimer=null,_(t.state===Dr.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),t.setAndBroadcast(Dr.Offline),Promise.resolve()})))},t.prototype.handleWatchStreamFailure=function(t){this.state===Dr.Online?(this.setAndBroadcast(Dr.Unknown),_(0===this.watchStreamFailures,"watchStreamFailures must be 0"),_(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=1&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+t.toString()),this.setAndBroadcast(Dr.Offline)))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===Dr.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(y(e),this.shouldWarnClientIsOffline=!1):m("OnlineStateTracker",e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}();function Ur(t){switch(t){case x.OK:return v("Treated status OK as error");case x.CANCELLED:case x.UNKNOWN:case x.DEADLINE_EXCEEDED:case x.RESOURCE_EXHAUSTED:case x.INTERNAL:case x.UNAVAILABLE:case x.UNAUTHENTICATED:return!1;case x.INVALID_ARGUMENT:case x.NOT_FOUND:case x.ALREADY_EXISTS:case x.PERMISSION_DENIED:case x.FAILED_PRECONDITION:case x.ABORTED:case x.OUT_OF_RANGE:case x.UNIMPLEMENTED:case x.DATA_LOSS:return!0;default:return v("Unknown status code: "+t)}}function Vr(t){if(void 0===t)return y("GRPC error has no .code"),x.UNKNOWN;switch(t){case zr.OK:return x.OK;case zr.CANCELLED:return x.CANCELLED;case zr.UNKNOWN:return x.UNKNOWN;case zr.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case zr.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case zr.INTERNAL:return x.INTERNAL;case zr.UNAVAILABLE:return x.UNAVAILABLE;case zr.UNAUTHENTICATED:return x.UNAUTHENTICATED;case zr.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case zr.NOT_FOUND:return x.NOT_FOUND;case zr.ALREADY_EXISTS:return x.ALREADY_EXISTS;case zr.PERMISSION_DENIED:return x.PERMISSION_DENIED;case zr.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case zr.ABORTED:return x.ABORTED;case zr.OUT_OF_RANGE:return x.OUT_OF_RANGE;case zr.UNIMPLEMENTED:return x.UNIMPLEMENTED;case zr.DATA_LOSS:return x.DATA_LOSS;default:return v("Unknown status code: "+t)}}function qr(t){if(void 0===t)return zr.OK;switch(t){case x.OK:return zr.OK;case x.CANCELLED:return zr.CANCELLED;case x.UNKNOWN:return zr.UNKNOWN;case x.DEADLINE_EXCEEDED:return zr.DEADLINE_EXCEEDED;case x.RESOURCE_EXHAUSTED:return zr.RESOURCE_EXHAUSTED;case x.INTERNAL:return zr.INTERNAL;case x.UNAVAILABLE:return zr.UNAVAILABLE;case x.UNAUTHENTICATED:return zr.UNAUTHENTICATED;case x.INVALID_ARGUMENT:return zr.INVALID_ARGUMENT;case x.NOT_FOUND:return zr.NOT_FOUND;case x.ALREADY_EXISTS:return zr.ALREADY_EXISTS;case x.PERMISSION_DENIED:return zr.PERMISSION_DENIED;case x.FAILED_PRECONDITION:return zr.FAILED_PRECONDITION;case x.ABORTED:return zr.ABORTED;case x.OUT_OF_RANGE:return zr.OUT_OF_RANGE;case x.UNIMPLEMENTED:return zr.UNIMPLEMENTED;case x.DATA_LOSS:return zr.DATA_LOSS;default:return v("Unknown status code: "+t)}}!function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS"}(zr||(zr={}));var Wr,Gr,Hr=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ft.comparator(e.key,n.key)}:function(t,e){return ft.comparator(t.key,e.key)},this.keyedMap=Ft(),this.sortedSet=new It(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}();!function(t){t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Modified=2]="Modified",t[t.Metadata=3]="Metadata"}(Wr||(Wr={})),function(t){t[t.Local=0]="Local",t[t.Synced=1]="Synced"}(Gr||(Gr={}));var Kr,Qr=function(){function t(){this.changeMap=new It(ft.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Wr.Added&&n.type===Wr.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Wr.Metadata&&n.type!==Wr.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Wr.Modified&&n.type===Wr.Modified?this.changeMap=this.changeMap.insert(e,{type:Wr.Modified,doc:t.doc}):t.type===Wr.Modified&&n.type===Wr.Added?this.changeMap=this.changeMap.insert(e,{type:Wr.Added,doc:t.doc}):t.type===Wr.Removed&&n.type===Wr.Added?this.changeMap=this.changeMap.remove(e):t.type===Wr.Removed&&n.type===Wr.Modified?this.changeMap=this.changeMap.insert(e,{type:Wr.Removed,doc:n.doc}):t.type===Wr.Added&&n.type===Wr.Removed?this.changeMap=this.changeMap.insert(e,{type:Wr.Modified,doc:t.doc}):v("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Xr=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:Wr.Added,doc:t})})),new t(e,n,Hr.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(this.fromCache!==t.fromCache||this.syncStateChanged!==t.syncStateChanged||!this.mutatedKeys.isEqual(t.mutatedKeys)||!this.query.isEqual(t.query)||!this.docs.isEqual(t.docs)||!this.oldDocs.isEqual(t.oldDocs))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Yr=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r,i=((r={})[e]=Zr.createSynthesizedTargetChangeForCurrentChange(e,n),r);return new t(Ct.MIN,i,qt(),Rt(),Ut())},t}(),Zr=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(w(),n,Ut(),Ut(),Ut())},t}(),Jr=function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r},$r=function(t,e){this.targetId=t,this.existenceFilter=e};!function(t){t[t.NoChange=0]="NoChange",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Current=3]="Current",t[t.Reset=4]="Reset"}(Kr||(Kr={}));var ti=function(t,e,n,r){void 0===n&&(n=w()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ei=function(){function t(){this.pendingResponses=0,this.documentChanges=ii(),this._resumeToken=w(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),t.prototype.updateResumeToken=function(t){t.length>0&&(this._hasPendingChanges=!0,this._resumeToken=t)},t.prototype.toTargetChange=function(){var t=Ut(),e=Ut(),n=Ut();return this.documentChanges.forEach((function(r,i){switch(i){case Wr.Added:t=t.add(r);break;case Wr.Modified:e=e.add(r);break;case Wr.Removed:n=n.add(r);break;default:v("Encountered invalid change type: "+i)}})),new Zr(this._resumeToken,this._current,t,e,n)},t.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=ii()},t.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},t.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},t.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},t.prototype.recordTargetResponse=function(){this.pendingResponses-=1},t.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},t}(),ni=function(){function t(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=Rt(),this.pendingDocumentTargetMapping=ri(),this.pendingTargetResets=new Pt(Z)}return t.prototype.handleDocumentChange=function(t){for(var e=0,n=t.updatedTargetIds;e<n.length;e++){var r=n[e];t.newDoc instanceof Ge?this.addDocumentToTarget(r,t.newDoc):t.newDoc instanceof He&&this.removeDocumentFromTarget(r,t.key,t.newDoc)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){r=o[i];this.removeDocumentFromTarget(r,t.key,t.newDoc)}},t.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.ensureTargetState(n);switch(t.state){case Kr.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case Kr.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case Kr.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),_(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case Kr.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case Kr.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:v("Unknown target watch change state: "+t.state)}}))},t.prototype.forEachTarget=function(t,e){t.targetIds.length>0?t.targetIds.forEach(e):I(this.targetStates,e)},t.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.targetDataForActiveTarget(e);if(r){var i=r.target;if(i.isDocumentQuery())if(0===n){var o=new ft(i.path);this.removeDocumentFromTarget(e,o,new He(o,Ct.forDeletedDoc()))}else _(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(e)!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}},t.prototype.createRemoteEvent=function(t){var e=this,n={};I(this.targetStates,(function(r,i){var o=e.targetDataForActiveTarget(r);if(o){if(i.current&&o.target.isDocumentQuery()){var a=new ft(o.target.path);null!==e.pendingDocumentUpdates.get(a)||e.targetContainsDocument(r,a)||e.removeDocumentFromTarget(r,a,new He(a,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}}));var r=Ut();this.pendingDocumentTargetMapping.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.targetDataForActiveTarget(t);return!n||n.purpose===wn.LimboResolution||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Yr(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Rt(),this.pendingDocumentTargetMapping=ri(),this.pendingTargetResets=new Pt(Z),i},t.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?Wr.Modified:Wr.Added;this.ensureTargetState(t).addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},t.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,Wr.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},t.prototype.removeTarget=function(t){delete this.targetStates[t]},t.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.recordPendingTargetRequest=function(t){this.ensureTargetState(t).recordPendingTargetRequest()},t.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new ei),this.targetStates[t]},t.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new Pt(Z),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},t.prototype.isActiveTarget=function(t){var e=null!==this.targetDataForActiveTarget(t);return e||m("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.targetDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getTargetDataForTarget(t)},t.prototype.resetTarget=function(t){var e=this;_(!this.targetStates[t].isPending,"Should only reset active targets"),this.targetStates[t]=new ei,this.metadataProvider.getRemoteKeysForTarget(t).forEach((function(n){e.removeDocumentFromTarget(t,n,null)}))},t.prototype.targetContainsDocument=function(t,e){return this.metadataProvider.getRemoteKeysForTarget(t).has(e)},t}();function ri(){return new It(ft.comparator)}function ii(){return new It(ft.comparator)}var oi="RemoteStore",ai=function(){function t(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback((function(t){n.enqueueAndForget((function(){return a.__awaiter(o,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.canUseNetwork()?(m(oi,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.onlineStateTracker=new Br(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return a.__awaiter(this,void 0,void 0,(function(){var t;return a.__generator(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(Dr.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},t.prototype.disableNetwork=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Dr.Offline),[2]}}))}))},t.prototype.disableNetworkInternal=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),this.writePipeline.length>0&&(m(oi,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}}))}))},t.prototype.shutdown=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return m(oi,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(Dr.Unknown),[2]}}))}))},t.prototype.listen=function(t){S(this.listenTargets,t.targetId)||(this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t))},t.prototype.unlisten=function(t){_(S(this.listenTargets,t),"unlisten called on target no currently watched: "+t),delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),A(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(Dr.Unknown))},t.prototype.getTargetDataForTarget=function(t){return this.listenTargets[t]||null},t.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},t.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.startWatchStream=function(){_(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new ni(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!A(this.listenTargets)},t.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},t.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},t.prototype.onWatchStreamOpen=function(){return a.__awaiter(this,void 0,void 0,(function(){var t=this;return a.__generator(this,(function(e){return I(this.listenTargets,(function(e,n){t.sendWatchRequest(n)})),[2]}))}))},t.prototype.onWatchStreamClose=function(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return void 0===t&&_(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(Dr.Unknown),[2]}))}))},t.prototype.onWatchStreamChange=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:return this.onlineStateTracker.set(Dr.Online),t instanceof ti&&t.state===Kr.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof Jr?this.watchChangeAggregator.handleDocumentChange(t):t instanceof $r?this.watchChangeAggregator.handleExistenceFilter(t):(_(t instanceof ti,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(Ct.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),e.compareTo(n)>=0?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},t.prototype.raiseWatchSnapshot=function(t){var e=this;_(!t.isEqual(Ct.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(t);return I(n.targetChanges,(function(n,r){if(r.resumeToken.length>0){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.withResumeToken(r.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.withResumeToken(w(),n.snapshotVersion),e.sendUnwatchRequest(t);var r=new kn(n.target,t,wn.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}})),this.syncEngine.applyRemoteEvent(n)},t.prototype.handleTargetError=function(t){var e=this;_(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach((function(t){r=r.then((function(){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(e){return S(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]}))}))}))})),r},t.prototype.fillWritePipeline=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,e;return a.__generator(this,(function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(t=this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:-1,[4,this.localStore.nextMutationBatch(t)]):[3,4];case 1:return null!==(e=n.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}}))}))},t.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},t.prototype.outstandingWrites=function(){return this.writePipeline.length},t.prototype.addToWritePipeline=function(t){_(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},t.prototype.startWriteStream=function(){_(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return this.writeStream.writeHandshake(),[2]}))}))},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then((function(){for(var e=0,n=t.writePipeline;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}})).catch(Vn)},t.prototype.onMutationResult=function(t,e){var n=this;_(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=Gt.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then((function(){return n.fillWritePipeline()}))},t.prototype.onWriteStreamClose=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e=this;return a.__generator(this,(function(n){return void 0===t&&_(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),t&&this.writePipeline.length>0?(void 0,[2,(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then((function(){e.shouldStartWriteStream()&&e.startWriteStream()}))]):[2]}))}))},t.prototype.handleHandshakeError=function(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return Ur(t.code)?(m(oi,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=w(),[2,this.localStore.setLastStreamToken(w()).catch(Vn)]):[2]}))}))},t.prototype.handleWriteError=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n=this;return a.__generator(this,(function(r){return Ur(i=t.code)&&i!==x.ABORTED?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then((function(){return n.fillWritePipeline()}))]):[2];var i}))}))},t.prototype.createTransaction=function(){return new jr(this.datastore)},t.prototype.restartNetwork=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Dr.Unknown),[4,this.enableNetwork()];case 2:return t.sent(),[2]}}))}))},t.prototype.handleCredentialChange=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.canUseNetwork()?(m(oi,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.applyPrimaryState=function(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(Dr.Unknown),e.label=4;case 4:return[2]}}))}))},t}(),si=function(){function t(t,e){if(P("GeoPoint",arguments,2),R("GeoPoint","number",1,t),R("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new E(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new E(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return Z(this._lat,t._lat)||Z(this._long,t._long)},t}(),ui=function(){function t(){}return t.prototype.applyToLocalView=function(t,e){return new je(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),ci=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=pi(t),n=function(t){e.find((function(e){return e.isEqual(t)}))||e.push(t)},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new qe(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&J(e.elements,this.elements)},t}(),li=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=pi(t),n=function(t){e=e.filter((function(e){return!e.isEqual(t)}))},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new qe(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&J(e.elements,this.elements)},t}(),hi=function(){function t(t){this.operand=t}return t.prototype.applyToLocalView=function(t,e){var n=this.computeBaseValue(t);if(n instanceof Re&&this.operand instanceof Re){var r=n.internalValue+this.operand.internalValue;return new Re(r)}r=n.internalValue+this.operand.internalValue;return new Ne(r)},t.prototype.applyToRemoteDocument=function(t,e){return _(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},t.prototype.computeBaseValue=function(t){return t instanceof De?t:new Re(0)},t.prototype.isEqual=function(e){return e instanceof t&&this.operand.isEqual(e.operand)},t}();function pi(t){return t instanceof qe?t.internalValue.slice():[]}var fi=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}(),di=function(){var t={};return t[lr.ASCENDING.name]="ASCENDING",t[lr.DESCENDING.name]="DESCENDING",t}(),mi=function(){var t={};return t[rr.LESS_THAN.name]="LESS_THAN",t[rr.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",t[rr.GREATER_THAN.name]="GREATER_THAN",t[rr.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",t[rr.EQUAL.name]="EQUAL",t[rr.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",t[rr.IN.name]="IN",t[rr.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",t}(),yi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gi(t,e){_(!Zn(t),e+" is missing")}function vi(t){return"number"===typeof t?t:"string"===typeof t?Number(t):v("can't parse "+t)}var _i=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?x.UNKNOWN:Vr(t.code);return new E(e,t.message||"")},t.prototype.toInt32Value=function(t){return this.options.useProto3Json||Zn(t)?t:{value:t}},t.prototype.fromInt32Value=function(t){var e;return Zn(e="object"===typeof t?t.value:t)?null:e},t.prototype.toTimestamp=function(t){return this.options.useProto3Json?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"===typeof t)return this.fromIso8601String(t);_(!!t,"Cannot deserialize null or undefined timestamp.");var e=vi(t.seconds||"0"),n=t.nanos||0;return new St(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=yi.exec(t);if(_(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new St(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"===typeof t?(_(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),rt.fromBase64String(t)):(_(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),rt.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return _(!!t,"Trying to deserialize version that isn't set"),Ct.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=lt.fromString(t);return _(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return _(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),_(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new ft(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?lt.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new lt(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new lt(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return _(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof Oe)return{nullValue:"NULL_VALUE"};if(t instanceof Pe)return{booleanValue:t.value()};if(t instanceof Re)return{integerValue:""+t.value()};if(t instanceof Ne){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof Le?{stringValue:t.value()}:t instanceof Ve?{mapValue:this.toMapValue(t)}:t instanceof qe?{arrayValue:this.toArrayValue(t)}:t instanceof Fe?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof Ue?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof ze?{bytesValue:this.toBytes(t.value())}:t instanceof Be?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:v("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this;if("nullValue"in t)return Oe.INSTANCE;if("booleanValue"in t)return Pe.of(t.booleanValue);if("integerValue"in t)return new Re(vi(t.integerValue));if("doubleValue"in t){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Ne.NAN;if("Infinity"===t.doubleValue)return Ne.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Ne.NEGATIVE_INFINITY}return new Ne(t.doubleValue)}if("stringValue"in t)return new Le(t.stringValue);if("mapValue"in t)return this.fromFields(t.mapValue.fields||{});if("arrayValue"in t){gi(t.arrayValue,"arrayValue");var n=t.arrayValue.values||[];return new qe(n.map((function(t){return e.fromValue(t)})))}if("timestampValue"in t)return gi(t.timestampValue,"timestampValue"),new Fe(this.fromTimestamp(t.timestampValue));if("geoPointValue"in t){gi(t.geoPointValue,"geoPointValue");var r=t.geoPointValue.latitude||0,i=t.geoPointValue.longitude||0;return new Ue(new si(r,i))}if("bytesValue"in t){gi(t.bytesValue,"bytesValue");var o=this.fromBlob(t.bytesValue);return new ze(o)}if("referenceValue"in t){gi(t.referenceValue,"referenceValue");var a=this.fromResourceName(t.referenceValue),s=new st(a.get(1),a.get(3)),u=new ft(this.extractLocalPathFromResourceName(a));return new Be(s,u)}return v("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return _(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data()),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t,e){var n=this,r=this.fromName(t.name),i=this.fromVersion(t.updateTime);return new Ge(r,i,{hasCommittedMutations:!!e},void 0,t,(function(t){return n.fromValue(t)}))},t.prototype.toFields=function(t){var e=this,n={};return t.forEach((function(t,r){n[t]=e.toValue(r)})),n},t.prototype.fromFields=function(t){var e=this,n=t,r=Ve.EMPTY;return k(n,(function(t,n){r=r.set(new pt([t]),e.fromValue(n))})),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach((function(t){n.push(e.toValue(t))})),{values:n}},t.prototype.fromFound=function(t){var e=this;_(!!t.found,"Tried to deserialize a found document from a missing document."),gi(t.found.name,"doc.found.name"),gi(t.found.updateTime,"doc.found.updateTime");var n=this.fromName(t.found.name),r=this.fromVersion(t.found.updateTime);return new Ge(n,r,{},void 0,t.found,(function(t){return e.fromValue(t)}))},t.prototype.fromMissing=function(t){_(!!t.missing,"Tried to deserialize a missing document from a found document."),_(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new He(e,n)},t.prototype.fromMaybeDocument=function(t){return"found"in t?this.fromFound(t):"missing"in t?this.fromMissing(t):v("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case Kr.Added:return"ADD";case Kr.Current:return"CURRENT";case Kr.NoChange:return"NO_CHANGE";case Kr.Removed:return"REMOVE";case Kr.Reset:return"RESET";default:return v("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof $r)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof Jr){if(t.newDoc instanceof Ge){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data()),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof He){e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof ti){var n=void 0;return t.cause&&(n={code:qr(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return v("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=this;if("targetChange"in t){gi(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new ti(r,i,o,s||null)}else if("documentChange"in t){gi(t.documentChange,"documentChange");var u=t.documentChange;gi(u.document,"documentChange.name"),gi(u.document.name,"documentChange.document.name"),gi(u.document.updateTime,"documentChange.document.updateTime");var c=this.fromName(u.document.name),l=this.fromVersion(u.document.updateTime),h=new Ge(c,l,{},void 0,u.document,(function(t){return n.fromValue(t)})),p=u.targetIds||[],f=u.removedTargetIds||[];e=new Jr(p,f,h.key,h)}else if("documentDelete"in t){gi(t.documentDelete,"documentDelete");var d=t.documentDelete;gi(d.document,"documentDelete.document");c=this.fromName(d.document),l=d.readTime?this.fromVersion(d.readTime):Ct.forDeletedDoc(),h=new He(c,l),f=d.removedTargetIds||[];e=new Jr([],f,h.key,h)}else if("documentRemove"in t){gi(t.documentRemove,"documentRemove");var m=t.documentRemove;gi(m.document,"documentRemove");c=this.fromName(m.document),f=m.removedTargetIds||[];e=new Jr([],f,c,null)}else{if(!("filter"in t))return v("Unknown change type "+JSON.stringify(t));gi(t.filter,"filter");var y=t.filter;gi(y.targetId,"filter.targetId");var g=y.count||0,_=new fi(g),b=y.targetId;e=new $r(b,_)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?Kr.NoChange:"ADD"===t?Kr.Added:"REMOVE"===t?Kr.Removed:"CURRENT"===t?Kr.Current:"RESET"===t?Kr.Reset:v("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!("targetChange"in t))return Ct.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?Ct.MIN:e.readTime?this.fromVersion(e.readTime):Ct.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof Te)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof Ie)e={delete:this.toName(t.key)};else if(t instanceof Se)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof Ce))return v("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map((function(t){return n.toFieldTransform(t)}))}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):xe.NONE;if(t.update){gi(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new Se(r,i,o,n)}return new Te(r,i,n)}if(t.delete){r=this.fromName(t.delete);return new Ie(r,n)}if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map((function(t){return e.fromFieldTransform(t)}));return _(!0===n.exists,'Transforms only support precondition "exists == true"'),new Ce(r,a)}return v("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return _(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:v("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?xe.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?xe.exists(t.exists):xe.NONE},t.prototype.fromWriteResult=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);r.isEqual(Ct.MIN)&&(r=this.fromVersion(e));var i=null;return t.transformResults&&t.transformResults.length>0&&(i=t.transformResults.map((function(t){return n.fromValue(t)}))),new _e(r,i)},t.prototype.fromWriteResults=function(t,e){var n=this;return t&&t.length>0?(_(void 0!==e,"Received a write result without a commit time"),t.map((function(t){return n.fromWriteResult(t,e)}))):[]},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof ui)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ci)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map((function(t){return e.toValue(t)}))}};if(n instanceof li)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map((function(t){return e.toValue(t)}))}};if(n instanceof hi)return{fieldPath:t.field.canonicalString(),increment:this.toValue(n.operand)};throw v("Unknown transform: "+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=null;if("setToServerValue"in t)_("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=ui.instance;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new ci(r.map((function(t){return e.fromValue(t)})))}else if("removeAllFromArray"in t){r=t.removeAllFromArray.values||[];n=new li(r.map((function(t){return e.fromValue(t)})))}else if("increment"in t){var i=this.fromValue(t.increment);_(i instanceof De,"NUMERIC_ADD transform requires a NumberValue"),n=new hi(i)}else v("Unknown transform proto: "+JSON.stringify(t));var o=pt.fromServerFormat(t.fieldPath);return new ve(o,n)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;_(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return er.atPath(this.fromQueryPath(n)).toTarget()},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(_(n.length%2===0,"Collection Group queries should be within a document path or root."),e.parent=this.toQueryPath(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(_(n.length%2!==0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){_(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var l=null;return n.endAt&&(l=this.fromCursor(n.endAt)),new er(e,i,s,a,u,$n.First,c,l).toTarget()},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case wn.Listen:return null;case wn.ExistenceFilterMismatch:return"existence-filter-mismatch";case wn.LimboResolution:return"limbo-document";default:return v("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.target;return(e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map((function(t){return t instanceof ir?e.toUnaryOrFieldFilter(t):v("Unrecognized filter: "+JSON.stringify(t))}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromFieldFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return e.fromFilter(t)})).reduce((function(t,e){return t.concat(e)})):v("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map((function(t){return e.toPropertyOrder(t)}))},t.prototype.fromOrder=function(t){var e=this;return t.map((function(t){return e.fromPropertyOrder(t)}))},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map((function(t){return e.toValue(t)}))}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map((function(t){return e.fromValue(t)}));return new hr(r,n)},t.prototype.toDirection=function(t){return di[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return lr.ASCENDING;case"DESCENDING":return lr.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return mi[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return rr.EQUAL;case"GREATER_THAN":return rr.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return rr.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return rr.LESS_THAN;case"LESS_THAN_OR_EQUAL":return rr.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return rr.ARRAY_CONTAINS;case"IN":return rr.IN;case"ARRAY_CONTAINS_ANY":return rr.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return v("Unspecified operator");default:return v("Unknown operator")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return pt.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new pr(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.fromFieldFilter=function(t){return ir.create(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryOrFieldFilter=function(t){if(t.op===rr.EQUAL){if(t.value.isEqual(Ne.NAN))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}};if(t.value.isEqual(Oe.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return ir.create(e,rr.EQUAL,Ne.NAN);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return ir.create(n,rr.EQUAL,Oe.INSTANCE);case"OPERATOR_UNSPECIFIED":return v("Unspecified filter");default:return v("Unknown filter")}},t.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}},t.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map((function(t){return pt.fromServerFormat(t)}));return ge.fromArray(e)},t}(),bi=function(){this.viewSnap=null,this.targetId=0,this.listeners=[]},wi=function(){function t(t){this.syncEngine=t,this.queries=new Qe((function(t){return t.canonicalId()})),this.onlineState=Dr.Unknown,this.snapshotsInSyncListeners=new Set,this.syncEngine.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);(r||(n=!0,r=new bi,this.queries.set(e,r)),r.listeners.push(t),_(!t.applyOnlineStateChange(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),r.viewSnap)&&(t.onViewSnapshot(r.viewSnap)&&this.raiseSnapshotsInSyncEvent());return n?this.syncEngine.listen(e).then((function(t){return r.targetId=t,t})):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return a.__generator(this,(function(o){return e=t.query,n=!1,(r=this.queries.get(e))&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]}))}))},t.prototype.onWatchChange=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,a=this.queries.get(o);if(a){for(var s=0,u=a.listeners;s<u.length;s++){u[s].onViewSnapshot(i)&&(e=!0)}a.viewSnap=i}}e&&this.raiseSnapshotsInSyncEvent()},t.prototype.onWatchError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){i[r].onError(e)}this.queries.delete(t)},t.prototype.onOnlineStateChange=function(t){this.onlineState=t;var e=!1;this.queries.forEach((function(n,r){for(var i=0,o=r.listeners;i<o.length;i++){o[i].applyOnlineStateChange(t)&&(e=!0)}})),e&&this.raiseSnapshotsInSyncEvent()},t.prototype.addSnapshotsInSyncListener=function(t){this.snapshotsInSyncListeners.add(t),t.next()},t.prototype.removeSnapshotsInSyncListener=function(t){this.snapshotsInSyncListeners.delete(t)},t.prototype.raiseSnapshotsInSyncEvent=function(){this.snapshotsInSyncListeners.forEach((function(t){t.next()}))},t}(),xi=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.snap=null,this.onlineState=Dr.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(_(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Wr.Metadata&&e.push(i)}t=new Xr(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(t)&&(this.queryObserver.next(t),o=!0):this.shouldRaiseInitialEvent(t,this.onlineState)&&(this.raiseInitialEvent(t),o=!0),this.snap=t,o},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t;var e=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&(this.raiseInitialEvent(this.snap),e=!0),e},t.prototype.shouldRaiseInitialEvent=function(t,e){if(_(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==Dr.Offline;return this.options.waitForSyncWhenOnline&&n?(_(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===Dr.Offline},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(t){_(!this.raisedInitialEvent,"Trying to raise initial events for second time"),t=Xr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},t}(),Ei=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.addedKeys=n,this.removedKeys=r}return t.fromSnapshot=function(e,n){for(var r=Ut(),i=Ut(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case Wr.Added:r=r.add(s.doc.key);break;case Wr.Removed:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Ti=function(t){this.key=t},Si=function(t){this.key=t},Ci=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=Ut(),this.mutatedKeys=Ut(),this.documentSet=new Hr(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new Qr,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimitToFirst()&&i.size===this.query.limit?i.last():null,c=this.query.hasLimitToLast()&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=e instanceof Ge?e:null;h&&(_(t.isEqual(h.key),"Mismatching keys found in document changes: "+t+" != "+h.key),h=n.query.matches(h)?h:null);var p=!!l&&n.mutatedKeys.has(l.key),f=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),d=!1;l&&h?l.data().isEqual(h.data())?p!==f&&(r.track({type:Wr.Metadata,doc:h}),d=!0):n.shouldWaitForSyncedDocument(l,h)||(r.track({type:Wr.Modified,doc:h}),d=!0,(u&&n.query.docComparator(h,u)>0||c&&n.query.docComparator(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:Wr.Added,doc:h}),d=!0):l&&!h&&(r.track({type:Wr.Removed,doc:l}),d=!0,(u||c)&&(s=!0));d&&(h?(a=a.add(h),o=f?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),this.query.hasLimitToFirst()||this.query.hasLimitToLast())for(;a.size>this.query.limit;){var l=this.query.hasLimitToFirst()?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:Wr.Removed,doc:l})}return _(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this;_(!t.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case Wr.Added:return 1;case Wr.Modified:case Wr.Metadata:return 2;case Wr.Removed:return 0;default:return v("Unknown ChangeType: "+t)}};return n(t)-n(e)}(t.type,e.type)||r.query.docComparator(t.doc,e.doc)})),this.applyTargetChange(n);var a=e?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?Gr.Synced:Gr.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new Xr(this.query,t.documentSet,i,o,t.mutatedKeys,s===Gr.Local,u,!1),limboChanges:a}:{limboChanges:a}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===Dr.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Qr,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&(!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations)},t.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e._syncedDocuments=e._syncedDocuments.add(t)})),t.modifiedDocuments.forEach((function(t){return _(e._syncedDocuments.has(t),"Modified document "+t+" not found in view.")})),t.removedDocuments.forEach((function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)})),this.current=t.current)},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=Ut(),this.documentSet.forEach((function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))}));var n=[];return e.forEach((function(e){t.limboDocuments.has(e)||n.push(new Si(e))})),this.limboDocuments.forEach((function(t){e.has(t)||n.push(new Ti(t))})),n},t.prototype.synchronizeWithPersistedState=function(t){this._syncedDocuments=t.remoteKeys,this.limboDocuments=Ut();var e=this.computeDocChanges(t.documents);return this.applyChanges(e,!0)},t.prototype.computeInitialSnapshot=function(){return Xr.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===Gr.Local)},t}();var Ii=5,ki=function(){function t(t,e,n,r){this.asyncQueue=t,this.remoteStore=e,this.updateFunction=n,this.deferred=r,this.retries=Ii,this.backoff=new Pr(this.asyncQueue,nt.RetryTransaction)}return t.prototype.run=function(){this.runWithBackOff()},t.prototype.runWithBackOff=function(){var t=this;this.backoff.backoffAndRun((function(){return a.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return a.__generator(this,(function(r){return t=this.remoteStore.createTransaction(),(e=this.tryRunUpdateFunction(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.handleTransactionError(t)}))}))})).catch((function(t){n.handleTransactionError(t)})),[2]}))}))}))},t.prototype.tryRunUpdateFunction=function(t){try{var e=this.updateFunction(t);return!Zn(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(y){return this.deferred.reject(y),null}},t.prototype.handleTransactionError=function(t){var e=this;this.retries>0&&this.isRetryableTransactionError(t)?(this.retries-=1,this.asyncQueue.enqueueAndForget((function(){return e.runWithBackOff(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.isRetryableTransactionError=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ur(e)}return!1},t}(),Ai=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Oi=function(t){this.key=t,this.receivedDocument=!1},Pi=function(){function t(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new Qe((function(t){return t.canonicalId()})),this.queriesByTarget={},this.limboTargetsByKey=new It(ft.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new gr,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=le.forSyncEngine(),this.isPrimary=void 0,this.onlineState=Dr.Unknown}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){_(null!==t,"SyncEngine listener cannot be null"),_(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=t},t.prototype.listen=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o;return a.__generator(this,(function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(t))?(e=r.targetId,this.sharedClientState.addLocalQueryTarget(e),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateTarget(t.toTarget())];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(t,e,"current"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}}))}))},t.prototype.initializeViewAndComputeSnapshot=function(t,e,n){return a.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,u,c;return a.__generator(this,(function(a){switch(a.label){case 0:return[4,this.localStore.executeQuery(t,!0)];case 1:return r=a.sent(),i=new Ci(t,r.remoteKeys),o=i.computeDocChanges(r.documents),s=Zr.createSynthesizedTargetChangeForCurrentChange(e,n&&this.onlineState!==Dr.Offline),_(0===(u=i.applyChanges(o,!0===this.isPrimary,s)).limboChanges.length,"View returned limbo docs before target ack from the server."),_(!!u.snapshot,"applyChanges for new view should always return a snapshot"),c=new Ai(t,e,i),this.queryViewsByQuery.set(t,c),this.queriesByTarget[e]||(this.queriesByTarget[e]=[]),this.queriesByTarget[e].push(t),[2,u.snapshot]}}))}))},t.prototype.synchronizeViewAndComputeSnapshot=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n;return a.__generator(this,(function(r){switch(r.label){case 0:return[4,this.localStore.executeQuery(t.query,!0)];case 1:return e=r.sent(),n=t.view.synchronizeWithPersistedState(e),this.isPrimary&&this.updateTrackedLimbos(t.targetId,n.limboChanges),[2,n]}}))}))},t.prototype.unlisten=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r=this;return a.__generator(this,(function(i){switch(i.label){case 0:return this.assertSubscribed("unlisten()"),_(!!(e=this.queryViewsByQuery.get(t)),"Trying to unlisten on query not found:"+t),(n=this.queriesByTarget[e.targetId]).length>1?(this.queriesByTarget[e.targetId]=n.filter((function(e){return!e.isEqual(t)})),this.queryViewsByQuery.delete(t),[2]):this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.sharedClientState.isActiveQueryTarget(e.targetId)?[3,2]:[4,this.localStore.releaseTarget(e.targetId,!1).then((function(){r.sharedClientState.clearQueryState(e.targetId),r.remoteStore.unlisten(e.targetId),r.removeAndCleanupTarget(e.targetId)})).catch(Vn)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupTarget(e.targetId),[4,this.localStore.releaseTarget(e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},t.prototype.write=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:return this.assertSubscribed("write()"),[4,this.localStore.localWrite(t)];case 1:return n=r.sent(),this.sharedClientState.addPendingMutation(n.batchId),this.addMutationCallback(n.batchId,e),[4,this.emitNewSnapsAndNotifyLocalStore(n.changes)];case 2:return r.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return r.sent(),[2]}}))}))},t.prototype.runTransaction=function(t,e,n){new ki(t,this.remoteStore,e,n).run()},t.prototype.applyRemoteEvent=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(t)];case 2:return e=r.sent(),k(t.targetChanges,(function(t,e){var r=n.limboResolutionsByTarget[Number(t)];r&&(_(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),e.addedDocuments.size>0?r.receivedDocument=!0:e.modifiedDocuments.size>0?_(r.receivedDocument,"Received change for limbo target document without add."):e.removedDocuments.size>0&&(_(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))})),[4,this.emitNewSnapsAndNotifyLocalStore(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,Vn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===Mr.RemoteStore||!this.isPrimary&&e===Mr.SharedClientState){this.assertSubscribed("applyOnlineStateChange()");var n=[];this.queryViewsByQuery.forEach((function(e,r){var i=r.view.applyOnlineStateChange(t);_(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)})),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},t.prototype.rejectListen=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,s,u=this;return a.__generator(this,(function(a){switch(a.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(t,"rejected",e),n=this.limboResolutionsByTarget[t],(r=n&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=(i=new It(ft.comparator)).insert(r,new He(r,Ct.forDeletedDoc())),o=Ut().add(r),s=new Yr(Ct.MIN,{},new Pt(Z),i,o),[2,this.applyRemoteEvent(s)]):[3,1];case 1:return[4,this.localStore.releaseTarget(t,!1).then((function(){return u.removeAndCleanupTarget(t,e)})).catch(Vn)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))},t.prototype.applyBatchState=function(t,e,n){return a.__awaiter(this,void 0,void 0,(function(){var r;return a.__generator(this,(function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return null===(r=i.sent())?(m("SyncEngine","Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):v("Unknown batchState: "+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}}))}))},t.prototype.applySuccessfulWrite=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n;return a.__generator(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applySuccessfulWrite()"),e=t.batch.batchId,this.processUserCallback(e,null),this.triggerPendingWritesCallbacks(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(e,"acknowledged"),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,Vn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.rejectFailedWrite=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.triggerPendingWritesCallbacks(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(t,"rejected",e),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,Vn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.registerPendingWritesCallback=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n;return a.__generator(this,(function(r){switch(r.label){case 0:return this.remoteStore.canUseNetwork()||m("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.localStore.getHighestUnacknowledgedBatchId()];case 1:return-1===(e=r.sent())?(t.resolve(),[2]):((n=this.pendingWritesCallbacks.get(e)||[]).push(t),this.pendingWritesCallbacks.set(e,n),[2])}}))}))},t.prototype.triggerPendingWritesCallbacks=function(t){(this.pendingWritesCallbacks.get(t)||[]).forEach((function(t){t.resolve()})),this.pendingWritesCallbacks.delete(t)},t.prototype.rejectOutstandingPendingWritesCallbacks=function(t){this.pendingWritesCallbacks.forEach((function(e){e.forEach((function(e){e.reject(new E(x.CANCELLED,t))}))})),this.pendingWritesCallbacks.clear()},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new It(Z)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(_(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupTarget=function(t,e){var n=this;void 0===e&&(e=null),this.sharedClientState.removeLocalQueryTarget(t),_(this.queriesByTarget[t]&&0!==this.queriesByTarget[t].length,"There are no queries mapped to target id "+t);for(var r=0,i=this.queriesByTarget[t];r<i.length;r++){var o=i[r];this.queryViewsByQuery.delete(o),e&&this.syncEngineListener.onWatchError(o,e)}if(delete this.queriesByTarget[t],this.isPrimary){var a=this.limboDocumentRefs.referencesForId(t);this.limboDocumentRefs.removeReferencesForId(t),a.forEach((function(t){n.limboDocumentRefs.containsKey(t)||n.removeLimboTarget(t)}))}},t.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i instanceof Ti)this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i);else if(i instanceof Si){m("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)}else v("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){m("SyncEngine","New document in limbo: "+e);var n=this.limboTargetIdGenerator.next(),r=er.atPath(e.path);this.limboResolutionsByTarget[n]=new Oi(e),this.remoteStore.listen(new kn(r.toTarget(),n,wn.LimboResolution,ut.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n,r,i,o=this;return a.__generator(this,(function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach((function(a,s){i.push(Promise.resolve().then((function(){var e=s.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(s.query,!1).then((function(t){var n=t.documents;return s.view.computeDocChanges(n,e)})):e})).then((function(t){var i=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=Ei.fromSnapshot(s.targetId,a.snapshot);r.push(u)}})))})),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}}))}))},t.prototype.assertSubscribed=function(t){_(null!==this.syncEngineListener,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleCredentialChange=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n;return a.__generator(this,(function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.rejectOutstandingPendingWritesCallbacks("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.localStore.handleUserChange(t)]):[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}}))}))},t.prototype.applyPrimaryState=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,c=this;return a.__generator(this,(function(a){switch(a.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return a.sent(),e=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e.toArray())];case 2:for(n=a.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,s=[],u=Promise.resolve(),I(this.queriesByTarget,(function(t,e){c.sharedClientState.isLocalQueryTarget(t)?s.push(t):u=u.then((function(){return c.removeAndCleanupTarget(t),c.localStore.releaseTarget(t,!0)})),c.remoteStore.unlisten(t)})),[4,u]);case 4:return a.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(s)];case 5:return a.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:a.sent(),a.label=7;case 7:return[2]}}))}))},t.prototype.resetLimboDocuments=function(){var t=this;I(this.limboResolutionsByTarget,(function(e){t.remoteStore.unlisten(e)})),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new It(ft.comparator)},t.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,c,l,h,p,f,d;return a.__generator(this,(function(a){switch(a.label){case 0:e=[],n=[],r=0,i=t,a.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(u=this.queriesByTarget[o])&&0!==u.length?[4,this.localStore.releaseTarget(o,!0)]:[3,8]):[3,14];case 2:return a.sent(),[4,this.localStore.allocateTarget(u[0].toTarget())];case 3:s=a.sent(),c=0,l=u,a.label=4;case 4:return c<l.length?(h=l[c],_(!!(p=this.queryViewsByQuery.get(h)),"No query view found for "+h),[4,this.synchronizeViewAndComputeSnapshot(p)]):[3,7];case 5:(f=a.sent()).snapshot&&n.push(f.snapshot),a.label=6;case 6:return c++,[3,4];case 7:return[3,12];case 8:return _(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.localStore.getTarget(o)];case 9:return _(!!(d=a.sent()),"Target for id "+o+" not found"),[4,this.localStore.allocateTarget(d)];case 10:return s=a.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(d),o,!1)];case 11:a.sent(),a.label=12;case 12:e.push(s),a.label=13;case 13:return r++,[3,1];case 14:return this.syncEngineListener.onWatchChange(n),[2,e]}}))}))},t.prototype.synthesizeTargetToQuery=function(t){return new er(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,$n.First,t.startAt,t.endAt)},t.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},t.prototype.applyTargetState=function(t,e,n){return a.__awaiter(this,void 0,void 0,(function(){var r,i;return a.__generator(this,(function(o){switch(o.label){case 0:if(this.isPrimary)return m("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.queriesByTarget[t])return[3,7];switch(e){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.localStore.getNewDocumentChanges()];case 2:return r=o.sent(),i=Yr.createSynthesizedRemoteEventForCurrentChange(t,"current"===e),[4,this.emitNewSnapsAndNotifyLocalStore(r,i)];case 3:return o.sent(),[3,7];case 4:return[4,this.localStore.releaseTarget(t,!0)];case 5:return o.sent(),this.removeAndCleanupTarget(t,n),[3,7];case 6:v("Unexpected target state: "+e),o.label=7;case 7:return[2]}}))}))},t.prototype.applyActiveTargetsChange=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,s,u,c,l,h,p=this;return a.__generator(this,(function(f){switch(f.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,f.label=1;case 1:return n<r.length?(h=r[n],_(!this.queriesByTarget[h],"Trying to add an already active target"),[4,this.localStore.getTarget(h)]):[3,6];case 2:return _(!!(i=f.sent()),"Query data for active target "+h+" not found"),[4,this.localStore.allocateTarget(i)];case 3:return o=f.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(i),o.targetId,!1)];case 4:f.sent(),this.remoteStore.listen(o),f.label=5;case 5:return n++,[3,1];case 6:s=function(t){return a.__generator(this,(function(e){switch(e.label){case 0:return u.queriesByTarget[t]?[4,u.localStore.releaseTarget(t,!1).then((function(){p.remoteStore.unlisten(t),p.removeAndCleanupTarget(t)})).catch(Vn)]:[2,"continue"];case 1:return e.sent(),[2]}}))},u=this,c=0,l=e,f.label=7;case 7:return c<l.length?(h=l[c],[5,s(h)]):[3,10];case 8:f.sent(),f.label=9;case 9:return c++,[3,7];case 10:return[2]}}))}))},t.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},t.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},t.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];if(e&&e.receivedDocument)return Ut().add(e.key);var n=Ut(),r=this.queriesByTarget[t];if(!r)return n;for(var i=0,o=r;i<o.length;i++){var a=o[i],s=this.queryViewsByQuery.get(a);_(!!s,"No query view found for "+a),n=n.unionWith(s.view.syncedDocuments)}return n},t}(),Di=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),Mi="firestore_clients";function Ri(t,e){return _(-1===e.indexOf("_"),"Client key cannot contain '_', but was '"+e+"'"),Mi+"_"+t+"_"+e}var Ni="firestore_mutations";function Li(t,e,n){var r=Ni+"_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}var Fi="firestore_targets";function ji(t,e){return Fi+"_"+t+"_"+e}var zi="firestore_online_state";var Bi="firestore_sequence_number";var Ui="SharedClientState",Vi=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r,_(void 0!==r===("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n,r){var i=JSON.parse(r),o="object"===typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"===typeof i.error),a=void 0;return o&&i.error&&(o="string"===typeof i.error.message&&"string"===typeof i.error.code)&&(a=new E(i.error.code,i.error.message)),o?new t(e,n,i.state,a):(y(Ui,"Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),qi=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n,_(void 0!==n===("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n){var r=JSON.parse(n),i="object"===typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"===typeof r.error),o=void 0;return i&&r.error&&(i="string"===typeof r.error.message&&"string"===typeof r.error.code)&&(o=new E(r.error.code,r.error.message)),i?new t(e,r.state,o):(y(Ui,"Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Wi=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.fromWebStorageEntry=function(e,n){for(var r=JSON.parse(n),i="object"===typeof r&&r.activeTargetIds instanceof Array,o=qt(),a=0;i&&a<r.activeTargetIds.length;++a)i=Jn(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(y(Ui,"Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Gi=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.fromWebStorageEntry=function(e){var n=JSON.parse(e);return"object"===typeof n&&n.onlineState in Dr&&"string"===typeof n.clientId?new t(n.clientId,Dr[n.onlineState]):(y(Ui,"Failed to parse online state: "+e),null)},t}(),Hi=function(){function t(){this.activeTargetIds=qt()}return t.prototype.addQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Ki=function(){function t(e,n,r,i,o){if(this.queue=e,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!t.isAvailable(this.platform))throw new E(x.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=Ri(this.persistenceKey,this.localClientId),this.sequenceNumberKey=function(t){return Bi+"_"+t}(this.persistenceKey),this.activeClients[this.localClientId]=new Hi,this.clientStateKeyRe=new RegExp("^"+Mi+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Ni+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+Fi+"_"+a+"_(\\d+)$"),this.onlineStateKey=function(t){return zi+"_"+t}(this.persistenceKey),this.platform.window.addEventListener("storage",this.storageListener)}return t.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,c,l,h,p=this;return a.__generator(this,(function(a){switch(a.label){case 0:return _(!this.started,"WebStorageSharedClientState already started"),_(null!==this.syncEngine,"syncEngine property must be set before calling start()"),_(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(t=a.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.localClientId&&(i=this.getItem(Ri(this.persistenceKey,r)))&&(o=Wi.fromWebStorageEntry(r,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(s=this.storage.getItem(this.onlineStateKey))&&(u=this.fromWebStorageOnlineState(s))&&this.handleOnlineStateEvent(u),c=0,l=this.earlyEvents;c<l.length;c++)h=l[c],this.handleWebStorageEvent(h);return this.earlyEvents=[],this.platform.window.addEventListener("unload",(function(){return p.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){var t=qt();return k(this.activeClients,(function(e,n){t=t.unionWith(n.activeTargetIds)})),t},t.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},t.prototype.addPendingMutation=function(t){this.persistMutationState(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(ji(this.persistenceKey,t));if(n){var r=qi.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},t.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},t.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(ji(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.removeMutationState(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.persistOnlineState(t)},t.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return m(Ui,"READ",t,e),e},t.prototype.setItem=function(t,e){m(Ui,"SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){m(Ui,"REMOVE",t),this.storage.removeItem(t)},t.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(m(Ui,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void y("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget((function(){return a.__awaiter(e,void 0,void 0,(function(){var e,n,r,i,o,s;return a.__generator(this,(function(a){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue))return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue)))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(_(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(s=function(t){var e=ut.INVALID;if(null!=t)try{var n=JSON.parse(t);_("number"===typeof n,"Found non-numeric sequence number"),e=n}catch(r){y(Ui,"Failed to read sequence number from WebStorage",r)}return e}(t.newValue))!==ut.INVALID&&this.sequenceNumberHandler(s));return[2]}))}))}))}},Object.defineProperty(t.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),t.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},t.prototype.persistMutationState=function(t,e,n){var r=new Vi(this.currentUser,t,e,n),i=Li(this.persistenceKey,this.currentUser,t);this.setItem(i,r.toWebStorageJSON())},t.prototype.removeMutationState=function(t){var e=Li(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.persistOnlineState=function(t){var e={clientId:this.localClientId,onlineState:Dr[t]};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},t.prototype.persistQueryTargetState=function(t,e,n){var r=ji(this.persistenceKey,t),i=new qi(t,e,n);this.setItem(r,i.toWebStorageJSON())},t.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},t.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return _(null!==n,"Cannot parse client state key '"+t+"'"),Wi.fromWebStorageEntry(n,e)},t.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);_(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Vi.fromWebStorageEntry(new Di(i),r,e)},t.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);_(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return qi.fromWebStorageEntry(r,e)},t.prototype.fromWebStorageOnlineState=function(t){return Gi.fromWebStorageEntry(t)},t.prototype.handleMutationBatchEvent=function(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return t.user.uid!==this.currentUser.uid?(m(Ui,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]}))}))},t.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},t.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],s=[];return i.forEach((function(t){return a.__awaiter(n,void 0,void 0,(function(){return a.__generator(this,(function(e){return r.has(t)||o.push(t),[2]}))}))})),r.forEach((function(t){return a.__awaiter(n,void 0,void 0,(function(){return a.__generator(this,(function(e){return i.has(t)||s.push(t),[2]}))}))})),this.syncEngine.applyActiveTargetsChange(o,s)},t.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},t}();var Qi=function(){function t(){this.localState=new Hi,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},t.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.queryState[t]},t.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.start=function(){return this.localState=new Hi,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t}(),Xi=function(){function t(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}return t.prototype.lruParams=function(){return Mn.withCacheSize(this.cacheSizeBytes)},t}(),Yi=function(){},Zi=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=Y.newId()}return t.prototype.start=function(t){var e=this;this.verifyNotTerminated();var n=new dt,r=new dt,i=!1;return this.credentials.setChangeListener((function(o){i?e.asyncQueue.enqueueAndForget((function(){return e.handleCredentialChange(o)})):(i=!0,e.initializePersistence(t,r,o).then((function(t){return e.initializeRest(o,t)})).then(n.resolve,n.reject))})),this.asyncQueue.enqueueAndForget((function(){return n.promise})),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.syncEngine.enableNetwork()}))},t.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof Xi?this.startIndexedDbPersistence(n,t).then((function(t){return e.resolve(),t})).catch((function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.startMemoryPersistence()})):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof E?t.code===x.FAILED_PRECONDITION||t.code===x.UNIMPLEMENTED:!("undefined"!==typeof DOMException&&t instanceof DOMException)||(22===t.code||20===t.code||11===t.code)},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new E(x.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=Un.buildStoragePrefix(this.databaseInfo),i=new _i(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then((function(){return a.__awaiter(n,void 0,void 0,(function(){var n,o;return a.__generator(this,(function(a){switch(a.label){case 0:if(e.synchronizeTabs&&!Ki.isAvailable(this.platform))throw new E(x.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return n=e.lruParams(),this.sharedClientState=e.synchronizeTabs?new Ki(this.asyncQueue,this.platform,r,this.clientId,t):new Qi,[4,Un.createIndexedDbPersistence({allowTabSynchronization:e.synchronizeTabs,persistenceKey:r,clientId:this.clientId,platform:this.platform,queue:this.asyncQueue,serializer:i,lruParams:n,sequenceNumberSyncer:this.sharedClientState})];case 1:return o=a.sent(),this.persistence=o,[2,o.referenceDelegate.garbageCollector]}}))}))}))},t.prototype.startMemoryPersistence=function(){return this.persistence=Tr.createEagerPersistence(this.clientId),this.sharedClientState=new Qi,Promise.resolve(null)},t.prototype.initializeRest=function(t,e){var n=this;return m("FirestoreClient","Initializing. user=",t.uid),this.platform.loadConnection(this.databaseInfo).then((function(r){return a.__awaiter(n,void 0,void 0,(function(){var n,i,o,s,u,c,l=this;return a.__generator(this,(function(h){switch(h.label){case 0:return n=new mr,this.localStore=new _r(this.persistence,n,t),[4,this.localStore.start()];case 1:return h.sent(),e&&(this.lruScheduler=new Rn(e,this.asyncQueue,this.localStore)),i=this.platform.newConnectivityMonitor(),o=this.platform.newSerializer(this.databaseInfo.databaseId),s=new Fr(this.asyncQueue,r,this.credentials,o),u=function(t){return l.syncEngine.applyOnlineStateChange(t,Mr.RemoteStore)},c=function(t){return l.syncEngine.applyOnlineStateChange(t,Mr.SharedClientState)},this.remoteStore=new ai(this.localStore,s,this.asyncQueue,u,i),this.syncEngine=new Pi(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=c,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new wi(this.syncEngine),[4,this.sharedClientState.start()];case 2:return h.sent(),[4,this.remoteStore.start()];case 3:return h.sent(),[4,this.persistence.setPrimaryStateListener((function(t){return a.__awaiter(l,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}}))}))}))];case 4:return h.sent(),[4,this.persistence.setDatabaseDeletedListener((function(){return a.__awaiter(l,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))}))];case 5:return h.sent(),[2]}}))}))}))},t.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),m("FirestoreClient","Credential Changed. Current user: "+t.uid),this.syncEngine.handleCredentialChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.syncEngine.disableNetwork()}))},t.prototype.terminate=function(){var t=this;return this.asyncQueue.enqueueAndInitiateShutdown((function(){return a.__awaiter(t,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return t.sent(),[4,this.sharedClientState.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:return t.sent(),this.credentials.removeChangeListener(),[2]}}))}))}))},t.prototype.waitForPendingWrites=function(){var t=this;this.verifyNotTerminated();var e=new dt;return this.asyncQueue.enqueueAndForget((function(){return t.syncEngine.registerPendingWritesCallback(e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.verifyNotTerminated();var i=new xi(t,e,n);return this.asyncQueue.enqueueAndForget((function(){return r.eventMgr.listen(i)})),i},t.prototype.unlisten=function(t){var e=this;this.clientTerminated||this.asyncQueue.enqueueAndForget((function(){return e.eventMgr.unlisten(t)}))},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return e.localStore.readDocument(t)})).then((function(t){if(t instanceof Ge)return t;if(t instanceof He)return null;throw new E(x.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return a.__awaiter(e,void 0,void 0,(function(){var e,n,r;return a.__generator(this,(function(i){switch(i.label){case 0:return[4,this.localStore.executeQuery(t,!0)];case 1:return e=i.sent(),n=new Ci(t,e.remoteKeys),r=n.computeDocChanges(e.documents),[2,n.applyChanges(r,!1).snapshot]}}))}))}))},t.prototype.write=function(t){var e=this;this.verifyNotTerminated();var n=new dt;return this.asyncQueue.enqueueAndForget((function(){return e.syncEngine.write(t,n)})),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},t.prototype.addSnapshotsInSyncListener=function(t){var e=this;this.verifyNotTerminated(),this.asyncQueue.enqueueAndForget((function(){return e.eventMgr.addSnapshotsInSyncListener(t),Promise.resolve()}))},t.prototype.removeSnapshotsInSyncListener=function(t){this.clientTerminated||this.eventMgr.removeSnapshotsInSyncListener(t)},Object.defineProperty(t.prototype,"clientTerminated",{get:function(){return this.asyncQueue.isShuttingDown},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.verifyNotTerminated();var n=new dt;return this.asyncQueue.enqueueAndForget((function(){return e.syncEngine.runTransaction(e.asyncQueue,t,n),Promise.resolve()})),n.promise},t}(),Ji=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),$i=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new E(x.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+X(r,"element")+".")}("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(R("FieldPath","string",n,t[n]),0===t[n].length)throw new E(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pt(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw H("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(pt.keyField().canonicalString()),t}(),to=new RegExp("[~\\*/\\[\\]]");var eo=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},no=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){_(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,t(Di.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){_(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},t}(),ro=function(){function t(t){var e=this;this.tokenListener=null,this.currentUser=Di.UNAUTHENTICATED,this.receivedInitialUser=!1,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.receivedInitialUser=!0,e.changeListener&&e.changeListener(e.currentUser)},this.tokenCounter=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.tokenListener):(this.tokenListener(null),t.get().then((function(t){e.auth=t,e.tokenListener&&e.auth.addAuthTokenListener(e.tokenListener)}),(function(){})))}return t.prototype.getToken=function(){var t=this;_(null!=this.tokenListener,"getToken cannot be called after listener removed.");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){if(t.tokenCounter!==e)throw new E(x.ABORTED,"getToken aborted due to token change.");return n?(_("string"===typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new eo(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){_(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,this.receivedInitialUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){_(null!=this.tokenListener,"removeChangeListener() called twice"),_(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.auth&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},t.prototype.getUser=function(){var t=this.auth&&this.auth.getUid();return _(null===t||"string"===typeof t,"Received invalid UID: "+t),new Di(t)},t}(),io=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=Di.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.sessionIndex},e=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),oo=function(){function t(t,e){this.gapi=t,this.sessionIndex=e}return t.prototype.getToken=function(){return Promise.resolve(new io(this.gapi,this.sessionIndex))},t.prototype.setChangeListener=function(t){t(Di.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function ao(t){if(!t)return new no;switch(t.type){case"gapi":var e=t.client;return _(!("object"!==typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new oo(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new E(x.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function so(t){return function(t,e){if("object"!==typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"===typeof n[o])return!0}return!1}(t,["next","error","complete"])}var uo,co=function(){function t(t){this._methodName=t}return t.delete=function(){return O("FieldValue.delete",arguments),lo.instance},t.serverTimestamp=function(){return O("FieldValue.serverTimestamp",arguments),ho.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return D("FieldValue.arrayUnion",arguments,1),new po(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return D("FieldValue.arrayRemove",arguments,1),new fo(t)},t.increment=function(t){return R("FieldValue.increment","number",1,t),P("FieldValue.increment",arguments,1),new mo(t)},t.prototype.isEqual=function(t){return this===t},t}(),lo=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return a.__extends(e,t),e.instance=new e,e}(co),ho=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return a.__extends(e,t),e.instance=new e,e}(co),po=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n._elements=e,n}return a.__extends(e,t),e}(co),fo=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n._elements=e,n}return a.__extends(e,t),e}(co),mo=function(t){function e(e){var n=t.call(this,"FieldValue.increment")||this;return n._operand=e,n}return a.__extends(e,t),e}(co),yo=T(co,"Use FieldValue.<field>() instead."),go=/^__.*__$/,vo=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new Se(t,this.data,this.fieldMask,e)):n.push(new Te(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Ce(t,this.fieldTransforms)),n},t}(),_o=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new Se(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new Ce(t,this.fieldTransforms)),n},t}();function bo(t){switch(t){case uo.Set:case uo.MergeSet:case uo.Update:return!0;case uo.Argument:case uo.ArrayArgument:return!1;default:throw v("Unexpected case for UserDataSource: "+t)}}!function(t){t[t.Set=0]="Set",t[t.Update=1]="Update",t[t.MergeSet=2]="MergeSet",t[t.Argument=3]="Argument",t[t.ArrayArgument=4]="ArrayArgument"}(uo||(uo={}));var wo=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new E(x.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(0===t.length)throw this.createError("Document fields must not be empty");if(bo(this.dataSource)&&go.test(t))throw this.createError('Document fields cannot begin and end with "__"')},t}(),xo=function(t,e){this.databaseId=t,this.key=e},Eo=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new wo(uo.Set,t,pt.EMPTY_PATH);So("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new vo(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r=new wo(uo.MergeSet,t,pt.EMPTY_PATH);So("Data must be an object, but it was:",r,e);var i,o,a=this.parseData(e,r);if(n){for(var s=new Pt(pt.comparator),u=0,c=n;u<c.length;u++){var l=c[u],h=void 0;if(l instanceof $i)h=l._internalPath;else{if("string"!==typeof l)throw v("Expected stringOrFieldPath to be a string or a FieldPath");h=Io(t,l)}if(!r.contains(h))throw new E(x.INVALID_ARGUMENT,"Field '"+h+"' is specified in your field mask but missing from your input data.");s=s.add(h)}i=ge.fromSet(s),o=r.fieldTransforms.filter((function(t){return i.covers(t.field)}))}else i=ge.fromArray(r.fieldMask),o=r.fieldTransforms;return new vo(a,i,o)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new wo(uo.Update,t,pt.EMPTY_PATH);So("Data must be an object, but it was:",r,e);var i=new Pt(pt.comparator),o=Ve.EMPTY;k(e,(function(e,a){var s=Io(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof lo)i=i.add(s);else{var c=n.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}}));var a=ge.fromSet(i);return new _o(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new wo(uo.Update,t,pt.EMPTY_PATH),o=[Co(t,e)],a=[n];if(r.length%2!==0)throw new E(x.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(Co(t,r[s])),a.push(r[s+1]);var u=new Pt(pt.comparator),c=Ve.EMPTY;for(s=0;s<o.length;++s){var l=o[s],h=i.childContextForFieldPath(l),p=this.runPreConverter(a[s],h);if(p instanceof lo)u=u.add(l);else{var f=this.parseData(p,h);null!=f&&(u=u.add(l),c=c.set(l,f))}}var d=ge.fromSet(u);return new _o(c,d,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e,n){void 0===n&&(n=!1);var r=new wo(n?uo.ArrayArgument:uo.Argument,t,pt.EMPTY_PATH),i=this.parseData(e,r);return _(null!=i,"Parsed data should not be null."),_(0===r.fieldTransforms.length,"Field transforms should have been disallowed."),i},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(r){var n=ko(r);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(To(t=this.runPreConverter(t,e)))return So("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof co)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement&&e.dataSource!==uo.ArrayArgument)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new It(Z);return A(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):k(t,(function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))})),new Ve(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=Oe.INSTANCE),n.push(s),r++}return new qe(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!bo(e.dataSource))throw e.createError(t._methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t._methodName+"() is not currently supported inside arrays");if(t instanceof lo){if(e.dataSource!==uo.MergeSet)throw e.dataSource===uo.Update?(_(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof ho)e.fieldTransforms.push(new ve(e.path,ui.instance));else if(t instanceof po){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new ci(n);e.fieldTransforms.push(new ve(e.path,r))}else if(t instanceof fo){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new li(n);e.fieldTransforms.push(new ve(e.path,i))}else if(t instanceof mo){var o=this.parseQueryValue("FieldValue.increment",t._operand),a=new hi(o);e.fieldTransforms.push(new ve(e.path,a))}else v("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return Oe.INSTANCE;if("number"===typeof t)return Jn(t)?new Re(t):new Ne(t);if("boolean"===typeof t)return Pe.of(t);if("string"===typeof t)return new Le(t);if(t instanceof Date)return new Fe(St.fromDate(t));if(t instanceof St)return new Fe(new St(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof si)return new Ue(t);if(t instanceof rt)return new ze(t);if(t instanceof xo)return new Be(t.databaseId,t.key);throw e.createError("Unsupported field value: "+q(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map((function(e,r){var i=new wo(uo.Argument,t,pt.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))}))},t}();function To(t){return"object"===typeof t&&null!==t&&!(t instanceof Array)&&!(t instanceof Date)&&!(t instanceof St)&&!(t instanceof si)&&!(t instanceof rt)&&!(t instanceof xo)&&!(t instanceof co)}function So(t,e,n){if(!To(n)||!V(n)){var r=q(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Co(t,e){if(e instanceof $i)return e._internalPath;if("string"===typeof e)return Io(t,e);throw new E(x.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Io(t,e){try{return function(t){if(t.search(to)>=0)throw new E(x.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new($i.bind.apply($i,a.__spreadArrays([void 0],t.split("."))))}catch(e){throw new E(x.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e)._internalPath}catch(r){var n=ko(r);throw new E(x.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function ko(t){return t instanceof Error?t.message:t.toString()}var Ao="firestore.googleapis.com",Oo=!0,Po=!0,Do=!1,Mo=Mn.COLLECTION_DISABLED,Ro=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new E(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ao,this.ssl=Oo}else L("settings","non-empty string","host",t.host),this.host=t.host,F("settings","boolean","ssl",t.ssl),this.ssl=C(t.ssl,Oo);if(G("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),F("settings","object","credentials",t.credentials),this.credentials=t.credentials,F("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?y("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&y("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=C(t.timestampsInSnapshots,Po),F("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Mn.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==Mo&&t.cacheSizeBytes<Mn.MINIMUM_CACHE_SIZE_BYTES)throw new E(x.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Mn.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}F("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0===t.experimentalForceLongPolling?Do:t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),No=function(){function t(e,n){var r=this;if(this._firebaseApp=null,this._queue=new yt,this.INTERNAL={delete:function(){return a.__awaiter(r,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"===typeof e.options){var i=e;this._firebaseApp=i,this._databaseId=t.databaseIdFromApp(i),this._persistenceKey=i.name,this._credentials=new ro(n)}else{var o=e;if(!o.projectId)throw new E(x.INVALID_ARGUMENT,"Must provide projectId");this._databaseId=new st(o.projectId,o.database),this._persistenceKey="[DEFAULT]",this._credentials=new no}this._settings=new Ro({}),this._dataConverter=this.createDataConverter(this._databaseId)}return t.prototype.settings=function(t){if(P("Firestore.settings",arguments,1),R("Firestore.settings","object",1,t),S(t,"persistence"))throw new E(x.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new Ro(t);if(this._firestoreClient&&!this._settings.isEqual(e))throw new E(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._settings=e,void 0!==e.credentials&&(this._credentials=ao(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new E(x.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&y("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=C(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.configureClient(new Xi(this._settings.cacheSizeBytes,e))},t.prototype.clearPersistence=function(){var t=this,e=Un.buildStoragePrefix(this.makeDatabaseInfo()),n=new dt;return this._queue.enqueueAndForgetEvenAfterShutdown((function(){return a.__awaiter(t,void 0,void 0,(function(){var t;return a.__generator(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientTerminated)throw new E(x.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,Un.clearPersistence(e)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}}))}))})),n.promise},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"_isTerminated",{get:function(){return this.ensureClientConfigured(),this._firestoreClient.clientTerminated},enumerable:!0,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.ensureClientConfigured(),this._firestoreClient.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.ensureClientConfigured(),so(t))return this.onSnapshotsInSyncInternal(t);R("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.onSnapshotsInSyncInternal(e)},t.prototype.onSnapshotsInSyncInternal=function(t){var e=this,n=new Ji({next:function(){t.next&&t.next()},error:function(t){throw v("Uncaught Error in onSnapshotsInSync")}});return this._firestoreClient.addSnapshotsInSyncListener(n),function(){n.mute(),e._firestoreClient.removeSnapshotsInSyncListener(n)}},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new Yi),this._firestoreClient},t.prototype.makeDatabaseInfo=function(){return new ot(this._databaseId,this._persistenceKey,this._settings.host,this._settings.ssl,this._settings.forceLongPolling)},t.prototype.configureClient=function(t){_(!!this._settings.host,"FirestoreSettings.host is not set"),_(!this._firestoreClient,"configureClient() called multiple times");var e=this.makeDatabaseInfo();return this._firestoreClient=new Zi(b.getPlatform(),e,this._credentials,this._queue),this._firestoreClient.start(t)},t.prototype.createDataConverter=function(t){return new Eo((function(e){if(e instanceof jo){var n=t,r=e.firestore._databaseId;if(!r.isEqual(n))throw new E(x.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new xo(t,e._key)}return e}))},t.databaseIdFromApp=function(t){var e=t.options;if(!S(e,"projectId"))throw new E(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!==typeof n)throw new E(x.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new st(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._firebaseApp)throw new E(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return P("Firestore.collection",arguments,1),R("Firestore.collection","non-empty string",1,t),this.ensureClientConfigured(),new Wo(lt.fromString(t),this)},t.prototype.doc=function(t){return P("Firestore.doc",arguments,1),R("Firestore.doc","non-empty string",1,t),this.ensureClientConfigured(),jo.forPath(lt.fromString(t),this)},t.prototype.collectionGroup=function(t){if(P("Firestore.collectionGroup",arguments,1),R("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new E(x.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new Vo(new er(lt.EMPTY_PATH,t),this)},t.prototype.runTransaction=function(t){var e=this;return P("Firestore.runTransaction",arguments,1),R("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction((function(n){return t(new Lo(e,n))}))},t.prototype.batch=function(){return this.ensureClientConfigured(),new Fo(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(f()){case i.DEBUG:return"debug";case i.ERROR:return"error";case i.SILENT:return"silent";default:return v("Unknown log level: "+f())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(P("Firestore.setLogLevel",arguments,1),R("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":d(i.DEBUG);break;case"error":d(i.ERROR);break;case"silent":d(i.SILENT);break;default:throw new E(x.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._settings.timestampsInSnapshots},t}(),Lo=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;P("Transaction.get",arguments,1);var n=Qo("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return v("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof He)return new Bo(e._firestore,n._key,null,!1,!1,n._converter);if(r instanceof Ge)return new Bo(e._firestore,n._key,r,!1,!1,n._converter);throw v("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)}))},t.prototype.set=function(t,e,n){M("Transaction.set",arguments,2,3);var r=Qo("Transaction.set",t,this._firestore);n=Go("Transaction.set",n);var i=Yo(r._converter,e,"Transaction.set"),o=i[0],a=i[1],s=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,n.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._transaction.set(r._key,s),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"===typeof e||e instanceof $i?(D("Transaction.update",arguments,3),r=Qo("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,o)):(P("Transaction.update",arguments,2),r=Qo("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(r._key,i),this},t.prototype.delete=function(t){P("Transaction.delete",arguments,1);var e=Qo("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),Fo=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){M("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=Qo("WriteBatch.set",t,this._firestore);n=Go("WriteBatch.set",n);var i=Yo(r._converter,e,"WriteBatch.set"),o=i[0],a=i[1],s=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,n.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._mutations=this._mutations.concat(s.toMutations(r._key,xe.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),"string"===typeof e||e instanceof $i?(D("WriteBatch.update",arguments,3),r=Qo("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,o)):(P("WriteBatch.update",arguments,2),r=Qo("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,xe.exists(!0))),this},t.prototype.delete=function(t){P("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=Qo("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new Ie(e._key,xe.NONE)),this},t.prototype.commit=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]}))}))},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new E(x.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),jo=function(){function t(t,e,n){this._key=t,this.firestore=e,this._converter=n,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n,r){if(e.length%2!==0)throw new E(x.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new ft(e),n,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Wo(this._key.path.popLast(),this.firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(P("DocumentReference.collection",arguments,1),R("DocumentReference.collection","non-empty string",1,t),!t)throw new E(x.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=lt.fromString(t);return new Wo(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw H("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)&&this._converter===e._converter},t.prototype.set=function(t,e){M("DocumentReference.set",arguments,1,2),e=Go("DocumentReference.set",e);var n=Yo(this._converter,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore._dataConverter.parseMergeData(i,r,e.mergeFields):this.firestore._dataConverter.parseSetData(i,r);return this._firestoreClient.write(o.toMutations(this._key,xe.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"===typeof t||t instanceof $i?(D("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,r)):(P("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(n.toMutations(this._key,xe.exists(!0)))},t.prototype.delete=function(){return P("DocumentReference.delete",arguments,0),this._firestoreClient.write([new Ie(this._key,xe.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];M("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!==typeof t[i]||so(t[i])||(G("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),F("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return so(t[i])?n=t[i]:(R("DocumentReference.onSnapshot","function",i,t[i]),N("DocumentReference.onSnapshot","function",i+1,t[i+1]),N("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Ji({next:function(t){if(e.next){_(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new Bo(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites,n._converter))}},error:r}),o=this._firestoreClient.listen(er.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return M("DocumentReference.get",arguments,0,1),Ko("DocumentReference.get",t),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then((function(t){n(new Bo(e.firestore,e._key,t,!0,t instanceof Ge&&t.hasLocalMutations,e._converter))}),r):e.getViaSnapshotListener(n,r,t)}))},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new E(x.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new E(x.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t.prototype.withConverter=function(e){return new t(this._key,this.firestore,e)},t}(),zo=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Bo=function(){function t(t,e,n,r,i,o){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i,this._converter=o}return t.prototype.data=function(t){if(M("DocumentSnapshot.data",arguments,0,1),t=Ho("DocumentSnapshot.data",t),this._document){if(this._converter){var e=new Uo(this._firestore,this._key,this._document,this._fromCache,this._hasPendingWrites);return this._converter.fromFirestore(e,t)}return this.toJSObject(this._document.data(),ke.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled()))}},t.prototype.get=function(t,e){if(M("DocumentSnapshot.get",arguments,1,2),e=Ho("DocumentSnapshot.get",e),this._document){var n=this._document.data().field(Co("DocumentSnapshot.get",t));if(null!==n)return this.toJSValue(n,ke.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new jo(this._key,this._firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new zo(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw H("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))&&this._converter===e._converter},t.prototype.toJSObject=function(t,e){var n=this,r={};return t.forEach((function(t,i){r[t]=n.toJSValue(i,e)})),r},t.prototype.toJSValue=function(t,e){if(t instanceof Ve)return this.toJSObject(t,e);if(t instanceof qe)return this.toJSArray(t,e);if(t instanceof Be){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||y("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new jo(n,this._firestore,this._converter)}return t.value(e)},t.prototype.toJSArray=function(t,e){var n=this;return t.internalValue.map((function(t){return n.toJSValue(t,e)}))},t}(),Uo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return _(void 0!==n,"Document in a QueryDocumentSnapshot should exist"),n},e}(Bo),Vo=function(){function t(t,e,n){this._query=t,this.firestore=e,this._converter=n}return t.prototype.where=function(e,n,r){P("Query.where",arguments,3),W("Query.where",3,r);var i,o=["<","<=","==",">=",">","array-contains","in","array-contains-any"];B("Query.where",o,2,n);var a=Co("Query.where",e),s=rr.fromString(n);if(a.isKeyField()){if(s===rr.ARRAY_CONTAINS||s===rr.ARRAY_CONTAINS_ANY)throw new E(x.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+s.toString()+"' queries on FieldPath.documentId().");if(s===rr.IN){this.validateDisjunctiveFilterElements(r,s);for(var u=[],c=0,l=r;c<l.length;c++){var h=l[c];u.push(this.parseDocumentIdValue(h))}i=new qe(u)}else i=this.parseDocumentIdValue(r)}else s!==rr.IN&&s!==rr.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(r,s),i=this.firestore._dataConverter.parseQueryValue("Query.where",r,s===rr.IN);var p=ir.create(a,s,i);return this.validateNewFilter(p),new t(this._query.addFilter(p),this.firestore,this._converter)},t.prototype.orderBy=function(e,n){var r;if(M("Query.orderBy",arguments,1,2),N("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=lr.ASCENDING;else{if("desc"!==n)throw new E(x.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=lr.DESCENDING}if(null!==this._query.startAt)throw new E(x.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new E(x.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Co("Query.orderBy",e),o=new pr(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore,this._converter)},t.prototype.limit=function(e){return P("Query.limit",arguments,1),R("Query.limit","number",1,e),K("Query.limit",1,e),new t(this._query.withLimitToFirst(e),this.firestore,this._converter)},t.prototype.limitToLast=function(e){return P("Query.limitToLast",arguments,1),R("Query.limitToLast","number",1,e),K("Query.limitToLast",1,e),new t(this._query.withLimitToLast(e),this.firestore,this._converter)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];D("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore,this._converter)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];D("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore,this._converter)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];D("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore,this._converter)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];D("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore,this._converter)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw H("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.withConverter=function(e){return new t(this._query,this.firestore,e)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(W(t,1,e),e instanceof Bo){if(n.length>0)throw new E(x.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new E(x.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Be(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(s instanceof je)throw new E(x.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=a.field.canonicalString();throw new E(x.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new hr(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new E(x.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!==typeof a)throw new E(x.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new E(x.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+a+"' contains a slash.");var s=this._query.path.child(lt.fromString(a));if(!ft.isDocumentKey(s))throw new E(x.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new ft(s);i.push(new Be(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(t,a);i.push(c)}}return new hr(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];M("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!==typeof t[i]||so(t[i])||(G("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),F("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),so(t[i])?n=t[i]:(R("Query.onSnapshot","function",i,t[i]),N("Query.onSnapshot","function",i+1,t[i+1]),N("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.validateHasExplicitOrderByForLimitToLast(this._query),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Ji({next:function(t){e.next&&e.next(new qo(n.firestore,n._query,t,n._converter))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.validateHasExplicitOrderByForLimitToLast=function(t){if(t.hasLimitToLast()&&0===t.explicitOrderBy.length)throw new E(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},t.prototype.get=function(t){var e=this;return M("Query.get",arguments,0,1),Ko("Query.get",t),this.validateHasExplicitOrderByForLimitToLast(this._query),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then((function(t){n(new qo(e.firestore,e._query,t,e._converter))}),r):e.getViaSnapshotListener(n,r,t)}))},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new E(x.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.parseDocumentIdValue=function(t){if("string"===typeof t){if(""===t)throw new E(x.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==t.indexOf("/"))throw new E(x.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this._query.path.child(lt.fromString(t));if(!ft.isDocumentKey(e))throw new E(x.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return new Be(this.firestore._databaseId,new ft(e))}if(t instanceof jo){var n=t;return new Be(this.firestore._databaseId,n._key)}throw new E(x.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+q(t)+".")},t.prototype.validateDisjunctiveFilterElements=function(t,e){if(!Array.isArray(t)||0===t.length)throw new E(x.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new E(x.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new E(x.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new E(x.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},t.prototype.validateNewFilter=function(t){if(t instanceof ir){var e=[rr.ARRAY_CONTAINS,rr.ARRAY_CONTAINS_ANY],n=[rr.IN,rr.ARRAY_CONTAINS_ANY],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(t.field))throw new E(x.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(t.field,a)}else if(i||r){var s=null;if(i&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(e)),null!=s)throw s===t.op?new E(x.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new E(x.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new E(x.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),qo=function(){function t(t,e,n,r){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._converter=r,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new zo(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;M("QuerySnapshot.forEach",arguments,1,2),R("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach((function(r){t.call(e,n.convertToDocumentImpl(r))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new Vo(this._originalQuery,this._firestore,this._converter)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(G("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),F("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new E(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e,n,r){if(n.oldDocs.isEmpty()){var i,o=0;return n.docChanges.map((function(e){var a=new Uo(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key),r);return _(e.type===Wr.Added,"Invalid event type for first snapshot"),_(!i||n.query.docComparator(i,e.doc)<0,"Got added events in wrong order"),i=e.doc,{type:"added",doc:a,oldIndex:-1,newIndex:o++}}))}var a=n.oldDocs;return n.docChanges.filter((function(t){return e||t.type!==Wr.Metadata})).map((function(e){var i=new Uo(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key),r),o=-1,s=-1;return e.type!==Wr.Added&&(_((o=a.indexOf(e.doc.key))>=0,"Index for document not found"),a=a.delete(e.doc.key)),e.type!==Wr.Removed&&(s=(a=a.add(e.doc)).indexOf(e.doc.key)),{type:Xo(e.type),doc:i,oldIndex:o,newIndex:s}}))}(this._firestore,e,this._snapshot,this._converter),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw H("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)&&this._converter===e._converter},t.prototype.convertToDocumentImpl=function(t){return new Uo(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key),this._converter)},t}();a.__spreadArrays(["length","forEach","map"],"undefined"!==typeof Symbol?[Symbol.iterator]:[]).forEach((function(t){try{Object.defineProperty(qo.prototype.docChanges,t,{get:function(){return function(){throw new E(x.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(e){}}));var Wo=function(t){function e(e,n,r){var i=t.call(this,er.atPath(e),n,r)||this;if(i._path=e,e.length%2!==1)throw new E(x.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return i}return a.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new jo(new ft(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(M("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Y.newId()),R("CollectionReference.doc","non-empty string",1,t),""===t)throw new E(x.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=lt.fromString(t);return jo.forPath(this._query.path.child(e),this.firestore,this._converter)},e.prototype.add=function(t){P("CollectionReference.add",arguments,1),R("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then((function(){return e}))},e.prototype.withConverter=function(t){return new e(this._path,this.firestore,t)},e}(Vo);function Go(t,e){if(void 0===e)return{merge:!1};if(G(t,e,["merge","mergeFields"]),F(t,"boolean","merge",e.merge),j(t,"mergeFields","a string or a FieldPath",e.mergeFields,(function(t){return"string"===typeof t||t instanceof $i})),void 0!==e.mergeFields&&void 0!==e.merge)throw new E(x.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Ho(t,e){return void 0===e?{}:(G(t,e,["serverTimestamps"]),z(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Ko(t,e){N(t,"object",1,e),e&&(G(t,e,["source"]),z(t,0,"source",e.source,["default","server","cache"]))}function Qo(t,e,n){if(e instanceof jo){if(e.firestore!==n)throw new E(x.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw H(t,"DocumentReference",1,e)}function Xo(t){switch(t){case Wr.Added:return"added";case Wr.Modified:case Wr.Metadata:return"modified";case Wr.Removed:return"removed";default:return v("Unknown change type: "+t)}}function Yo(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}var Zo=T(No,"Use firebase.firestore() instead."),Jo=T(Lo,"Use firebase.firestore().runTransaction() instead."),$o=T(Fo,"Use firebase.firestore().batch() instead."),ta=T(jo,"Use firebase.firestore().doc() instead."),ea=T(Bo),na=T(Uo),ra=T(Vo),ia=T(qo),oa=T(Wo,"Use firebase.firestore().collection() instead."),aa={Firestore:Zo,GeoPoint:si,Timestamp:St,Blob:it,Transaction:Jo,WriteBatch:$o,DocumentReference:ta,DocumentSnapshot:ea,Query:ra,QueryDocumentSnapshot:na,QuerySnapshot:ia,CollectionReference:oa,FieldPath:$i,FieldValue:yo,setLogLevel:No.setLogLevel,CACHE_SIZE_UNLIMITED:Mo};function sa(t){t.INTERNAL.registerComponent(new c.Component("firestore",(function(t){var e=t.getProvider("app").getImmediate();return new No(e,t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(function(t){_(t&&"object"===typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}(aa)))}var ua=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.shutdown=function(){},t}(),ca=function(){function t(){var t=this;this.networkAvailableListener=function(){return t.onNetworkAvailable()},this.networkUnavailableListener=function(){return t.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return t.prototype.addCallback=function(t){this.callbacks.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},t.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},t.prototype.onNetworkAvailable=function(){m("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++){(0,e[t])(0)}},t.prototype.onNetworkUnavailable=function(){m("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++){(0,e[t])(1)}},t.isAvailable=function(){return"undefined"!==typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),la=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){_(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){_(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){_(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){_(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){_(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){_(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),ha="Connection",pa={BatchGetDocuments:"batchGet",Commit:"commit"},fa="gl-js/ fire/"+h,da=function(){function t(t){this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=fa},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise((function(o,s){var u=new l.XhrIo;u.listenOnce(l.EventType.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case l.ErrorCode.NO_ERROR:var e=u.getResponseJson();m(ha,"XHR received:",JSON.stringify(e)),o(e);break;case l.ErrorCode.TIMEOUT:m(ha,'RPC "'+t+'" timed out'),s(new E(x.DEADLINE_EXCEEDED,"Request time out"));break;case l.ErrorCode.HTTP_ERROR:var n=u.getStatus();if(m(ha,'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var i=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(x).indexOf(e)>=0?e:x.UNKNOWN}(r.status);s(new E(i,r.message))}else s(new E(x.UNKNOWN,"Server responded with status "+u.getStatus()))}else m(ha,'RPC "'+t+'" failed'),s(new E(x.UNAVAILABLE,"Connection failed."));break;default:v('RPC "'+t+'" failed with unanticipated webchannel error '+u.getLastErrorCode()+": "+u.getLastError()+", giving up.")}}finally{m(ha,'RPC "'+t+'" completed.')}}));var c=a.__assign({},e);delete c.database;var h=JSON.stringify(c);m(ha,"XHR sending: ",i+" "+h);var p={"Content-Type":"text/plain"};r.modifyHeadersForRequest(p,n),u.send(i,"POST",h,p,15)}))},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=l.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,e),u.isReactNative()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");m(ha,"Creating WebChannel: "+o+" "+i);var a=r.createWebChannel(o,i),s=!1,c=!1,h=new la({sendFn:function(t){c?m(ha,"Not sending because WebChannel is closed:",t):(s||(m(ha,"Opening WebChannel transport."),a.open(),s=!0),m(ha,"WebChannel sending:",t),a.send(t))},closeFn:function(){return a.close()}}),p=function(t,e){a.listen(t,(function(t){try{e(t)}catch(n){setTimeout((function(){throw n}),0)}}))};return p(l.WebChannel.EventType.OPEN,(function(){c||m(ha,"WebChannel transport opened.")})),p(l.WebChannel.EventType.CLOSE,(function(){c||(c=!0,m(ha,"WebChannel transport closed"),h.callOnClose())})),p(l.WebChannel.EventType.ERROR,(function(t){c||(c=!0,m(ha,"WebChannel transport errored:",t),h.callOnClose(new E(x.UNAVAILABLE,"The operation could not be completed")))})),p(l.WebChannel.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];_(!!n,"Got a webchannel message without data.");var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){m(ha,"WebChannel received error:",i);var o=i.status,s=function(t){var e=zr[t];if(void 0!==e)return Vr(e)}(o),u=i.message;void 0===s&&(s=x.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),c=!0,h.callOnClose(new E(s,u)),a.close()}else m(ha,"WebChannel received:",n),h.callOnMessage(n)}})),setTimeout((function(){h.callOnOpen()}),0),h},t.prototype.makeUrl=function(t){var e=pa[t];return _(void 0!==e,"Unknown REST mapping for: "+t),this.baseUrl+"/v1/projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents:"+e},t}(),ma=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!==typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!==typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!==typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.loadConnection=function(t){return Promise.resolve(new da(t))},t.prototype.newConnectivityMonitor=function(){return ca.isAvailable()?new ca:new ua},t.prototype.newSerializer=function(t){return new _i(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();b.setPlatform(new ma);var ya="@firebase/firestore",ga="1.9.1";function va(t){sa(t),t.registerVersion(ya,ga)}va(o),e.registerFirestore=va}).call(this,n(30))},function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"ErrorCode",(function(){return ur})),n.d(e,"EventType",(function(){return cr})),n.d(e,"WebChannel",(function(){return lr})),n.d(e,"XhrIo",(function(){return hr})),n.d(e,"createWebChannelTransport",(function(){return sr}));var r,i="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},o=o||{},a=i;function s(t){return"string"==typeof t}function u(t){return"number"==typeof t}function c(t,e){t=t.split("."),e=e||a;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function l(){}function h(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function p(t){return"array"==h(t)}function f(t){var e=h(t);return"array"==e||"object"==e&&"number"==typeof t.length}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var m="closure_uid_"+(1e9*Math.random()>>>0),y=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function v(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _(t,e,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:v).apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var w=Date.now||function(){return+new Date};function x(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.xb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function E(){this.j=this.j,this.i=this.i}E.prototype.j=!1,E.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0))this[m]||(this[m]=++y)},E.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var T=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(s(t))return s(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},S=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=s(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function C(t){return Array.prototype.concat.apply([],arguments)}function I(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function k(t){return/^[\s\xa0]*$/.test(t)}var A,O=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function P(t,e){return-1!=t.indexOf(e)}function D(t,e){return t<e?-1:t>e?1:0}t:{var M=a.navigator;if(M){var R=M.userAgent;if(R){A=R;break t}}A=""}function N(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function L(t){var e,n={};for(e in t)n[e]=t[e];return n}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<F.length;o++)n=F[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function z(t){return z[" "](t),t}z[" "]=l;var B,U=P(A,"Opera"),V=P(A,"Trident")||P(A,"MSIE"),q=P(A,"Edge"),W=q||V,G=P(A,"Gecko")&&!(P(A.toLowerCase(),"webkit")&&!P(A,"Edge"))&&!(P(A,"Trident")||P(A,"MSIE"))&&!P(A,"Edge"),H=P(A.toLowerCase(),"webkit")&&!P(A,"Edge");function K(){var t=a.document;return t?t.documentMode:void 0}t:{var Q="",X=function(){var t=A;return G?/rv:([^\);]+)(\)|;)/.exec(t):q?/Edge\/([\d\.]+)/.exec(t):V?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):H?/WebKit\/(\S+)/.exec(t):U?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(X&&(Q=X?X[1]:""),V){var Y=K();if(null!=Y&&Y>parseFloat(Q)){B=String(Y);break t}}B=Q}var Z,J={};function $(t){return function(t,e){var n=J;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=O(String(B)).split("."),r=O(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=D(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||D(0==a[2].length,0==s[2].length)||D(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}var tt=a.document;Z=tt&&V?K()||("CSS1Compat"==tt.compatMode?parseInt(B,10):5):void 0;var et=!V||9<=Number(Z),nt=V&&!$("9"),rt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",l,e),a.removeEventListener("test",l,e)}catch(n){}return t}();function it(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function ot(t,e){if(it.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(G){t:{try{z(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=s(t.pointerType)?t.pointerType:at[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}it.prototype.b=function(){this.Ia=!1},x(ot,it);var at={2:"touch",3:"pen",4:"mouse"};ot.prototype.b=function(){ot.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,nt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var st="closure_listenable_"+(1e6*Math.random()|0),ut=0;function ct(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++ut,this.X=this.Z=!1}function lt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function ht(t){this.src=t,this.a={},this.b=0}function pt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=T(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(lt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ft(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}ht.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=ft(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new ct(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var dt="closure_lm_"+(1e6*Math.random()|0),mt={};function yt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(p(n)){for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);return null}return r=Tt(r),e&&e[st]?e.Aa(n,r,d(i)?!!i.capture:!!i,o):gt(e,n,r,!0,i,o)}(t,e,n,r,i);if(p(e)){for(var o=0;o<e.length;o++)yt(t,e[o],n,r,i);return null}return n=Tt(n),t&&t[st]?t.za(e,n,d(r)?!!r.capture:!!r,i):gt(t,e,n,!1,r,i)}function gt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=d(i)?!!i.capture:!!i;if(a&&!et)return null;var s=xt(t);if(s||(t[dt]=s=new ht(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=wt,e=et?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)rt||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(_t(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function vt(t){if(!u(t)&&t&&!t.X){var e=t.src;if(e&&e[st])pt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(_t(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(pt(n,t),0==n.b&&(n.src=null,e[dt]=null)):lt(t)}}}function _t(t){return t in mt?mt[t]:mt[t]="on"+t}function bt(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&vt(t),n.call(r,e)}function wt(t,e){return!!t.X||(et?bt(t,new ot(e,this)):bt(t,e=new ot(e||c("window.event"),this)))}function xt(t){return(t=t[dt])instanceof ht?t:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tt(t){return"function"==h(t)?t:(t[Et]||(t[Et]=function(e){return t.handleEvent(e)}),t[Et])}function St(){E.call(this),this.c=new ht(this),this.J=this,this.B=null}function Ct(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&pt(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ia}x(St,E),St.prototype[st]=!0,(r=St.prototype).addEventListener=function(t,e,n,r){yt(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(p(n))for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);else i=d(i)?!!i.capture:!!i,r=Tt(r),e&&e[st]?(e=e.c,(n=String(n).toString())in e.a&&(-1<(r=ft(a=e.a[n],r,i,o))&&(lt(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete e.a[n],e.b--)))):e&&(e=xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=ft(n,r,i,o)),(r=-1<e?n[e]:null)&&vt(r))}(this,t,e,n,r)},r.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(s(t))t=new it(t,n);else if(t instanceof it)t.target=t.target||n;else{var i=t;j(t=new it(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Ct(a,r,!0,t)&&i}if(i=Ct(a=t.a=n,r,!0,t)&&i,i=Ct(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Ct(a=t.a=e[o],r,!1,t)&&i;return i},r.G=function(){if(St.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)lt(n[r]);delete e.a[t],e.b--}}this.B=null},r.za=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},r.Aa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var It=a.JSON.stringify;function kt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function At(){this.b=this.a=null}kt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Ot,Pt=new kt((function(){return new Mt}),(function(t){t.reset()}));function Dt(){var t=Ft,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Mt(){this.next=this.b=this.a=null}function Rt(t){a.setTimeout((function(){throw t}),0)}function Nt(t,e){Ot||function(){var t=a.Promise.resolve(void 0);Ot=function(){t.then(jt)}}(),Lt||(Ot(),Lt=!0),Ft.add(t,e)}At.prototype.add=function(t,e){var n=Pt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Mt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Mt.prototype.reset=function(){this.next=this.b=this.a=null};var Lt=!1,Ft=new At;function jt(){for(var t;t=Dt();){try{t.a.call(t.b)}catch(n){Rt(n)}var e=Pt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Lt=!1}function zt(t,e){St.call(this),this.b=t||1,this.a=e||a,this.f=_(this.fb,this),this.g=w()}function Bt(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Ut(t,e,n){if("function"==h(t))n&&(t=_(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function Vt(t,e,n){E.call(this),this.f=null!=n?_(t,n):t,this.c=e,this.b=_(this.$a,this),this.a=[]}function qt(t){t.U=Ut(t.b,t.c),t.f.apply(null,t.a)}function Wt(t){E.call(this),this.b=t,this.a={}}x(zt,St),(r=zt.prototype).ba=!1,r.L=null,r.fb=function(){if(this.ba){var t=w()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(Bt(this),this.start()))}},r.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=w())},r.G=function(){zt.N.G.call(this),Bt(this),delete this.a},x(Vt,E),(r=Vt.prototype).ea=!1,r.U=null,r.Ta=function(t){this.a=arguments,this.U?this.ea=!0:qt(this)},r.G=function(){Vt.N.G.call(this),this.U&&(a.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},r.$a=function(){this.U=null,this.ea&&(this.ea=!1,qt(this))},x(Wt,E);var Gt=[];function Ht(t,e,n,r){p(n)||(n&&(Gt[0]=n.toString()),n=Gt);for(var i=0;i<n.length;i++){var o=yt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Kt(t){N(t.a,(function(t,e){this.a.hasOwnProperty(e)&&vt(t)}),t),t.a={}}function Qt(){}Wt.prototype.G=function(){Wt.N.G.call(this),Kt(this)},Wt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xt=new St;function Yt(t){it.call(this,"serverreachability",t)}function Zt(t){Xt.dispatchEvent(new Yt(Xt,t))}function Jt(t){it.call(this,"statevent",t)}function $t(t){Xt.dispatchEvent(new Jt(Xt,t))}function te(t){it.call(this,"timingevent",t)}function ee(t,e){if("function"!=h(t))throw Error("Fn must not be null and must be a function");return a.setTimeout((function(){t()}),e)}x(Yt,it),x(Jt,it),x(te,it);var ne={NO_ERROR:0,gb:1,nb:2,mb:3,jb:4,lb:5,ob:6,La:7,TIMEOUT:8,rb:9},re={ib:"complete",vb:"success",Ma:"error",La:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",kb:"downloadprogress",wb:"uploadprogress"};function ie(){}function oe(t){var e;return(e=t.a)||(e=t.a={}),e}function ae(){}ie.prototype.a=null;var se,ue={OPEN:"a",hb:"b",Ma:"c",qb:"d"};function ce(){it.call(this,"d")}function le(){it.call(this,"c")}function he(){}function pe(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new Wt(this),this.O=fe,t=W?125:void 0,this.P=new zt(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}x(ce,it),x(le,it),x(he,ie),se=new he;var fe=45e3,de={},me={};function ye(t,e,n){t.F=1,t.f=Ue(Re(e)),t.l=n,t.H=!0,ve(t,null)}function ge(t,e,n,r){t.F=1,t.f=Ue(Re(e)),t.l=null,t.H=n,ve(t,r)}function ve(t,e){t.v=w(),we(t),t.D=Re(t.f),Be(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new Vt(_(t.Ja,t,t.a),t.J)),Ht(t.I,t.a,"readystatechange",t.cb),e=t.h?L(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),Zt(1)}function _e(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=be(t,n);if(i==me){4==e&&(t.c=4,$t(14),r=!1);break}if(i==de){t.c=4,$t(15),r=!1;break}Ce(t,i)}4==e&&0==n.length&&(t.c=1,$t(16),r=!1),t.b=t.b&&r,r||(Se(t),Te(t))}function be(t,e){var n=t.A,r=e.indexOf("\n",n);return-1==r?me:(n=Number(e.substring(n,r)),isNaN(n)?de:(r+=1)+n>e.length?me:(e=e.substr(r,n),t.A=r+n,e))}function we(t){t.R=w()+t.O,xe(t,t.O)}function xe(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=ee(_(t.ab,t),e)}function Ee(t){t.i&&(a.clearTimeout(t.i),t.i=null)}function Te(t){t.g.Ca()||t.m||t.g.na(t)}function Se(t){Ee(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,Bt(t.P),Kt(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Ce(t,e){try{t.g.Fa(t,e),Zt(4)}catch(n){}}function Ie(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(f(t)||s(t))S(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(f(t)||s(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(s(t))return t.split("");if(f(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ke)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ae(t,e){Pe(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Oe(t))}function Oe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Pe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Pe(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Pe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(r=pe.prototype).setTimeout=function(t){this.O=t},r.cb=function(t){t=t.target;var e=this.B;e&&3==Rn(t)?e.Ta():this.Ja(t)},r.Ja=function(t){try{if(t==this.a)t:{var e=Rn(this.a),n=this.a.ya(),r=this.a.T();if(!(3>e||3==e&&!W&&!this.a.aa())){this.m||4!=e||7==n||Zt(8==n||0>=r?3:2),Ee(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var a=Nn(this.a,"X-HTTP-Initial-Response");if(a&&!k(a)){var s=a;break e}}s=null}if(!s){this.b=!1,this.c=3,$t(12),Se(this),Te(this);break t}this.s=!0,Ce(this,s)}this.H?(_e(this,e,o),W&&this.b&&3==e&&(Ht(this.I,this.P,"tick",this.bb),this.P.start())):Ce(this,o),4==e&&Se(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,we(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,$t(12)):(this.c=0,$t(13)),Se(this),Te(this)}}}catch(u){}},r.bb=function(){if(this.a){var t=Rn(this.a),e=this.a.aa();this.A<e.length&&(Ee(this),_e(this,t,e),this.b&&4!=t&&we(this))}},r.cancel=function(){this.m=!0,Se(this)},r.ab=function(){this.i=null;var t=w();0<=t-this.R?(2!=this.F&&(Zt(3),$t(17)),Se(this),this.c=2,Te(this)):xe(this,this.R-t)},(r=ke.prototype).C=function(){Oe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},r.K=function(){return Oe(this),this.a.concat()},r.get=function(t,e){return Pe(this.b,t)?this.b[t]:e},r.set=function(t,e){Pe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},r.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var De=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Me(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Me?(this.h=void 0!==e?e:t.h,Ne(this,t.f),this.j=t.j,Le(this,t.b),Fe(this,t.i),this.a=t.a,je(this,en(t.c)),this.g=t.g):t&&(n=String(t).match(De))?(this.h=!!e,Ne(this,n[1]||"",!0),this.j=Ve(n[2]||""),Le(this,n[3]||"",!0),Fe(this,n[4]),this.a=Ve(n[5]||"",!0),je(this,n[6]||"",!0),this.g=Ve(n[7]||"")):(this.h=!!e,this.c=new Ye(null,this.h))}function Re(t){return new Me(t)}function Ne(t,e,n){t.f=n?Ve(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Le(t,e,n){t.b=n?Ve(e,!0):e}function Fe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function je(t,e,n){e instanceof Ye?(t.c=e,function(t,e){e&&!t.f&&(Ze(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Je(this,e),tn(this,n,t))}),t)),t.f=e}(t.c,t.h)):(n||(e=qe(e,Qe)),t.c=new Ye(e,t.h))}function ze(t,e,n){t.c.set(e,n)}function Be(t,e,n){p(n)||(n=[String(n)]),tn(t.c,e,n)}function Ue(t){return ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^w()).toString(36)),t}function Ve(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function qe(t,e,n){return s(t)?(t=encodeURI(t).replace(e,We),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function We(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Me.prototype.toString=function(){var t=[],e=this.f;e&&t.push(qe(e,Ge,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(qe(e,Ge,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(qe(n,"/"==n.charAt(0)?Ke:He,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",qe(n,Xe)),t.join("")},Me.prototype.resolve=function(t){var e=Re(this),n=!!t.f;n?Ne(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?Le(e,t.b):n=null!=t.i;var r=t.a;if(n)Fe(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(P(i,"./")||P(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?je(e,en(t.c)):n=!!t.g,n&&(e.g=t.g),e};var Ge=/[#\/\?@]/g,He=/[#\?:]/g,Ke=/[#\?]/g,Qe=/[#\?@]/g,Xe=/#/g;function Ye(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Ze(t){t.a||(t.a=new ke,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Je(t,e){Ze(t),e=nn(t,e),Pe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ae(t.a,e))}function $e(t,e){return Ze(t),e=nn(t,e),Pe(t.a.b,e)}function tn(t,e,n){Je(t,e),0<n.length&&(t.c=null,t.a.set(nn(t,e),I(n)),t.b+=n.length)}function en(t){var e=new Ye;return e.c=t.c,t.a&&(e.a=new ke(t.a),e.b=t.b),e}function nn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function rn(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function on(t){var e=t.a.F.a;if(null!=e)$t(4),e?($t(10),Kn(t.a,t,!1)):($t(11),Kn(t.a,t,!0));else{t.b=new pe(t,void 0,void 0),t.b.h=t.h,e=Jn(e=t.a,e.Y()?t.f:null,t.i),$t(4),Be(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&ze(e,n,r),ge(t.b,e,!1,t.f)}}function an(){this.a=this.b=null}function sn(){this.a=new ke}function un(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[m]||(t[m]=++y)):e.charAt(0)+t}function cn(t,e){this.b=t,this.a=e}function ln(t){this.g=t||hn,a.PerformanceNavigationTiming?t=0<(t=a.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(a.ka&&a.ka.Da&&a.ka.Da()&&a.ka.Da().yb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new sn),this.b=null,this.c=[]}(r=Ye.prototype).add=function(t,e){Ze(this),this.c=null,t=nn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},r.forEach=function(t,e){Ze(this),this.a.forEach((function(n,r){S(n,(function(n){t.call(e,n,r,this)}),this)}),this)},r.K=function(){Ze(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},r.C=function(t){Ze(this);var e=[];if(s(t))$e(this,t)&&(e=C(e,this.a.get(nn(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=C(e,t[n])}return e},r.set=function(t,e){return Ze(this),this.c=null,$e(this,t=nn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},r.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},r.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")},x((function(){}),(function(){})),(r=rn.prototype).M=null,r.$=function(t){return this.a.$(t)},r.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},r.Ca=function(){return!1},r.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=Nn(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=Nn(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(i){return(e=this.a).m=this.c,void Yn(e,2)}this.f=r[0]}else(e=this.a).m=this.c,Yn(e,2)}else 1==this.M&&(this.g?$t(6):"11111"==e?($t(5),this.g=!0,(!V||10<=Number(Z))&&(this.c=200,this.b.cancel(),$t(11),Kn(this.a,this,!0))):($t(7),this.g=!1))},r.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,on(this)):1==this.M&&(this.g?($t(11),Kn(this.a,this,!0)):($t(10),Kn(this.a,this,!1)));else{0==this.M?$t(8):1==this.M&&$t(9);var t=this.a;t.m=this.c,Yn(t,2)}},r.Y=function(){return this.a.Y()},r.ma=function(){return this.a.ma()},sn.prototype.add=function(t){this.a.set(un(t),t)},sn.prototype.C=function(){return this.a.C()};var hn=10;function pn(t,e){!t.a&&(P(e,"spdy")||P(e,"quic")||P(e,"h2"))&&(t.f=t.g,t.a=new sn,t.b&&(yn(t,t.b),t.b=null))}function fn(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function dn(t){return t.b?1:t.a?t.a.a.c:0}function mn(t,e){return t.b?t=t.b==e:t.a?(e=un(e),t=Pe(t.a.a.b,e)):t=!1,t}function yn(t,e){t.a?t.a.add(e):t.b=e}function gn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=un(e),n=Pe(t.a.a.b,n)),n&&Ae(t.a.a,un(e)))}function vn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return S(t.a.C(),(function(t){e=e.concat(t.j)})),e}return I(t.c)}function _n(){}function bn(){this.a=new _n}function wn(t,e,n){var r=n||"";try{Ie(t,(function(t,n){var i=t;d(t)&&(i=It(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function xn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}ln.prototype.cancel=function(){var t;this.c=vn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(S(this.a.C(),(function(t){t.cancel()})),(t=this.a.a).b={},t.a.length=0,t.c=0)},_n.prototype.stringify=function(t){return a.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return a.JSON.parse(t,void 0)};var En=a.JSON.parse;function Tn(t){St.call(this),this.headers=new ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Sn,this.D=this.F=!1}x(Tn,St);var Sn="",Cn=/^https?$/i,In=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function An(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,On(t),Dn(t)}function On(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Pn(t){if(t.b&&"undefined"!=typeof o&&(!t.s[1]||4!=Rn(t)||2!=t.T()))if(t.l&&4==Rn(t))Ut(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==Rn(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var s=String(t.A).match(De)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}i=!Cn.test(s?s.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var c=2<Rn(t)?t.a.statusText:""}catch(l){c=""}t.f=c+" ["+t.T()+"]",On(t)}}finally{Dn(t)}}}function Dn(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?l:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function Mn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(a.clearTimeout(t.m),t.m=null)}function Rn(t){return t.a?t.a.readyState:0}function Nn(t,e){return t.a?t.a.getResponseHeader(e):null}function Ln(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=function(t){var e="";return N(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),s(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=t.indexOf("#"))&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var i=""}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return ze(t,e,n),t}function Fn(t){this.f=[],this.F=new an,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!c("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=c("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=c("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=c("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=c("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.zb||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new ln(t&&t.concurrentRequestLimit),this.ja=new bn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function jn(t){if(zn(t),3==t.u){var e=t.P++,n=Re(t.B);ze(n,"SID",t.H),ze(n,"RID",e),ze(n,"TYPE","terminate"),qn(t,n),(e=new pe(t,e,void 0)).F=2,e.f=Ue(Re(n)),n=!1,a.navigator&&a.navigator.sendBeacon&&(n=a.navigator.sendBeacon(e.f.toString(),"")),!n&&a.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=w(),we(e)}Zn(t)}function zn(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(a.clearTimeout(t.l),t.l=null),Qn(t),t.b.cancel(),t.h&&(u(t.h)&&a.clearTimeout(t.h),t.h=null)}function Bn(t,e){t.f.push(new cn(t.Qa++,e)),3==t.u&&Un(t)}function Un(t){fn(t.b)||t.h||(t.h=!0,Nt(t.Ha,t),t.A=0)}function Vn(t,e){var n;n=e?e.W:t.P++;var r=Re(t.B);ze(r,"SID",t.H),ze(r,"RID",n),ze(r,"AID",t.O),qn(t,r),t.g&&t.i&&Ln(r,t.g,t.i),n=new pe(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=Wn(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),yn(t.b,n),ye(n,r,e)}function qn(t,e){t.c&&Ie({},(function(t,n){ze(e,n,t)}))}function Wn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?_(t.c.Sa,t.c,t):null;t:for(var i=t.f,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{wn(l,a,"req"+c+"_")}catch(h){r&&r(l)}}if(s){r=a.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function Gn(t){t.a||t.l||(t.S=1,Nt(t.Ga,t),t.v=0)}function Hn(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=ee(_(t.Ga,t),Xn(t,t.v)),t.v++,!0)}function Kn(t,e,n){var r=e.l;r&&pn(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=Jn(t,null,t.ha),Un(t)}function Qn(t){null!=t.s&&(a.clearTimeout(t.s),t.s=null)}function Xn(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function Yn(t,e){if(2==e){var n=null;t.c&&(n=null);var r=_(t.eb,t);n||(n=new Me("//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||Ne(n,"https"),Ue(n)),function(t,e){var n=new Qt;if(a.Image){var r=new Image;r.onload=b(xn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=b(xn,n,r,"TestLoadImage: error",!1,e),r.onabort=b(xn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=b(xn,n,r,"TestLoadImage: timeout",!1,e),a.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else $t(2);t.u=0,t.c&&t.c.ta(e),Zn(t),zn(t)}function Zn(t){t.u=0,t.m=-1,t.c&&(0==vn(t.b).length&&0==t.f.length||(t.b.c.length=0,I(t.f),t.f.length=0),t.c.sa())}function Jn(t,e,n){var r=function(t){return t instanceof Me?Re(t):new Me(t,void 0)}(n);if(""!=r.b)e&&Le(r,e+"."+r.b),Fe(r,r.i);else{var i,o=a.location;i=e?e+"."+o.hostname:o.hostname,r=function(t,e,n,r){var i=new Me(null,void 0);return t&&Ne(i,t),e&&Le(i,e),n&&Fe(i,n),r&&(i.a=r),i}(o.protocol,i,+o.port,n)}return t.V&&N(t.V,(function(t,e){ze(r,e,t)})),e=t.j,n=t.I,e&&n&&ze(r,e,n),ze(r,"VER",t.wa),qn(t,r),r}function $n(){}function tr(){if(V&&!(10<=Number(Z)))throw Error("Environmental error: no available transport.")}function er(t,e){St.call(this),this.a=new Fn(e),this.g=t,this.m=e&&e.testUrl?e.testUrl:function(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];if(0==i.lastIndexOf("/",0))e=i;else(r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!k(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!k(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new ir(this)}function nr(t){ce.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function rr(){le.call(this),this.status=1}function ir(t){this.a=t}(r=Tn.prototype).ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?oe(this.H):oe(se),this.a.onreadystatechange=_(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(o){return void An(this,o)}t=n||"";var i=new ke(this.headers);r&&Ie(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=kn,n=t.length,r=s(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:s(t)?t.charAt(e):t[e]}(i.K()),n=a.FormData&&t instanceof a.FormData,!(0<=T(In,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.D=function(t){return V&&$(9)&&u(t.timeout)&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=_(this.Ba,this)):this.m=Ut(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){An(this,o)}},r.Ba=function(){"undefined"!=typeof o&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},r.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Dn(this))},r.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Dn(this,!0)),Tn.N.G.call(this)},r.Ea=function(){this.j||(this.w||this.l||this.g?Pn(this):this.Za())},r.Za=function(){Pn(this)},r.T=function(){try{return 2<Rn(this)?this.a.status:-1}catch(t){return-1}},r.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},r.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),En(e)}},r.ya=function(){return this.h},r.Xa=function(){return s(this.f)?this.f:String(this.f)},(r=Fn.prototype).wa=8,r.u=1,r.Ca=function(){return 0==this.u},r.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());var e,n=new pe(this,t=this.P++,void 0),r=this.i;if(this.J&&(r?j(r=L(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&s(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Wn(this,n,e),ze(i=Re(this.B),"RID",t),ze(i,"CVER",22),this.o&&this.j&&ze(i,"X-HTTP-Session-Id",this.j),qn(this,i),this.g&&r&&Ln(i,this.g,r),yn(this.b,n),this.W?(ze(i,"$req",e),ze(i,"SID","null"),n.S=!0,ye(n,i,null)):ye(n,i,e),this.u=2}}else 3==this.u&&(t?Vn(this,t):0==this.f.length||fn(this.b)||Vn(this))},r.Ga=function(){this.l=null,this.a=new pe(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=Re(this.pa);ze(t,"RID","rpc"),ze(t,"SID",this.H),ze(t,"CI",this.ia?"0":"1"),ze(t,"AID",this.O),qn(this,t),ze(t,"TYPE","xmlhttp"),this.g&&this.i&&Ln(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),ge(this.a,t,!0,this.ga)},r.Fa=function(t,e){if(0!=this.u&&(this.a==t||mn(this.b,t)))if(this.m=t.o,!t.s&&mn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(o){n=null}if(p(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;Qn(this),this.a.cancel(),this.a=null}Hn(this),$t(18)}}else this.ra=e[1],0<this.ra-this.O&&37500>e[2]&&this.ia&&0==this.v&&!this.s&&(this.s=ee(_(this.Ya,this),6e3));if(1>=dn(this.b)&&this.fa){try{this.fa()}catch(o){}this.fa=void 0}}else Yn(this,11)}else if((t.s||this.a==t)&&Qn(this),!k(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&u(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=Nn(r,"X-Client-Wire-Protocol"))&&pn(this.b,i),this.j&&(r=Nn(r,"X-HTTP-Session-Id")))&&(this.I=r,ze(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=Jn(this,this.Y()?this.ga:null,this.ha),r.s?(gn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(Ee(r),we(r)),this.a=r):Gn(this),0<this.f.length&&Un(this)}else"stop"!=r[0]&&"close"!=r[0]||Yn(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?Yn(this,7):jn(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},r.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,Hn(this),$t(19))},r.na=function(t){var e=null;if(this.a==t){Qn(this),this.a=null;var n=2}else{if(!mn(this.b,t))return;e=t.j,gn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=w()-t.v,Xt.dispatchEvent(new te(Xt,t.l?t.l.length:0,e,this.A)),Un(this)):Gn(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&function(t,e){return!(dn(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.f=e.j.concat(t.f),!0):!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa))&&(t.h=ee(_(t.Ha,t,e),Xn(t,t.A)),t.A++,!0))}(this,t)||2==n&&Hn(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:Yn(this,5);break;case 4:Yn(this,10);break;case 3:Yn(this,6);break;default:Yn(this,2)}}},r.eb=function(t){$t(t?2:1)},r.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Tn(this.Ka)).F=this.R,t},r.ma=function(){return!!this.c&&!0},r.Y=function(){return this.R},(r=$n.prototype).va=function(){},r.ua=function(){},r.ta=function(){},r.sa=function(){},r.Sa=function(){},tr.prototype.a=function(t,e){return new er(t,e)},x(er,St),(r=er.prototype).addEventListener=function(t,e,n,r){er.N.addEventListener.call(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){er.N.removeEventListener.call(this,t,e,n,r)},r.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;$t(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new rn(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=Ln(e,t.g,t.i)),(t=t.w).i=n,e=Jn(t.a,null,t.i),$t(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,on(t)):(Be(e,"MODE","init"),!t.a.o&&t.a.j&&Be(e,"X-HTTP-Session-Id",t.a.j),t.b=new pe(t,void 0,void 0),t.b.h=t.h,ge(t.b,e,!1,null),t.M=0)},r.close=function(){jn(this.a)},r.Wa=function(t){if(s(t)){var e={};e.__data__=t,Bn(this.a,e)}else this.h?((e={}).__data__=It(t),Bn(this.a,e)):Bn(this.a,t)},r.G=function(){this.a.c=null,delete this.f,jn(this.a),delete this.a,er.N.G.call(this)},x(nr,ce),x(rr,le),x(ir,$n),ir.prototype.va=function(){this.a.dispatchEvent("a")},ir.prototype.ua=function(t){this.a.dispatchEvent(new nr(t))},ir.prototype.ta=function(t){this.a.dispatchEvent(new rr(t))},ir.prototype.sa=function(){this.a.dispatchEvent("b")};var or=b((function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r}),tr);tr.prototype.createWebChannel=tr.prototype.a,er.prototype.send=er.prototype.Wa,er.prototype.open=er.prototype.Va,er.prototype.close=er.prototype.close,ne.NO_ERROR=0,ne.TIMEOUT=8,ne.HTTP_ERROR=6,re.COMPLETE="complete",ae.EventType=ue,ue.OPEN="a",ue.CLOSE="b",ue.ERROR="c",ue.MESSAGE="d",St.prototype.listen=St.prototype.za,Tn.prototype.listenOnce=Tn.prototype.Aa,Tn.prototype.getLastError=Tn.prototype.Xa,Tn.prototype.getLastErrorCode=Tn.prototype.ya,Tn.prototype.getStatus=Tn.prototype.T,Tn.prototype.getResponseJson=Tn.prototype.Ua,Tn.prototype.getResponseText=Tn.prototype.aa,Tn.prototype.send=Tn.prototype.ca;var ar={createWebChannelTransport:or,ErrorCode:ne,EventType:re,WebChannel:ae,XhrIo:Tn},sr=ar.createWebChannelTransport,ur=ar.ErrorCode,cr=ar.EventType,lr=ar.WebChannel,hr=ar.XhrIo;e.default=ar}.call(this,n(20))},function(t,e,n){"use strict";var r,i=(r=n(7))&&"object"===typeof r&&"default"in r?r.default:r,o=n(2),a=n(12),s={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},u=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return o.__extends(e,t),e}(Error);var c=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.messaging?[4,this.messaging.getToken()]:[2,void 0];case 1:return(t=e.sent())?[2,t]:[2,void 0];case 2:return e.sent(),[2,void 0];case 3:return[2]}}))}))},t.prototype.getContext=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e;return o.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function l(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var h=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"===typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"===typeof t||"object"===typeof t)return l(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"===typeof t||"object"===typeof t?l(t,(function(t){return e.decode(t)})):t},t}();var p=function(){function t(t,e,n,r){var i=this;void 0===r&&(r="us-central1"),this.app_=t,this.region_=r,this.serializer=new h,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return i.deleteService()}},this.contextProvider=new c(e,n),this.cancelAllRequests=new Promise((function(t){i.deleteService=function(){return t()}}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId,n=this.region_;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+n+"/"+t:"https://"+n+"-"+e+".cloudfunctions.net/"+t},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i;return o.__generator(this,(function(o){switch(o.label){case 0:n.append("Content-Type","application/json"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}}))}))},t.prototype.call=function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,a,c,l,h,p,f;return o.__generator(this,(function(o){switch(o.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},a=new Headers,[4,this.contextProvider.getContext()];case 1:return(c=o.sent()).authToken&&a.append("Authorization","Bearer "+c.authToken),c.instanceIdToken&&a.append("Firebase-Instance-ID-Token",c.instanceIdToken),l=n.timeout||7e4,[4,Promise.race([this.postJSON(r,i,a),(d=l,new Promise((function(t,e){setTimeout((function(){e(new u("deadline-exceeded","deadline-exceeded"))}),d)}))),this.cancelAllRequests])];case 2:if(!(h=o.sent()))throw new u("cancelled","Firebase Functions instance was deleted.");if(p=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e&&e.error;if(a){var c=a.status;if("string"===typeof c){if(!s[c])return new u("internal","internal");r=s[c],i=c}var l=a.message;"string"===typeof l&&(i=l),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(h){}return"ok"===r?null:new u(r,i,o)}(h.status,h.json,this.serializer))throw p;if(!h.json)throw new u("internal","Response is not valid JSON object.");if("undefined"===typeof(f=h.json.data)&&(f=h.json.result),"undefined"===typeof f)throw new u("internal","Response is missing data field.");return[2,{data:this.serializer.decode(f)}]}var d}))}))},t}(),f="functions";function d(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("messaging");return new p(n,r,i,e)}!function(t){var e={Functions:p};t.INTERNAL.registerComponent(new a.Component(f,d,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))}(i),i.registerVersion("@firebase/functions","0.4.28")},function(t,e,n){"use strict";n.r(e),n.d(e,"isSupported",(function(){return F})),n.d(e,"registerMessaging",(function(){return L}));var r,i,o=n(7),a=n.n(o),s=(n(27),n(2)),u=n(13),c=n(12),l=((r={})["only-available-in-window"]="This method is available in a Window context.",r["only-available-in-sw"]="This method is available in a service worker context.",r["should-be-overriden"]="This method should be overriden by extended classes.",r["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",r["permission-default"]="The required permissions were not granted and dismissed instead.",r["permission-blocked"]="The required permissions were not granted and blocked instead.",r["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",r["notifications-blocked"]="Notifications have been blocked.",r["failed-serviceworker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",r["sw-registration-expected"]="A service worker registration was the expected input.",r["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",r["invalid-saved-token"]="Unable to access details of the saved token.",r["sw-reg-redundant"]="The service worker being used for push was made redundant.",r["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$errorInfo}",r["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",r["token-unsubscribe-failed"]="A problem occured while unsubscribing the user from FCM: {$errorInfo}",r["token-update-failed"]="A problem occured while updating the user from FCM: {$errorInfo}",r["token-update-no-token"]="FCM returned no token when updating the user to push.",r["use-sw-before-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",r["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",r["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",r["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",r["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",r["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",r["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$errorInfo}",r["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",r["failed-to-delete-token"]="Unable to delete the currently saved token.",r["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",r["bad-scope"]="The service worker scope must be a string with at least one character.",r["bad-vapid-key"]="The public VAPID key is not a Uint8Array with 65 bytes.",r["bad-subscription"]="The subscription must be a valid PushSubscription.",r["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",r["failed-delete-vapid-key"]="The VAPID key could not be deleted.",r["invalid-public-vapid-key"]="The public VAPID key must be a string.",r["use-public-key-before-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",r["public-vapid-key-decryption-failed"]="The public VAPID key did not equal 65 bytes when decrypted.",r),h=new u.ErrorFactory("messaging","Messaging",l),p=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),f="https://fcmregistrations.googleapis.com/v1";function d(t,e){if(null==t||null==e)return!1;if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(var n=new DataView(t),r=new DataView(e),i=0;i<t.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}function m(t){return function(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,Object(s.__spread)(e)))}(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}!function(t){t.PUSH_MSG_RECEIVED="push-msg-received",t.NOTIFICATION_CLICKED="notification-clicked"}(i||(i={}));var y=function(){function t(){}return t.prototype.getToken=function(t,e,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,u,c;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return[4,v(t)];case 1:r=s.sent(),i=_(e,n),o={method:"POST",headers:r,body:JSON.stringify(i)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(g(t.app),o)];case 3:return[4,s.sent().json()];case 4:return a=s.sent(),[3,6];case 5:throw u=s.sent(),h.create("token-subscribe-failed",{errorInfo:u});case 6:if(a.error)throw c=a.error.message,h.create("token-subscribe-failed",{errorInfo:c});if(!a.token)throw h.create("token-subscribe-no-token");return[2,a.token]}}))}))},t.prototype.updateToken=function(t,e,n,r){return Object(s.__awaiter)(this,void 0,void 0,(function(){var i,o,a,u,c,l;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return[4,v(e)];case 1:i=s.sent(),o=_(n,r),a={method:"PATCH",headers:i,body:JSON.stringify(o)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(g(e.app)+"/"+t.fcmToken,a)];case 3:return[4,s.sent().json()];case 4:return u=s.sent(),[3,6];case 5:throw c=s.sent(),h.create("token-update-failed",{errorInfo:c});case 6:if(u.error)throw l=u.error.message,h.create("token-update-failed",{errorInfo:l});if(!u.token)throw h.create("token-update-no-token");return[2,u.token]}}))}))},t.prototype.deleteToken=function(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return[4,v(t)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(g(t.app)+"/"+e.fcmToken,r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw o=i.error.message,h.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw a=s.sent(),h.create("token-unsubscribe-failed",{errorInfo:a});case 6:return[2]}}))}))},t}();function g(t){return f+"/projects/"+t.options.projectId+"/registrations"}function v(t){var e=t.app,n=t.installations;return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.options.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function _(t,e){var n=m(t.getKey("p256dh")),r=m(t.getKey("auth")),i={web:{endpoint:t.endpoint,p256dh:n,auth:r}};return d(e.buffer,p.buffer)||(i.web.applicationPubKey=m(e)),i}function b(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var w="undefined",x="fcm_token_object_Store";function E(t){var e=indexedDB.open(w);e.onerror=function(t){},e.onsuccess=function(n){!function(t,e){if(t.objectStoreNames.contains(x)){var n=t.transaction(x).objectStore(x),r=new y,i=n.openCursor();i.onerror=function(t){console.warn("Unable to cleanup old IDB.",t)},i.onsuccess=function(){var n=i.result;if(n){var o=n.value;r.deleteToken(e,o),n.continue()}else t.close(),indexedDB.deleteDatabase(w)}}}(e.result,t)}}var T=function(){function t(){this.dbPromise=null}return t.prototype.get=function(t){return this.createTransaction((function(e){return e.get(t)}))},t.prototype.getIndex=function(t,e){return this.createTransaction((function(n){return n.index(t).get(e)}))},t.prototype.put=function(t){return this.createTransaction((function(e){return e.put(t)}),"readwrite")},t.prototype.delete=function(t){return this.createTransaction((function(e){return e.delete(t)}),"readwrite")},t.prototype.closeDatabase=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:t.sent().close(),this.dbPromise=null,t.label=2;case 2:return[2]}}))}))},t.prototype.createTransaction=function(t,e){return void 0===e&&(e="readonly"),Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.getDb()];case 1:return n=a.sent(),r=n.transaction(this.objectStoreName,e),i=r.objectStore(this.objectStoreName),[4,S(t(i))];case 2:return o=a.sent(),[2,new Promise((function(t,e){r.oncomplete=function(){t(o)},r.onerror=function(){e(r.error)}}))]}}))}))},t.prototype.getDb=function(){var t=this;return this.dbPromise||(this.dbPromise=new Promise((function(e,n){var r=indexedDB.open(t.dbName,t.dbVersion);r.onsuccess=function(){e(r.result)},r.onerror=function(){t.dbPromise=null,n(r.error)},r.onupgradeneeded=function(e){return t.onDbUpgrade(r,e)}}))),this.dbPromise},t}();function S(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}var C=function(t){function e(e){var n=t.call(this)||this;return n.services=e,n.dbName="fcm_token_details_db",n.dbVersion=4,n.objectStoreName="fcm_token_object_Store",n}return Object(s.__extends)(e,t),e.prototype.onDbUpgrade=function(t,e){var n=t.result;switch(e.oldVersion){case 0:(i=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"})).createIndex("fcmSenderId","fcmSenderId",{unique:!1}),i.createIndex("fcmToken","fcmToken",{unique:!0});case 1:E(this.services);case 2:var r=(i=t.transaction.objectStore(this.objectStoreName)).openCursor();r.onsuccess=function(){var t=r.result;if(t){var e=t.value,n=Object(s.__assign)({},e);e.createTime||(n.createTime=Date.now()),"string"===typeof e.vapidKey&&(n.vapidKey=b(e.vapidKey)),"string"===typeof e.auth&&(n.auth=b(e.auth).buffer),"string"===typeof e.auth&&(n.p256dh=b(e.p256dh).buffer),"string"===typeof e.fcmPushSet&&delete n.fcmPushSet,t.update(n),t.continue()}};break;case 3:var i,o=(i=t.transaction.objectStore(this.objectStoreName)).openCursor();o.onsuccess=function(){var t=o.result;if(t){var e=t.value,n=Object(s.__assign)({},e);"string"===typeof e.fcmPushSet&&delete n.fcmPushSet,t.update(n),t.continue()}}}},e.prototype.getTokenDetailsFromToken=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){if(!t)throw h.create("bad-token");return I({fcmToken:t}),[2,this.getIndex("fcmToken",t)]}))}))},e.prototype.getTokenDetailsFromSWScope=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){if(!t)throw h.create("bad-scope");return I({swScope:t}),[2,this.get(t)]}))}))},e.prototype.saveTokenDetails=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){if(!t.swScope)throw h.create("bad-scope");if(!t.vapidKey)throw h.create("bad-vapid-key");if(!t.endpoint||!t.auth||!t.p256dh)throw h.create("bad-subscription");if(!t.fcmSenderId)throw h.create("bad-sender-id");if(!t.fcmToken)throw h.create("bad-token");return I(t),[2,this.put(t)]}))}))},e.prototype.deleteToken=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return"string"!==typeof t||0===t.length?[2,Promise.reject(h.create("invalid-delete-token"))]:[4,this.getTokenDetailsFromToken(t)];case 1:if(!(e=n.sent()))throw h.create("delete-token-not-found");return[4,this.delete(e.swScope)];case 2:return n.sent(),[2,e]}}))}))},e}(T);function I(t){if(t.fcmToken&&("string"!==typeof t.fcmToken||0===t.fcmToken.length))throw h.create("bad-token");if(t.swScope&&("string"!==typeof t.swScope||0===t.swScope.length))throw h.create("bad-scope");if(t.vapidKey&&(!(t.vapidKey instanceof Uint8Array)||65!==t.vapidKey.length))throw h.create("bad-vapid-key");if(t.endpoint&&("string"!==typeof t.endpoint||0===t.endpoint.length))throw h.create("bad-subscription");if(t.auth&&!(t.auth instanceof ArrayBuffer))throw h.create("bad-subscription");if(t.p256dh&&!(t.p256dh instanceof ArrayBuffer))throw h.create("bad-subscription");if(t.fcmSenderId&&("string"!==typeof t.fcmSenderId||0===t.fcmSenderId.length))throw h.create("bad-sender-id")}var k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_vapid_details_db",e.dbVersion=1,e.objectStoreName="fcm_vapid_object_Store",e}return Object(s.__extends)(e,t),e.prototype.onDbUpgrade=function(t){t.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},e.prototype.getVapidFromSWScope=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:if("string"!==typeof t||0===t.length)throw h.create("bad-scope");return[4,this.get(t)];case 1:return[2,(e=n.sent())?e.vapidKey:void 0]}}))}))},e.prototype.saveVapidDetails=function(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){if("string"!==typeof t||0===t.length)throw h.create("bad-scope");if(null===e||65!==e.length)throw h.create("bad-vapid-key");return n={swScope:t,vapidKey:e},[2,this.put(n)]}))}))},e.prototype.deleteVapidDetails=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getVapidFromSWScope(t)];case 1:if(!(e=n.sent()))throw h.create("delete-scope-not-found");return[4,this.delete(t)];case 2:return n.sent(),[2,e]}}))}))},e}(T),A=function(){function t(t){var e=this;this.services=t,this.vapidDetailsModel=new k,this.subscriptionManager=new y;var n=t.app;if(this.app=n,!n.options.messagingSenderId||"string"!==typeof n.options.messagingSenderId)throw h.create("bad-sender-id");this.INTERNAL={delete:function(){return e.delete()}},this.tokenDetailsModel=new C(t)}return t.prototype.getToken=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return"default"!==(t=this.getNotificationPermission())?[3,2]:[4,this.requestNotificationPermission()];case 1:t=o.sent(),o.label=2;case 2:if("granted"!==t)throw h.create("notifications-blocked");return[4,this.getSWRegistration_()];case 3:return e=o.sent(),[4,this.getPublicVapidKey_()];case 4:return n=o.sent(),[4,this.getPushSubscription(e,n)];case 5:return r=o.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(e.scope)];case 6:return(i=o.sent())?[2,this.manageExistingToken(e,r,n,i)]:[2,this.getNewToken(e,r,n)]}}))}))},t.prototype.manageExistingToken=function(t,e,n,r){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return function(t,e,n){if(!n.vapidKey||!d(e.buffer,n.vapidKey.buffer))return!1;var r=t.endpoint===n.endpoint,i=d(t.getKey("auth"),n.auth),o=d(t.getKey("p256dh"),n.p256dh);return r&&i&&o}(e,n,r)?Date.now()<r.createTime+6048e5?[2,r.fcmToken]:[2,this.updateToken(t,e,n,r)]:[3,1];case 1:return[4,this.deleteTokenFromDB(r.fcmToken)];case 2:return i.sent(),[2,this.getNewToken(t,e,n)];case 3:return[2]}}))}))},t.prototype.updateToken=function(t,e,n,r){return Object(s.__awaiter)(this,void 0,void 0,(function(){var i,o,a;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,4,,6]),[4,this.subscriptionManager.updateToken(r,this.services,e,n)];case 1:return i=s.sent(),o={swScope:t.scope,vapidKey:n,fcmSenderId:this.services.app.options.messagingSenderId,fcmToken:i,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(o)];case 2:return s.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return s.sent(),[2,i];case 4:return a=s.sent(),[4,this.deleteToken(r.fcmToken)];case 5:throw s.sent(),a;case 6:return[2]}}))}))},t.prototype.getNewToken=function(t,e,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return[4,this.subscriptionManager.getToken(this.services,e,n)];case 1:return r=o.sent(),i={swScope:t.scope,vapidKey:n,fcmSenderId:this.app.options.messagingSenderId,fcmToken:r,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(i)];case 2:return o.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return o.sent(),[2,r]}}))}))},t.prototype.deleteToken=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.deleteTokenFromDB(t)];case 1:return r.sent(),[4,this.getSWRegistration_()];case 2:return(e=r.sent())?[4,e.pushManager.getSubscription()]:[3,4];case 3:if(n=r.sent())return[2,n.unsubscribe()];r.label=4;case 4:return[2,!0]}}))}))},t.prototype.deleteTokenFromDB=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.tokenDetailsModel.deleteToken(t)];case 1:e=r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this.subscriptionManager.deleteToken(this.services,e)];case 3:return r.sent(),[3,5];case 4:return n=r.sent(),console.error(n),[3,5];case 5:return[2]}}))}))},t.prototype.getPushSubscription=function(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e})]}}))}))},t.prototype.requestPermission=function(){throw h.create("only-available-in-window")},t.prototype.useServiceWorker=function(t){throw h.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){throw h.create("only-available-in-window")},t.prototype.onMessage=function(t,e,n){throw h.create("only-available-in-window")},t.prototype.onTokenRefresh=function(t,e,n){throw h.create("only-available-in-window")},t.prototype.setBackgroundMessageHandler=function(t){throw h.create("only-available-in-sw")},t.prototype.delete=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return t.sent(),[2]}}))}))},t.prototype.getNotificationPermission=function(){return Notification.permission},t.prototype.requestNotificationPermission=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return Notification.requestPermission?[2,Notification.requestPermission()]:[2,Notification.permission]}))}))},t.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},t.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},t.prototype.getSubscriptionManager=function(){return this.subscriptionManager},t}();var O=function(t){function e(e){var n=t.call(this,e)||this;return n.bgMessageHandler=null,self.addEventListener("push",(function(t){n.onPush(t)})),self.addEventListener("pushsubscriptionchange",(function(t){n.onSubChange(t)})),self.addEventListener("notificationclick",(function(t){n.onNotificationClick(t)})),n}return Object(s.__extends)(e,t),e.prototype.onPush=function(t){t.waitUntil(this.onPush_(t))},e.prototype.onSubChange=function(t){t.waitUntil(this.onSubChange_(t))},e.prototype.onNotificationClick=function(t){t.waitUntil(this.onNotificationClick_(t))},e.prototype.onPush_=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o,a;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:if(!t.data)return[2];try{e=t.data.json()}catch(u){return[2]}return[4,this.hasVisibleClients_()];case 1:return s.sent()?[2,this.sendMessageToWindowClients_(e)]:(n=this.getNotificationData_(e))?(r=n.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return i=s.sent(),o=n.actions,a=Notification.maxActions,o&&a&&o.length>a&&console.warn("This browser only supports "+a+" actions.The remaining actions will not be displayed."),[2,i.showNotification(r,n)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(e)]:[3,5];case 4:return s.sent(),[2];case 5:return[2]}}))}))},e.prototype.onSubChange_=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return t=i.sent(),[3,3];case 2:throw e=i.sent(),h.create("unable-to-resubscribe",{errorInfo:e});case 3:return i.trys.push([3,5,,8]),[4,t.pushManager.getSubscription()];case 4:return i.sent(),[3,8];case 5:return n=i.sent(),[4,this.getTokenDetailsModel().getTokenDetailsFromSWScope(t.scope)];case 6:if(!(r=i.sent()))throw n;return[4,this.deleteToken(r.fcmToken)];case 7:throw i.sent(),n;case 8:return[2]}}))}))},e.prototype.onNotificationClick_=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n,r,o;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:if(!(t.notification&&t.notification.data&&t.notification.data.FCM_MSG))return[2];if(t.action)return[2];if(t.stopImmediatePropagation(),t.notification.close(),!(e=t.notification.data.FCM_MSG).notification)return[2];if(!(n=e.fcmOptions&&e.fcmOptions.link||e.notification.click_action)){if(!(e.data&&"google.c.a.c_id"in e.data))return[2];n=self.location.origin}return[4,this.getWindowClient_(n)];case 1:return(r=a.sent())?[3,4]:[4,self.clients.openWindow(n)];case 2:return r=a.sent(),[4,(s=3e3,new Promise((function(t){setTimeout(t,s)})))];case 3:return a.sent(),[3,6];case 4:return[4,r.focus()];case 5:r=a.sent(),a.label=6;case 6:return r?(delete e.notification,delete e.fcmOptions,o=D(i.NOTIFICATION_CLICKED,e),[2,this.attemptToMessageClient_(r,o)]):[2]}var s}))}))},e.prototype.getNotificationData_=function(t){var e;if(t&&"object"===typeof t.notification){var n=Object(s.__assign)({},t.notification);return n.data=Object(s.__assign)(Object(s.__assign)({},t.notification.data),((e={}).FCM_MSG=t,e)),n}},e.prototype.setBackgroundMessageHandler=function(t){if(!t||"function"!==typeof t)throw h.create("bg-handler-function-expected");this.bgMessageHandler=t},e.prototype.getWindowClient_=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return e=new URL(t,self.location.href).href,[4,P()];case 1:for(n=o.sent(),r=null,i=0;i<n.length;i++)if(new URL(n[i].url,self.location.href).href===e){r=n[i];break}return[2,r]}}))}))},e.prototype.attemptToMessageClient_=function(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(n){if(!t)throw h.create("no-window-client-to-msg");return t.postMessage(e),[2]}))}))},e.prototype.hasVisibleClients_=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return[4,P()];case 1:return[2,t.sent().some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))]}}))}))},e.prototype.sendMessageToWindowClients_=function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n,r=this;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return[4,P()];case 1:return e=o.sent(),n=D(i.PUSH_MSG_RECEIVED,t),[4,Promise.all(e.map((function(t){return r.attemptToMessageClient_(t,n)})))];case 2:return o.sent(),[2]}}))}))},e.prototype.getSWRegistration_=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return[2,self.registration]}))}))},e.prototype.getPublicVapidKey_=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,e;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(t=n.sent()))throw h.create("sw-registration-expected");return[4,this.getVapidDetailsModel().getVapidFromSWScope(t.scope)];case 2:return null==(e=n.sent())?[2,p]:[2,e]}}))}))},e}(A);function P(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function D(t,e){return{firebaseMessagingType:t,firebaseMessagingData:e}}var M=function(t){function e(e){var n=t.call(this,e)||this;return n.registrationToUse=null,n.publicVapidKeyToUse=null,n.messageObserver=null,n.tokenRefreshObserver=null,n.onMessageInternal=Object(u.createSubscribe)((function(t){n.messageObserver=t})),n.onTokenRefreshInternal=Object(u.createSubscribe)((function(t){n.tokenRefreshObserver=t})),n.setupSWMessageListener_(),n}return Object(s.__extends)(e,t),e.prototype.requestPermission=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?h.create("permission-blocked"):h.create("permission-default")}}))}))},e.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw h.create("sw-registration-expected");if(null!=this.registrationToUse)throw h.create("use-sw-before-get-token");this.registrationToUse=t},e.prototype.usePublicVapidKey=function(t){if("string"!==typeof t)throw h.create("invalid-public-vapid-key");if(null!=this.publicVapidKeyToUse)throw h.create("use-public-key-before-get-token");var e=b(t);if(65!==e.length)throw h.create("public-vapid-key-decryption-failed");this.publicVapidKeyToUse=e},e.prototype.onMessage=function(t,e,n){return"function"===typeof t?this.onMessageInternal(t,e,n):this.onMessageInternal(t)},e.prototype.onTokenRefresh=function(t,e,n){return"function"===typeof t?this.onTokenRefreshInternal(t,e,n):this.onTokenRefreshInternal(t)},e.prototype.waitForRegistrationToActivate_=function(t){var e=t.installing||t.waiting||t.active;return new Promise((function(n,r){if(e)if("activated"!==e.state)if("redundant"!==e.state){e.addEventListener("statechange",(function i(){if("activated"===e.state)n(t);else{if("redundant"!==e.state)return;r(h.create("sw-reg-redundant"))}e.removeEventListener("statechange",i)}))}else r(h.create("sw-reg-redundant"));else n(t);else r(h.create("no-sw-in-reg"))}))},e.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}).catch((function(t){throw h.create("failed-serviceworker-registration",{browserErrorMessage:t.message})})).then((function(e){return t.waitForRegistrationToActivate_(e).then((function(){return t.registrationToUse=e,e.update(),e}))})))},e.prototype.getPublicVapidKey_=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,p]}))}))},e.prototype.setupSWMessageListener_=function(){var t=this;navigator.serviceWorker.addEventListener("message",(function(e){return Object(s.__awaiter)(t,void 0,void 0,(function(){var t,n,r,o,a;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return e.data&&e.data.firebaseMessagingType&&e.data.firebaseMessagingData?(t=e.data,n=t.firebaseMessagingType,r=t.firebaseMessagingData,this.messageObserver&&this.messageObserver.next(r),(o=r.data)&&"google.c.a.c_id"in o&&"1"===o["google.c.a.e"]?(a=function(t){switch(t){case i.NOTIFICATION_CLICKED:return"notification_open";case i.PUSH_MSG_RECEIVED:return"notification_foreground";default:throw new Error}}(n),[4,this.services.analyticsProvider.get()]):[3,2]):[2];case 1:s.sent().logEvent(a,{message_name:o["google.c.a.c_l"],message_id:o["google.c.a.c_id"],message_time:o["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),s.label=2;case 2:return[2]}}))}))}),!1)},e}(A);var R="@firebase/messaging",N="0.6.0";function L(t){var e={isSupported:F};t.INTERNAL.registerComponent(new c.Component("messaging",(function(t){var e={app:t.getProvider("app").getImmediate(),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!F())throw h.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new O(e):new M(e)}),"PUBLIC").setServiceProps(e)),t.registerVersion(R,N)}function F(){return self&&"ServiceWorkerGlobalScope"in self?"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}L(a.a)},function(t,e,n){"use strict";n.r(e),n.d(e,"registerStorage",(function(){return oe}));var r=n(7),i=n.n(r),o=n(2),a=n(12),s="firebasestorage.googleapis.com",u="storageBucket",c=12e4,l=6e5,h=-9007199254740991,p=function(){function t(t,e){this.code_=d(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return d(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.serverResponse_},t.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),t}(),f={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function d(t){return"storage/"+t}function m(){return new p(f.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function y(){return new p(f.CANCELED,"User canceled the upload/download.")}function g(){return new p(f.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function v(){return new p(f.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function _(t,e,n){return new p(f.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function b(){return new p(f.APP_DELETED,"The Firebase app was deleted.")}function w(t,e){return new p(f.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function x(t){throw new p(f.INTERNAL_ERROR,"Internal error: "+t)}var E={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function T(t){switch(t){case E.RAW:case E.BASE64:case E.BASE64URL:case E.DATA_URL:return;default:throw"Expected one of the event types: ["+E.RAW+", "+E.BASE64+", "+E.BASE64URL+", "+E.DATA_URL+"]."}}var S=function(t,e){this.data=t,this.contentType=e||null};function C(t,e){switch(t){case E.RAW:return new S(I(e));case E.BASE64:case E.BASE64URL:return new S(k(t,e));case E.DATA_URL:return new S(function(t){var e=new A(t);return e.base64?k(E.BASE64,e.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(n){throw w(E.DATA_URL,"Malformed data URL.")}return I(e)}(e.rest)}(e),new A(e).contentType)}throw m()}function I(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296===(64512&r))if(n<t.length-1&&56320===(64512&t.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else e.push(239,191,189);else 56320===(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function k(t,e){switch(t){case E.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw w(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case E.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw w(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(c){throw w(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var A=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw w(E.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=(r=n,i=";base64",r.length>=i.length&&r.substring(r.length-i.length)===i),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1);var r,i};var O,P={STATE_CHANGED:"state_changed"},D={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},M={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function R(t){switch(t){case D.RUNNING:case D.PAUSING:case D.CANCELING:return M.RUNNING;case D.PAUSED:return M.PAUSED;case D.SUCCESS:return M.SUCCESS;case D.CANCELED:return M.CANCELED;case D.ERROR:default:return M.ERROR}}function N(t){return null!=t}function L(t){return void 0!==t}function F(t){return"function"===typeof t}function j(t){return"object"===typeof t}function z(t){return j(t)&&null!==t}function B(t){return"string"===typeof t||t instanceof String}function U(t){return V(t)&&Number.isInteger(t)}function V(t){return"number"===typeof t||t instanceof Number}function q(t){return W()&&t instanceof Blob}function W(){return"undefined"!==typeof Blob}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(O||(O={}));var G=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=O.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=O.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=O.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw x("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),N(r))for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return N(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw x("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw x("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw x("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){N(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){N(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),H=function(){function t(){}return t.prototype.createXhrIo=function(){return new G},t}();function K(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Q(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=K();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(W())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}var X=function(){function t(t,e){var n=0,r="";q(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(q(this.data_)){var r=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===r?null:new t(r)}return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(W()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(Q.apply(null,r))}var i=e.map((function(t){return B(t)?C(E.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}(),Y=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!0,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n,r;try{n=t.makeFromUrl(e)}catch(i){return new t(e,"")}if(""===n.path)return n;throw r=e,new p(f.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")},t.makeFromUrl=function(e){var n=null;var r=new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i");for(var i=s.replace(/[.]/g,"\\."),o=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+i+"/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:function(t){t.path_=decodeURIComponent(t.path)}}],a=0;a<o.length;a++){var u=o[a],c=u.regex.exec(e);if(c){var l=c[u.indices.bucket],h=c[u.indices.path];h||(h=""),n=new t(l,h),u.postModify(n);break}}if(null==n)throw function(t){return new p(f.INVALID_URL,"Invalid URL '"+t+"'.")}(e);return n},t}();function Z(t){var e,n;try{e=JSON.parse(t)}catch(r){return null}return j(n=e)&&!Array.isArray(n)?e:null}function J(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}function $(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function tt(t){return"https://"+s+"/v0"+t}function et(t){var e=encodeURIComponent,n="?";for(var r in t){if(t.hasOwnProperty(r))n=n+(e(r)+"="+e(t[r]))+"&"}return n=n.slice(0,-1)}function nt(t,e){return e}var rt=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||nt},it=null;function ot(){if(it)return it;var t=[];t.push(new rt("bucket")),t.push(new rt("generation")),t.push(new rt("metageneration")),t.push(new rt("name","fullPath",!0));var e=new rt("name");e.xform=function(t,e){return function(t){return!B(t)||t.length<2?t:$(t)}(e)},t.push(e);var n=new rt("size");return n.xform=function(t,e){return N(e)?Number(e):e},t.push(n),t.push(new rt("timeCreated")),t.push(new rt("updated")),t.push(new rt("md5Hash",null,!0)),t.push(new rt("cacheControl",null,!0)),t.push(new rt("contentDisposition",null,!0)),t.push(new rt("contentEncoding",null,!0)),t.push(new rt("contentLanguage",null,!0)),t.push(new rt("contentType",null,!0)),t.push(new rt("metadata","customMetadata",!0)),it=t}function at(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new Y(n,r);return e.makeStorageReference(i)}})}(r,t),r}function st(t,e,n){var r=Z(e);return null===r?null:at(t,r,n)}function ut(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function ct(t){if(!j(t)||!t)throw"Expected Metadata object.";for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];if("customMetadata"===e){if(!j(n))throw"Expected object for 'customMetadata' mapping."}else if(z(n))throw"Mapping for '"+e+"' cannot be an object."}}var lt="maxResults",ht=1e3,pt="pageToken",ft="prefixes",dt="items";function mt(t,e){var n={prefixes:[],items:[],nextPageToken:e.nextPageToken},r=t.bucket();if(null===r)throw new p(f.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+u+"' property when initializing the app?");if(e[ft])for(var i=0,o=e[ft];i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t.makeStorageReference(new Y(r,a));n.prefixes.push(s)}if(e[dt])for(var c=0,l=e[dt];c<l.length;c++){var h=l[c];s=t.makeStorageReference(new Y(r,h.name));n.items.push(s)}return n}function yt(t){if(!j(t)||!t)throw"Expected ListOptions object.";for(var e in t)if(e===lt){if(!U(t[lt])||t[lt]<=0)throw"Expected maxResults to be a positive number.";if(t[lt]>1e3)throw"Expected maxResults to be less than or equal to "+ht+"."}else{if(e!==pt)throw"Unknown option: "+e;if(t[pt]&&!B(t[pt]))throw"Expected pageToken to be string."}}var gt=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function vt(t){if(!t)throw m()}function _t(t,e){return function(n,r){var i=st(t,r,e);return vt(null!==i),i}}function bt(t){return function(e,n){var r=function(t,e){var n=Z(e);return null===n?null:mt(t,n)}(t,n);return vt(null!==r),r}}function wt(t,e){return function(n,r){var i=st(t,r,e);return vt(null!==i),function(t,e){var n=Z(e);if(null===n)return null;if(!B(n.downloadTokens))return null;var r=n.downloadTokens;if(0===r.length)return null;var i=encodeURIComponent;return r.split(",").map((function(e){var n=t.bucket,r=t.fullPath;return tt("/b/"+i(n)+"/o/"+i(r))+et({alt:"media",token:e})}))[0]}(i,r)}}function xt(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=new p(f.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new p(f.QUOTA_EXCEEDED,"Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new p(f.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.setServerResponseProp(n.serverResponseProp()),r}}function Et(t){var e=xt(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new p(f.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")),o.setServerResponseProp(r.serverResponseProp()),o}}function Tt(t,e,n){var r=tt(e.fullServerUrl()),i=t.maxOperationRetryTime(),o=new gt(r,"GET",_t(t,n),i);return o.errorHandler=Et(e),o}function St(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=tt(e.bucketOnlyServerUrl()),s=t.maxOperationRetryTime(),u=new gt(a,"GET",bt(t),s);return u.urlParams=o,u.errorHandler=xt(e),u}function Ct(t,e,n){var r=tt(e.fullServerUrl()),i=t.maxOperationRetryTime(),o=new gt(r,"GET",wt(t,n),i);return o.errorHandler=Et(e),o}function It(t,e,n,r){var i=tt(e.fullServerUrl()),o=ut(n,r),a=t.maxOperationRetryTime(),s=new gt(i,"PATCH",_t(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=Et(e),s}function kt(t,e){var n=tt(e.fullServerUrl()),r=t.maxOperationRetryTime();var i=new gt(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=Et(e),i}function At(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}var Ot=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function Pt(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(r){vt(!1)}return vt(!!n&&-1!==(e||["active"]).indexOf(n)),n}function Dt(t,e,n,r,i,o,a,s){var u=new Ot(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new p(f.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,d=h+l,m={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},y=r.slice(h,d);if(null===y)throw g();var v=e.maxUploadRetryTime(),_=new gt(n,"POST",(function(t,n){var i,a=Pt(t,["active","final"]),s=u.current+l,c=r.size();return i="final"===a?_t(e,o)(t,n):null,new Ot(s,c,"final"===a,i)}),v);return _.headers=m,_.body=y.uploadData(),_.progressCallback=s||null,_.errorHandler=xt(t),_}var Mt=function(t,e,n){if(F(t)||N(e)||N(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}},Rt=function(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o};function Nt(t,e,n){for(var r=e.length,i=e.length,o=0;o<e.length;o++)if(e[o].optional){r=o;break}if(!(r<=n.length&&n.length<=i))throw function(t,e,n,r){var i,o;return t===e?(i=t,o=1===t?"argument":"arguments"):(i="between "+t+" and "+e,o="arguments"),new p(f.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+i+" "+o+", received "+r+".")}(r,i,t,n.length);for(o=0;o<n.length;o++)try{e[o].validator(n[o])}catch(a){throw a instanceof Error?_(o,t,a.message):_(o,t,a)}}var Lt=function(t,e){var n=this;this.validator=function(e){n.optional&&!L(e)||t(e)},this.optional=!!e};function Ft(t,e){function n(t){if(!B(t))throw"Expected string."}var r,i,o;return t?(i=n,o=t,r=function(t){i(t),o(t)}):r=n,new Lt(r,e)}function jt(){return new Lt((function(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||W()&&t instanceof Blob))throw"Expected Blob or File."}))}function zt(t){return new Lt(ct,t)}function Bt(t){return new Lt(yt,t)}function Ut(){return new Lt((function(t){if(!(V(t)&&t>=0))throw"Expected a number 0 or greater."}))}function Vt(t,e){return new Lt((function(e){if(!(null===e||N(e)&&e instanceof Object))throw"Expected an Object.";void 0!==t&&null!==t&&t(e)}),e)}function qt(t){return new Lt((function(t){if(!(null===t||F(t)))throw"Expected a Function."}),t)}function Wt(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var Gt=function(){function t(t,e,n,r,i,o){var a=this;void 0===o&&(o=null),this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.authWrapper_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=D.RUNNING,this.errorHandler_=function(t){a.request_=null,a.chunkMultiplier_=1,t.codeEquals(f.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=t,a.transition_(D.ERROR))},this.metadataErrorHandler_=function(t){a.request_=null,t.codeEquals(f.CANCELED)?a.completeTransitions_():(a.error_=t,a.transition_(D.ERROR))},this.promise_=new Promise((function(t,e){a.resolve_=t,a.reject_=e,a.start_()})),this.promise_.then(null,(function(){}))}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n){return t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){this.state_===D.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.authWrapper_.getAuthToken().then((function(n){switch(e.state_){case D.RUNNING:t(n);break;case D.CANCELING:e.transition_(D.CANCELED);break;case D.PAUSING:e.transition_(D.PAUSED)}}))},t.prototype.createResumable_=function(){var t=this;this.resolveToken_((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=At(e,r,i),s={name:a.fullPath},u=tt(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=ut(a,n),h=t.maxUploadRetryTime(),p=new gt(u,"POST",(function(t){var e;Pt(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(n){vt(!1)}return vt(B(e)),e}),h);return p.urlParams=s,p.headers=c,p.body=l,p.errorHandler=xt(e),p}(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_((function(n){var r=function(t,e,n,r){var i=t.maxUploadRetryTime(),o=new gt(n,"POST",(function(t){var e=Pt(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(o){vt(!1)}n||vt(!1);var i=Number(n);return vt(!isNaN(i)),new Ot(i,r.size(),"final"===e)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=xt(e),o}(t.authWrapper_,t.location_,e,t.blob_),i=t.authWrapper_.makeRequest(r,n);t.request_=i,i.getPromise().then((function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.continueUpload_=function(){var t=this,e=262144*this.chunkMultiplier_,n=new Ot(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_((function(i){var o;try{o=Dt(t.location_,t.authWrapper_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(s){return t.error_=s,void t.transition_(D.ERROR)}var a=t.authWrapper_.makeRequest(o,i);t.request_=a,a.getPromise().then((function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_(D.SUCCESS)):t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_((function(e){var n=Tt(t.authWrapper_,t.location_,t.mappings_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.metadata_=e,t.transition_(D.SUCCESS)}),t.metadataErrorHandler_)}))},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=At(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+ut(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",h=X.getBlob(c,r,l);if(null===h)throw g();var p={name:u.fullPath},f=tt(o),d=t.maxUploadRetryTime(),m=new gt(f,"POST",_t(t,n),d);return m.urlParams=p,m.headers=a,m.body=h.uploadData(),m.errorHandler=xt(e),m}(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_(D.SUCCESS)}),t.errorHandler_)}))},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case D.CANCELING:case D.PAUSING:this.state_=t,null!==this.request_&&this.request_.cancel();break;case D.RUNNING:var e=this.state_===D.PAUSED;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case D.PAUSED:this.state_=t,this.notifyObservers_();break;case D.CANCELED:this.error_=y(),this.state_=t,this.notifyObservers_();break;case D.ERROR:case D.SUCCESS:this.state_=t,this.notifyObservers_()}},t.prototype.completeTransitions_=function(){switch(this.state_){case D.PAUSING:this.transition_(D.PAUSED);break;case D.CANCELING:this.transition_(D.CANCELED);break;case D.RUNNING:this.start_()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=R(this.state_);return new Rt(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){function i(){if(t!==P.STATE_CHANGED)throw"Expected one of the event types: ["+P.STATE_CHANGED+"]."}var o="Expected a function or an Object with one of `next`, `error`, `complete` properties.",a=qt(!0).validator,s=Vt(null,!0).validator;function u(t){try{return void a(t)}catch(e){}try{if(s(t),!(L(t.next)||L(t.error)||L(t.complete)))throw"";return}catch(e){throw o}}var c=[Ft(i),Vt(u,!0),qt(!0),qt(!0)];Nt("on",c,arguments);var l=this;function h(t){return function(e,n,i){null!==t&&Nt("on",t,arguments);var o=new Mt(e,n,r);return l.addObserver_(o),function(){l.removeObserver_(o)}}}function p(t){if(null===t)throw o;u(t)}var f=[Vt(p),qt(!0),qt(!0)],d=!(L(e)||L(n)||L(r));return d?h(f):h(null)(e,n,r)},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){var e=this.observers_.indexOf(t);-1!==e&&this.observers_.splice(e,1)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_(),this.observers_.slice().forEach((function(e){t.notifyObserver_(e)}))},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(R(this.state_)){case M.SUCCESS:Wt(this.resolve_.bind(null,this.snapshot))();break;case M.CANCELED:case M.ERROR:Wt(this.reject_.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){switch(R(this.state_)){case M.RUNNING:case M.PAUSED:t.next&&Wt(t.next.bind(t,this.snapshot))();break;case M.SUCCESS:t.complete&&Wt(t.complete.bind(t))();break;case M.CANCELED:case M.ERROR:t.error&&Wt(t.error.bind(t,this.error_))();break;default:t.error&&Wt(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){Nt("resume",[],arguments);var t=this.state_===D.PAUSED||this.state_===D.PAUSING;return t&&this.transition_(D.RUNNING),t},t.prototype.pause=function(){Nt("pause",[],arguments);var t=this.state_===D.RUNNING;return t&&this.transition_(D.PAUSING),t},t.prototype.cancel=function(){Nt("cancel",[],arguments);var t=this.state_===D.RUNNING||this.state_===D.PAUSING;return t&&this.transition_(D.CANCELING),t},t}(),Ht=function(){function t(t,e){this.authWrapper=t,this.location=e instanceof Y?e:Y.makeFromUrl(e)}return t.prototype.toString=function(){return Nt("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return ot()},t.prototype.child=function(t){Nt("child",[Ft()],arguments);var e=J(this.location.path,t),n=new Y(this.location.bucket,e);return this.newRef(this.authWrapper,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this.location.path);if(null===t)return null;var e=new Y(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new Y(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return $(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),Nt("put",[jt(),zt(!0)],arguments),this.throwIfRoot_("put"),new Gt(this,this.authWrapper,this.location,this.mappings(),new X(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=E.RAW),Nt("putString",[Ft(),Ft(T,!0),zt(!0)],arguments),this.throwIfRoot_("putString");var r=C(e,t),i=Object.assign({},n);return!N(i.contentType)&&N(r.contentType)&&(i.contentType=r.contentType),new Gt(this,this.authWrapper,this.location,this.mappings(),new X(r.data,!0),i)},t.prototype.delete=function(){var t=this;return Nt("delete",[],arguments),this.throwIfRoot_("delete"),this.authWrapper.getAuthToken().then((function(e){var n=kt(t.authWrapper,t.location);return t.authWrapper.makeRequest(n,e).getPromise()}))},t.prototype.listAll=function(){Nt("listAll",[],arguments);var t={prefixes:[],items:[]};return this.listAllHelper(t).then((function(){return t}))},t.prototype.listAllHelper=function(t,e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r,i,a;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return n={pageToken:e},[4,this.list(n)];case 1:return r=o.sent(),(i=t.prefixes).push.apply(i,r.prefixes),(a=t.items).push.apply(a,r.items),null==r.nextPageToken?[3,3]:[4,this.listAllHelper(t,r.nextPageToken)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},t.prototype.list=function(t){Nt("list",[Bt(!0)],arguments);var e=this;return this.authWrapper.getAuthToken().then((function(n){var r=t||{},i=St(e.authWrapper,e.location,"/",r.pageToken,r.maxResults);return e.authWrapper.makeRequest(i,n).getPromise()}))},t.prototype.getMetadata=function(){var t=this;return Nt("getMetadata",[],arguments),this.throwIfRoot_("getMetadata"),this.authWrapper.getAuthToken().then((function(e){var n=Tt(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()}))},t.prototype.updateMetadata=function(t){var e=this;return Nt("updateMetadata",[zt()],arguments),this.throwIfRoot_("updateMetadata"),this.authWrapper.getAuthToken().then((function(n){var r=It(e.authWrapper,e.location,t,e.mappings());return e.authWrapper.makeRequest(r,n).getPromise()}))},t.prototype.getDownloadURL=function(){var t=this;return Nt("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.authWrapper.getAuthToken().then((function(e){var n=Ct(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise().then((function(t){if(null===t)throw v();return t}))}))},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw function(t){return new p(f.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)},t}(),Kt=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}(),Qt=function(){function t(){this.map=new Map,this.id=h}return t.prototype.addRequest=function(t){var e=this,n=this.id;this.id++,this.map.set(n,t),t.getPromise().then((function(){return e.map.delete(n)}),(function(){return e.map.delete(n)}))},t.prototype.clear=function(){this.map.forEach((function(t){t&&t.cancel(!0)})),this.map.clear()},t}(),Xt=function(){function t(e,n,r,i,o,a){if(this.bucket_=null,this.deleted_=!1,this.app_=e,null!==this.app_){var s=this.app_.options;N(s)&&(this.bucket_=t.extractBucket_(s))}this.authProvider_=n,this.storageRefMaker_=r,this.requestMaker_=i,this.pool_=a,this.service_=o,this.maxOperationRetryTime_=c,this.maxUploadRetryTime_=l,this.requestMap_=new Qt}return t.extractBucket_=function(t){var e=t[u]||null;return null==e?null:Y.makeFromBucketSpec(e).bucket},t.prototype.getAuthToken=function(){var t=this.authProvider_.getImmediate({optional:!0});return t?t.getToken().then((function(t){return null!==t?t.accessToken:null}),(function(){return null})):Promise.resolve(null)},t.prototype.bucket=function(){if(this.deleted_)throw b();return this.bucket_},t.prototype.service=function(){return this.service_},t.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)},t.prototype.makeRequest=function(t,e){if(this.deleted_)return new Kt(b());var n=this.requestMaker_(t,e,this.pool_);return this.requestMap_.addRequest(n),n},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},t.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},t.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t},t.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},t.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t},t}();var Yt=function(){function t(t,e,n,r,i,o,a,s,u,c,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise((function(t,e){h.resolve_=t,h.reject_=e,h.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.xhr;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());L(s)?i(s):i()}catch(u){o(u)}else null!==a?((r=m()).setServerResponseProp(a.getResponseText()),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?b():y()):o(r=new p(f.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new Zt(!1,null,!0)):this.backoffId_=function(t,e,n){var r=1,i=null,a=!1,s=0;function u(){return 2===s}var c=!1;function l(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];c||(c=!0,e.apply(null,t))}function h(e){i=setTimeout((function(){i=null,t(p,u())}),e)}function p(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];c||(t?l.call.apply(l,Object(o.__spreadArrays)([null,t],n)):u()||a?l.call.apply(l,Object(o.__spreadArrays)([null,t],n)):(r<64&&(r*=2),1===s?(s=2,e=0):e=1e3*(r+Math.random()),h(e)))}var f=!1;function d(t){f||(f=!0,c||(null!==i?(t||(s=2),clearTimeout(i),h(0)):t||(s=1)))}return h(0),setTimeout((function(){a=!0,d(!0)}),n),d}((function(e,n){if(n)e(!1,new Zt(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===O.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new Zt(a,n))}else{var s=n.getErrorCode()===O.ABORT;e(!1,new Zt(!1,null,s))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}),e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),Zt=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function Jt(t,e,n){var r=et(t.urlParams),o=t.url+r,a=Object.assign({},t.headers);return function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(a,e),function(t){var e="undefined"!==typeof i.a?i.a.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}(a),new Yt(o,t.method,a,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}var $t=function(){function t(t,e,n,r){if(this.bucket_=null,this.authWrapper_=new Xt(t,e,(function(t,e){return new Ht(t,e)}),Jt,this,n),this.app_=t,null!=r)this.bucket_=Y.makeFromBucketSpec(r);else{var i=this.authWrapper_.bucket();null!=i&&(this.bucket_=new Y(i,""))}this.internals_=new te(this)}return t.prototype.ref=function(t){function e(t){if("string"!==typeof t)throw"Path is not a string.";if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."}if(Nt("ref",[Ft(e,!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var n=new Ht(this.authWrapper_,this.bucket_);return null!=t?n.child(t):n},t.prototype.refFromURL=function(t){function e(t){if("string"!==typeof t)throw"Path is not a string.";if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{Y.makeFromUrl(t)}catch(e){throw"Expected valid full URL but got an invalid one."}}return Nt("refFromURL",[Ft(e,!1)],arguments),new Ht(this.authWrapper_,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){Nt("setMaxUploadRetryTime",[Ut()],arguments),this.authWrapper_.setMaxUploadRetryTime(t)},t.prototype.setMaxOperationRetryTime=function(t){Nt("setMaxOperationRetryTime",[Ut()],arguments),this.authWrapper_.setMaxOperationRetryTime(t)},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),t}(),te=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),Promise.resolve()},t}(),ee="@firebase/storage",ne="0.3.22",re="storage";function ie(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return new $t(n,r,new H,e)}function oe(t){var e={TaskState:M,TaskEvent:P,StringFormat:E,Storage:$t,Reference:Ht};t.INTERNAL.registerComponent(new a.Component(re,ie,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(ee,ne)}oe(i.a)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=(r=n(7))&&"object"===typeof r&&"default"in r?r.default:r;n(27);var o,a,s,u,c=n(2),l=n(13),h=n(23),p=n(12),f="@firebase/performance",d="0.2.28",m=d,y="FB-PERF-TRACE-START",g="FB-PERF-TRACE-STOP",v="FB-PERF-TRACE-MEASURE",_="_wt_",b="@firebase/performance/config",w="@firebase/performance/configexpire",x=((o={})["trace started"]="Trace {$traceName} was started before.",o["trace stopped"]="Trace {$traceName} is not running.",o["no window"]="Window is not available.",o["no app id"]="App id is not available.",o["no project id"]="Project id is not available.",o["no api key"]="Api key is not available.",o["invalid cc log"]="Attempted to queue invalid cc event",o["FB not default"]="Performance can only start when Firebase app instance is the default one.",o["RC response not ok"]="RC response is not ok",o["invalid attribute name"]="Attribute name {$attributeName} is invalid.",o["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",o["invalide custom metric name"]="Custom metric name {$customMetricName} is invalid",o),E=new l.ErrorFactory("performance","Performance",x),T=function(){function t(t){if(this.window=t,!t)throw E.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return!!(fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===a&&(a=new t(s)),a},t}();var S,C,I=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw E.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw E.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw E.create("no api key");return t},t.getInstance=function(){return void 0===u&&(u=new t),u},t}();function k(){return S}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(C||(C={}));var A=["firebase_","google_","ga_"],O=new RegExp("^[a-zA-Z]\\w*$"),P=40,D=100;function M(){var t=T.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function R(){switch(T.getInstance().document.visibilityState){case"visible":return C.VISIBLE;case"hidden":return C.HIDDEN;default:return C.UNKNOWN}}function N(){var t=T.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}var L=new h.Logger("Performance");L.logLevel=h.LogLevel.INFO;var F="0.0.1",j={loggingEnabled:!0},z="FIREBASE_INSTALLATIONS_AUTH";function B(t){var e=function(){var t=T.getInstance().localStorage;if(!t)return;var e=t.getItem(w);if(!e||(n=e,!(Number(n)>Date.now())))return;var n;var r=t.getItem(b);if(!r)return;try{return JSON.parse(r)}catch(o){return}}();return e?(V(e),Promise.resolve()):function(t){return function(){var t=I.getInstance().installationsService.getToken();return t.then((function(t){})),t}().then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+I.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+I.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:z+" "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:I.getInstance().getAppId(),app_version:m,sdk_version:F})});return fetch(r).then((function(t){if(t.ok)return t.json();throw E.create("RC response not ok")}))})).catch((function(){L.info(U)}))}(t).then((function(t){return V(t)})).then((function(t){return function(t){var e=T.getInstance().localStorage;if(!t||!e)return;e.setItem(b,JSON.stringify(t)),e.setItem(w,String(Date.now()+60*I.getInstance().configTimeToLive*60*1e3))}(t)}),(function(){}))}var U="Could not fetch config, will use default configs";function V(t){if(!t)return t;var e=I.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=j.loggingEnabled,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=q(e.tracesSamplingRate),e.logNetworkAfterSampling=q(e.networkRequestsSamplingRate),t}function q(t){return Math.random()<=t}var W,G=1;function H(){return G=2,W=W||function(){var t=T.getInstance().document;return new Promise((function(e){t&&"complete"!==t.readyState?t.addEventListener("readystatechange",(function n(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())})):e()}))}().then((function(){return function(){var t=I.getInstance().installationsService.getId();return t.then((function(t){S=t})),t}()})).then((function(t){return B(t)})).then((function(){return K()}),(function(){return K()}))}function K(){G=3}var Q,X=1e4,Y=3,Z=Y,J=[];function $(t){if(!t.eventTime||!t.message)throw E.create("invalid cc log");J=c.__spreadArrays(J,[t])}function tt(){if(Q)return Q;var t=function(t){return function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=t.apply(void 0,r);$({message:o,eventTime:Date.now()})}}(rt);return(Q=new h.Logger("@firebase/performance/cc")).logHandler=t,Q}function et(t){var e=I.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&T.getInstance().requiredApisAvailable()&&(t.isAuto&&R()!==C.VISIBLE||e.loggingEnabled&&e.logTraceAfterSampling&&(3===G?nt(t):H().then((function(){return nt(t)}),(function(){return nt(t)}))))}function nt(t){k()&&setTimeout((function(){return tt().log(t,1)}),0)}function rt(t,e){return 0===e?function(t){var e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:it(),network_request_metric:e};return JSON.stringify(n)}(t):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=ot(t.counters));var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=ot(n));var r={application_info:it(),trace_metric:e};return JSON.stringify(r)}(t)}function it(){return{google_app_id:I.getInstance().getAppId(),app_instance_id:k(),web_app_info:{sdk_version:m,page_url:T.getInstance().getUrl(),service_worker_status:M(),visibility_state:R(),effective_connection_type:N()},application_process_state:0}}function ot(t){return Object.keys(t).map((function(e){return{key:e,value:t[e]}}))}!function t(e){setTimeout((function(){if(0!==Z){if(!J.length)return t(X);var e=c.__spreadArrays(J);J=[];var n=e.map((function(t){return{source_extension_json:t.message,event_time_ms:String(t.eventTime)}})),r={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:I.getInstance().logSource,log_event:n};fetch(I.getInstance().logEndPointUrl,{method:"POST",body:JSON.stringify(r)}).then((function(t){return t.ok||L.info("Call to Firebase backend failed."),t.json()})).then((function(e){var n=Number(e.next_request_wait_millis),r=isNaN(n)?X:Math.max(X,n);Z=Y,t(r)})).catch((function(){J=c.__spreadArrays(e,J),Z--,L.info("Tries left: "+Z+"."),t(X)}))}}),e)}(5500);var at=100,st="_",ut=["_fp","_fcp","_fid"];var ct=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=T.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=y+"-"+this.randomId+"-"+this.name,this.traceStopMark=g+"-"+this.randomId+"-"+this.name,this.traceMeasure=n||v+"-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw E.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw E.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),et(this)},t.prototype.record=function(t,e,n){if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=c.__assign({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}et(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]&&this.putMetric(t,0),this.counters[t]+=e},t.prototype.putMetric=function(t,e){if(!function(t,e){return!(0===t.length||t.length>at)&&(e&&e.startsWith(_)&&ut.indexOf(t)>-1||!t.startsWith(st))}(t,this.name))throw E.create("invalide custom metric name",{customMetricName:t});this.counters[t]=e},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n=function(t){return!(0===t.length||t.length>P)&&(!A.some((function(e){return t.startsWith(e)}))&&!!t.match(O))}(t),r=function(t){return 0!==t.length&&t.length<=D}(e);if(n&&r)this.customAttributes[t]=e;else{if(!n)throw E.create("invalid attribute name",{attributeName:t});if(!r)throw E.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return c.__assign({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=T.getInstance().getUrl();if(i){var o=new t(_+i,!0),a=Math.floor(1e3*T.getInstance().getTimeOrigin());o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd)));if(n){var s=n.find((function(t){return"first-paint"===t.name}));s&&s.startTime&&o.putMetric("_fp",Math.floor(1e3*s.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric("_fcp",Math.floor(1e3*u.startTime)),r&&o.putMetric("_fid",Math.floor(1e3*r))}et(o)}},t.createUserTimingTrace=function(e){et(new t(e,!1,e))},t}();function lt(t){var e=t;if(e&&void 0!==e.responseStart){var n=T.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=I.getInstance();e.instrumentationEnabled&&t.url!==e.logEndPointUrl.split("?")[0]&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return tt().log(t,0)}),0)}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}var ht=5e3;function pt(){k()&&(setTimeout((function(){return function(){var t=T.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){ct.createOobTrace(e,n),r=void 0}),ht);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),ct.createOobTrace(e,n,t))}))}else ct.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=T.getInstance(),e=t.getEntriesByType("resource"),n=0,r=e;n<r.length;n++){lt(r[n])}t.setupObserver("resource",lt)}()}),0),setTimeout((function(){return function(){for(var t=T.getInstance(),e=t.getEntriesByType("measure"),n=0,r=e;n<r.length;n++){ft(r[n])}t.setupObserver("measure",ft)}()}),0))}function ft(t){var e=t.name;e.substring(0,v.length)!==v&&ct.createUserTimingTrace(e)}var dt=function(){function t(t){this.app=t,T.getInstance().requiredApisAvailable()?H().then(pt,pt):L.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled.")}return t.prototype.trace=function(t){return new ct(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return I.getInstance().instrumentationEnabled},set:function(t){I.getInstance().instrumentationEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return I.getInstance().dataCollectionEnabled},set:function(t){I.getInstance().dataCollectionEnabled=t},enumerable:!0,configurable:!0}),t}(),mt="[DEFAULT]";function yt(t){var e=function(t,e){if(t.name!==mt)throw E.create("FB not default");if("undefined"===typeof window)throw E.create("no window");return function(t){s=t}(window),I.getInstance().firebaseAppInstance=t,I.getInstance().installationsService=e,new dt(t)};t.INTERNAL.registerComponent(new p.Component("performance",(function(t){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();return e(n,r)}),"PUBLIC")),t.registerVersion(f,d)}yt(i),e.registerPerformance=yt},function(t,e,n){"use strict";n.r(e),n.d(e,"factory",(function(){return C})),n.d(e,"registerAnalytics",(function(){return O})),n.d(e,"resetGlobalVars",(function(){return T})),n.d(e,"settings",(function(){return S}));var r,i,o,a=n(7),s=n.n(a),u=(n(27),n(2)),c=n(13),l=n(12),h="measurementId",p="firebase_id",f="origin",d="https://www.googletagmanager.com/gtag/js";function m(t,e,n){var i=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];window[e].push(arguments)};return window[n]&&"function"===typeof window[n]&&(i=window[n]),window[n]=function(t,e){return function(n,i,o){if(n===r.EVENT){var a=[];if(o&&o.send_to){var s=o.send_to;Array.isArray(s)||(s=[s]);for(var u=0,c=s;u<c.length;u++){var l=c[u],h=e[l];if(!h){a=[];break}a.push(h)}}if(0===a.length)for(var p=0,f=Object.values(e);p<f.length;p++){var d=f[p];a.push(d)}Promise.all(a).then((function(){return t(r.EVENT,i,o||{})})).catch((function(t){return console.error(t)}))}else if(n===r.CONFIG){(e[i]||Promise.resolve()).then((function(){t(r.CONFIG,i,o)})).catch((function(t){return console.error(t)}))}else t(r.SET,i)}}(i,t),{gtagCore:i,wrappedGtag:window[n]}}!function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(r||(r={})),function(t){t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(i||(i={}));var y,g,v=((o={})["no-ga-id"]='"'+h+'" field is empty in Firebase config. Firebase Analytics requires this field to contain a valid measurement ID.',o["already-exists"]="A Firebase Analytics instance with the measurement ID ${id}  already exists. Only one Firebase Analytics instance can be created for each measurement ID.",o["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",o["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate",o),_=new c.ErrorFactory("analytics","Analytics",v),b={},w="dataLayer",x="gtag",E=!1;function T(t,e){void 0===t&&(t=!1),void 0===e&&(e={}),E=t,b=e,w="dataLayer",x="gtag"}function S(t){if(E)throw _.create("already-initialized");t.dataLayerName&&(w=t.dataLayerName),t.gtagName&&(x=t.gtagName)}function C(t,e){var n=t.options[h];if(!n)throw _.create("no-ga-id");if(null!=b[n])throw _.create("already-exists",{id:n});if(!E){(function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(d))return r}return null})()||function(t){var e=document.createElement("script");e.src=d+"?l="+t,e.async=!0,document.head.appendChild(e)}(w),function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(w);var i=m(b,w,x),o=i.wrappedGtag,a=i.gtagCore;g=o,y=a,E=!0}return b[n]=function(t,e,n){return Object(u.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(u.__generator)(this,(function(a){switch(a.label){case 0:return[4,e.getId()];case 1:return i=a.sent(),n("js",new Date),n(r.CONFIG,t.options[h],((o={})[p]=i,o[f]="firebase",o.update=!0,o)),[2]}}))}))}(t,e,y),{app:t,logEvent:function(t,e,i){return function(t,e,n,i,o){var a=i||{};o&&o.global||(a=Object(u.__assign)(Object(u.__assign)({},i),{send_to:e})),t(r.EVENT,n,a||{})}(g,n,t,e,i)},setCurrentScreen:function(t,e){return function(t,e,n,i){i&&i.global?t(r.SET,{screen_name:n}):t(r.CONFIG,e,{update:!0,screen_name:n})}(g,n,t,e)},setUserId:function(t,e){return function(t,e,n,i){i&&i.global?t(r.SET,{user_id:n}):t(r.CONFIG,e,{update:!0,user_id:n})}(g,n,t,e)},setUserProperties:function(t,e){return function(t,e,n,i){if(i&&i.global){for(var o={},a=0,s=Object.keys(n);a<s.length;a++){var u=s[a];o["user_properties."+u]=n[u]}t(r.SET,o)}else t(r.CONFIG,e,{update:!0,user_properties:n})}(g,n,t,e)},setAnalyticsCollectionEnabled:function(t){return function(t,e){window["ga-disable-"+t]=!e}(n,t)}}}var I="@firebase/analytics",k="0.2.9",A="analytics";function O(t){t.INTERNAL.registerComponent(new l.Component(A,(function(t){return C(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:S,EventName:i})),t.INTERNAL.registerComponent(new l.Component("analytics-internal",(function(t){try{return{logEvent:t.getProvider(A).getImmediate().logEvent}}catch(e){throw _.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),t.registerVersion(I,k)}O(s.a)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=(r=n(7))&&"object"===typeof r&&"default"in r?r.default:r;n(27);var o,a=n(2),s=n(13),u=n(23),c=n(12),l=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o;return a.__generator(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=a.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=a.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return a.sent(),[2,i]}}))}))},t}(),h=((o={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",o["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",o["registration-api-key"]="Undefined API key. Check Firebase app initialization.",o["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",o["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",o["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",o["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",o["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",o["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",o["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',o["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',o["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",o["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",o),p=new s.ErrorFactory("remoteconfig","Remote Config",h);var f=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,c,l,h,f,d,m,y,g,v,_,b,w;return a.__generator(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=a.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,s={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===x&&(x=navigator),x.languages&&x.languages[0]||x.language)},c={method:"POST",headers:s,body:JSON.stringify(u)},l=fetch(o,c),h=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),a.label=2;case 2:return a.trys.push([2,5,,6]),[4,Promise.race([l,h])];case 3:return a.sent(),[4,l];case 4:return f=a.sent(),[3,6];case 5:throw d=a.sent(),m="fetch-client-network","AbortError"===d.name&&(m="fetch-timeout"),p.create(m,{originalErrorMessage:d.message});case 6:if(y=f.status,g=f.headers.get("ETag")||void 0,200!==f.status)return[3,11];b=void 0,a.label=7;case 7:return a.trys.push([7,9,,10]),[4,f.json()];case 8:return b=a.sent(),[3,10];case 9:throw w=a.sent(),p.create("fetch-client-parse",{originalErrorMessage:w.message});case 10:v=b.entries,_=b.state,a.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===_?y=500:"NO_CHANGE"===_?y=304:"NO_TEMPLATE"!==_&&"EMPTY_CONFIG"!==_||(v={}),304!==y&&200!==y)throw p.create("fetch-status",{httpStatus:y});return[2,{status:y,eTag:g,config:v}]}var x}))}))},t}(),d=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),m="",y=["1","true","t","yes","y","on"],g=function(){function t(t,e){void 0===e&&(e=m),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&y.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),v=6e4,_=432e5,b=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:v,minimumFetchIntervalMillis:_},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=u.LogLevel.DEBUG;break;case"silent":this._logger.logLevel=u.LogLevel.SILENT;break;default:this._logger.logLevel=u.LogLevel.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!0,configurable:!0}),t.prototype.activate=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,e,n;return a.__generator(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,e,n,r=this;return a.__generator(this,(function(i){switch(i.label){case 0:t=new d,setTimeout((function(){return a.__awaiter(r,void 0,void 0,(function(){return a.__generator(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return i.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return i.sent(),[3,6];case 4:return e=i.sent(),u="fetch-throttle",n=(o=e)instanceof s.FirebaseError&&-1!==o.code.indexOf(u)?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw i.sent(),e;case 6:return[2]}var o,u}))}))},t.prototype.fetchAndActivate=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t=this;return function(t,e){void 0===t&&(t={});void 0===e&&(e={});return Object.keys(a.__assign(a.__assign({},t),e))}(this._storageCache.getActiveConfig(),this.defaultConfig).reduce((function(e,n){return e[n]=t.getValue(n),e}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new g("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new g("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new g("static"))},t}();function w(t,e){var n=t.target.error||void 0;return p.create(e,{originalErrorMessage:n&&n.message})}var x="app_namespace_store",E="firebase_remote_config",T=1;var S=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open(E,T);n.onerror=function(t){e(w(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(x,{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([x],"readonly").objectStore(x),a=n.createCompositeKey(t);try{var s=o.get(a);s.onerror=function(t){i(w(t,"storage-get"))},s.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(u){i(p.create("storage-get",{originalErrorMessage:u&&u.message}))}}))]}}))}))},t.prototype.set=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n,r=this;return a.__generator(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var a=n.transaction([x],"readwrite").objectStore(x),s=r.createCompositeKey(t);try{var u=a.put({compositeKey:s,value:e});u.onerror=function(t){o(w(t,"storage-set"))},u.onsuccess=function(){i()}}catch(c){o(p.create("storage-set",{originalErrorMessage:c&&c.message}))}}))]}}))}))},t.prototype.delete=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([x],"readwrite").objectStore(x),a=n.createCompositeKey(t);try{var s=o.delete(a);s.onerror=function(t){i(w(t,"storage-delete"))},s.onsuccess=function(){r()}}catch(u){i(p.create("storage-delete",{originalErrorMessage:u&&u.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),C=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,i,o;return a.__generator(this,(function(a){switch(a.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=a.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=a.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=a.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}(),I=1e3,k=2,A=144e5,O=.5;function P(t){var e=I*Math.pow(k,t),n=Math.round(O*e*(Math.random()-.5)*2);return Math.min(A,e+n)}function D(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(p.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var M=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e;return a.__generator(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return a.__awaiter(this,void 0,void 0,(function(){var e,i,o;return a.__generator(this,(function(a){switch(a.label){case 0:return[4,D(t.signal,n)];case 1:a.sent(),a.label=2;case 2:return a.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=a.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return a.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof s.FirebaseError))return!1;var e=Number(t.httpStatus);return 429===e||500===e||503===e||504===e}(i=a.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+P(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return a.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}}))}))},t}(),R="@firebase/remote-config",N="0.1.9";function L(t){t.INTERNAL.registerComponent(new c.Component("remoteConfig",(function(e,n){var r=e.getProvider("app").getImmediate(),i=e.getProvider("installations").getImmediate();if("undefined"===typeof window)throw p.create("registration-window");var o=r.options,a=o.projectId,s=o.apiKey,c=o.appId;if(!a)throw p.create("registration-project-id");if(!s)throw p.create("registration-api-key");if(!c)throw p.create("registration-app-id");n=n||"firebase";var h=new S(c,r.name,n),d=new C(h),m=new u.Logger(R);m.logLevel=u.LogLevel.ERROR;var y=new f(i,t.SDK_VERSION,n,a,s,c),g=new M(y,h),v=new l(g,h,d,m),_=new b(r,v,d,h,m);return _.ensureInitialized(),_}),"PUBLIC").setMultipleInstances(!0)),t.registerVersion(R,N)}L(i),e.registerRemoteConfig=L},function(t,e,n){"use strict";var r=n(63);function i(){}function o(){}o.resetWarningCache=i,t.exports=function(){function t(t,e,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},function(t,e,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e,n){"use strict";t.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,(function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()}))}},function(t,e,n){"use strict";var r=new RegExp("%[a-f0-9]{2}","gi"),i=new RegExp("(%[a-f0-9]{2})+","gi");function o(t,e){try{return decodeURIComponent(t.join(""))}catch(i){}if(1===t.length)return t;e=e||1;var n=t.slice(0,e),r=t.slice(e);return Array.prototype.concat.call([],o(n),o(r))}function a(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(r),n=1;n<e.length;n++)e=(t=o(e,n).join("")).match(r);return t}}t.exports=function(t){if("string"!==typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var n={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},r=i.exec(t);r;){try{n[r[0]]=decodeURIComponent(r[0])}catch(e){var o=a(r[0]);o!==r[0]&&(n[r[0]]=o)}r=i.exec(t)}n["%C2"]="\ufffd";for(var s=Object.keys(n),u=0;u<s.length;u++){var c=s[u];t=t.replace(new RegExp(c,"g"),n[c])}return t}(t)}}},,,function(t,e,n){"use strict";function r(t){return t&&"object"===typeof t&&"default"in t?t.default:t}var i=n(0),o=r(i),a=r(n(69));function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u=!("undefined"===typeof window||!window.document||!window.document.createElement);t.exports=function(t,e,n){if("function"!==typeof t)throw new Error("Expected reducePropsToState to be a function.");if("function"!==typeof e)throw new Error("Expected handleStateChangeOnClient to be a function.");if("undefined"!==typeof n&&"function"!==typeof n)throw new Error("Expected mapStateOnServer to either be undefined or a function.");return function(r){if("function"!==typeof r)throw new Error("Expected WrappedComponent to be a React component.");var c,l=[];function h(){c=t(l.map((function(t){return t.props}))),p.canUseDOM?e(c):n&&(c=n(c))}var p=function(t){var e,n;function i(){return t.apply(this,arguments)||this}n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,i.peek=function(){return c},i.rewind=function(){if(i.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var t=c;return c=void 0,l=[],t};var s=i.prototype;return s.shouldComponentUpdate=function(t){return!a(t,this.props)},s.componentWillMount=function(){l.push(this),h()},s.componentDidUpdate=function(){h()},s.componentWillUnmount=function(){var t=l.indexOf(this);l.splice(t,1),h()},s.render=function(){return o.createElement(r,this.props)},i}(i.Component);return s(p,"displayName","SideEffect("+function(t){return t.displayName||t.name||"Component"}(r)+")"),s(p,"canUseDOM",u),p}}},function(t,e){t.exports=function(t,e,n,r){var i=n?n.call(r,t,e):void 0;if(void 0!==i)return!!i;if(t===e)return!0;if("object"!==typeof t||!t||"object"!==typeof e||!e)return!1;var o=Object.keys(t),a=Object.keys(e);if(o.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(e),u=0;u<o.length;u++){var c=o[u];if(!s(c))return!1;var l=t[c],h=e[c];if(!1===(i=n?n.call(r,l,h,c):void 0)||void 0===i&&l!==h)return!1}return!0}},function(t,e,n){"use strict";var r=Array.isArray,i=Object.keys,o=Object.prototype.hasOwnProperty,a="undefined"!==typeof Element;t.exports=function(t,e){try{return function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){var s,u,c,l=r(e),h=r(n);if(l&&h){if((u=e.length)!=n.length)return!1;for(s=u;0!==s--;)if(!t(e[s],n[s]))return!1;return!0}if(l!=h)return!1;var p=e instanceof Date,f=n instanceof Date;if(p!=f)return!1;if(p&&f)return e.getTime()==n.getTime();var d=e instanceof RegExp,m=n instanceof RegExp;if(d!=m)return!1;if(d&&m)return e.toString()==n.toString();var y=i(e);if((u=y.length)!==i(n).length)return!1;for(s=u;0!==s--;)if(!o.call(n,y[s]))return!1;if(a&&e instanceof Element&&n instanceof Element)return e===n;for(s=u;0!==s--;)if(("_owner"!==(c=y[s])||!e.$$typeof)&&!t(e[c],n[c]))return!1;return!0}return e!==e&&n!==n}(t,e)}catch(n){if(n.message&&n.message.match(/stack|recursion/i)||-2146828260===n.number)return console.warn("Warning: react-fast-compare does not handle circular references.",n.name,n.message),!1;throw n}}},function(t,e,n){(function(t){e.__esModule=!0,e.warn=e.requestAnimationFrame=e.reducePropsToState=e.mapStateOnServer=e.handleClientStateChange=e.convertReactPropstoHtmlAttributes=void 0;var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=u(n(0)),a=u(n(26)),s=n(34);function u(t){return t&&t.__esModule?t:{default:t}}var c=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!1===e?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},l=function(t){var e=m(t,s.TAG_NAMES.TITLE),n=m(t,s.HELMET_PROPS.TITLE_TEMPLATE);if(n&&e)return n.replace(/%s/g,(function(){return e}));var r=m(t,s.HELMET_PROPS.DEFAULT_TITLE);return e||r||void 0},h=function(t){return m(t,s.HELMET_PROPS.ON_CHANGE_CLIENT_STATE)||function(){}},p=function(t,e){return e.filter((function(e){return"undefined"!==typeof e[t]})).map((function(e){return e[t]})).reduce((function(t,e){return i({},t,e)}),{})},f=function(t,e){return e.filter((function(t){return"undefined"!==typeof t[s.TAG_NAMES.BASE]})).map((function(t){return t[s.TAG_NAMES.BASE]})).reverse().reduce((function(e,n){if(!e.length)for(var r=Object.keys(n),i=0;i<r.length;i++){var o=r[i].toLowerCase();if(-1!==t.indexOf(o)&&n[o])return e.concat(n)}return e}),[])},d=function(t,e,n){var i={};return n.filter((function(e){return!!Array.isArray(e[t])||("undefined"!==typeof e[t]&&b("Helmet: "+t+' should be of type "Array". Instead found type "'+r(e[t])+'"'),!1)})).map((function(e){return e[t]})).reverse().reduce((function(t,n){var r={};n.filter((function(t){for(var n=void 0,o=Object.keys(t),a=0;a<o.length;a++){var u=o[a],c=u.toLowerCase();-1===e.indexOf(c)||n===s.TAG_PROPERTIES.REL&&"canonical"===t[n].toLowerCase()||c===s.TAG_PROPERTIES.REL&&"stylesheet"===t[c].toLowerCase()||(n=c),-1===e.indexOf(u)||u!==s.TAG_PROPERTIES.INNER_HTML&&u!==s.TAG_PROPERTIES.CSS_TEXT&&u!==s.TAG_PROPERTIES.ITEM_PROP||(n=u)}if(!n||!t[n])return!1;var l=t[n].toLowerCase();return i[n]||(i[n]={}),r[n]||(r[n]={}),!i[n][l]&&(r[n][l]=!0,!0)})).reverse().forEach((function(e){return t.push(e)}));for(var o=Object.keys(r),u=0;u<o.length;u++){var c=o[u],l=(0,a.default)({},i[c],r[c]);i[c]=l}return t}),[]).reverse()},m=function(t,e){for(var n=t.length-1;n>=0;n--){var r=t[n];if(r.hasOwnProperty(e))return r[e]}return null},y=function(){var t=Date.now();return function(e){var n=Date.now();n-t>16?(t=n,e(n)):setTimeout((function(){y(e)}),0)}}(),g=function(t){return clearTimeout(t)},v="undefined"!==typeof window?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||y:t.requestAnimationFrame||y,_="undefined"!==typeof window?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||g:t.cancelAnimationFrame||g,b=function(t){return console&&"function"===typeof console.warn&&console.warn(t)},w=null,x=function(t,e){var n=t.baseTag,r=t.bodyAttributes,i=t.htmlAttributes,o=t.linkTags,a=t.metaTags,u=t.noscriptTags,c=t.onChangeClientState,l=t.scriptTags,h=t.styleTags,p=t.title,f=t.titleAttributes;S(s.TAG_NAMES.BODY,r),S(s.TAG_NAMES.HTML,i),T(p,f);var d={baseTag:C(s.TAG_NAMES.BASE,n),linkTags:C(s.TAG_NAMES.LINK,o),metaTags:C(s.TAG_NAMES.META,a),noscriptTags:C(s.TAG_NAMES.NOSCRIPT,u),scriptTags:C(s.TAG_NAMES.SCRIPT,l),styleTags:C(s.TAG_NAMES.STYLE,h)},m={},y={};Object.keys(d).forEach((function(t){var e=d[t],n=e.newTags,r=e.oldTags;n.length&&(m[t]=n),r.length&&(y[t]=d[t].oldTags)})),e&&e(),c(t,m,y)},E=function(t){return Array.isArray(t)?t.join(""):t},T=function(t,e){"undefined"!==typeof t&&document.title!==t&&(document.title=E(t)),S(s.TAG_NAMES.TITLE,e)},S=function(t,e){var n=document.getElementsByTagName(t)[0];if(n){for(var r=n.getAttribute(s.HELMET_ATTRIBUTE),i=r?r.split(","):[],o=[].concat(i),a=Object.keys(e),u=0;u<a.length;u++){var c=a[u],l=e[c]||"";n.getAttribute(c)!==l&&n.setAttribute(c,l),-1===i.indexOf(c)&&i.push(c);var h=o.indexOf(c);-1!==h&&o.splice(h,1)}for(var p=o.length-1;p>=0;p--)n.removeAttribute(o[p]);i.length===o.length?n.removeAttribute(s.HELMET_ATTRIBUTE):n.getAttribute(s.HELMET_ATTRIBUTE)!==a.join(",")&&n.setAttribute(s.HELMET_ATTRIBUTE,a.join(","))}},C=function(t,e){var n=document.head||document.querySelector(s.TAG_NAMES.HEAD),r=n.querySelectorAll(t+"["+s.HELMET_ATTRIBUTE+"]"),i=Array.prototype.slice.call(r),o=[],a=void 0;return e&&e.length&&e.forEach((function(e){var n=document.createElement(t);for(var r in e)if(e.hasOwnProperty(r))if(r===s.TAG_PROPERTIES.INNER_HTML)n.innerHTML=e.innerHTML;else if(r===s.TAG_PROPERTIES.CSS_TEXT)n.styleSheet?n.styleSheet.cssText=e.cssText:n.appendChild(document.createTextNode(e.cssText));else{var u="undefined"===typeof e[r]?"":e[r];n.setAttribute(r,u)}n.setAttribute(s.HELMET_ATTRIBUTE,"true"),i.some((function(t,e){return a=e,n.isEqualNode(t)}))?i.splice(a,1):o.push(n)})),i.forEach((function(t){return t.parentNode.removeChild(t)})),o.forEach((function(t){return n.appendChild(t)})),{oldTags:i,newTags:o}},I=function(t){return Object.keys(t).reduce((function(e,n){var r="undefined"!==typeof t[n]?n+'="'+t[n]+'"':""+n;return e?e+" "+r:r}),"")},k=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).reduce((function(e,n){return e[s.REACT_TAG_MAP[n]||n]=t[n],e}),e)},A=function(t,e,n){switch(t){case s.TAG_NAMES.TITLE:return{toComponent:function(){return function(t,e,n){var r,i=((r={key:e})[s.HELMET_ATTRIBUTE]=!0,r),a=k(n,i);return[o.default.createElement(s.TAG_NAMES.TITLE,a,e)]}(0,e.title,e.titleAttributes)},toString:function(){return function(t,e,n,r){var i=I(n),o=E(e);return i?"<"+t+" "+s.HELMET_ATTRIBUTE+'="true" '+i+">"+c(o,r)+"</"+t+">":"<"+t+" "+s.HELMET_ATTRIBUTE+'="true">'+c(o,r)+"</"+t+">"}(t,e.title,e.titleAttributes,n)}};case s.ATTRIBUTE_NAMES.BODY:case s.ATTRIBUTE_NAMES.HTML:return{toComponent:function(){return k(e)},toString:function(){return I(e)}};default:return{toComponent:function(){return function(t,e){return e.map((function(e,n){var r,i=((r={key:n})[s.HELMET_ATTRIBUTE]=!0,r);return Object.keys(e).forEach((function(t){var n=s.REACT_TAG_MAP[t]||t;if(n===s.TAG_PROPERTIES.INNER_HTML||n===s.TAG_PROPERTIES.CSS_TEXT){var r=e.innerHTML||e.cssText;i.dangerouslySetInnerHTML={__html:r}}else i[n]=e[t]})),o.default.createElement(t,i)}))}(t,e)},toString:function(){return function(t,e,n){return e.reduce((function(e,r){var i=Object.keys(r).filter((function(t){return!(t===s.TAG_PROPERTIES.INNER_HTML||t===s.TAG_PROPERTIES.CSS_TEXT)})).reduce((function(t,e){var i="undefined"===typeof r[e]?e:e+'="'+c(r[e],n)+'"';return t?t+" "+i:i}),""),o=r.innerHTML||r.cssText||"",a=-1===s.SELF_CLOSING_TAGS.indexOf(t);return e+"<"+t+" "+s.HELMET_ATTRIBUTE+'="true" '+i+(a?"/>":">"+o+"</"+t+">")}),"")}(t,e,n)}}}};e.convertReactPropstoHtmlAttributes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).reduce((function(e,n){return e[s.HTML_TAG_MAP[n]||n]=t[n],e}),e)},e.handleClientStateChange=function(t){w&&_(w),t.defer?w=v((function(){x(t,(function(){w=null}))})):(x(t),w=null)},e.mapStateOnServer=function(t){var e=t.baseTag,n=t.bodyAttributes,r=t.encode,i=t.htmlAttributes,o=t.linkTags,a=t.metaTags,u=t.noscriptTags,c=t.scriptTags,l=t.styleTags,h=t.title,p=void 0===h?"":h,f=t.titleAttributes;return{base:A(s.TAG_NAMES.BASE,e,r),bodyAttributes:A(s.ATTRIBUTE_NAMES.BODY,n,r),htmlAttributes:A(s.ATTRIBUTE_NAMES.HTML,i,r),link:A(s.TAG_NAMES.LINK,o,r),meta:A(s.TAG_NAMES.META,a,r),noscript:A(s.TAG_NAMES.NOSCRIPT,u,r),script:A(s.TAG_NAMES.SCRIPT,c,r),style:A(s.TAG_NAMES.STYLE,l,r),title:A(s.TAG_NAMES.TITLE,{title:p,titleAttributes:f},r)}},e.reducePropsToState=function(t){return{baseTag:f([s.TAG_PROPERTIES.HREF],t),bodyAttributes:p(s.ATTRIBUTE_NAMES.BODY,t),defer:m(t,s.HELMET_PROPS.DEFER),encode:m(t,s.HELMET_PROPS.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:p(s.ATTRIBUTE_NAMES.HTML,t),linkTags:d(s.TAG_NAMES.LINK,[s.TAG_PROPERTIES.REL,s.TAG_PROPERTIES.HREF],t),metaTags:d(s.TAG_NAMES.META,[s.TAG_PROPERTIES.NAME,s.TAG_PROPERTIES.CHARSET,s.TAG_PROPERTIES.HTTPEQUIV,s.TAG_PROPERTIES.PROPERTY,s.TAG_PROPERTIES.ITEM_PROP],t),noscriptTags:d(s.TAG_NAMES.NOSCRIPT,[s.TAG_PROPERTIES.INNER_HTML],t),onChangeClientState:h(t),scriptTags:d(s.TAG_NAMES.SCRIPT,[s.TAG_PROPERTIES.SRC,s.TAG_PROPERTIES.INNER_HTML],t),styleTags:d(s.TAG_NAMES.STYLE,[s.TAG_PROPERTIES.CSS_TEXT],t),title:l(t),titleAttributes:p(s.ATTRIBUTE_NAMES.TITLE,t)}},e.requestAnimationFrame=v,e.warn=b}).call(this,n(20))},,function(t,e,n){"use strict";n.r(e);var r=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|itemProp|itemScope|itemType|itemID|itemRef|on|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,i=function(t){var e={};return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}}((function(t){return r.test(t)||111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)<91}));e.default=i}]]);
//# sourceMappingURL=2.a9e2dd78.chunk.js.map